let t,e,i,n,o;function r(t,e,i,n){Object.defineProperty(t,e,{get:i,set:n,enumerable:!0,configurable:!0})}var s,a,l,h,c,d,u,f,p,g,m,v=globalThis,y={},b={},w=v.parcelRequire94c2;null==w&&((w=function(t){if(t in y)return y[t].exports;if(t in b){var e=b[t];delete b[t];var i={id:t,exports:{}};return y[t]=i,e.call(i.exports,i,i.exports),i.exports}var n=Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(t,e){b[t]=e},v.parcelRequire94c2=w);var x=w.register;x("b5jdx",function(t,e){r(t.exports,"register",()=>i,t=>i=t);var i,n=new Map;i=function(t,e){for(var i=0;i<e.length-1;i+=2)n.set(e[i],{baseUrl:t,path:e[i+1]})}}),x("clphu",function(t,e){let i;r(t.exports,"Hammer",()=>hq),r(t.exports,"util",()=>hU),r(t.exports,"Queue",()=>fG),r(t.exports,"DataSet",()=>fZ),r(t.exports,"DataView",()=>fJ),r(t.exports,"data",()=>f2),r(t.exports,"keycharm",()=>gE),r(t.exports,"Network",()=>mD),r(t.exports,"DOMutil",()=>mR),r(t.exports,"network",()=>mN),r(t.exports,"default",()=>mL);/**
 * vis-network
 * https://visjs.github.io/vis-network/
 *
 * A dynamic, browser-based visualization library.
 *
 * @version 9.1.9
 * @date    2023-11-03T01:44:38.007Z
 *
 * @copyright (c) 2011-2017 Almende B.V, http://almende.com
 * @copyright (c) 2017-2019 visjs contributors, https://github.com/visjs
 *
 * @license
 * vis.js is dual licensed under both
 *
 *   1. The Apache 2.0 License
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *   and
 *
 *   2. The MIT License
 *      http://opensource.org/licenses/MIT
 *
 * vis.js may be distributed under either license.
 */var n,o,s,a,l,h,c,d,u,f,p,g,m,y,b,w,x,k,O,S,_,C,E,M,P,T,A,D,I,B,z,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==v?v:"undefined"!=typeof self?self:{};function N(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var L=function(t){return t&&t.Math===Math&&t},F=L("object"==typeof globalThis&&globalThis)||L("object"==typeof window&&window)||L("object"==typeof self&&self)||L("object"==typeof R&&R)||function(){return this}()||R||Function("return this")(),j=function(t){try{return!!t()}catch(t){return!0}},H=!j(function(){var t=(function(){}).bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),W=Function.prototype,V=W.apply,Q=W.call,$="object"==typeof Reflect&&Reflect.apply||(H?Q.bind(V):function(){return Q.apply(V,arguments)}),q=Function.prototype,U=q.call,Y=H&&q.bind.bind(U,U),G=H?Y:function(t){return function(){return U.apply(t,arguments)}},X=G({}.toString),K=G("".slice),Z=function(t){return K(X(t),8,-1)},J=function(t){if("Function"===Z(t))return G(t)},tt="object"==typeof document&&document.all,te={all:tt,IS_HTMLDDA:void 0===tt&&void 0!==tt},ti=te.all,tn=te.IS_HTMLDDA?function(t){return"function"==typeof t||t===ti}:function(t){return"function"==typeof t},to={},tr=!j(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}),ts=Function.prototype.call,ta=H?ts.bind(ts):function(){return ts.apply(ts,arguments)},tl={},th={}.propertyIsEnumerable,tc=Object.getOwnPropertyDescriptor,td=tc&&!th.call({1:2},1);tl.f=td?function(t){var e=tc(this,t);return!!e&&e.enumerable}:th;var tu=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},tf=Object,tp=G("".split),tg=j(function(){return!tf("z").propertyIsEnumerable(0)})?function(t){return"String"===Z(t)?tp(t,""):tf(t)}:tf,tm=function(t){return null==t},tv=TypeError,ty=function(t){if(tm(t))throw new tv("Can't call method on "+t);return t},tb=function(t){return tg(ty(t))},tw=te.all,tx=te.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:tn(t)||t===tw}:function(t){return"object"==typeof t?null!==t:tn(t)},tk={},tO=function(t){return tn(t)?t:void 0},tS=function(t,e){return arguments.length<2?tO(tk[t])||tO(F[t]):tk[t]&&tk[t][e]||F[t]&&F[t][e]},t_=G({}.isPrototypeOf),tC="undefined"!=typeof navigator&&String(navigator.userAgent)||"",tE=F.process,tM=F.Deno,tP=tE&&tE.versions||tM&&tM.version,tT=tP&&tP.v8;tT&&(a=(s=tT.split("."))[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&tC&&(!(s=tC.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=tC.match(/Chrome\/(\d+)/))&&(a=+s[1]);var tA=a,tD=F.String,tI=!!Object.getOwnPropertySymbols&&!j(function(){var t=Symbol("symbol detection");return!tD(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&tA&&tA<41}),tB=tI&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,tz=Object,tR=tB?function(t){return"symbol"==typeof t}:function(t){var e=tS("Symbol");return tn(e)&&t_(e.prototype,tz(t))},tN=String,tL=function(t){try{return tN(t)}catch(t){return"Object"}},tF=TypeError,tj=function(t){if(tn(t))return t;throw new tF(tL(t)+" is not a function")},tH=function(t,e){var i=t[e];return tm(i)?void 0:tj(i)},tW=TypeError,tV={exports:{}},tQ=Object.defineProperty,t$="__core-js_shared__",tq=F[t$]||function(t,e){try{tQ(F,t,{value:e,configurable:!0,writable:!0})}catch(i){F[t]=e}return e}(t$,{});(tV.exports=function(t,e){return tq[t]||(tq[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.33.0",mode:"pure",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"});var tU=tV.exports,tY=Object,tG=function(t){return tY(ty(t))},tX=G({}.hasOwnProperty),tK=Object.hasOwn||function(t,e){return tX(tG(t),e)},tZ=0,tJ=Math.random(),t0=G(1..toString),t1=function(t){return"Symbol("+(void 0===t?"":t)+")_"+t0(++tZ+tJ,36)},t2=F.Symbol,t5=tU("wks"),t3=tB?t2.for||t2:t2&&t2.withoutSetter||t1,t4=function(t){return tK(t5,t)||(t5[t]=tI&&tK(t2,t)?t2[t]:t3("Symbol."+t)),t5[t]},t8=function(t,e){var i,n;if("string"===e&&tn(i=t.toString)&&!tx(n=ta(i,t))||tn(i=t.valueOf)&&!tx(n=ta(i,t))||"string"!==e&&tn(i=t.toString)&&!tx(n=ta(i,t)))return n;throw new tW("Can't convert object to primitive value")},t6=TypeError,t9=t4("toPrimitive"),t7=function(t,e){if(!tx(t)||tR(t))return t;var i,n=tH(t,t9);if(n){if(void 0===e&&(e="default"),!tx(i=ta(n,t,e))||tR(i))return i;throw new t6("Can't convert object to primitive value")}return void 0===e&&(e="number"),t8(t,e)},et=function(t){var e=t7(t,"string");return tR(e)?e:e+""},ee=F.document,ei=tx(ee)&&tx(ee.createElement),en=function(t){return ei?ee.createElement(t):{}},eo=!tr&&!j(function(){return 7!==Object.defineProperty(en("div"),"a",{get:function(){return 7}}).a}),er=Object.getOwnPropertyDescriptor;to.f=tr?er:function(t,e){if(t=tb(t),e=et(e),eo)try{return er(t,e)}catch(t){}if(tK(t,e))return tu(!ta(tl.f,t,e),t[e])};var es=/#|\.prototype\./,ea=function(t,e){var i=eh[el(t)];return i===ed||i!==ec&&(tn(e)?j(e):!!e)},el=ea.normalize=function(t){return String(t).replace(es,".").toLowerCase()},eh=ea.data={},ec=ea.NATIVE="N",ed=ea.POLYFILL="P",eu=J(J.bind),ef=function(t,e){return tj(t),void 0===e?t:H?eu(t,e):function(){return t.apply(e,arguments)}},ep={},eg=tr&&j(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),em=String,ev=TypeError,ey=function(t){if(tx(t))return t;throw new ev(em(t)+" is not an object")},eb=TypeError,ew=Object.defineProperty,ex=Object.getOwnPropertyDescriptor,ek="enumerable",eO="configurable",eS="writable";ep.f=tr?eg?function(t,e,i){if(ey(t),e=et(e),ey(i),"function"==typeof t&&"prototype"===e&&"value"in i&&eS in i&&!i[eS]){var n=ex(t,e);n&&n[eS]&&(t[e]=i.value,i={configurable:eO in i?i[eO]:n[eO],enumerable:ek in i?i[ek]:n[ek],writable:!1})}return ew(t,e,i)}:ew:function(t,e,i){if(ey(t),e=et(e),ey(i),eo)try{return ew(t,e,i)}catch(t){}if("get"in i||"set"in i)throw new eb("Accessors not supported");return"value"in i&&(t[e]=i.value),t};var e_=tr?function(t,e,i){return ep.f(t,e,tu(1,i))}:function(t,e,i){return t[e]=i,t},eC=to.f,eE=function(t){var e=function(i,n,o){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(i);case 2:return new t(i,n)}return new t(i,n,o)}return $(t,this,arguments)};return e.prototype=t.prototype,e},eM=function(t,e){var i,n,o,r,s,a,l,h,c,d=t.target,u=t.global,f=t.stat,p=t.proto,g=u?F:f?F[d]:(F[d]||{}).prototype,m=u?tk:tk[d]||e_(tk,d,{})[d],v=m.prototype;for(r in e)n=!(i=ea(u?r:d+(f?".":"#")+r,t.forced))&&g&&tK(g,r),a=m[r],n&&(l=t.dontCallGetSet?(c=eC(g,r))&&c.value:g[r]),s=n&&l?l:e[r],(!n||typeof a!=typeof s)&&(h=t.bind&&n?ef(s,F):t.wrap&&n?eE(s):p&&tn(s)?J(s):s,(t.sham||s&&s.sham||a&&a.sham)&&e_(h,"sham",!0),e_(m,r,h),p&&(tK(tk,o=d+"Prototype")||e_(tk,o,{}),e_(tk[o],r,s),t.real&&v&&(i||!v[r])&&e_(v,r,s)))},eP=Math.ceil,eT=Math.floor,eA=Math.trunc||function(t){var e=+t;return(e>0?eT:eP)(e)},eD=function(t){var e=+t;return e!=e||0===e?0:eA(e)},eI=Math.max,eB=Math.min,ez=function(t,e){var i=eD(t);return i<0?eI(i+e,0):eB(i,e)},eR=Math.min,eN=function(t){var e;return(e=t.length)>0?eR(eD(e),0x1fffffffffffff):0},eL=function(t){return function(e,i,n){var o,r=tb(e),s=eN(r),a=ez(n,s);if(t&&i!=i){for(;s>a;)if((o=r[a++])!=o)return!0}else for(;s>a;a++)if((t||a in r)&&r[a]===i)return t||a||0;return!t&&-1}},eF={includes:eL(!0),indexOf:eL(!1)},ej={},eH=eF.indexOf,eW=G([].push),eV=function(t,e){var i,n=tb(t),o=0,r=[];for(i in n)!tK(ej,i)&&tK(n,i)&&eW(r,i);for(;e.length>o;)tK(n,i=e[o++])&&(~eH(r,i)||eW(r,i));return r},eQ=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],e$=Object.keys||function(t){return eV(t,eQ)},eq={};eq.f=Object.getOwnPropertySymbols;var eU=Object.assign,eY=Object.defineProperty,eG=G([].concat),eX=!eU||j(function(){if(tr&&1!==eU({b:1},eU(eY({},"a",{enumerable:!0,get:function(){eY(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol("assign detection"),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!==eU({},t)[i]||e$(eU({},e)).join("")!==n})?function(t,e){for(var i=tG(t),n=arguments.length,o=1,r=eq.f,s=tl.f;n>o;)for(var a,l=tg(arguments[o++]),h=r?eG(e$(l),r(l)):e$(l),c=h.length,d=0;c>d;)a=h[d++],(!tr||ta(s,l,a))&&(i[a]=l[a]);return i}:eU;eM({target:"Object",stat:!0,arity:2,forced:Object.assign!==eX},{assign:eX});var eK=N(tk.Object.assign),eZ=G([].slice),eJ=Function,e0=G([].concat),e1=G([].join),e2={},e5=function(t,e,i){if(!tK(e2,e)){for(var n=[],o=0;o<e;o++)n[o]="a["+o+"]";e2[e]=eJ("C,a","return new C("+e1(n,",")+")")}return e2[e](t,i)},e3=H?eJ.bind:function(t){var e=tj(this),i=e.prototype,n=eZ(arguments,1),o=function(){var i=e0(n,eZ(arguments));return this instanceof o?e5(e,i.length,i):e.apply(t,i)};return tx(i)&&(o.prototype=i),o};eM({target:"Function",proto:!0,forced:Function.bind!==e3},{bind:e3});var e4=function(t){return tk[t+"Prototype"]},e8=e4("Function").bind,e6=Function.prototype,e9=function(t){var e=t.bind;return t===e6||t_(e6,t)&&e===e6.bind?e8:e},e7=N(e9);function it(t,e,i,n){t.beginPath(),t.arc(e,i,n,0,2*Math.PI,!1),t.closePath()}function ie(t,e,i,n,o,r){var s=Math.PI/180;n-2*r<0&&(r=n/2),o-2*r<0&&(r=o/2),t.beginPath(),t.moveTo(e+r,i),t.lineTo(e+n-r,i),t.arc(e+n-r,i+r,r,270*s,360*s,!1),t.lineTo(e+n,i+o-r),t.arc(e+n-r,i+o-r,r,0,90*s,!1),t.lineTo(e+r,i+o),t.arc(e+r,i+o-r,r,90*s,180*s,!1),t.lineTo(e,i+r),t.arc(e+r,i+r,r,180*s,270*s,!1),t.closePath()}function ii(t,e,i,n,o){var r=n/2*.5522848,s=o/2*.5522848,a=e+n,l=i+o,h=e+n/2,c=i+o/2;t.beginPath(),t.moveTo(e,c),t.bezierCurveTo(e,c-s,h-r,i,h,i),t.bezierCurveTo(h+r,i,a,c-s,a,c),t.bezierCurveTo(a,c+s,h+r,l,h,l),t.bezierCurveTo(h-r,l,e,c+s,e,c),t.closePath()}function io(t,e,i,n,o){var r=1/3*o,s=n/2*.5522848,a=r/2*.5522848,l=e+n,h=i+r,c=e+n/2,d=i+r/2,u=i+(o-r/2),f=i+o;t.beginPath(),t.moveTo(l,d),t.bezierCurveTo(l,d+a,c+s,h,c,h),t.bezierCurveTo(c-s,h,e,d+a,e,d),t.bezierCurveTo(e,d-a,c-s,i,c,i),t.bezierCurveTo(c+s,i,l,d-a,l,d),t.lineTo(l,u),t.bezierCurveTo(l,u+a,c+s,f,c,f),t.bezierCurveTo(c-s,f,e,u+a,e,u),t.lineTo(e,d)}function ir(t,e,i,n,o,r){t.beginPath(),t.moveTo(e,i);for(var s=r.length,a=n-e,l=o-i,h=l/a,c=Math.sqrt(a*a+l*l),d=0,u=!0,f=0,p=+r[0];c>=.1;)(p=+r[d++%s])>c&&(p=c),f=Math.sqrt(p*p/(1+h*h)),e+=f=a<0?-f:f,i+=h*f,!0===u?t.lineTo(e,i):t.moveTo(e,i),c-=p,u=!u}var is={circle:it,dashedLine:ir,database:io,diamond:function(t,e,i,n){t.beginPath(),t.lineTo(e,i+n),t.lineTo(e+n,i),t.lineTo(e,i-n),t.lineTo(e-n,i),t.closePath()},ellipse:ii,ellipse_vis:ii,hexagon:function(t,e,i,n){t.beginPath();var o=2*Math.PI/6;t.moveTo(e+n,i);for(var r=1;r<6;r++)t.lineTo(e+n*Math.cos(o*r),i+n*Math.sin(o*r));t.closePath()},roundRect:ie,square:function(t,e,i,n){t.beginPath(),t.rect(e-n,i-n,2*n,2*n),t.closePath()},star:function(t,e,i,n){t.beginPath(),n*=.82,i+=.1*n;for(var o=0;o<10;o++){var r=o%2==0?1.3*n:.5*n;t.lineTo(e+r*Math.sin(2*o*Math.PI/10),i-r*Math.cos(2*o*Math.PI/10))}t.closePath()},triangle:function(t,e,i,n){t.beginPath(),n*=1.15,i+=.275*n;var o=2*n,r=o/2,s=Math.sqrt(3)/6*o,a=Math.sqrt(o*o-r*r);t.moveTo(e,i-(a-s)),t.lineTo(e+r,i+s),t.lineTo(e-r,i+s),t.lineTo(e,i-(a-s)),t.closePath()},triangleDown:function(t,e,i,n){t.beginPath(),n*=1.15,i-=.275*n;var o=2*n,r=o/2,s=Math.sqrt(3)/6*o,a=Math.sqrt(o*o-r*r);t.moveTo(e,i+(a-s)),t.lineTo(e+r,i-s),t.lineTo(e-r,i-s),t.lineTo(e,i+(a-s)),t.closePath()}},ia={exports:{}};!function(t){function e(t){if(t)return function(t){for(var i in e.prototype)t[i]=e.prototype[i];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<n.length;o++)if((i=n[o])===e||i.fn===e){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=Array(arguments.length-1),i=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(i){i=i.slice(0);for(var n=0,o=i.length;n<o;++n)i[n].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}}(ia);var il=N(ia.exports),ih=t4("toStringTag"),ic={};ic[ih]="z";var id="[object z]"===String(ic),iu=t4("toStringTag"),ip=Object,ig="Arguments"===Z(function(){return arguments}()),im=function(t,e){try{return t[e]}catch(t){}},iv=id?Z:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=im(e=ip(t),iu))?i:ig?Z(e):"Object"===(n=Z(e))&&tn(e.callee)?"Arguments":n},iy=String,ib=function(t){if("Symbol"===iv(t))throw TypeError("Cannot convert a Symbol value to a string");return iy(t)},iw=G("".charAt),ix=G("".charCodeAt),ik=G("".slice),iO=function(t){return function(e,i){var n,o,r=ib(ty(e)),s=eD(i),a=r.length;return s<0||s>=a?t?"":void 0:(n=ix(r,s))<55296||n>56319||s+1===a||(o=ix(r,s+1))<56320||o>57343?t?iw(r,s):n:t?ik(r,s,s+2):(n-55296<<10)+(o-56320)+65536}},iS={codeAt:iO(!1),charAt:iO(!0)},i_=F.WeakMap,iC=tn(i_)&&/native code/.test(String(i_)),iE=tU("keys"),iM=function(t){return iE[t]||(iE[t]=t1(t))},iP="Object already initialized",iT=F.TypeError,iA=F.WeakMap;if(iC||tq.state){var iD=tq.state||(tq.state=new iA);iD.get=iD.get,iD.has=iD.has,iD.set=iD.set,l=function(t,e){if(iD.has(t))throw new iT(iP);return e.facade=t,iD.set(t,e),e},h=function(t){return iD.get(t)||{}},c=function(t){return iD.has(t)}}else{var iI=iM("state");ej[iI]=!0,l=function(t,e){if(tK(t,iI))throw new iT(iP);return e.facade=t,e_(t,iI,e),e},h=function(t){return tK(t,iI)?t[iI]:{}},c=function(t){return tK(t,iI)}}var iB=l,iz=function(t){return function(e){var i;if(!tx(e)||(i=h(e)).type!==t)throw new iT("Incompatible receiver, "+t+" required");return i}},iR=Function.prototype,iN=tr&&Object.getOwnPropertyDescriptor,iL=tK(iR,"name"),iF=iL&&(!tr||tr&&iN(iR,"name").configurable),ij={};ij.f=tr&&!eg?Object.defineProperties:function(t,e){ey(t);for(var i,n=tb(e),o=e$(e),r=o.length,s=0;r>s;)ep.f(t,i=o[s++],n[i]);return t};var iH=tS("document","documentElement"),iW="prototype",iV="script",iQ=iM("IE_PROTO"),i$=function(){},iq=function(t){return"<"+iV+">"+t+"</"+iV+">"},iU=function(t){t.write(iq("")),t.close();var e=t.parentWindow.Object;return t=null,e},iY=function(){var t,e=en("iframe");return e.style.display="none",iH.appendChild(e),e.src=String("java"+iV+":"),(t=e.contentWindow.document).open(),t.write(iq("document.F=Object")),t.close(),t.F},iG=function(){try{d=new ActiveXObject("htmlfile")}catch(t){}iG="undefined"!=typeof document?document.domain&&d?iU(d):iY():iU(d);for(var t=eQ.length;t--;)delete iG[iW][eQ[t]];return iG()};ej[iQ]=!0;var iX=Object.create||function(t,e){var i;return null!==t?(i$[iW]=ey(t),i=new i$,i$[iW]=null,i[iQ]=t):i=iG(),void 0===e?i:ij.f(i,e)},iK=!j(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),iZ=iM("IE_PROTO"),iJ=Object,i0=iJ.prototype,i1=iK?iJ.getPrototypeOf:function(t){var e=tG(t);if(tK(e,iZ))return e[iZ];var i=e.constructor;return tn(i)&&e instanceof i?i.prototype:e instanceof iJ?i0:null},i2=function(t,e,i,n){return n&&n.enumerable?t[e]=i:e_(t,e,i),t},i5=t4("iterator"),i3=!1;[].keys&&("next"in(p=[].keys())?(f=i1(i1(p)))!==Object.prototype&&(u=f):i3=!0),tn((u=!tx(u)||j(function(){var t={};return u[i5].call(t)!==t})?{}:iX(u))[i5])||i2(u,i5,function(){return this});var i4=u,i8=i3,i6=ep.f,i9=id?({}).toString:function(){return"[object "+iv(this)+"]"},i7=t4("toStringTag"),nt=function(t,e,i,n){if(t){var o=i?t:t.prototype;tK(o,i7)||i6(o,i7,{configurable:!0,value:e}),n&&!id&&e_(o,"toString",i9)}},ne={},ni=function(){return this},nn=String,no=TypeError,nr=function(t,e,i){try{return G(tj(Object.getOwnPropertyDescriptor(t,e)[i]))}catch(t){}},ns=function(t){if("object"==typeof t||tn(t))return t;throw new no("Can't set "+nn(t)+" as a prototype")},na=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=nr(Object.prototype,"__proto__","set"))(i,[]),e=i instanceof Array}catch(t){}return function(i,n){return ey(i),ns(n),e?t(i,n):i.__proto__=n,i}}():void 0),nl={PROPER:iL&&"something"===(function(){}).name,CONFIGURABLE:iF},nh=function(t,e,i,n){var o=e+" Iterator";return t.prototype=iX(i4,{next:tu(+!n,i)}),nt(t,o,!1,!0),ne[o]=ni,t},nc=nl.PROPER;nl.CONFIGURABLE;var nd=t4("iterator"),nu="keys",nf="values",np="entries",ng=function(){return this},nm=function(t,e,i,n,o,r,s){nh(i,e,n);var a,l,h,c=function(t){if(t===o&&g)return g;if(!i8&&t&&t in f)return f[t];switch(t){case nu:case nf:case np:return function(){return new i(this,t)}}return function(){return new i(this)}},d=e+" Iterator",u=!1,f=t.prototype,p=f[nd]||f["@@iterator"]||o&&f[o],g=!i8&&p||c(o),m="Array"===e&&f.entries||p;if(m&&(a=i1(m.call(new t)))!==Object.prototype&&a.next&&(nt(a,d,!0,!0),ne[d]=ng),nc&&o===nf&&p&&p.name!==nf&&(u=!0,g=function(){return ta(p,this)}),o){if(l={values:c(nf),keys:r?g:c(nu),entries:c(np)},s)for(h in l)!i8&&!u&&h in f||i2(f,h,l[h]);else eM({target:e,proto:!0,forced:i8||u},l)}return s&&f[nd]!==g&&i2(f,nd,g,{name:o}),ne[e]=g,l},nv=function(t,e){return{value:t,done:e}},ny=iS.charAt,nb="String Iterator",nw=iz(nb);nm(String,"String",function(t){iB(this,{type:nb,string:ib(t),index:0})},function(){var t,e=nw(this),i=e.string,n=e.index;return n>=i.length?nv(void 0,!0):(t=ny(i,n),e.index+=t.length,nv(t,!1))});var nx=function(t,e,i){var n,o;ey(t);try{if(!(n=tH(t,"return"))){if("throw"===e)throw i;return i}n=ta(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw i;if(o)throw n;return ey(n),i},nk=t4("iterator"),nO=Array.prototype,nS=function(t){return void 0!==t&&(ne.Array===t||nO[nk]===t)},n_=G(Function.toString);tn(tq.inspectSource)||(tq.inspectSource=function(t){return n_(t)});var nC=tq.inspectSource,nE=function(){},nM=[],nP=tS("Reflect","construct"),nT=/^\s*(?:class|function)\b/,nA=G(nT.exec),nD=!nT.test(nE),nI=function(t){if(!tn(t))return!1;try{return nP(nE,nM,t),!0}catch(t){return!1}},nB=function(t){if(!tn(t))return!1;switch(iv(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return nD||!!nA(nT,nC(t))}catch(t){return!0}};nB.sham=!0;var nz=!nP||j(function(){var t;return nI(nI.call)||!nI(Object)||!nI(function(){t=!0})||t})?nB:nI,nR=function(t,e,i){var n=et(e);n in t?ep.f(t,n,tu(0,i)):t[n]=i},nN=t4("iterator"),nL=function(t){if(!tm(t))return tH(t,nN)||tH(t,"@@iterator")||ne[iv(t)]},nF=TypeError,nj=function(t,e){var i=arguments.length<2?nL(t):e;if(tj(i))return ey(ta(i,t));throw new nF(tL(t)+" is not iterable")},nH=function(t,e,i,n){try{return n?e(ey(i)[0],i[1]):e(i)}catch(e){nx(t,"throw",e)}},nW=Array,nV=t4("iterator"),nQ=!1;try{var n$=0,nq={next:function(){return{done:!!n$++}},return:function(){nQ=!0}};nq[nV]=function(){return this},Array.from(nq,function(){throw 2})}catch(t){}var nU=function(t,e){try{if(!e&&!nQ)return!1}catch(t){return!1}var i=!1;try{var n={};n[nV]=function(){return{next:function(){return{done:i=!0}}}},t(n)}catch(t){}return i};eM({target:"Array",stat:!0,forced:!nU(function(t){Array.from(t)})},{from:function(t){var e,i,n,o,r,s,a=tG(t),l=nz(this),h=arguments.length,c=h>1?arguments[1]:void 0,d=void 0!==c;d&&(c=ef(c,h>2?arguments[2]:void 0));var u=nL(a),f=0;if(u&&!(this===nW&&nS(u)))for(r=(o=nj(a,u)).next,i=l?new this:[];!(n=ta(r,o)).done;f++)s=d?nH(o,c,[n.value,f],!0):n.value,nR(i,f,s);else for(e=eN(a),i=l?new this(e):nW(e);e>f;f++)s=d?c(a[f],f):a[f],nR(i,f,s);return i.length=f,i}});var nY=tk.Array.from,nG=N(nY);ep.f;var nX="Array Iterator",nK=iz(nX);nm(Array,"Array",function(t,e){iB(this,{type:nX,target:tb(t),index:0,kind:e})},function(){var t=nK(this),e=t.target,i=t.kind,n=t.index++;if(!e||n>=e.length)return t.target=void 0,nv(void 0,!0);switch(i){case"keys":return nv(n,!1);case"values":return nv(e[n],!1)}return nv([n,e[n]],!1)},"values"),ne.Arguments=ne.Array;var nZ={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},nJ=t4("toStringTag");for(var n0 in nZ){var n1=F[n0],n2=n1&&n1.prototype;n2&&iv(n2)!==nJ&&e_(n2,nJ,n0),ne[n0]=ne.Array}var n5=N(nL),n3=N(nL);function n4(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}var n8={exports:{}},n6=ep.f;eM({target:"Object",stat:!0,forced:Object.defineProperty!==n6,sham:!tr},{defineProperty:n6});var n9=tk.Object,n7=n8.exports=function(t,e,i){return n9.defineProperty(t,e,i)};n9.defineProperty.sham&&(n7.sham=!0);var ot=n8.exports,oe=N(ot),oi=Array.isArray||function(t){return"Array"===Z(t)},on=TypeError,oo=function(t){if(t>0x1fffffffffffff)throw on("Maximum allowed index exceeded");return t},or=t4("species"),os=Array,oa=function(t){var e;return oi(t)&&(nz(e=t.constructor)&&(e===os||oi(e.prototype))?e=void 0:tx(e)&&null===(e=e[or])&&(e=void 0)),void 0===e?os:e},ol=function(t,e){return new(oa(t))(0===e?0:e)},oh=t4("species"),oc=function(t){return tA>=51||!j(function(){var e=[];return(e.constructor={})[oh]=function(){return{foo:1}},1!==e[t](Boolean).foo})},od=t4("isConcatSpreadable"),ou=tA>=51||!j(function(){var t=[];return t[od]=!1,t.concat()[0]!==t}),of=function(t){if(!tx(t))return!1;var e=t[od];return void 0!==e?!!e:oi(t)};eM({target:"Array",proto:!0,arity:1,forced:!ou||!oc("concat")},{concat:function(t){var e,i,n,o,r,s=tG(this),a=ol(s,0),l=0;for(e=-1,n=arguments.length;e<n;e++)if(r=-1===e?s:arguments[e],of(r))for(oo(l+(o=eN(r))),i=0;i<o;i++,l++)i in r&&nR(a,l,r[i]);else oo(l+1),nR(a,l++,r);return a.length=l,a}});var op={},og=eQ.concat("length","prototype");op.f=Object.getOwnPropertyNames||function(t){return eV(t,og)};var om={},ov=Array,oy=Math.max,ob=function(t,e,i){for(var n=eN(t),o=ez(e,n),r=ez(void 0===i?n:i,n),s=ov(oy(r-o,0)),a=0;o<r;o++,a++)nR(s,a,t[o]);return s.length=a,s},ow=op.f,ox="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ok=function(t){try{return ow(t)}catch(t){return ob(ox)}};om.f=function(t){return ox&&"Window"===Z(t)?ok(t):ow(tb(t))};var oO=function(t,e,i){return ep.f(t,e,i)},oS={};oS.f=t4;var o_=ep.f,oC=function(t){var e=tk.Symbol||(tk.Symbol={});tK(e,t)||o_(e,t,{value:oS.f(t)})},oE=function(){var t=tS("Symbol"),e=t&&t.prototype,i=e&&e.valueOf,n=t4("toPrimitive");e&&!e[n]&&i2(e,n,function(t){return ta(i,this)},{arity:1})},oM=G([].push),oP=function(t){var e=1===t,i=2===t,n=3===t,o=4===t,r=6===t,s=7===t,a=5===t||r;return function(l,h,c,d){for(var u,f,p=tG(l),g=tg(p),m=ef(h,c),v=eN(g),y=0,b=d||ol,w=e?b(l,v):i||s?b(l,0):void 0;v>y;y++)if((a||y in g)&&(f=m(u=g[y],y,p),t)){if(e)w[y]=f;else if(f)switch(t){case 3:return!0;case 5:return u;case 6:return y;case 2:oM(w,u)}else switch(t){case 4:return!1;case 7:oM(w,u)}}return r?-1:n||o?o:w}},oT={forEach:oP(0),map:oP(1),filter:oP(2),some:oP(3),every:oP(4),find:oP(5),findIndex:oP(6),filterReject:oP(7)},oA=oT.forEach,oD=iM("hidden"),oI="Symbol",oB="prototype",oz=iz(oI),oR=Object[oB],oN=F.Symbol,oL=oN&&oN[oB],oF=F.RangeError,oj=F.TypeError,oH=F.QObject,oW=to.f,oV=ep.f,oQ=om.f,o$=tl.f,oq=G([].push),oU=tU("symbols"),oY=tU("op-symbols"),oG=tU("wks"),oX=!oH||!oH[oB]||!oH[oB].findChild,oK=function(t,e,i){var n=oW(oR,e);n&&delete oR[e],oV(t,e,i),n&&t!==oR&&oV(oR,e,n)},oZ=tr&&j(function(){return 7!==iX(oV({},"a",{get:function(){return oV(this,"a",{value:7}).a}})).a})?oK:oV,oJ=function(t,e){var i=oU[t]=iX(oL);return iB(i,{type:oI,tag:t,description:e}),tr||(i.description=e),i},o0=function(t,e,i){t===oR&&o0(oY,e,i),ey(t);var n=et(e);return(ey(i),tK(oU,n))?(i.enumerable?(tK(t,oD)&&t[oD][n]&&(t[oD][n]=!1),i=iX(i,{enumerable:tu(0,!1)})):(tK(t,oD)||oV(t,oD,tu(1,{})),t[oD][n]=!0),oZ(t,n,i)):oV(t,n,i)},o1=function(t,e){ey(t);var i=tb(e);return oA(e$(i).concat(o4(i)),function(e){(!tr||ta(o2,i,e))&&o0(t,e,i[e])}),t},o2=function(t){var e=et(t),i=ta(o$,this,e);return(!(this===oR&&tK(oU,e))||!!tK(oY,e))&&(!(i||!tK(this,e)||!tK(oU,e)||tK(this,oD)&&this[oD][e])||i)},o5=function(t,e){var i=tb(t),n=et(e);if(!(i===oR&&tK(oU,n))||tK(oY,n)){var o=oW(i,n);return o&&tK(oU,n)&&!(tK(i,oD)&&i[oD][n])&&(o.enumerable=!0),o}},o3=function(t){var e=oQ(tb(t)),i=[];return oA(e,function(t){tK(oU,t)||tK(ej,t)||oq(i,t)}),i},o4=function(t){var e=t===oR,i=oQ(e?oY:tb(t)),n=[];return oA(i,function(t){tK(oU,t)&&(!e||tK(oR,t))&&oq(n,oU[t])}),n};!tI&&(i2(oL=(oN=function(){if(t_(oL,this))throw new oj("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?ib(arguments[0]):void 0,e=t1(t),i=function(t){this===oR&&ta(i,oY,t),tK(this,oD)&&tK(this[oD],e)&&(this[oD][e]=!1);var n=tu(1,t);try{oZ(this,e,n)}catch(t){if(!(t instanceof oF))throw t;oK(this,e,n)}};return tr&&oX&&oZ(oR,e,{configurable:!0,set:i}),oJ(e,t)})[oB],"toString",function(){return oz(this).tag}),i2(oN,"withoutSetter",function(t){return oJ(t1(t),t)}),tl.f=o2,ep.f=o0,ij.f=o1,to.f=o5,op.f=om.f=o3,eq.f=o4,oS.f=function(t){return oJ(t4(t),t)},tr&&oO(oL,"description",{configurable:!0,get:function(){return oz(this).description}})),eM({global:!0,constructor:!0,wrap:!0,forced:!tI,sham:!tI},{Symbol:oN}),oA(e$(oG),function(t){oC(t)}),eM({target:oI,stat:!0,forced:!tI},{useSetter:function(){oX=!0},useSimple:function(){oX=!1}}),eM({target:"Object",stat:!0,forced:!tI,sham:!tr},{create:function(t,e){return void 0===e?iX(t):o1(iX(t),e)},defineProperty:o0,defineProperties:o1,getOwnPropertyDescriptor:o5}),eM({target:"Object",stat:!0,forced:!tI},{getOwnPropertyNames:o3}),oE(),nt(oN,oI),ej[oD]=!0;var o8=tI&&!!Symbol.for&&!!Symbol.keyFor,o6=tU("string-to-symbol-registry"),o9=tU("symbol-to-string-registry");eM({target:"Symbol",stat:!0,forced:!o8},{for:function(t){var e=ib(t);if(tK(o6,e))return o6[e];var i=tS("Symbol")(e);return o6[e]=i,o9[i]=e,i}});var o7=tU("symbol-to-string-registry");eM({target:"Symbol",stat:!0,forced:!o8},{keyFor:function(t){if(!tR(t))throw TypeError(tL(t)+" is not a symbol");if(tK(o7,t))return o7[t]}});var rt=G([].push),re=function(t){if(tn(t))return t;if(oi(t)){for(var e=t.length,i=[],n=0;n<e;n++){var o=t[n];"string"==typeof o?rt(i,o):("number"==typeof o||"Number"===Z(o)||"String"===Z(o))&&rt(i,ib(o))}var r=i.length,s=!0;return function(t,e){if(s)return s=!1,e;if(oi(this))return e;for(var n=0;n<r;n++)if(i[n]===t)return e}}},ri=String,rn=tS("JSON","stringify"),ro=G(/./.exec),rr=G("".charAt),rs=G("".charCodeAt),ra=G("".replace),rl=G(1..toString),rh=/[\uD800-\uDFFF]/g,rc=/^[\uD800-\uDBFF]$/,rd=/^[\uDC00-\uDFFF]$/,ru=!tI||j(function(){var t=tS("Symbol")("stringify detection");return"[null]"!==rn([t])||"{}"!==rn({a:t})||"{}"!==rn(Object(t))}),rf=j(function(){return'"\udf06\ud834"'!==rn("\uDF06\uD834")||'"\udead"'!==rn("\uDEAD")}),rp=function(t,e){var i=eZ(arguments),n=re(e);if(!(!tn(n)&&(void 0===t||tR(t))))return i[1]=function(t,e){if(tn(n)&&(e=ta(n,this,ri(t),e)),!tR(e))return e},$(rn,null,i)},rg=function(t,e,i){var n=rr(i,e-1),o=rr(i,e+1);return ro(rc,t)&&!ro(rd,o)||ro(rd,t)&&!ro(rc,n)?"\\u"+rl(rs(t,0),16):t};rn&&eM({target:"JSON",stat:!0,arity:3,forced:ru||rf},{stringify:function(t,e,i){var n=eZ(arguments),o=$(ru?rp:rn,null,n);return rf&&"string"==typeof o?ra(o,rh,rg):o}}),eM({target:"Object",stat:!0,forced:!tI||j(function(){eq.f(1)})},{getOwnPropertySymbols:function(t){var e=eq.f;return e?e(tG(t)):[]}}),oC("asyncIterator"),oC("hasInstance"),oC("isConcatSpreadable"),oC("iterator"),oC("match"),oC("matchAll"),oC("replace"),oC("search"),oC("species"),oC("split"),oC("toPrimitive"),oE(),oC("toStringTag"),nt(tS("Symbol"),"Symbol"),oC("unscopables"),nt(F.JSON,"JSON",!0);var rm=tk.Symbol,rv=ep.f,ry=t4("metadata"),rb=Function.prototype;void 0===rb[ry]&&rv(rb,ry,{value:null}),oC("asyncDispose"),oC("dispose"),oC("metadata");var rw=tS("Symbol"),rx=rw.keyFor,rk=G(rw.prototype.valueOf),rO=rw.isRegisteredSymbol||function(t){try{return void 0!==rx(rk(t))}catch(t){return!1}};eM({target:"Symbol",stat:!0},{isRegisteredSymbol:rO});for(var rS=tS("Symbol"),r_=rS.isWellKnownSymbol,rC=tS("Object","getOwnPropertyNames"),rE=G(rS.prototype.valueOf),rM=tU("wks"),rP=0,rT=rC(rS),rA=rT.length;rP<rA;rP++)try{var rD=rT[rP];tR(rS[rD])&&t4(rD)}catch(t){}var rI=function(t){if(r_&&r_(t))return!0;try{for(var e=rE(t),i=0,n=rC(rM),o=n.length;i<o;i++)if(rM[n[i]]==e)return!0}catch(t){}return!1};eM({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:rI}),oC("matcher"),oC("observable"),eM({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:rO}),eM({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:rI}),oC("metadataKey"),oC("patternMatch"),oC("replaceAll");var rB=N(rm),rz=oS.f("iterator"),rR=N(rz);function rN(t){return(rN="function"==typeof rB&&"symbol"==typeof rR?function(t){return typeof t}:function(t){return t&&"function"==typeof rB&&t.constructor===rB&&t!==rB.prototype?"symbol":typeof t})(t)}var rL=N(oS.f("toPrimitive"));function rF(t){var e=function(t,e){if("object"!==rN(t)||null===t)return t;var i=t[rL];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==rN(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rN(e)?e:String(e)}function rj(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),oe(t,rF(n.key),n)}}function rH(t,e,i){return e&&rj(t.prototype,e),i&&rj(t,i),oe(t,"prototype",{writable:!1}),t}eM({target:"Array",stat:!0},{isArray:oi});var rW=tk.Array.isArray,rV=N(rW),rQ=TypeError,r$=Object.getOwnPropertyDescriptor,rq=tr&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(oi(t)&&!r$(t,"length").writable)throw new rQ("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e};eM({target:"Array",proto:!0,arity:1,forced:j(function(){return 0x100000001!==[].push.call({length:0x100000000},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=tG(this),i=eN(e),n=arguments.length;oo(i+n);for(var o=0;o<n;o++)e[i]=arguments[o],i++;return rq(e,i),i}});var rU=e4("Array").push,rY=Array.prototype,rG=function(t){var e=t.push;return t===rY||t_(rY,t)&&e===rY.push?rU:e},rX=N(rG),rK=oc("slice"),rZ=t4("species"),rJ=Array,r0=Math.max;eM({target:"Array",proto:!0,forced:!rK},{slice:function(t,e){var i,n,o,r=tb(this),s=eN(r),a=ez(t,s),l=ez(void 0===e?s:e,s);if(oi(r)&&(nz(i=r.constructor)&&(i===rJ||oi(i.prototype))?i=void 0:tx(i)&&null===(i=i[rZ])&&(i=void 0),i===rJ||void 0===i))return eZ(r,a,l);for(o=0,n=new(void 0===i?rJ:i)(r0(l-a,0));a<l;a++,o++)a in r&&nR(n,o,r[a]);return n.length=o,n}});var r1=e4("Array").slice,r2=Array.prototype,r5=function(t){var e=t.slice;return t===r2||t_(r2,t)&&e===r2.slice?r1:e},r3=N(r5),r4=N(nY);function r8(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function r6(t,e){if(t){if("string"==typeof t)return r8(t,e);var i,n=r3(i=Object.prototype.toString.call(t)).call(i,8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return r4(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r8(t,e)}}function r9(t,e){return function(t){if(rV(t))return t}(t)||function(t,e){var i=null==t?null:void 0!==rB&&n5(t)||t["@@iterator"];if(null!=i){var n,o,r,s,a=[],l=!0,h=!1;try{if(r=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=r.call(i)).done)&&(rX(a).call(a,n.value),a.length!==e);l=!0);}catch(t){h=!0,o=t}finally{try{if(!l&&null!=i.return&&(s=i.return(),Object(s)!==s))return}finally{if(h)throw o}}return a}}(t,e)||r6(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r7(t){return function(t){if(rV(t))return r8(t)}(t)||function(t){if(void 0!==rB&&null!=n5(t)||null!=t["@@iterator"])return r4(t)}(t)||r6(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var st=N(rm),se=e4("Array").concat,si=Array.prototype,sn=N(function(t){var e=t.concat;return t===si||t_(si,t)&&e===si.concat?se:e}),so=N(r5),sr=G([].concat),ss=tS("Reflect","ownKeys")||function(t){var e=op.f(ey(t)),i=eq.f;return i?sr(e,i(t)):e};eM({target:"Reflect",stat:!0},{ownKeys:ss});var sa=N(tk.Reflect.ownKeys),sl=N(rW),sh=oT.map;eM({target:"Array",proto:!0,forced:!oc("map")},{map:function(t){return sh(this,t,arguments.length>1?arguments[1]:void 0)}});var sc=e4("Array").map,sd=Array.prototype,su=N(function(t){var e=t.map;return t===sd||t_(sd,t)&&e===sd.map?sc:e});eM({target:"Object",stat:!0,forced:j(function(){e$(1)})},{keys:function(t){return e$(tG(t))}});var sf=N(tk.Object.keys),sp=Date,sg=G(sp.prototype.getTime);eM({target:"Date",stat:!0},{now:function(){return sg(new sp)}});var sm=N(tk.Date.now),sv=function(t,e){var i=[][t];return!!i&&j(function(){i.call(null,e||function(){return 1},1)})},sy=oT.forEach,sb=sv("forEach")?[].forEach:function(t){return sy(this,t,arguments.length>1?arguments[1]:void 0)};eM({target:"Array",proto:!0,forced:[].forEach!==sb},{forEach:sb});var sw=e4("Array").forEach,sx=Array.prototype,sk={DOMTokenList:!0,NodeList:!0},sO=function(t){var e=t.forEach;return t===sx||t_(sx,t)&&e===sx.forEach||tK(sk,iv(t))?sw:e},sS=N(sO),s_=G([].reverse),sC=[1,2];eM({target:"Array",proto:!0,forced:String(sC)===String(sC.reverse())},{reverse:function(){return oi(this)&&(this.length=this.length),s_(this)}});var sE=e4("Array").reverse,sM=Array.prototype,sP=function(t){var e=t.reverse;return t===sM||t_(sM,t)&&e===sM.reverse?sE:e},sT=N(sP),sA=TypeError,sD=function(t,e){if(!delete t[e])throw new sA("Cannot delete property "+tL(e)+" of "+tL(t))},sI=oc("splice"),sB=Math.max,sz=Math.min;eM({target:"Array",proto:!0,forced:!sI},{splice:function(t,e){var i,n,o,r,s,a,l=tG(this),h=eN(l),c=ez(t,h),d=arguments.length;for(0===d?i=n=0:1===d?(i=0,n=h-c):(i=d-2,n=sz(sB(eD(e),0),h-c)),oo(h+i-n),o=ol(l,n),r=0;r<n;r++)(s=c+r)in l&&nR(o,r,l[s]);if(o.length=n,i<n){for(r=c;r<h-n;r++)s=r+n,a=r+i,s in l?l[a]=l[s]:sD(l,a);for(r=h;r>h-n+i;r--)sD(l,r-1)}else if(i>n)for(r=h-n;r>c;r--)s=r+n-1,a=r+i-1,s in l?l[a]=l[s]:sD(l,a);for(r=0;r<i;r++)l[r+c]=arguments[r+2];return rq(l,h-n+i),o}});var sR=e4("Array").splice,sN=Array.prototype,sL=N(function(t){var e=t.splice;return t===sN||t_(sN,t)&&e===sN.splice?sR:e}),sF=eF.includes;eM({target:"Array",proto:!0,forced:j(function(){return![,].includes()})},{includes:function(t){return sF(this,t,arguments.length>1?arguments[1]:void 0)}});var sj=e4("Array").includes,sH=t4("match"),sW=function(t){var e;return tx(t)&&(void 0!==(e=t[sH])?!!e:"RegExp"===Z(t))},sV=TypeError,sQ=t4("match"),s$=function(t){if(sW(t))throw new sV("The method doesn't accept regular expressions");return t},sq=G("".indexOf);eM({target:"String",proto:!0,forced:!function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[sQ]=!1,"/./"[t](e)}catch(t){}}return!1}("includes")},{includes:function(t){return!!~sq(ib(ty(this)),ib(s$(t)),arguments.length>1?arguments[1]:void 0)}});var sU=e4("String").includes,sY=Array.prototype,sG=String.prototype,sX=N(function(t){var e=t.includes;return t===sY||t_(sY,t)&&e===sY.includes?sj:"string"==typeof t||t===sG||t_(sG,t)&&e===sG.includes?sU:e});eM({target:"Object",stat:!0,forced:j(function(){i1(1)}),sham:!iK},{getPrototypeOf:function(t){return i1(tG(t))}});var sK=tk.Object.getPrototypeOf,sZ=N(sK),sJ=oT.filter;eM({target:"Array",proto:!0,forced:!oc("filter")},{filter:function(t){return sJ(this,t,arguments.length>1?arguments[1]:void 0)}});var s0=e4("Array").filter,s1=Array.prototype,s2=N(function(t){var e=t.filter;return t===s1||t_(s1,t)&&e===s1.filter?s0:e}),s5=G(tl.f),s3=G([].push),s4=tr&&j(function(){var t=Object.create(null);return t[2]=2,!s5(t,2)}),s8=function(t){return function(e){for(var i,n=tb(e),o=e$(n),r=s4&&null===i1(n),s=o.length,a=0,l=[];s>a;)i=o[a++],(!tr||(r?i in n:s5(n,i)))&&s3(l,t?[i,n[i]]:n[i]);return l}},s6={entries:s8(!0),values:s8(!1)},s9=s6.values;eM({target:"Object",stat:!0},{values:function(t){return s9(t)}});var s7=N(tk.Object.values),at="	\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF",ae=G("".replace),ai=RegExp("^["+at+"]+"),an=RegExp("(^|[^"+at+"])["+at+"]+$"),ao=function(t){return function(e){var i=ib(ty(e));return 1&t&&(i=ae(i,ai,"")),2&t&&(i=ae(i,an,"$1")),i}},ar={start:ao(1),end:ao(2),trim:ao(3)},as=ar.trim,aa=F.parseInt,al=F.Symbol,ah=al&&al.iterator,ac=/^[+-]?0x/i,ad=G(ac.exec),au=8!==aa(at+"08")||22!==aa(at+"0x16")||ah&&!j(function(){aa(Object(ah))})?function(t,e){var i=as(ib(t));return aa(i,e>>>0||(ad(ac,i)?16:10))}:aa;eM({global:!0,forced:parseInt!==au},{parseInt:au});var af=N(tk.parseInt),ap=eF.indexOf,ag=J([].indexOf),am=!!ag&&1/ag([1],1,-0)<0;eM({target:"Array",proto:!0,forced:am||!sv("indexOf")},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return am?ag(this,t,e)||0:ap(this,t,e)}});var av=e4("Array").indexOf,ay=Array.prototype,ab=N(function(t){var e=t.indexOf;return t===ay||t_(ay,t)&&e===ay.indexOf?av:e}),aw=s6.entries;eM({target:"Object",stat:!0},{entries:function(t){return aw(t)}});var ax=N(tk.Object.entries);eM({target:"Object",stat:!0,sham:!tr},{create:iX});var ak=tk.Object,aO=function(t,e){return ak.create(t,e)},aS=N(aO);tk.JSON||(tk.JSON={stringify:JSON.stringify});var a_=N(function(t,e,i){return $(tk.JSON.stringify,null,arguments)}),aC="function"==typeof Bun&&Bun&&"string"==typeof Bun.version,aE=TypeError,aM=function(t,e){if(t<e)throw new aE("Not enough arguments");return t},aP=F.Function,aT=/MSIE .\./.test(tC)||aC&&((n=F.Bun.version.split(".")).length<3||"0"===n[0]&&(n[1]<3||"3"===n[1]&&"0"===n[2])),aA=function(t,e){var i=e?2:1;return aT?function(n,o){var r=aM(arguments.length,1)>i,s=tn(n)?n:aP(n),a=r?eZ(arguments,i):[],l=r?function(){$(s,this,a)}:s;return e?t(l,o):t(l)}:t},aD=aA(F.setInterval,!0);eM({global:!0,bind:!0,forced:F.setInterval!==aD},{setInterval:aD});var aI=aA(F.setTimeout,!0);eM({global:!0,bind:!0,forced:F.setTimeout!==aI},{setTimeout:aI});var aB=N(tk.setTimeout);eM({target:"Array",proto:!0},{fill:function(t){for(var e=tG(this),i=eN(e),n=arguments.length,o=ez(n>1?arguments[1]:void 0,i),r=n>2?arguments[2]:void 0,s=void 0===r?i:ez(r,i);s>o;)e[o++]=t;return e}});var az=e4("Array").fill,aR=Array.prototype,aN=N(function(t){var e=t.fill;return t===aR||t_(aR,t)&&e===aR.fill?az:e});/*! Hammer.JS - v2.0.17-rc - 2019-12-16
 * http://naver.github.io/egjs
 *
 * Forked By Naver egjs
 * Copyright (c) hammerjs
 * Licensed under the MIT license */function aL(){return(aL=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function aF(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function aj(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var aH="function"!=typeof Object.assign?function(t){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e}:Object.assign,aW=["","webkit","Moz","MS","ms","o"],aV="undefined"==typeof document?{style:{}}:document.createElement("div"),aQ=Math.round,a$=Math.abs,aq=Date.now;function aU(t,e){for(var i,n,o=e[0].toUpperCase()+e.slice(1),r=0;r<aW.length;){if((n=(i=aW[r])?i+o:e)in t)return n;r++}}g="undefined"==typeof window?{}:window;var aY=aU(aV.style,"touchAction"),aG=void 0!==aY,aX="compute",aK="auto",aZ="manipulation",aJ="none",a0="pan-x",a1="pan-y",a2=function(){if(!aG)return!1;var t={},e=g.CSS&&g.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){return t[i]=!e||g.CSS.supports("touch-action",i)}),t}(),a5="ontouchstart"in g,a3=void 0!==aU(g,"PointerEvent"),a4=a5&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),a8="touch",a6="mouse",a9=["x","y"],a7=["clientX","clientY"];function lt(t,e,i){var n;if(t){if(t.forEach)t.forEach(e,i);else if(void 0!==t.length)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}}function le(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function li(t,e){return t.indexOf(e)>-1}var ln=function(){function t(t,e){this.manager=t,this.set(e)}var e=t.prototype;return e.set=function(t){t===aX&&(t=this.compute()),aG&&this.manager.element.style&&a2[t]&&(this.manager.element.style[aY]=t),this.actions=t.toLowerCase().trim()},e.update=function(){this.set(this.manager.options.touchAction)},e.compute=function(){var t=[];return lt(this.manager.recognizers,function(e){le(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(li(t,aJ))return aJ;var e=li(t,a0),i=li(t,a1);return e&&i?aJ:e||i?e?a0:a1:li(t,aZ)?aZ:aK}(t.join(" "))},e.preventDefaults=function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented){e.preventDefault();return}var n=this.actions,o=li(n,aJ)&&!a2[aJ],r=li(n,a1)&&!a2[a1],s=li(n,a0)&&!a2[a0];if(o){var a=1===t.pointers.length,l=t.distance<2,h=t.deltaTime<250;if(a&&l&&h)return}if((!s||!r)&&(o||r&&6&i||s&&24&i))return this.preventSrc(e)},e.preventSrc=function(t){this.manager.session.prevented=!0,t.preventDefault()},t}();function lo(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function lr(t){var e=t.length;if(1===e)return{x:aQ(t[0].clientX),y:aQ(t[0].clientY)};for(var i=0,n=0,o=0;o<e;)i+=t[o].clientX,n+=t[o].clientY,o++;return{x:aQ(i/e),y:aQ(n/e)}}function ls(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:aQ(t.pointers[i].clientX),clientY:aQ(t.pointers[i].clientY)},i++;return{timeStamp:aq(),pointers:e,center:lr(e),deltaX:t.deltaX,deltaY:t.deltaY}}function la(t,e,i){i||(i=a9);var n=e[i[0]]-t[i[0]],o=e[i[1]]-t[i[1]];return Math.sqrt(n*n+o*o)}function ll(t,e,i){i||(i=a9);var n=e[i[0]]-t[i[0]];return 180*Math.atan2(e[i[1]]-t[i[1]],n)/Math.PI}function lh(t,e){return t===e?1:a$(t)>=a$(e)?t<0?2:4:e<0?8:16}function lc(t,e,i){return{x:e/t||0,y:i/t||0}}function ld(t,e,i){var n,o,r,s,a,l,h,c,d,u,f,p,g,m,v,y,b,w=i.pointers.length,x=i.changedPointers.length,k=1&e&&w-x==0,O=12&e&&w-x==0;i.isFirst=!!k,i.isFinal=!!O,k&&(t.session={}),i.eventType=e,o=t.session,s=(r=i.pointers).length,o.firstInput||(o.firstInput=ls(i)),s>1&&!o.firstMultiple?o.firstMultiple=ls(i):1===s&&(o.firstMultiple=!1),a=o.firstInput,h=(l=o.firstMultiple)?l.center:a.center,c=i.center=lr(r),i.timeStamp=aq(),i.deltaTime=i.timeStamp-a.timeStamp,i.angle=ll(h,c),i.distance=la(h,c),d=i.center,u=o.offsetDelta||{},f=o.prevDelta||{},p=o.prevInput||{},(1===i.eventType||4===p.eventType)&&(f=o.prevDelta={x:p.deltaX||0,y:p.deltaY||0},u=o.offsetDelta={x:d.x,y:d.y}),i.deltaX=f.x+(d.x-u.x),i.deltaY=f.y+(d.y-u.y),i.offsetDirection=lh(i.deltaX,i.deltaY),g=lc(i.deltaTime,i.deltaX,i.deltaY),i.overallVelocityX=g.x,i.overallVelocityY=g.y,i.overallVelocity=a$(g.x)>a$(g.y)?g.x:g.y,i.scale=l?(m=l.pointers,la(r[0],r[1],a7)/la(m[0],m[1],a7)):1,i.rotation=l?(v=l.pointers,ll(r[1],r[0],a7)+ll(v[1],v[0],a7)):0,i.maxPointers=o.prevInput?i.pointers.length>o.prevInput.maxPointers?i.pointers.length:o.prevInput.maxPointers:i.pointers.length,function(t,e){var i,n,o,r,s=t.lastInterval||e,a=e.timeStamp-s.timeStamp;if(8!==e.eventType&&(a>25||void 0===s.velocity)){var l=e.deltaX-s.deltaX,h=e.deltaY-s.deltaY,c=lc(a,l,h);n=c.x,o=c.y,i=a$(c.x)>a$(c.y)?c.x:c.y,r=lh(l,h),t.lastInterval=e}else i=s.velocity,n=s.velocityX,o=s.velocityY,r=s.direction;e.velocity=i,e.velocityX=n,e.velocityY=o,e.direction=r}(o,i),y=t.element,lo(n=(b=i.srcEvent).composedPath?b.composedPath()[0]:b.path?b.path[0]:b.target,y)&&(y=n),i.target=y,t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function lu(t){return t.trim().split(/\s+/g)}function lf(t,e,i){lt(lu(e),function(e){t.addEventListener(e,i,!1)})}function lp(t,e,i){lt(lu(e),function(e){t.removeEventListener(e,i,!1)})}function lg(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||window}var lm=function(){function t(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){le(t.options.enable,[t])&&i.handler(e)},this.init()}var e=t.prototype;return e.handler=function(){},e.init=function(){this.evEl&&lf(this.element,this.evEl,this.domHandler),this.evTarget&&lf(this.target,this.evTarget,this.domHandler),this.evWin&&lf(lg(this.element),this.evWin,this.domHandler)},e.destroy=function(){this.evEl&&lp(this.element,this.evEl,this.domHandler),this.evTarget&&lp(this.target,this.evTarget,this.domHandler),this.evWin&&lp(lg(this.element),this.evWin,this.domHandler)},t}();function lv(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return -1}var ly={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},lb={2:a8,3:"pen",4:a6,5:"kinect"},lw="pointerdown",lx="pointermove pointerup pointercancel";g.MSPointerEvent&&!g.PointerEvent&&(lw="MSPointerDown",lx="MSPointerMove MSPointerUp MSPointerCancel");var lk=function(t){function e(){var i,n=e.prototype;return n.evEl=lw,n.evWin=lx,i=t.apply(this,arguments)||this,i.store=i.manager.session.pointerEvents=[],i}return aF(e,t),e.prototype.handler=function(t){var e=this.store,i=!1,n=ly[t.type.toLowerCase().replace("ms","")],o=lb[t.pointerType]||t.pointerType,r=o===a8,s=lv(e,t.pointerId,"pointerId");1&n&&(0===t.button||r)?s<0&&(e.push(t),s=e.length-1):12&n&&(i=!0),!(s<0)&&(e[s]=t,this.callback(this.manager,n,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),i&&e.splice(s,1))},e}(lm);function lO(t){return Array.prototype.slice.call(t,0)}function lS(t,e,i){for(var n=[],o=[],r=0;r<t.length;){var s=e?t[r][e]:t[r];0>lv(o,s)&&n.push(t[r]),o[r]=s,r++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}var l_={touchstart:1,touchmove:2,touchend:4,touchcancel:8},lC=function(t){function e(){var i;return e.prototype.evTarget="touchstart touchmove touchend touchcancel",i=t.apply(this,arguments)||this,i.targetIds={},i}return aF(e,t),e.prototype.handler=function(t){var e=l_[t.type],i=lE.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:a8,srcEvent:t})},e}(lm);function lE(t,e){var i,n,o=lO(t.touches),r=this.targetIds;if(3&e&&1===o.length)return r[o[0].identifier]=!0,[o,o];var s=lO(t.changedTouches),a=[],l=this.target;if(n=o.filter(function(t){return lo(t.target,l)}),1===e)for(i=0;i<n.length;)r[n[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;if(a.length)return[lS(n.concat(a),"identifier",!0),a]}var lM={mousedown:1,mousemove:2,mouseup:4},lP=function(t){function e(){var i,n=e.prototype;return n.evEl="mousedown",n.evWin="mousemove mouseup",i=t.apply(this,arguments)||this,i.pressed=!1,i}return aF(e,t),e.prototype.handler=function(t){var e=lM[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:a6,srcEvent:t}))},e}(lm);function lT(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY},n=this.lastTouches;this.lastTouches.push(i),setTimeout(function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)},2500)}}function lA(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,lT.call(this,e)):12&t&&lT.call(this,e)}function lD(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var o=this.lastTouches[n],r=Math.abs(e-o.x),s=Math.abs(i-o.y);if(r<=25&&s<=25)return!0}return!1}var lI=function(t){function e(e,i){var n;return(n=t.call(this,e,i)||this).handler=function(t,e,i){var o=i.pointerType===a8,r=i.pointerType===a6;if(!r||!i.sourceCapabilities||!i.sourceCapabilities.firesTouchEvents){if(o)lA.call(aj(aj(n)),e,i);else if(r&&lD.call(aj(aj(n)),i))return;n.callback(t,e,i)}},n.touch=new lC(n.manager,n.handler),n.mouse=new lP(n.manager,n.handler),n.primaryTouch=null,n.lastTouches=[],n}return aF(e,t),e.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},e}(lm);function lB(t,e,i){return!!Array.isArray(t)&&(lt(t,i[e],i),!0)}var lz=1;function lR(t,e){var i=e.manager;return i?i.get(t):t}function lN(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}var lL=function(){function t(t){void 0===t&&(t={}),this.options=aL({enable:!0},t),this.id=lz++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var e=t.prototype;return e.set=function(t){return aH(this.options,t),this.manager&&this.manager.touchAction.update(),this},e.recognizeWith=function(t){if(lB(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=lR(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},e.dropRecognizeWith=function(t){return lB(t,"dropRecognizeWith",this)||(t=lR(t,this),delete this.simultaneous[t.id]),this},e.requireFailure=function(t){if(lB(t,"requireFailure",this))return this;var e=this.requireFail;return -1===lv(e,t=lR(t,this))&&(e.push(t),t.requireFailure(this)),this},e.dropRequireFailure=function(t){if(lB(t,"dropRequireFailure",this))return this;t=lR(t,this);var e=lv(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},e.hasRequireFailures=function(){return this.requireFail.length>0},e.canRecognizeWith=function(t){return!!this.simultaneous[t.id]},e.emit=function(t){var e=this,i=this.state;function n(i){e.manager.emit(i,t)}i<8&&n(e.options.event+lN(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=8&&n(e.options.event+lN(i))},e.tryEmit=function(t){if(this.canEmit())return this.emit(t);this.state=32},e.canEmit=function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},e.recognize=function(t){var e=aH({},t);if(!le(this.options.enable,[this,e])){this.reset(),this.state=32;return}56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},e.process=function(t){},e.getTouchAction=function(){},e.reset=function(){},t}(),lF=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,aL({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},e))||this).pTime=!1,i.pCenter=!1,i._timer=null,i._input=null,i.count=0,i}aF(e,t);var i=e.prototype;return i.getTouchAction=function(){return[aZ]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime<i.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(o&&r&&n){if(4!==t.eventType)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<i.interval,a=!this.pCenter||la(this.pCenter,t.center)<i.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&s?this.count+=1:this.count=1,this._input=t,0==this.count%i.taps)return this.hasRequireFailures()?(this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.interval),2):8}return 32},i.failTimeout=function(){var t=this;return this._timer=setTimeout(function(){t.state=32},this.options.interval),32},i.reset=function(){clearTimeout(this._timer)},i.emit=function(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},e}(lL),lj=function(t){function e(e){return void 0===e&&(e={}),t.call(this,aL({pointers:1},e))||this}aF(e,t);var i=e.prototype;return i.attrTest=function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},i.process=function(t){var e=this.state,i=t.eventType,n=6&e,o=this.attrTest(t);return n&&(8&i||!o)?16|e:n||o?4&i?8|e:2&e?4|e:2:32},e}(lL);function lH(t){return 16===t?"down":8===t?"up":2===t?"left":4===t?"right":""}var lW=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,aL({event:"pan",threshold:10,pointers:1,direction:30},e))||this).pX=null,i.pY=null,i}aF(e,t);var i=e.prototype;return i.getTouchAction=function(){var t=this.options.direction,e=[];return 6&t&&e.push(a1),24&t&&e.push(a0),e},i.directionTest=function(t){var e=this.options,i=!0,n=t.distance,o=t.direction,r=t.deltaX,s=t.deltaY;return o&e.direction||(6&e.direction?(o=0===r?1:r<0?2:4,i=r!==this.pX,n=Math.abs(t.deltaX)):(o=0===s?1:s<0?8:16,i=s!==this.pY,n=Math.abs(t.deltaY))),t.direction=o,i&&n>e.threshold&&o&e.direction},i.attrTest=function(t){return lj.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},i.emit=function(e){this.pX=e.deltaX,this.pY=e.deltaY;var i=lH(e.direction);i&&(e.additionalEvent=this.options.event+i),t.prototype.emit.call(this,e)},e}(lj),lV=function(t){function e(e){return void 0===e&&(e={}),t.call(this,aL({event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},e))||this}aF(e,t);var i=e.prototype;return i.getTouchAction=function(){return lW.prototype.getTouchAction.call(this)},i.attrTest=function(e){var i,n=this.options.direction;return 30&n?i=e.overallVelocity:6&n?i=e.overallVelocityX:24&n&&(i=e.overallVelocityY),t.prototype.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers===this.options.pointers&&a$(i)>this.options.velocity&&4&e.eventType},i.emit=function(t){var e=lH(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)},e}(lj),lQ=function(t){function e(e){return void 0===e&&(e={}),t.call(this,aL({event:"pinch",threshold:0,pointers:2},e))||this}aF(e,t);var i=e.prototype;return i.getTouchAction=function(){return[aJ]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},i.emit=function(e){if(1!==e.scale){var i=e.scale<1?"in":"out";e.additionalEvent=this.options.event+i}t.prototype.emit.call(this,e)},e}(lj),l$=function(t){function e(e){return void 0===e&&(e={}),t.call(this,aL({event:"rotate",threshold:0,pointers:2},e))||this}aF(e,t);var i=e.prototype;return i.getTouchAction=function(){return[aJ]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)},e}(lj),lq=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,aL({event:"press",pointers:1,time:251,threshold:9},e))||this)._timer=null,i._input=null,i}aF(e,t);var i=e.prototype;return i.getTouchAction=function(){return[aK]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime>i.time;if(this._input=t,o&&n&&(!(12&t.eventType)||r)){if(1&t.eventType)this.reset(),this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.time);else if(4&t.eventType)return 8}else this.reset();return 32},i.reset=function(){clearTimeout(this._timer)},i.emit=function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=aq(),this.manager.emit(this.options.event,this._input)))},e}(lL),lU={domEvents:!1,touchAction:aX,enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},lY=[[l$,{enable:!1}],[lQ,{enable:!1},["rotate"]],[lV,{direction:6}],[lW,{direction:6},["swipe"]],[lF],[lF,{event:"doubletap",taps:2},["tap"]],[lq]];function lG(t,e){var i,n=t.element;n.style&&(lt(t.options.cssProps,function(o,r){i=aU(n.style,r),e?(t.oldCssProps[i]=n.style[i],n.style[i]=o):n.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={}))}var lX=function(){function t(t,e){var i,n=this;this.options=aH({},lU,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((i=this.options.inputClass)?i:a3?lk:a4?lC:a5?lI:lP)(this,ld),this.touchAction=new ln(this,this.options.touchAction),lG(this,!0),lt(this.options.recognizers,function(t){var e=n.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}var e=t.prototype;return e.set=function(t){return aH(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},e.stop=function(t){this.session.stopped=t?2:1},e.recognize=function(t){var e,i=this.session;if(!i.stopped){this.touchAction.preventDefaults(t);var n=this.recognizers,o=i.curRecognizer;(!o||o&&8&o.state)&&(i.curRecognizer=null,o=null);for(var r=0;r<n.length;)e=n[r],2!==i.stopped&&(!o||e===o||e.canRecognizeWith(o))?e.recognize(t):e.reset(),!o&&14&e.state&&(i.curRecognizer=e,o=e),r++}},e.get=function(t){if(t instanceof lL)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event===t)return e[i];return null},e.add=function(t){if(lB(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},e.remove=function(t){if(lB(t,"remove",this))return this;var e=this.get(t);if(t){var i=this.recognizers,n=lv(i,e);-1!==n&&(i.splice(n,1),this.touchAction.update())}return this},e.on=function(t,e){if(void 0===t||void 0===e)return this;var i=this.handlers;return lt(lu(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},e.off=function(t,e){if(void 0===t)return this;var i=this.handlers;return lt(lu(t),function(t){e?i[t]&&i[t].splice(lv(i[t],e),1):delete i[t]}),this},e.emit=function(t,e){if(this.options.domEvents){var i;(i=document.createEvent("Event")).initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var o=0;o<n.length;)n[o](e),o++}},e.destroy=function(){this.element&&lG(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},t}(),lK={touchstart:1,touchmove:2,touchend:4,touchcancel:8},lZ=function(t){function e(){var i,n=e.prototype;return n.evTarget="touchstart",n.evWin="touchstart touchmove touchend touchcancel",i=t.apply(this,arguments)||this,i.started=!1,i}return aF(e,t),e.prototype.handler=function(t){var e=lK[t.type];if(1===e&&(this.started=!0),this.started){var i=lJ.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:a8,srcEvent:t})}},e}(lm);function lJ(t,e){var i=lO(t.touches),n=lO(t.changedTouches);return 12&e&&(i=lS(i.concat(n),"identifier",!0)),[i,n]}function l0(t,e,i){var n="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=window.console&&(window.console.warn||window.console.log);return o&&o.call(window.console,n,i),t.apply(this,arguments)}}var l1=l0(function(t,e,i){for(var n=Object.keys(e),o=0;o<n.length;)(!i||i&&void 0===t[n[o]])&&(t[n[o]]=e[n[o]]),o++;return t},"extend","Use `assign`."),l2=l0(function(t,e){return l1(t,e,!0)},"merge","Use `assign`.");function l5(t,e){return function(){return t.apply(e,arguments)}}var l3=((o=function(t,e){return void 0===e&&(e={}),new lX(t,aL({recognizers:lY.concat()},e))}).VERSION="2.0.17-rc",o.DIRECTION_ALL=30,o.DIRECTION_DOWN=16,o.DIRECTION_LEFT=2,o.DIRECTION_RIGHT=4,o.DIRECTION_UP=8,o.DIRECTION_HORIZONTAL=6,o.DIRECTION_VERTICAL=24,o.DIRECTION_NONE=1,o.DIRECTION_DOWN=16,o.INPUT_START=1,o.INPUT_MOVE=2,o.INPUT_END=4,o.INPUT_CANCEL=8,o.STATE_POSSIBLE=1,o.STATE_BEGAN=2,o.STATE_CHANGED=4,o.STATE_ENDED=8,o.STATE_RECOGNIZED=8,o.STATE_CANCELLED=16,o.STATE_FAILED=32,o.Manager=lX,o.Input=lm,o.TouchAction=ln,o.TouchInput=lC,o.MouseInput=lP,o.PointerEventInput=lk,o.TouchMouseInput=lI,o.SingleTouchInput=lZ,o.Recognizer=lL,o.AttrRecognizer=lj,o.Tap=lF,o.Pan=lW,o.Swipe=lV,o.Pinch=lQ,o.Rotate=l$,o.Press=lq,o.on=lf,o.off=lp,o.each=lt,o.merge=l2,o.extend=l1,o.bindFn=l5,o.assign=aH,o.inherit=function(t,e,i){var n,o=e.prototype;(n=t.prototype=Object.create(o)).constructor=t,n._super=o,i&&aH(n,i)},o.bindFn=l5,o.prefixed=aU,o.toArray=lO,o.inArray=lv,o.uniqueArray=lS,o.splitStr=lu,o.boolOrFn=le,o.hasParent=lo,o.addEventListeners=lf,o.removeEventListeners=lp,o.defaults=aH({},lU,{preset:lY}),o);function l4(t,e){var i=void 0!==st&&n3(t)||t["@@iterator"];if(!i){if(sl(t)||(i=function(t,e){if(t){if("string"==typeof t)return l8(t,void 0);var i,n=so(i=Object.prototype.toString.call(t)).call(i,8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return nG(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l8(t,void 0)}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function l8(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}l3.defaults;var l6=st("DELETE");function l9(t){for(var e,i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return l7.apply(void 0,sn(e=[{},t]).call(e,n))}function l7(){var t=(function t(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];if(i.length<2)return i[0];if(i.length>2)return t.apply(void 0,sn(s=[l7(i[0],i[1])]).call(s,r7(so(i).call(i,2))));var o=i[0],r=i[1];if(o instanceof Date&&r instanceof Date)return o.setTime(r.getTime()),o;var s,a,l=l4(sa(r));try{for(l.s();!(a=l.n()).done;){var h=a.value;Object.prototype.propertyIsEnumerable.call(r,h)&&(r[h]===l6?delete o[h]:null===o[h]||null===r[h]||"object"!==rN(o[h])||"object"!==rN(r[h])||sl(o[h])||sl(r[h])?o[h]=function e(i){return sl(i)?su(i).call(i,function(t){return e(t)}):"object"!==rN(i)||null===i?i:i instanceof Date?new Date(i.getTime()):t({},i)}(r[h]):o[h]=t(o[h],r[h]))}}catch(t){l.e(t)}finally{l.f()}return o}).apply(void 0,arguments);return function t(e){for(var i=0,n=sf(e);i<n.length;i++){var o=n[i];e[o]===l6?delete e[o]:"object"===rN(e[o])&&null!==e[o]&&t(e[o])}}(t),t}function ht(){for(var t,e,i,n,o,r,s,a=arguments.length,l=Array(a),h=0;h<a;h++)l[h]=arguments[h];return i=(e=r9(function(){for(var t,e=(t=0xefc8249d,function(e){for(var i=e.toString(),n=0;n<i.length;n++){var o=.02519603282416938*(t+=i.charCodeAt(n));t=o>>>0,o-=t,o*=t,t=o>>>0,o-=t,t+=0x100000000*o}return(t>>>0)*23283064365386963e-26}),i=e(" "),n=e(" "),o=e(" "),r=0;r<arguments.length;r++)i-=e(r<0||arguments.length<=r?void 0:arguments[r]),i<0&&(i+=1),n-=e(r<0||arguments.length<=r?void 0:arguments[r]),n<0&&(n+=1),o-=e(r<0||arguments.length<=r?void 0:arguments[r]),o<0&&(o+=1);return[i,n,o]}(t=l.length?l:[sm()]),3))[0],n=e[1],o=e[2],r=1,(s=function(){var t=2091639*i+23283064365386963e-26*r;return i=n,n=o,o=t-(r=0|t)}).uint32=function(){return 0x100000000*s()},s.fract53=function(){return s()+(2097152*s()|0)*11102230246251565e-32},s.algorithm="Alea",s.seed=t,s.version="0.9",s}var he="undefined"!=typeof window?window.Hammer||l3:function(){var t;return{on:t=function(){},off:t,destroy:t,emit:t,get:function(){return{set:t}}}};function hi(t){var e,i=this;this._cleanupQueue=[],this.active=!1,this._dom={container:t,overlay:document.createElement("div")},this._dom.overlay.classList.add("vis-overlay"),this._dom.container.appendChild(this._dom.overlay),this._cleanupQueue.push(function(){i._dom.overlay.parentNode.removeChild(i._dom.overlay)});var n=he(this._dom.overlay);n.on("tap",e7(e=this._onTapOverlay).call(e,this)),this._cleanupQueue.push(function(){n.destroy()});var o=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];sS(o).call(o,function(t){n.on(t,function(t){t.srcEvent.stopPropagation()})}),document&&document.body&&(this._onClick=function(e){!function(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}(e.target,t)&&i.deactivate()},document.body.addEventListener("click",this._onClick),this._cleanupQueue.push(function(){document.body.removeEventListener("click",i._onClick)})),this._escListener=function(t){("key"in t?"Escape"===t.key:27===t.keyCode)&&i.deactivate()}}il(hi.prototype),hi.current=null,hi.prototype.destroy=function(){this.deactivate();var t,e,i,n=l4(sT(t=sL(e=this._cleanupQueue).call(e,0)).call(t));try{for(n.s();!(i=n.n()).done;)(0,i.value)()}catch(t){n.e(t)}finally{n.f()}},hi.prototype.activate=function(){hi.current&&hi.current.deactivate(),hi.current=this,this.active=!0,this._dom.overlay.style.display="none",this._dom.container.classList.add("vis-active"),this.emit("change"),this.emit("activate"),document.body.addEventListener("keydown",this._escListener)},hi.prototype.deactivate=function(){this.active=!1,this._dom.overlay.style.display="block",this._dom.container.classList.remove("vis-active"),document.body.removeEventListener("keydown",this._escListener),this.emit("change"),this.emit("deactivate")},hi.prototype._onTapOverlay=function(t){this.activate(),t.srcEvent.stopPropagation()};var hn=/^\/?Date\((-?\d+)/i,ho=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,hr=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,hs=/^rgb\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *\)$/i,ha=/^rgba\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *([01]|0?\.\d+) *\)$/i;function hl(t){return t instanceof Number||"number"==typeof t}function hh(t){if(t)for(;!0===t.hasChildNodes();){var e=t.firstChild;e&&(hh(e),t.removeChild(e))}}function hc(t){return t instanceof String||"string"==typeof t}function hd(t){return"object"===rN(t)&&null!==t}function hu(t,e,i,n){var o=!1;!0===n&&(o=null===e[i]&&void 0!==t[i]),o?delete t[i]:t[i]=e[i]}function hf(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var n in t)if(void 0!==e[n]){if(null===e[n]||"object"!==rN(e[n]))hu(t,e,n,i);else{var o=t[n],r=e[n];hd(o)&&hd(r)&&hf(o,r,i)}}}function hp(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(sl(i))throw TypeError("Arrays are not supported by deepExtend");for(var o=0;o<t.length;o++){var r=t[o];if(Object.prototype.hasOwnProperty.call(i,r)){if(i[r]&&i[r].constructor===Object)void 0===e[r]&&(e[r]={}),e[r].constructor===Object?hm(e[r],i[r],!1,n):hu(e,i,r,n);else if(sl(i[r]))throw TypeError("Arrays are not supported by deepExtend");else hu(e,i,r,n)}}return e}function hg(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(sl(i))throw TypeError("Arrays are not supported by deepExtend");for(var o in i)if(Object.prototype.hasOwnProperty.call(i,o)&&!sX(t).call(t,o)){if(i[o]&&i[o].constructor===Object)void 0===e[o]&&(e[o]={}),e[o].constructor===Object?hm(e[o],i[o]):hu(e,i,o,n);else if(sl(i[o])){e[o]=[];for(var r=0;r<i[o].length;r++)e[o].push(i[o][r])}else hu(e,i,o,n)}return e}function hm(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(var r in e)(Object.prototype.hasOwnProperty.call(e,r)||!0===n)&&("object"===rN(e[r])&&null!==e[r]&&sZ(e[r])===Object.prototype?void 0===t[r]?t[r]=hm({},e[r],n):"object"===rN(t[r])&&null!==t[r]&&sZ(t[r])===Object.prototype?hm(t[r],e[r],n):hu(t,e,r,o):sl(e[r])?t[r]=so(i=e[r]).call(i):hu(t,e,r,o));return t}function hv(t,e){var i;return sn(i=[]).call(i,r7(t),[e])}function hy(t){return so(t).call(t)}function hb(t){return t.getBoundingClientRect().left}function hw(t){return t.getBoundingClientRect().top}function hx(t,e){if(sl(t))for(var i=t.length,n=0;n<i;n++)e(t[n],n,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e(t[o],o,t)}function hk(t){var e;switch(t.length){case 3:case 4:return(e=hr.exec(t))?{r:af(e[1]+e[1],16),g:af(e[2]+e[2],16),b:af(e[3]+e[3],16)}:null;case 6:case 7:return(e=ho.exec(t))?{r:af(e[1],16),g:af(e[2],16),b:af(e[3],16)}:null;default:return null}}function hO(t,e){if(sX(t).call(t,"rgba"))return t;if(sX(t).call(t,"rgb")){var i=t.substr(ab(t).call(t,"(")+1).replace(")","").split(",");return"rgba("+i[0]+","+i[1]+","+i[2]+","+e+")"}var n=hk(t);return null==n?t:"rgba("+n.r+","+n.g+","+n.b+","+e+")"}function hS(t,e,i){var n;return"#"+so(n=(0x1000000+(t<<16)+(e<<8)+i).toString(16)).call(n,1)}function h_(t,e){if(hc(t)){var i=t;if(hD(i)){var n,o=su(n=i.substr(4).substr(0,i.length-5).split(",")).call(n,function(t){return af(t)});i=hS(o[0],o[1],o[2])}if(!0!==hA(i))return{background:i,border:i,highlight:{background:i,border:i},hover:{background:i,border:i}};var r=hT(i),s={h:r.h,s:.8*r.s,v:Math.min(1,1.02*r.v)},a={h:r.h,s:Math.min(1,1.25*r.s),v:.8*r.v},l=hP(a.h,a.s,a.v),h=hP(s.h,s.s,s.v);return{background:i,border:l,highlight:{background:h,border:l},hover:{background:h,border:l}}}return e?{background:t.background||e.background,border:t.border||e.border,highlight:hc(t.highlight)?{border:t.highlight,background:t.highlight}:{background:t.highlight&&t.highlight.background||e.highlight.background,border:t.highlight&&t.highlight.border||e.highlight.border},hover:hc(t.hover)?{border:t.hover,background:t.hover}:{border:t.hover&&t.hover.border||e.hover.border,background:t.hover&&t.hover.background||e.hover.background}}:{background:t.background||void 0,border:t.border||void 0,highlight:hc(t.highlight)?{border:t.highlight,background:t.highlight}:{background:t.highlight&&t.highlight.background||void 0,border:t.highlight&&t.highlight.border||void 0},hover:hc(t.hover)?{border:t.hover,background:t.hover}:{border:t.hover&&t.hover.border||void 0,background:t.hover&&t.hover.background||void 0}}}function hC(t,e,i){var n=Math.min(t/=255,Math.min(e/=255,i/=255)),o=Math.max(t,Math.max(e,i));if(n===o)return{h:0,s:0,v:n};var r=t===n?e-i:i===n?t-e:i-t;return{h:60*((t===n?3:i===n?1:5)-r/(o-n))/360,s:(o-n)/o,v:o}}function hE(t){var e=document.createElement("div"),i={};e.style.cssText=t;for(var n=0;n<e.style.length;++n)i[e.style[n]]=e.style.getPropertyValue(e.style[n]);return i}function hM(t,e,i){var n,o,r,s=Math.floor(6*t),a=6*t-s,l=i*(1-e),h=i*(1-a*e),c=i*(1-(1-a)*e);switch(s%6){case 0:n=i,o=c,r=l;break;case 1:n=h,o=i,r=l;break;case 2:n=l,o=i,r=c;break;case 3:n=l,o=h,r=i;break;case 4:n=c,o=l,r=i;break;case 5:n=i,o=l,r=h}return{r:Math.floor(255*n),g:Math.floor(255*o),b:Math.floor(255*r)}}function hP(t,e,i){var n=hM(t,e,i);return hS(n.r,n.g,n.b)}function hT(t){var e=hk(t);if(!e)throw TypeError("'".concat(t,"' is not a valid color."));return hC(e.r,e.g,e.b)}function hA(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)}function hD(t){return hs.test(t)}function hI(t){return ha.test(t)}function hB(t){if(null===t||"object"!==rN(t))return null;if(t instanceof Element)return t;var e=aS(t);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&"object"==rN(t[i])&&(e[i]=hB(t[i]));return e}function hz(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=function(t){return null!=t},r=function(t){return null!==t&&"object"===rN(t)};if(!r(t))throw Error("Parameter mergeTarget must be an object");if(!r(e))throw Error("Parameter options must be an object");if(!o(i))throw Error("Parameter option must have a value");if(!r(n))throw Error("Parameter globalOptions must be an object");var s=e[i],a=r(n)&&!function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(n)?n[i]:void 0,l=a?a.enabled:void 0;if(void 0!==s){if("boolean"==typeof s){r(t[i])||(t[i]={}),t[i].enabled=s;return}if(null===s&&!r(t[i])){if(!o(a))return;t[i]=aS(a)}if(r(s)){var h=!0;void 0!==s.enabled?h=s.enabled:void 0!==l&&(h=a.enabled),function(t,e,i){r(t[i])||(t[i]={});var n=e[i],o=t[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(o[s]=n[s])}(t,e,i),t[i].enabled=h}}}var hR={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:-1+(4-2*t)*t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}};function hN(t,e){sl(e)||(e=[e]);var i,n,o=l4(t);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r){i=r[e[0]];for(var s=1;s<e.length;s++)i&&(i=i[e[s]]);if(void 0!==i)break}}}catch(t){o.e(t)}finally{o.f()}return i}var hL={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgrey:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"},hF=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;n4(this,t),this.pixelRatio=e,this.generated=!1,this.centerCoordinates={x:144.5,y:144.5},this.r=289*.49,this.color={r:255,g:255,b:255,a:1},this.hueCircle=void 0,this.initialColor={r:255,g:255,b:255,a:1},this.previousColor=void 0,this.applied=!1,this.updateCallback=function(){},this.closeCallback=function(){},this._create()}return rH(t,[{key:"insertTo",value:function(t){void 0!==this.hammer&&(this.hammer.destroy(),this.hammer=void 0),this.container=t,this.container.appendChild(this.frame),this._bindHammer(),this._setSize()}},{key:"setUpdateCallback",value:function(t){if("function"==typeof t)this.updateCallback=t;else throw Error("Function attempted to set as colorPicker update callback is not a function.")}},{key:"setCloseCallback",value:function(t){if("function"==typeof t)this.closeCallback=t;else throw Error("Function attempted to set as colorPicker closing callback is not a function.")}},{key:"_isColorString",value:function(t){if("string"==typeof t)return hL[t]}},{key:"setColor",value:function(t){var e,i=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if("none"!==t){var n=this._isColorString(t);if(void 0!==n&&(t=n),!0===hc(t)){if(!0===hD(t)){var o=t.substr(4).substr(0,t.length-5).split(",");e={r:o[0],g:o[1],b:o[2],a:1}}else if(!0===hI(t)){var r=t.substr(5).substr(0,t.length-6).split(",");e={r:r[0],g:r[1],b:r[2],a:r[3]}}else if(!0===hA(t)){var s=hk(t);e={r:s.r,g:s.g,b:s.b,a:1}}}else if(t instanceof Object&&void 0!==t.r&&void 0!==t.g&&void 0!==t.b){var a=void 0!==t.a?t.a:"1.0";e={r:t.r,g:t.g,b:t.b,a:a}}if(void 0===e)throw Error("Unknown color passed to the colorPicker. Supported are strings: rgb, hex, rgba. Object: rgb ({r:r,g:g,b:b,[a:a]}). Supplied: "+a_(t));this._setColor(e,i)}}},{key:"show",value:function(){void 0!==this.closeCallback&&(this.closeCallback(),this.closeCallback=void 0),this.applied=!1,this.frame.style.display="block",this._generateHueCircle()}},{key:"_hide",value:function(){var t=this,e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];!0===e&&(this.previousColor=eK({},this.color)),!0===this.applied&&this.updateCallback(this.initialColor),this.frame.style.display="none",aB(function(){void 0!==t.closeCallback&&(t.closeCallback(),t.closeCallback=void 0)},0)}},{key:"_save",value:function(){this.updateCallback(this.color),this.applied=!1,this._hide()}},{key:"_apply",value:function(){this.applied=!0,this.updateCallback(this.color),this._updatePicker(this.color)}},{key:"_loadLast",value:function(){void 0!==this.previousColor?this.setColor(this.previousColor,!1):alert("There is no last color to load...")}},{key:"_setColor",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];!0===e&&(this.initialColor=eK({},t)),this.color=t;var i=hC(t.r,t.g,t.b),n=2*Math.PI,o=this.r*i.s,r=this.centerCoordinates.x+o*Math.sin(n*i.h),s=this.centerCoordinates.y+o*Math.cos(n*i.h);this.colorPickerSelector.style.left=r-.5*this.colorPickerSelector.clientWidth+"px",this.colorPickerSelector.style.top=s-.5*this.colorPickerSelector.clientHeight+"px",this._updatePicker(t)}},{key:"_setOpacity",value:function(t){this.color.a=t/100,this._updatePicker(this.color)}},{key:"_setBrightness",value:function(t){var e=hC(this.color.r,this.color.g,this.color.b);e.v=t/100;var i=hM(e.h,e.s,e.v);i.a=this.color.a,this.color=i,this._updatePicker()}},{key:"_updatePicker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.color,e=hC(t.r,t.g,t.b),i=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1)),i.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var n=this.colorPickerCanvas.clientWidth,o=this.colorPickerCanvas.clientHeight;i.clearRect(0,0,n,o),i.putImageData(this.hueCircle,0,0),i.fillStyle="rgba(0,0,0,"+(1-e.v)+")",i.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),aN(i).call(i),this.brightnessRange.value=100*e.v,this.opacityRange.value=100*t.a,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}},{key:"_setSize",value:function(){this.colorPickerCanvas.style.width="100%",this.colorPickerCanvas.style.height="100%",this.colorPickerCanvas.width=289*this.pixelRatio,this.colorPickerCanvas.height=289*this.pixelRatio}},{key:"_create",value:function(){if(this.frame=document.createElement("div"),this.frame.className="vis-color-picker",this.colorPickerDiv=document.createElement("div"),this.colorPickerSelector=document.createElement("div"),this.colorPickerSelector.className="vis-selector",this.colorPickerDiv.appendChild(this.colorPickerSelector),this.colorPickerCanvas=document.createElement("canvas"),this.colorPickerDiv.appendChild(this.colorPickerCanvas),this.colorPickerCanvas.getContext){var t=this.colorPickerCanvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1),this.colorPickerCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}else{var e,i,n,o,r=document.createElement("DIV");r.style.color="red",r.style.fontWeight="bold",r.style.padding="10px",r.innerText="Error: your browser does not support HTML canvas",this.colorPickerCanvas.appendChild(r)}this.colorPickerDiv.className="vis-color",this.opacityDiv=document.createElement("div"),this.opacityDiv.className="vis-opacity",this.brightnessDiv=document.createElement("div"),this.brightnessDiv.className="vis-brightness",this.arrowDiv=document.createElement("div"),this.arrowDiv.className="vis-arrow",this.opacityRange=document.createElement("input");try{this.opacityRange.type="range",this.opacityRange.min="0",this.opacityRange.max="100"}catch(t){}this.opacityRange.value="100",this.opacityRange.className="vis-range",this.brightnessRange=document.createElement("input");try{this.brightnessRange.type="range",this.brightnessRange.min="0",this.brightnessRange.max="100"}catch(t){}this.brightnessRange.value="100",this.brightnessRange.className="vis-range",this.opacityDiv.appendChild(this.opacityRange),this.brightnessDiv.appendChild(this.brightnessRange);var s=this;this.opacityRange.onchange=function(){s._setOpacity(this.value)},this.opacityRange.oninput=function(){s._setOpacity(this.value)},this.brightnessRange.onchange=function(){s._setBrightness(this.value)},this.brightnessRange.oninput=function(){s._setBrightness(this.value)},this.brightnessLabel=document.createElement("div"),this.brightnessLabel.className="vis-label vis-brightness",this.brightnessLabel.innerText="brightness:",this.opacityLabel=document.createElement("div"),this.opacityLabel.className="vis-label vis-opacity",this.opacityLabel.innerText="opacity:",this.newColorDiv=document.createElement("div"),this.newColorDiv.className="vis-new-color",this.newColorDiv.innerText="new",this.initialColorDiv=document.createElement("div"),this.initialColorDiv.className="vis-initial-color",this.initialColorDiv.innerText="initial",this.cancelButton=document.createElement("div"),this.cancelButton.className="vis-button vis-cancel",this.cancelButton.innerText="cancel",this.cancelButton.onclick=e7(e=this._hide).call(e,this,!1),this.applyButton=document.createElement("div"),this.applyButton.className="vis-button vis-apply",this.applyButton.innerText="apply",this.applyButton.onclick=e7(i=this._apply).call(i,this),this.saveButton=document.createElement("div"),this.saveButton.className="vis-button vis-save",this.saveButton.innerText="save",this.saveButton.onclick=e7(n=this._save).call(n,this),this.loadButton=document.createElement("div"),this.loadButton.className="vis-button vis-load",this.loadButton.innerText="load last",this.loadButton.onclick=e7(o=this._loadLast).call(o,this),this.frame.appendChild(this.colorPickerDiv),this.frame.appendChild(this.arrowDiv),this.frame.appendChild(this.brightnessLabel),this.frame.appendChild(this.brightnessDiv),this.frame.appendChild(this.opacityLabel),this.frame.appendChild(this.opacityDiv),this.frame.appendChild(this.newColorDiv),this.frame.appendChild(this.initialColorDiv),this.frame.appendChild(this.cancelButton),this.frame.appendChild(this.applyButton),this.frame.appendChild(this.saveButton),this.frame.appendChild(this.loadButton)}},{key:"_bindHammer",value:function(){var t=this;this.drag={},this.pinch={},this.hammer=new he(this.colorPickerCanvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("hammer.input",function(e){e.isFirst&&t._moveSelector(e)}),this.hammer.on("tap",function(e){t._moveSelector(e)}),this.hammer.on("panstart",function(e){t._moveSelector(e)}),this.hammer.on("panmove",function(e){t._moveSelector(e)}),this.hammer.on("panend",function(e){t._moveSelector(e)})}},{key:"_generateHueCircle",value:function(){if(!1===this.generated){var t,e,i,n,o,r=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1)),r.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var s=this.colorPickerCanvas.clientWidth,a=this.colorPickerCanvas.clientHeight;r.clearRect(0,0,s,a),this.centerCoordinates={x:.5*s,y:.5*a},this.r=.49*s;var l=2*Math.PI/360,h=1/360,c=1/this.r;for(i=0;i<360;i++)for(n=0;n<this.r;n++)t=this.centerCoordinates.x+n*Math.sin(l*i),e=this.centerCoordinates.y+n*Math.cos(l*i),o=hM(i*h,n*c,1),r.fillStyle="rgb("+o.r+","+o.g+","+o.b+")",r.fillRect(t-.5,e-.5,2,2);r.strokeStyle="rgba(0,0,0,1)",r.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),r.stroke(),this.hueCircle=r.getImageData(0,0,s,a)}this.generated=!0}},{key:"_moveSelector",value:function(t){var e=this.colorPickerDiv.getBoundingClientRect(),i=t.center.x-e.left,n=t.center.y-e.top,o=.5*this.colorPickerDiv.clientHeight,r=.5*this.colorPickerDiv.clientWidth,s=i-r,a=n-o,l=Math.atan2(s,a),h=.98*Math.min(Math.sqrt(s*s+a*a),r),c=Math.cos(l)*h+o,d=Math.sin(l)*h+r;this.colorPickerSelector.style.top=c-.5*this.colorPickerSelector.clientHeight+"px",this.colorPickerSelector.style.left=d-.5*this.colorPickerSelector.clientWidth+"px";var u=l/(2*Math.PI);u=u<0?u+1:u;var f=h/this.r,p=hC(this.color.r,this.color.g,this.color.b);p.h=u,p.s=f;var g=hM(p.h,p.s,p.v);g.a=this.color.a,this.color=g,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}}]),t}();function hj(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];if(e.length<1)throw TypeError("Invalid arguments.");if(1===e.length)return document.createTextNode(e[0]);var n=document.createElement(e[0]);return n.appendChild(hj.apply(void 0,r7(so(e).call(e,1)))),n}var hH=function(){function t(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return!1};n4(this,t),this.parent=e,this.changedOptions=[],this.container=i,this.allowCreation=!1,this.hideOption=r,this.options={},this.initialized=!1,this.popupCounter=0,this.defaultOptions={enabled:!1,filter:!0,container:void 0,showButton:!0},eK(this.options,this.defaultOptions),this.configureOptions=n,this.moduleOptions={},this.domElements=[],this.popupDiv={},this.popupLimit=5,this.popupHistory={},this.colorPicker=new hF(o),this.wrapper=void 0}return rH(t,[{key:"setOptions",value:function(t){if(void 0!==t){this.popupHistory={},this._removePopup();var e=!0;if("string"==typeof t)this.options.filter=t;else if(sl(t))this.options.filter=t.join();else if("object"===rN(t)){if(null==t)throw TypeError("options cannot be null");void 0!==t.container&&(this.options.container=t.container),void 0!==s2(t)&&(this.options.filter=s2(t)),void 0!==t.showButton&&(this.options.showButton=t.showButton),void 0!==t.enabled&&(e=t.enabled)}else"boolean"==typeof t?(this.options.filter=!0,e=t):"function"==typeof t&&(this.options.filter=t,e=!0);!1===s2(this.options)&&(e=!1),this.options.enabled=e}this._clean()}},{key:"setModuleOptions",value:function(t){this.moduleOptions=t,!0===this.options.enabled&&(this._clean(),void 0!==this.options.container&&(this.container=this.options.container),this._create())}},{key:"_create",value:function(){this._clean(),this.changedOptions=[];var t=s2(this.options),e=0,i=!1;for(var n in this.configureOptions)Object.prototype.hasOwnProperty.call(this.configureOptions,n)&&(this.allowCreation=!1,i=!1,"function"==typeof t?i=(i=t(n,[]))||this._handleObject(this.configureOptions[n],[n],!0):(!0===t||-1!==ab(t).call(t,n))&&(i=!0),!1!==i&&(this.allowCreation=!0,e>0&&this._makeItem([]),this._makeHeader(n),this._handleObject(this.configureOptions[n],[n])),e++);this._makeButton(),this._push()}},{key:"_push",value:function(){this.wrapper=document.createElement("div"),this.wrapper.className="vis-configuration-wrapper",this.container.appendChild(this.wrapper);for(var t=0;t<this.domElements.length;t++)this.wrapper.appendChild(this.domElements[t]);this._showPopupIfNeeded()}},{key:"_clean",value:function(){for(var t=0;t<this.domElements.length;t++)this.wrapper.removeChild(this.domElements[t]);void 0!==this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=void 0),this.domElements=[],this._removePopup()}},{key:"_getValue",value:function(t){for(var e=this.moduleOptions,i=0;i<t.length;i++)if(void 0!==e[t[i]])e=e[t[i]];else{e=void 0;break}return e}},{key:"_makeItem",value:function(t){if(!0===this.allowCreation){var e=document.createElement("div");e.className="vis-configuration vis-config-item vis-config-s"+t.length;for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return sS(n).call(n,function(t){e.appendChild(t)}),this.domElements.push(e),this.domElements.length}return 0}},{key:"_makeHeader",value:function(t){var e=document.createElement("div");e.className="vis-configuration vis-config-header",e.innerText=t,this._makeItem([],e)}},{key:"_makeLabel",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=document.createElement("div");if(n.className="vis-configuration vis-config-label vis-config-s"+e.length,!0===i){for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(hj("i","b",t))}else n.innerText=t+":";return n}},{key:"_makeDropdown",value:function(t,e,i){var n=document.createElement("select");n.className="vis-configuration vis-config-select";var o=0;void 0!==e&&-1!==ab(t).call(t,e)&&(o=ab(t).call(t,e));for(var r=0;r<t.length;r++){var s=document.createElement("option");s.value=t[r],r===o&&(s.selected="selected"),s.innerText=t[r],n.appendChild(s)}var a=this;n.onchange=function(){a._update(this.value,i)};var l=this._makeLabel(i[i.length-1],i);this._makeItem(i,l,n)}},{key:"_makeRange",value:function(t,e,i){var n=t[0],o=t[1],r=t[2],s=t[3],a=document.createElement("input");a.className="vis-configuration vis-config-range";try{a.type="range",a.min=o,a.max=r}catch(t){}a.step=s;var l="",h=0;void 0!==e?(e<0&&1.2*e<o?(a.min=Math.ceil(1.2*e),h=a.min,l="range increased"):e/1.2<o&&(a.min=Math.ceil(e/1.2),h=a.min,l="range increased"),1.2*e>r&&1!==r&&(a.max=Math.ceil(1.2*e),h=a.max,l="range increased"),a.value=e):a.value=n;var c=document.createElement("input");c.className="vis-configuration vis-config-rangeinput",c.value=a.value;var d=this;a.onchange=function(){c.value=this.value,d._update(Number(this.value),i)},a.oninput=function(){c.value=this.value};var u=this._makeLabel(i[i.length-1],i),f=this._makeItem(i,u,a,c);""!==l&&this.popupHistory[f]!==h&&(this.popupHistory[f]=h,this._setupPopup(l,f))}},{key:"_makeButton",value:function(){var t=this;if(!0===this.options.showButton){var e=document.createElement("div");e.className="vis-configuration vis-config-button",e.innerText="generate options",e.onclick=function(){t._printOptions()},e.onmouseover=function(){e.className="vis-configuration vis-config-button hover"},e.onmouseout=function(){e.className="vis-configuration vis-config-button"},this.optionsContainer=document.createElement("div"),this.optionsContainer.className="vis-configuration vis-config-option-container",this.domElements.push(this.optionsContainer),this.domElements.push(e)}}},{key:"_setupPopup",value:function(t,e){var i=this;if(!0===this.initialized&&!0===this.allowCreation&&this.popupCounter<this.popupLimit){var n=document.createElement("div");n.id="vis-configuration-popup",n.className="vis-configuration-popup",n.innerText=t,n.onclick=function(){i._removePopup()},this.popupCounter+=1,this.popupDiv={html:n,index:e}}}},{key:"_removePopup",value:function(){void 0!==this.popupDiv.html&&(this.popupDiv.html.parentNode.removeChild(this.popupDiv.html),clearTimeout(this.popupDiv.hideTimeout),clearTimeout(this.popupDiv.deleteTimeout),this.popupDiv={})}},{key:"_showPopupIfNeeded",value:function(){var t=this;if(void 0!==this.popupDiv.html){var e=this.domElements[this.popupDiv.index].getBoundingClientRect();this.popupDiv.html.style.left=e.left+"px",this.popupDiv.html.style.top=e.top-30+"px",document.body.appendChild(this.popupDiv.html),this.popupDiv.hideTimeout=aB(function(){t.popupDiv.html.style.opacity=0},1500),this.popupDiv.deleteTimeout=aB(function(){t._removePopup()},1800)}}},{key:"_makeCheckbox",value:function(t,e,i){var n=document.createElement("input");n.type="checkbox",n.className="vis-configuration vis-config-checkbox",n.checked=t,void 0!==e&&(n.checked=e,e!==t&&("object"===rN(t)?e!==t.enabled&&this.changedOptions.push({path:i,value:e}):this.changedOptions.push({path:i,value:e})));var o=this;n.onchange=function(){o._update(this.checked,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,n)}},{key:"_makeTextInput",value:function(t,e,i){var n=document.createElement("input");n.type="text",n.className="vis-configuration vis-config-text",n.value=e,e!==t&&this.changedOptions.push({path:i,value:e});var o=this;n.onchange=function(){o._update(this.value,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,n)}},{key:"_makeColorField",value:function(t,e,i){var n=this,o=t[1],r=document.createElement("div");"none"!==(e=void 0===e?o:e)?(r.className="vis-configuration vis-config-colorBlock",r.style.backgroundColor=e):r.className="vis-configuration vis-config-colorBlock none",e=void 0===e?o:e,r.onclick=function(){n._showColorPicker(e,r,i)};var s=this._makeLabel(i[i.length-1],i);this._makeItem(i,s,r)}},{key:"_showColorPicker",value:function(t,e,i){var n=this;e.onclick=function(){},this.colorPicker.insertTo(e),this.colorPicker.show(),this.colorPicker.setColor(t),this.colorPicker.setUpdateCallback(function(t){var o="rgba("+t.r+","+t.g+","+t.b+","+t.a+")";e.style.backgroundColor=o,n._update(o,i)}),this.colorPicker.setCloseCallback(function(){e.onclick=function(){n._showColorPicker(t,e,i)}})}},{key:"_handleObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=s2(this.options),r=!1;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){n=!0;var a=t[s],l=hv(e,s);if("function"==typeof o&&!1===(n=o(s,e))&&!sl(a)&&"string"!=typeof a&&"boolean"!=typeof a&&a instanceof Object&&(this.allowCreation=!1,n=this._handleObject(a,l,!0),this.allowCreation=!1===i),!1!==n){r=!0;var h=this._getValue(l);if(sl(a))this._handleArray(a,h,l);else if("string"==typeof a)this._makeTextInput(a,h,l);else if("boolean"==typeof a)this._makeCheckbox(a,h,l);else if(a instanceof Object){if(!this.hideOption(e,s,this.moduleOptions)){if(void 0!==a.enabled){var c=hv(l,"enabled"),d=this._getValue(c);if(!0===d){var u=this._makeLabel(s,l,!0);this._makeItem(l,u),r=this._handleObject(a,l)||r}else this._makeCheckbox(a,d,l)}else{var f=this._makeLabel(s,l,!0);this._makeItem(l,f),r=this._handleObject(a,l)||r}}}else console.error("dont know how to handle",a,s,l)}}return r}},{key:"_handleArray",value:function(t,e,i){"string"==typeof t[0]&&"color"===t[0]?(this._makeColorField(t,e,i),t[1]!==e&&this.changedOptions.push({path:i,value:e})):"string"==typeof t[0]?(this._makeDropdown(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:e})):"number"==typeof t[0]&&(this._makeRange(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:Number(e)}))}},{key:"_update",value:function(t,e){var i=this._constructOptions(t,e);this.parent.body&&this.parent.body.emitter&&this.parent.body.emitter.emit&&this.parent.body.emitter.emit("configChange",i),this.initialized=!0,this.parent.setOptions(i)}},{key:"_constructOptions",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i;t="false"!==(t="true"===t||t)&&t;for(var o=0;o<e.length;o++)"global"!==e[o]&&(void 0===n[e[o]]&&(n[e[o]]={}),o!==e.length-1?n=n[e[o]]:n[e[o]]=t);return i}},{key:"_printOptions",value:function(){for(var t=this.getOptions();this.optionsContainer.firstChild;)this.optionsContainer.removeChild(this.optionsContainer.firstChild);this.optionsContainer.appendChild(hj("pre","const options = "+a_(t,null,2)))}},{key:"getOptions",value:function(){for(var t={},e=0;e<this.changedOptions.length;e++)this._constructOptions(this.changedOptions[e].value,this.changedOptions[e].path,t);return t}}]),t}(),hW=function(){function t(e,i){n4(this,t),this.container=e,this.overflowMethod=i||"cap",this.x=0,this.y=0,this.padding=5,this.hidden=!1,this.frame=document.createElement("div"),this.frame.className="vis-tooltip",this.container.appendChild(this.frame)}return rH(t,[{key:"setPosition",value:function(t,e){this.x=af(t),this.y=af(e)}},{key:"setText",value:function(t){if(t instanceof Element){for(;this.frame.firstChild;)this.frame.removeChild(this.frame.firstChild);this.frame.appendChild(t)}else this.frame.innerText=t}},{key:"show",value:function(t){if(void 0===t&&(t=!0),!0===t){var e=this.frame.clientHeight,i=this.frame.clientWidth,n=this.frame.parentNode.clientHeight,o=this.frame.parentNode.clientWidth,r=0,s=0;if("flip"==this.overflowMethod){var a=!1,l=!0;this.y-e<this.padding&&(l=!1),this.x+i>o-this.padding&&(a=!0),r=a?this.x-i:this.x,s=l?this.y-e:this.y}else(s=this.y-e)+e+this.padding>n&&(s=n-e-this.padding),s<this.padding&&(s=this.padding),(r=this.x)+i+this.padding>o&&(r=o-i-this.padding),r<this.padding&&(r=this.padding);this.frame.style.left=r+"px",this.frame.style.top=s+"px",this.frame.style.visibility="visible",this.hidden=!1}else this.hide()}},{key:"hide",value:function(){this.hidden=!0,this.frame.style.left="0",this.frame.style.top="0",this.frame.style.visibility="hidden"}},{key:"destroy",value:function(){this.frame.parentNode.removeChild(this.frame)}}]),t}(),hV=!1,hQ="background: #FFeeee; color: #dd0000",h$=function(){function t(){n4(this,t)}return rH(t,null,[{key:"validate",value:function(e,i,n){hV=!1,m=i;var o=i;return void 0!==n&&(o=i[n]),t.parse(e,o,[]),hV}},{key:"parse",value:function(e,i,n){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.check(o,e,i,n)}},{key:"check",value:function(e,i,n,o){if(void 0===n[e]&&void 0===n.__any__){t.getSuggestion(e,n,o);return}var r=e,s=!0;void 0===n[e]&&void 0!==n.__any__&&(r="__any__",s="object"===t.getType(i[e]));var a=n[r];s&&void 0!==a.__type__&&(a=a.__type__),t.checkFields(e,i,n,r,a,o)}},{key:"checkFields",value:function(e,i,n,o,r,s){var a=function(i){console.error("%c"+i+t.printLocation(s,e),hQ)},l=t.getType(i[e]),h=r[l];void 0!==h?"array"===t.getType(h)&&-1===ab(h).call(h,i[e])?(a('Invalid option detected in "'+e+'". Allowed values are:'+t.print(h)+' not "'+i[e]+'". '),hV=!0):"object"===l&&"__any__"!==o&&(s=hv(s,e),t.parse(i[e],n[o],s)):void 0===r.any&&(a('Invalid type received for "'+e+'". Expected: '+t.print(sf(r))+". Received ["+l+'] "'+i[e]+'"'),hV=!0)}},{key:"getType",value:function(t){var e=rN(t);return"object"===e?null===t?"null":t instanceof Boolean?"boolean":t instanceof Number?"number":t instanceof String?"string":sl(t)?"array":t instanceof Date?"date":void 0!==t.nodeType?"dom":!0===t._isAMomentObject?"moment":"object":"number"===e?"number":"boolean"===e?"boolean":"string"===e?"string":void 0===e?"undefined":e}},{key:"getSuggestion",value:function(e,i,n){var o,r=t.findInOptions(e,i,n,!1),s=t.findInOptions(e,m,[],!0);o=void 0!==r.indexMatch?" in "+t.printLocation(r.path,e,"")+'Perhaps it was incomplete? Did you mean: "'+r.indexMatch+'"?\n\n':s.distance<=4&&r.distance>s.distance?" in "+t.printLocation(r.path,e,"")+"Perhaps it was misplaced? Matching option found at: "+t.printLocation(s.path,s.closestMatch,""):r.distance<=8?'. Did you mean "'+r.closestMatch+'"?'+t.printLocation(r.path,e):". Did you mean one of these: "+t.print(sf(i))+t.printLocation(n,e),console.error('%cUnknown option detected: "'+e+'"'+o,hQ),hV=!0}},{key:"findInOptions",value:function(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1e9,s="",a=[],l=e.toLowerCase(),h=void 0;for(var c in i){var d,u=void 0;if(void 0!==i[c].__type__&&!0===o){var f=t.findInOptions(e,i[c],hv(n,c));r>f.distance&&(s=f.closestMatch,a=f.path,r=f.distance,h=f.indexMatch)}else -1!==ab(d=c.toLowerCase()).call(d,l)&&(h=c),r>(u=t.levenshteinDistance(e,c))&&(s=c,a=hy(n),r=u)}return{closestMatch:s,path:a,distance:r,indexMatch:h}}},{key:"printLocation",value:function(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Problem value found at: \n",n="\n\n"+i+"options = {\n",o=0;o<t.length;o++){for(var r=0;r<o+1;r++)n+="  ";n+=t[o]+": {\n"}for(var s=0;s<t.length+1;s++)n+="  ";n+=e+"\n";for(var a=0;a<t.length+1;a++){for(var l=0;l<t.length-a;l++)n+="  ";n+="}\n"}return n+"\n\n"}},{key:"print",value:function(t){return a_(t).replace(/(")|(\[)|(\])|(,"__type__")/g,"").replace(/(,)/g,", ")}},{key:"levenshteinDistance",value:function(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;var i,n,o=[];for(i=0;i<=e.length;i++)o[i]=[i];for(n=0;n<=t.length;n++)o[0][n]=n;for(i=1;i<=e.length;i++)for(n=1;n<=t.length;n++)e.charAt(i-1)==t.charAt(n-1)?o[i][n]=o[i-1][n-1]:o[i][n]=Math.min(o[i-1][n-1]+1,Math.min(o[i][n-1]+1,o[i-1][n]+1));return o[e.length][t.length]}}]),t}(),hq=he,hU=Object.freeze({__proto__:null,Activator:hi,Alea:ht,ColorPicker:hF,Configurator:hH,DELETE:l6,HSVToHex:hP,HSVToRGB:hM,Hammer:hq,Popup:hW,RGBToHSV:hC,RGBToHex:hS,VALIDATOR_PRINT_STYLE:hQ,Validator:h$,addClassName:function(t,e){var i=t.className.split(" "),n=e.split(" ");i=sn(i).call(i,s2(n).call(n,function(t){return!sX(i).call(i,t)})),t.className=i.join(" ")},addCssText:function(t,e){for(var i=hE(e),n=0,o=ax(i);n<o.length;n++){var r=r9(o[n],2),s=r[0],a=r[1];t.style.setProperty(s,a)}},addEventListener:function(t,e,i,n){if(t.addEventListener){var o;void 0===n&&(n=!1),"mousewheel"===e&&sX(o=navigator.userAgent).call(o,"Firefox")&&(e="DOMMouseScroll"),t.addEventListener(e,i,n)}else t.attachEvent("on"+e,i)},binarySearchCustom:function(t,e,i,n){for(var o=0,r=0,s=t.length-1;r<=s&&o<1e4;){var a=Math.floor((r+s)/2),l=t[a],h=e(void 0===n?l[i]:l[i][n]);if(0==h)return a;-1==h?r=a+1:s=a-1,o++}return -1},binarySearchValue:function(t,e,i,n,o){var r,s,a,l,h=0,c=0,d=t.length-1;for(o=void 0!=o?o:function(t,e){return t==e?0:t<e?-1:1};c<=d&&h<1e4;){if(r=t[Math.max(0,(l=Math.floor(.5*(d+c)))-1)][i],s=t[l][i],a=t[Math.min(t.length-1,l+1)][i],0==o(s,e))return l;if(0>o(r,e)&&o(s,e)>0)return"before"==n?Math.max(0,l-1):l;if(0>o(s,e)&&o(a,e)>0)return"before"==n?l:Math.min(t.length-1,l+1);0>o(s,e)?c=l+1:d=l-1,h++}return -1},bridgeObject:hB,copyAndExtendArray:hv,copyArray:hy,deepExtend:hm,deepObjectAssign:l7,easingFunctions:hR,equalArray:function(t,e){if(t.length!==e.length)return!1;for(var i=0,n=t.length;i<n;i++)if(t[i]!=e[i])return!1;return!0},extend:eK,fillIfDefined:hf,forEach:hx,getAbsoluteLeft:hb,getAbsoluteRight:function(t){return t.getBoundingClientRect().right},getAbsoluteTop:hw,getScrollBarWidth:function(){var t=document.createElement("p");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),document.body.appendChild(e);var i=t.offsetWidth;e.style.overflow="scroll";var n=t.offsetWidth;return i==n&&(n=e.clientWidth),document.body.removeChild(e),i-n},getTarget:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event,e=null;return t&&(t.target?e=t.target:t.srcElement&&(e=t.srcElement)),e instanceof Element&&(null==e.nodeType||3!=e.nodeType||(e=e.parentNode)instanceof Element)?e:null},getType:function(t){var e=rN(t);return"object"===e?null===t?"null":t instanceof Boolean?"Boolean":t instanceof Number?"Number":t instanceof String?"String":sl(t)?"Array":t instanceof Date?"Date":"Object":"number"===e?"Number":"boolean"===e?"Boolean":"string"===e?"String":void 0===e?"undefined":e},hasParent:function(t,e){for(var i=t;i;){if(i===e)return!0;if(i.parentNode)i=i.parentNode;else break}return!1},hexToHSV:hT,hexToRGB:hk,insertSort:function(t,e){for(var i=0;i<t.length;i++){var n=t[i],o=void 0;for(o=i;o>0&&0>e(n,t[o-1]);o--)t[o]=t[o-1];t[o]=n}return t},isDate:function(t){return!!(t instanceof Date||hc(t)&&(hn.exec(t)||!isNaN(Date.parse(t))))},isNumber:hl,isObject:hd,isString:hc,isValidHex:hA,isValidRGB:hD,isValidRGBA:hI,mergeOptions:hz,option:{asBoolean:function(t,e){return("function"==typeof t&&(t=t()),null!=t)?!1!=t:e||null},asNumber:function(t,e){return("function"==typeof t&&(t=t()),null!=t)?Number(t)||e||null:e||null},asString:function(t,e){return("function"==typeof t&&(t=t()),null!=t)?String(t):e||null},asSize:function(t,e){return("function"==typeof t&&(t=t()),hc(t))?t:hl(t)?t+"px":e||null},asElement:function(t,e){return"function"==typeof t&&(t=t()),t||e||null}},overrideOpacity:hO,parseColor:h_,preventDefault:function(t){t||(t=window.event),t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},pureDeepObjectAssign:l9,recursiveDOMDelete:hh,removeClassName:function(t,e){var i=t.className.split(" "),n=e.split(" ");i=s2(i).call(i,function(t){return!sX(n).call(n,t)}),t.className=i.join(" ")},removeCssText:function(t,e){for(var i=hE(e),n=0,o=sf(i);n<o.length;n++){var r=o[n];t.style.removeProperty(r)}},removeEventListener:function(t,e,i,n){if(t.removeEventListener){var o;void 0===n&&(n=!1),"mousewheel"===e&&sX(o=navigator.userAgent).call(o,"Firefox")&&(e="DOMMouseScroll"),t.removeEventListener(e,i,n)}else t.detachEvent("on"+e,i)},selectiveBridgeObject:function(t,e){if(null===e||"object"!==rN(e))return null;for(var i=aS(e),n=0;n<t.length;n++)Object.prototype.hasOwnProperty.call(e,t[n])&&"object"==rN(e[t[n]])&&(i[t[n]]=hB(e[t[n]]));return i},selectiveDeepExtend:hp,selectiveExtend:function(t,e){if(!sl(t))throw Error("Array with property names expected as first argument");for(var i=arguments.length,n=Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];for(var r=0;r<n.length;r++)for(var s=n[r],a=0;a<t.length;a++){var l=t[a];s&&Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},selectiveNotDeepExtend:hg,throttle:function(t){var e=!1;return function(){e||(e=!0,requestAnimationFrame(function(){e=!1,t()}))}},toArray:s7,topMost:hN,updateProperty:function(t,e,i){return t[e]!==i&&(t[e]=i,!0)}});function hY(t){return hJ=t,function(){var t={};if(h0=0,h1=hJ.charAt(0),ct(),"strict"===h2&&(t.strict=!0,ct()),("graph"===h2||"digraph"===h2)&&(t.type=h2,ct()),h5===hK.IDENTIFIER&&(t.id=h2,ct()),"{"!=h2)throw cr("Angle bracket { expected");if(ct(),ce(t),"}"!=h2)throw cr("Angle bracket } expected");if(ct(),""!==h2)throw cr("End of file expected");return ct(),delete t.node,delete t.edge,delete t.graph,t}()}var hG={fontsize:"font.size",fontcolor:"font.color",labelfontcolor:"font.color",fontname:"font.face",color:["color.border","color.background"],fillcolor:"color.background",tooltip:"title",labeltooltip:"title"},hX=aS(hG);hX.color="color.color",hX.style="dashes";var hK={NULL:0,DELIMITER:1,IDENTIFIER:2,UNKNOWN:3},hZ={"{":!0,"}":!0,"[":!0,"]":!0,";":!0,"=":!0,",":!0,"->":!0,"--":!0},hJ="",h0=0,h1="",h2="",h5=hK.NULL;function h3(){h0++,h1=hJ.charAt(h0)}function h4(){return hJ.charAt(h0+1)}function h8(t){var e=t.charCodeAt(0);return e<47?35===e||46===e:e<59?e>47:e<91?e>64:e<96?95===e:e<123&&e>96}function h6(t,e){if(t||(t={}),e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function h9(t,e){for(var i=null,n=[t],o=t;o.parent;)n.push(o.parent),o=o.parent;if(o.nodes){for(r=0,s=o.nodes.length;r<s;r++)if(e.id===o.nodes[r].id){i=o.nodes[r];break}}for(!i&&(i={id:e.id},t.node&&(i.attr=h6(i.attr,t.node))),r=n.length-1;r>=0;r--){var r,s,a,l=n[r];l.nodes||(l.nodes=[]),-1===ab(a=l.nodes).call(a,i)&&l.nodes.push(i)}e.attr&&(i.attr=h6(i.attr,e.attr))}function h7(t,e,i,n,o){var r={from:e,to:i,type:n};return t.edge&&(r.attr=h6({},t.edge)),r.attr=h6(r.attr||{},o),null!=o&&o.hasOwnProperty("arrows")&&null!=o.arrows&&(r.arrows={to:{enabled:!0,type:o.arrows.type}},o.arrows=null),r}function ct(){for(h5=hK.NULL,h2="";" "===h1||"	"===h1||"\n"===h1||"\r"===h1;)h3();do{var t=!1;if("#"===h1){for(var e=h0-1;" "===hJ.charAt(e)||"	"===hJ.charAt(e);)e--;if("\n"===hJ.charAt(e)||""===hJ.charAt(e)){for(;""!=h1&&"\n"!=h1;)h3();t=!0}}if("/"===h1&&"/"===h4()){for(;""!=h1&&"\n"!=h1;)h3();t=!0}if("/"===h1&&"*"===h4()){for(;""!=h1;)if("*"===h1&&"/"===h4()){h3(),h3();break}else h3();t=!0}for(;" "===h1||"	"===h1||"\n"===h1||"\r"===h1;)h3()}while(t)if(""===h1){h5=hK.DELIMITER;return}var i=h1+h4();if(hZ[i]){h5=hK.DELIMITER,h2=i,h3(),h3();return}if(hZ[h1]){h5=hK.DELIMITER,h2=h1,h3();return}if(h8(h1)||"-"===h1){for(h2+=h1,h3();h8(h1);)h2+=h1,h3();"false"===h2?h2=!1:"true"===h2?h2=!0:isNaN(Number(h2))||(h2=Number(h2)),h5=hK.IDENTIFIER;return}if('"'===h1){for(h3();""!=h1&&('"'!=h1||'"'===h1&&'"'===h4());)'"'===h1?(h2+=h1,h3()):"\\"===h1&&"n"===h4()?(h2+="\n",h3()):h2+=h1,h3();if('"'!=h1)throw cr('End of string " expected');h3(),h5=hK.IDENTIFIER;return}for(h5=hK.UNKNOWN;""!=h1;)h2+=h1,h3();throw SyntaxError('Syntax error in part "'+cs(h2,30)+'"')}function ce(t){for(;""!==h2&&"}"!=h2;)(function(t){var e=ci(t);if(e){cn(t,e);return}if("node"===h2?(ct(),t.node=co(),false):"edge"===h2?(ct(),t.edge=co(),false):"graph"!==h2||(ct(),t.graph=co(),false)){if(h5!=hK.IDENTIFIER)throw cr("Identifier expected");var i=h2;if(ct(),"="===h2){if(ct(),h5!=hK.IDENTIFIER)throw cr("Identifier expected");t[i]=h2,ct()}else(function(t,e){var i={id:e},n=co();n&&(i.attr=n),h9(t,i),cn(t,e)})(t,i)}})(t),";"===h2&&ct()}function ci(t){var e=null;if("subgraph"===h2&&((e={}).type="subgraph",ct(),h5===hK.IDENTIFIER&&(e.id=h2,ct())),"{"===h2){if(ct(),e||(e={}),e.parent=t,e.node=t.node,e.edge=t.edge,e.graph=t.graph,ce(e),"}"!=h2)throw cr("Angle bracket } expected");ct(),delete e.node,delete e.edge,delete e.graph,delete e.parent,t.subgraphs||(t.subgraphs=[]),t.subgraphs.push(e)}return e}function cn(t,e){for(;"->"===h2||"--"===h2;){var i,n=h2;ct();var o=ci(t);if(o)i=o;else{if(h5!=hK.IDENTIFIER)throw cr("Identifier or subgraph expected");h9(t,{id:i=h2}),ct()}var r=h7(t,e,i,n,co());(function(t,e){if(t.edges||(t.edges=[]),t.edges.push(e),t.edge){var i=h6({},t.edge);e.attr=h6(i,e.attr)}})(t,r),e=i}}function co(){for(var t,e=null,i={dashed:!0,solid:!1,dotted:[1,5]},n={dot:"circle",box:"box",crow:"crow",curve:"curve",icurve:"inv_curve",normal:"triangle",inv:"inv_triangle",diamond:"diamond",tee:"bar",vee:"vee"},o=[],r=[];"["===h2;){for(ct(),e={};""!==h2&&"]"!=h2;){if(h5!=hK.IDENTIFIER)throw cr("Attribute name expected");var s,a,l=h2;if(ct(),"="!=h2)throw cr("Equal sign = expected");if(ct(),h5!=hK.IDENTIFIER)throw cr("Attribute value expected");var h=h2;"style"===l&&(h=i[h]),"arrowhead"===l&&(a=n[h],l="arrows",h={to:{enabled:!0,type:a}}),"arrowtail"===l&&(a=n[h],l="arrows",h={from:{enabled:!0,type:a}}),o.push({attr:e,name:l,value:h}),r.push(l),ct(),","==h2&&ct()}if("]"!=h2)throw cr("Bracket ] expected");ct()}if(sX(r).call(r,"dir")){var c,d,u,f={};for(s=0,f.arrows={};s<o.length;s++)if("arrows"===o[s].name){if(null!=o[s].value.to)f.arrows.to=s;else if(null!=o[s].value.from)f.arrows.from=s;else throw cr("Invalid value of arrows")}else"dir"===o[s].name&&(f.dir=s);var p=o[f.dir].value;if(!sX(r).call(r,"arrows")){if("both"===p)o.push({attr:o[f.dir].attr,name:"arrows",value:{to:{enabled:!0}}}),f.arrows.to=o.length-1,o.push({attr:o[f.dir].attr,name:"arrows",value:{from:{enabled:!0}}}),f.arrows.from=o.length-1;else if("forward"===p)o.push({attr:o[f.dir].attr,name:"arrows",value:{to:{enabled:!0}}}),f.arrows.to=o.length-1;else if("back"===p)o.push({attr:o[f.dir].attr,name:"arrows",value:{from:{enabled:!0}}}),f.arrows.from=o.length-1;else if("none"===p)o.push({attr:o[f.dir].attr,name:"arrows",value:""}),f.arrows.to=o.length-1;else throw cr('Invalid dir type "'+p+'"')}if("both"===p)f.arrows.to&&f.arrows.from?(d=o[f.arrows.to].value.to.type,c=o[f.arrows.from].value.from.type,o[f.arrows.to]={attr:o[f.arrows.to].attr,name:o[f.arrows.to].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}},sL(o).call(o,f.arrows.from,1)):f.arrows.to?(d=o[f.arrows.to].value.to.type,c="arrow",o[f.arrows.to]={attr:o[f.arrows.to].attr,name:o[f.arrows.to].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}}):f.arrows.from&&(d="arrow",c=o[f.arrows.from].value.from.type,o[f.arrows.from]={attr:o[f.arrows.from].attr,name:o[f.arrows.from].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}});else if("back"===p)f.arrows.to&&f.arrows.from?(d="",c=o[f.arrows.from].value.from.type,o[f.arrows.from]={attr:o[f.arrows.from].attr,name:o[f.arrows.from].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}}):f.arrows.to?(d="",c="arrow",f.arrows.from=f.arrows.to,o[f.arrows.from]={attr:o[f.arrows.from].attr,name:o[f.arrows.from].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}}):f.arrows.from&&(d="",c=o[f.arrows.from].value.from.type,o[f.arrows.to]={attr:o[f.arrows.from].attr,name:o[f.arrows.from].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}}),o[f.arrows.from]={attr:o[f.arrows.from].attr,name:o[f.arrows.from].name,value:{from:{enabled:!0,type:o[f.arrows.from].value.from.type}}};else if("none"===p)o[u=f.arrows.to?f.arrows.to:f.arrows.from]={attr:o[u].attr,name:o[u].name,value:""};else if("forward"===p)f.arrows.to&&f.arrows.from?(d=o[f.arrows.to].value.to.type,c="",o[f.arrows.to]={attr:o[f.arrows.to].attr,name:o[f.arrows.to].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}}):f.arrows.to?(d=o[f.arrows.to].value.to.type,c="",o[f.arrows.to]={attr:o[f.arrows.to].attr,name:o[f.arrows.to].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}}):f.arrows.from&&(d="arrow",c="",f.arrows.to=f.arrows.from,o[f.arrows.to]={attr:o[f.arrows.to].attr,name:o[f.arrows.to].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}}),o[f.arrows.to]={attr:o[f.arrows.to].attr,name:o[f.arrows.to].name,value:{to:{enabled:!0,type:o[f.arrows.to].value.to.type}}};else throw cr('Invalid dir type "'+p+'"');sL(o).call(o,f.dir,1)}if(sX(r).call(r,"penwidth")){var g=[];for(s=0,t=o.length;s<t;s++)"width"!==o[s].name&&("penwidth"===o[s].name&&(o[s].name="width"),g.push(o[s]));o=g}for(s=0,t=o.length;s<t;s++)!function(t,e,i){for(var n=e.split("."),o=t;n.length;){var r=n.shift();n.length?(o[r]||(o[r]={}),o=o[r]):o[r]=i}}(o[s].attr,o[s].name,o[s].value);return e}function cr(t){return SyntaxError(t+', got "'+cs(h2,30)+'" (char '+h0+")")}function cs(t,e){return t.length<=e?t:t.substr(0,27)+"..."}function ca(t,e,i){for(var n=e.split("."),o=n.pop(),r=t,s=0;s<n.length;s++){var a=n[s];a in r||(r[a]={}),r=r[a]}return r[o]=i,t}function cl(t,e){var i={};for(var n in t)if(t.hasOwnProperty(n)){var o=e[n];sl(o)?sS(o).call(o,function(e){ca(i,e,t[n])}):"string"==typeof o?ca(i,o,t[n]):ca(i,n,t[n])}return i}function ch(t){var e=hY(t),i={nodes:[],edges:[],options:{}};if(e.nodes&&sS(n=e.nodes).call(n,function(t){var e={id:t.id,label:String(t.label||t.id)};h6(e,cl(t.attr,hG)),e.image&&(e.shape="image"),i.nodes.push(e)}),e.edges){var n,o,r=function(t){var e={from:t.from,to:t.to};return h6(e,cl(t.attr,hX)),null==e.arrows&&"->"===t.type&&(e.arrows="to"),e};sS(o=e.edges).call(o,function(t){var e,n,o,s,a;e=t.from instanceof Object?t.from.nodes:{id:t.from},n=t.to instanceof Object?t.to.nodes:{id:t.to},t.from instanceof Object&&t.from.edges&&sS(o=t.from.edges).call(o,function(t){var e=r(t);i.edges.push(e)}),a=function(e,n){var o=r(h7(i,e.id,n.id,t.type,t.attr));i.edges.push(o)},sl(e)?sS(e).call(e,function(t){sl(n)?sS(n).call(n,function(e){a(t,e)}):a(t,n)}):sl(n)?sS(n).call(n,function(t){a(e,t)}):a(e,n),t.to instanceof Object&&t.to.edges&&sS(s=t.to.edges).call(s,function(t){var e=r(t);i.edges.push(e)})})}return e.attr&&(i.options=e.attr),i}var cc=Object.freeze({__proto__:null,DOTToGraph:ch,parseDOT:hY});function cd(t,e){var i,n={edges:{inheritColor:!1},nodes:{fixed:!1,parseColor:!1}};null!=e&&(null!=e.fixed&&(n.nodes.fixed=e.fixed),null!=e.parseColor&&(n.nodes.parseColor=e.parseColor),null!=e.inheritColor&&(n.edges.inheritColor=e.inheritColor));var o=t.edges,r=su(o).call(o,function(t){var e={from:t.source,id:t.id,to:t.target};return null!=t.attributes&&(e.attributes=t.attributes),null!=t.label&&(e.label=t.label),null!=t.attributes&&null!=t.attributes.title&&(e.title=t.attributes.title),"Directed"===t.type&&(e.arrows="to"),t.color&&!1===n.edges.inheritColor&&(e.color=t.color),e});return{nodes:su(i=t.nodes).call(i,function(t){var e={id:t.id,fixed:n.nodes.fixed&&null!=t.x&&null!=t.y};return null!=t.attributes&&(e.attributes=t.attributes),null!=t.label&&(e.label=t.label),null!=t.size&&(e.size=t.size),null!=t.attributes&&null!=t.attributes.title&&(e.title=t.attributes.title),null!=t.title&&(e.title=t.title),null!=t.x&&(e.x=t.x),null!=t.y&&(e.y=t.y),null!=t.color&&(!0===n.nodes.parseColor?e.color=t.color:e.color={background:t.color,border:t.color,highlight:{background:t.color,border:t.color},hover:{background:t.color,border:t.color}}),e}),edges:r}}var cu=Object.freeze({__proto__:null,parseGephi:cd}),cf=Object.freeze({__proto__:null,cn:{addDescription:"åå»ç©ºç½å¤æ¾ç½®æ°èç¹ã",addEdge:"æ·»å è¿æ¥çº¿",addNode:"æ·»å èç¹",back:"è¿å",close:"éé",createEdgeError:"æ æ³å°è¿æ¥çº¿è¿æ¥å°ç¾¤éã",del:"å é¤éå®",deleteClusterError:"æ æ³å é¤ç¾¤éã",edgeDescription:"åå»æä¸ªèç¹å¹¶å°è¯¥è¿æ¥çº¿æå¨å°å¦ä¸ä¸ªèç¹ä»¥è¿æ¥å®ä»¬ã",edit:"ç¼è¾",editClusterError:"æ æ³ç¼è¾ç¾¤éã",editEdge:"ç¼è¾è¿æ¥çº¿",editEdgeDescription:"åå»æ§å¶èç¹å¹¶å°å®ä»¬æå°èç¹ä¸è¿æ¥ã",editNode:"ç¼è¾èç¹"},cs:{addDescription:"KluknutÃ­m do prÃ¡zdnÃ©ho prostoru mÅ¯Å¾ete pÅidat novÃ½ vrchol.",addEdge:"PÅidat hranu",addNode:"PÅidat vrchol",back:"ZpÄt",close:"ZavÅÃ­t",createEdgeError:"Nelze pÅipojit hranu ke shluku.",del:"Smazat vÃ½bÄr",deleteClusterError:"Nelze mazat shluky.",edgeDescription:"PÅetaÅ¾enÃ­m z jednoho vrcholu do druhÃ©ho mÅ¯Å¾ete spojit tyto vrcholy novou hranou.",edit:"Upravit",editClusterError:"Nelze upravovat shluky.",editEdge:"Upravit hranu",editEdgeDescription:"PÅetaÅ¾enÃ­m kontrolnÃ­ho vrcholu hrany ji mÅ¯Å¾ete pÅipojit k jinÃ©mu vrcholu.",editNode:"Upravit vrchol"},de:{addDescription:"Klicke auf eine freie Stelle, um einen neuen Knoten zu plazieren.",addEdge:"Kante hinzufÃ¼gen",addNode:"Knoten hinzufÃ¼gen",back:"ZurÃ¼ck",close:"SchlieÃen",createEdgeError:"Es ist nicht mÃ¶glich, Kanten mit Clustern zu verbinden.",del:"LÃ¶sche Auswahl",deleteClusterError:"Cluster kÃ¶nnen nicht gelÃ¶scht werden.",edgeDescription:"Klicke auf einen Knoten und ziehe die Kante zu einem anderen Knoten, um diese zu verbinden.",edit:"Editieren",editClusterError:"Cluster kÃ¶nnen nicht editiert werden.",editEdge:"Kante editieren",editEdgeDescription:"Klicke auf die Verbindungspunkte und ziehe diese auf einen Knoten, um sie zu verbinden.",editNode:"Knoten editieren"},en:{addDescription:"Click in an empty space to place a new node.",addEdge:"Add Edge",addNode:"Add Node",back:"Back",close:"Close",createEdgeError:"Cannot link edges to a cluster.",del:"Delete selected",deleteClusterError:"Clusters cannot be deleted.",edgeDescription:"Click on a node and drag the edge to another node to connect them.",edit:"Edit",editClusterError:"Clusters cannot be edited.",editEdge:"Edit Edge",editEdgeDescription:"Click on the control points and drag them to a node to connect to it.",editNode:"Edit Node"},es:{addDescription:"Haga clic en un lugar vacÃ­o para colocar un nuevo nodo.",addEdge:"AÃ±adir arista",addNode:"AÃ±adir nodo",back:"AtrÃ¡s",close:"Cerrar",createEdgeError:"No se puede conectar una arista a un grupo.",del:"Eliminar selecciÃ³n",deleteClusterError:"No es posible eliminar grupos.",edgeDescription:"Haga clic en un nodo y arrastre la arista hacia otro nodo para conectarlos.",edit:"Editar",editClusterError:"No es posible editar grupos.",editEdge:"Editar arista",editEdgeDescription:"Haga clic en un punto de control y arrastrelo a un nodo para conectarlo.",editNode:"Editar nodo"},fr:{addDescription:"Cliquez dans un endroit vide pour placer un nÅud.",addEdge:"Ajouter un lien",addNode:"Ajouter un nÅud",back:"Retour",close:"Fermer",createEdgeError:"Impossible de crÃ©er un lien vers un cluster.",del:"Effacer la sÃ©lection",deleteClusterError:"Les clusters ne peuvent pas Ãªtre effacÃ©s.",edgeDescription:"Cliquez sur un nÅud et glissez le lien vers un autre nÅud pour les connecter.",edit:"Ãditer",editClusterError:"Les clusters ne peuvent pas Ãªtre Ã©ditÃ©s.",editEdge:"Ãditer le lien",editEdgeDescription:"Cliquez sur les points de contrÃ´le et glissez-les pour connecter un nÅud.",editNode:"Ãditer le nÅud"},it:{addDescription:"Clicca per aggiungere un nuovo nodo",addEdge:"Aggiungi un vertice",addNode:"Aggiungi un nodo",back:"Indietro",close:"Chiudere",createEdgeError:"Non si possono collegare vertici ad un cluster",del:"Cancella la selezione",deleteClusterError:"I cluster non possono essere cancellati",edgeDescription:"Clicca su un nodo e trascinalo ad un altro nodo per connetterli.",edit:"Modifica",editClusterError:"I clusters non possono essere modificati.",editEdge:"Modifica il vertice",editEdgeDescription:"Clicca sui Punti di controllo e trascinali ad un nodo per connetterli.",editNode:"Modifica il nodo"},nl:{addDescription:"Klik op een leeg gebied om een nieuwe node te maken.",addEdge:"Link toevoegen",addNode:"Node toevoegen",back:"Terug",close:"Sluiten",createEdgeError:"Kan geen link maken naar een cluster.",del:"Selectie verwijderen",deleteClusterError:"Clusters kunnen niet worden verwijderd.",edgeDescription:"Klik op een node en sleep de link naar een andere node om ze te verbinden.",edit:"Wijzigen",editClusterError:"Clusters kunnen niet worden aangepast.",editEdge:"Link wijzigen",editEdgeDescription:"Klik op de verbindingspunten en sleep ze naar een node om daarmee te verbinden.",editNode:"Node wijzigen"},pt:{addDescription:"Clique em um espaÃ§o em branco para adicionar um novo nÃ³",addEdge:"Adicionar aresta",addNode:"Adicionar nÃ³",back:"Voltar",close:"Fechar",createEdgeError:"NÃ£o foi possÃ­vel linkar arestas a um cluster.",del:"Remover selecionado",deleteClusterError:"Clusters nÃ£o puderam ser removidos.",edgeDescription:"Clique em um nÃ³ e arraste a aresta atÃ© outro nÃ³ para conectÃ¡-los",edit:"Editar",editClusterError:"Clusters nÃ£o puderam ser editados.",editEdge:"Editar aresta",editEdgeDescription:"Clique nos pontos de controle e os arraste para um nÃ³ para conectÃ¡-los",editNode:"Editar nÃ³"},ru:{addDescription:"ÐÐ»Ð¸ÐºÐ½Ð¸ÑÐµ Ð² ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑÐ¾, ÑÑÐ¾Ð±Ñ Ð´Ð¾Ð±Ð°Ð²Ð¸ÑÑ Ð½Ð¾Ð²ÑÐ¹ ÑÐ·ÐµÐ».",addEdge:"ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ ÑÐµÐ±ÑÐ¾",addNode:"ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ ÑÐ·ÐµÐ»",back:"ÐÐ°Ð·Ð°Ð´",close:"ÐÐ°ÐºÑÑÐ²Ð°ÑÑ",createEdgeError:"ÐÐµÐ²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ ÑÐ¾ÐµÐ´Ð¸Ð½Ð¸ÑÑ ÑÐµÐ±ÑÐ° Ð² ÐºÐ»Ð°ÑÑÐµÑ.",del:"Ð£Ð´Ð°Ð»Ð¸ÑÑ Ð²ÑÐ±ÑÐ°Ð½Ð½Ð¾Ðµ",deleteClusterError:"ÐÐ»Ð°ÑÑÐµÑÑ Ð½Ðµ Ð¼Ð¾Ð³ÑÑ Ð±ÑÑÑ ÑÐ´Ð°Ð»ÐµÐ½Ñ",edgeDescription:"ÐÐ»Ð¸ÐºÐ½Ð¸ÑÐµ Ð½Ð° ÑÐ·ÐµÐ» Ð¸ Ð¿ÑÐ¾ÑÑÐ½Ð¸ÑÐµ ÑÐµÐ±ÑÐ¾ Ðº Ð´ÑÑÐ³Ð¾Ð¼Ñ ÑÐ·Ð»Ñ, ÑÑÐ¾Ð±Ñ ÑÐ¾ÐµÐ´Ð¸Ð½Ð¸ÑÑ Ð¸Ñ.",edit:"Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ",editClusterError:"ÐÐ»Ð°ÑÑÐµÑÑ Ð½ÐµÐ´Ð¾ÑÑÑÐ¿Ð½Ñ Ð´Ð»Ñ ÑÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°Ð½Ð¸Ñ.",editEdge:"Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ ÑÐµÐ±ÑÐ¾",editEdgeDescription:"ÐÐ»Ð¸ÐºÐ½Ð¸ÑÐµ Ð½Ð° ÐºÐ¾Ð½ÑÑÐ¾Ð»ÑÐ½ÑÐµ ÑÐ¾ÑÐºÐ¸ Ð¸ Ð¿ÐµÑÐµÑÐ°ÑÐ¸ÑÐµ Ð¸Ñ Ð² ÑÐ·ÐµÐ», ÑÑÐ¾Ð±Ñ Ð¿Ð¾Ð´ÐºÐ»ÑÑÐ¸ÑÑÑÑ Ðº Ð½ÐµÐ¼Ñ.",editNode:"Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ ÑÐ·ÐµÐ»"},uk:{addDescription:"KÐ»ÑÐºÐ½ÑÑÑ Ð½Ð° Ð²ÑÐ»ÑÐ½Ðµ Ð¼ÑÑÑÐµ, ÑÐ¾Ð± Ð´Ð¾Ð´Ð°ÑÐ¸ Ð½Ð¾Ð²Ð¸Ð¹ Ð²ÑÐ·Ð¾Ð».",addEdge:"ÐÐ¾Ð´Ð°ÑÐ¸ ÐºÑÐ°Ð¹",addNode:"ÐÐ¾Ð´Ð°ÑÐ¸ Ð²ÑÐ·Ð¾Ð»",back:"ÐÐ°Ð·Ð°Ð´",close:"ÐÐ°ÐºÑÐ¸ÑÐ¸",createEdgeError:"ÐÐµ Ð¼Ð¾Ð¶Ð»Ð¸Ð²Ð¾ Ð¾Ð±'ÑÐ´Ð½Ð°ÑÐ¸ ÐºÑÐ°Ñ Ð² Ð³ÑÑÐ¿Ñ.",del:"ÐÐ¸Ð´Ð°Ð»Ð¸ÑÐ¸ Ð¾Ð±ÑÐ°Ð½Ðµ",deleteClusterError:"ÐÑÑÐ¿Ð¸ Ð½Ðµ Ð¼Ð¾Ð¶ÑÑÑ Ð±ÑÑÐ¸ Ð²Ð¸Ð´Ð°Ð»ÐµÐ½Ñ.",edgeDescription:"ÐÐ»ÑÐºÐ½ÑÑÑ Ð½Ð° Ð²ÑÐ·Ð¾Ð» Ñ Ð¿ÐµÑÐµÑÑÐ³Ð½ÑÑÑ ÐºÑÐ°Ð¹ Ð´Ð¾ ÑÐ½ÑÐ¾Ð³Ð¾ Ð²ÑÐ·Ð»Ð°, ÑÐ¾Ð± ÑÑ Ð·'ÑÐ´Ð½Ð°ÑÐ¸.",edit:"Ð ÐµÐ´Ð°Ð³ÑÐ²Ð°ÑÐ¸",editClusterError:"ÐÑÑÐ¿Ð¸ Ð½ÐµÐ´Ð¾ÑÑÑÐ¿Ð½Ñ Ð´Ð»Ñ ÑÐµÐ´Ð°Ð³ÑÐ²Ð°Ð½Ð½Ñ.",editEdge:"Ð ÐµÐ´Ð°Ð³ÑÐ²Ð°ÑÐ¸ ÐºÑÐ°Ð¹",editEdgeDescription:"ÐÐ»ÑÐºÐ½ÑÑÑ Ð½Ð° ÐºÐ¾Ð½ÑÑÐ¾Ð»ÑÐ½Ñ ÑÐ¾ÑÐºÐ¸ Ñ Ð¿ÐµÑÐµÑÑÐ³Ð½ÑÑÑ ÑÑ Ñ Ð²ÑÐ·Ð¾Ð», ÑÐ¾Ð± Ð¿ÑÐ´ÐºÐ»ÑÑÐ¸ÑÐ¸ÑÑ Ð´Ð¾ Ð½ÑÐ¾Ð³Ð¾.",editNode:"Ð ÐµÐ´Ð°Ð³ÑÐ²Ð°ÑÐ¸ Ð²ÑÐ·Ð¾Ð»"}}),cp=function(){function t(){n4(this,t),this.NUM_ITERATIONS=4,this.image=new Image,this.canvas=document.createElement("canvas")}return rH(t,[{key:"init",value:function(){if(!this.initialized()){this.src=this.image.src;var t=this.image.width,e=this.image.height;this.width=t,this.height=e;var i=Math.floor(e/2),n=Math.floor(e/4),o=Math.floor(e/8),r=Math.floor(e/16),s=Math.floor(t/2),a=Math.floor(t/4),l=Math.floor(t/8),h=Math.floor(t/16);this.canvas.width=3*a,this.canvas.height=i,this.coordinates=[[0,0,s,i],[s,0,a,n],[s,n,l,o],[5*l,n,h,r]],this._fillMipMap()}}},{key:"initialized",value:function(){return void 0!==this.coordinates}},{key:"_fillMipMap",value:function(){var t=this.canvas.getContext("2d"),e=this.coordinates[0];t.drawImage(this.image,e[0],e[1],e[2],e[3]);for(var i=1;i<this.NUM_ITERATIONS;i++){var n=this.coordinates[i-1],o=this.coordinates[i];t.drawImage(this.canvas,n[0],n[1],n[2],n[3],o[0],o[1],o[2],o[3])}}},{key:"drawImageAtPosition",value:function(t,e,i,n,o,r){if(this.initialized()){if(e>2){e*=.5;for(var s=0;e>2&&s<this.NUM_ITERATIONS;)e*=.5,s+=1;s>=this.NUM_ITERATIONS&&(s=this.NUM_ITERATIONS-1);var a=this.coordinates[s];t.drawImage(this.canvas,a[0],a[1],a[2],a[3],i,n,o,r)}else t.drawImage(this.image,i,n,o,r)}}}]),t}(),cg=function(){function t(e){n4(this,t),this.images={},this.imageBroken={},this.callback=e}return rH(t,[{key:"_tryloadBrokenUrl",value:function(t,e,i){if(void 0!==t&&void 0!==i){if(void 0===e){console.warn("No broken url image defined");return}i.image.onerror=function(){console.error("Could not load brokenImage:",e)},i.image.src=e}}},{key:"_redrawWithImage",value:function(t){this.callback&&this.callback(t)}},{key:"load",value:function(t,e){var i=this,n=this.images[t];if(n)return n;var o=new cp;return this.images[t]=o,o.image.onload=function(){i._fixImageCoordinates(o.image),o.init(),i._redrawWithImage(o)},o.image.onerror=function(){console.error("Could not load image:",t),i._tryloadBrokenUrl(t,e,o)},o.image.src=t,o}},{key:"_fixImageCoordinates",value:function(t){0===t.width&&(document.body.appendChild(t),t.width=t.offsetWidth,t.height=t.offsetHeight,document.body.removeChild(t))}}]),t}(),cm={exports:{}},cv=j(function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}),cy=Object.isExtensible,cb=j(function(){cy(1)})||cv?function(t){return!!tx(t)&&(!cv||"ArrayBuffer"!==Z(t))&&(!cy||cy(t))}:cy,cw=!j(function(){return Object.isExtensible(Object.preventExtensions({}))}),cx=ep.f,ck=!1,cO=t1("meta"),cS=0,c_=function(t){cx(t,cO,{value:{objectID:"O"+cS++,weakData:{}}})},cC=cm.exports={enable:function(){cC.enable=function(){},ck=!0;var t=op.f,e=G([].splice),i={};i[cO]=1,t(i).length&&(op.f=function(i){for(var n=t(i),o=0,r=n.length;o<r;o++)if(n[o]===cO){e(n,o,1);break}return n},eM({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:om.f}))},fastKey:function(t,e){if(!tx(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!tK(t,cO)){if(!cb(t))return"F";if(!e)return"E";c_(t)}return t[cO].objectID},getWeakData:function(t,e){if(!tK(t,cO)){if(!cb(t))return!0;if(!e)return!1;c_(t)}return t[cO].weakData},onFreeze:function(t){return cw&&ck&&cb(t)&&!tK(t,cO)&&c_(t),t}};ej[cO]=!0;var cE=cm.exports,cM=TypeError,cP=function(t,e){this.stopped=t,this.result=e},cT=cP.prototype,cA=function(t,e,i){var n,o,r,s,a,l,h,c=i&&i.that,d=!!(i&&i.AS_ENTRIES),u=!!(i&&i.IS_RECORD),f=!!(i&&i.IS_ITERATOR),p=!!(i&&i.INTERRUPTED),g=ef(e,c),m=function(t){return n&&nx(n,"normal",t),new cP(!0,t)},v=function(t){return d?(ey(t),p?g(t[0],t[1],m):g(t[0],t[1])):p?g(t,m):g(t)};if(u)n=t.iterator;else if(f)n=t;else{if(!(o=nL(t)))throw new cM(tL(t)+" is not iterable");if(nS(o)){for(r=0,s=eN(t);s>r;r++)if((a=v(t[r]))&&t_(cT,a))return a;return new cP(!1)}n=nj(t,o)}for(l=u?t.next:n.next;!(h=ta(l,n)).done;){try{a=v(h.value)}catch(t){nx(n,"throw",t)}if("object"==typeof a&&a&&t_(cT,a))return a}return new cP(!1)},cD=TypeError,cI=function(t,e){if(t_(e,t))return t;throw new cD("Incorrect invocation")},cB=ep.f,cz=oT.forEach,cR=function(t,e,i){var n,o=-1!==t.indexOf("Map"),r=-1!==t.indexOf("Weak"),s=o?"set":"add",a=F[t],l=a&&a.prototype,h={};if(tr&&tn(a)&&(r||l.forEach&&!j(function(){new a().entries().next()}))){var c=(n=e(function(e,i){iB(cI(e,c),{type:t,collection:new a}),tm(i)||cA(i,e[s],{that:e,AS_ENTRIES:o})})).prototype,d=iz(t);cz(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(t){var e="add"===t||"set"===t;t in l&&!(r&&"clear"===t)&&e_(c,t,function(i,n){var o=d(this).collection;if(!e&&r&&!tx(i))return"get"===t&&void 0;var s=o[t](0===i?0:i,n);return e?this:s})}),r||cB(c,"size",{configurable:!0,get:function(){return d(this).collection.size}})}else n=i.getConstructor(e,t,o,s),cE.enable();return nt(n,t,!1,!0),h[t]=n,eM({global:!0,forced:!0},h),r||i.setStrong(n,t,o),n},cN=function(t,e,i){for(var n in e)i&&i.unsafe&&t[n]?t[n]=e[n]:i2(t,n,e[n],i);return t},cL=t4("species"),cF=function(t){var e=tS(t);tr&&e&&!e[cL]&&oO(e,cL,{configurable:!0,get:function(){return this}})},cj=cE.fastKey,cH={getConstructor:function(t,e,i,n){var o=t(function(t,o){cI(t,r),iB(t,{type:e,index:iX(null),first:void 0,last:void 0,size:0}),tr||(t.size=0),tm(o)||cA(o,t[n],{that:t,AS_ENTRIES:i})}),r=o.prototype,s=iz(e),a=function(t,e,i){var n,o,r=s(t),a=l(t,e);return a?a.value=i:(r.last=a={index:o=cj(e,!0),key:e,value:i,previous:n=r.last,next:void 0,removed:!1},r.first||(r.first=a),n&&(n.next=a),tr?r.size++:t.size++,"F"!==o&&(r.index[o]=a)),t},l=function(t,e){var i,n=s(t),o=cj(e);if("F"!==o)return n.index[o];for(i=n.first;i;i=i.next)if(i.key===e)return i};return cN(r,{clear:function(){for(var t=s(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,tr?t.size=0:this.size=0},delete:function(t){var e=s(this),i=l(this,t);if(i){var n=i.next,o=i.previous;delete e.index[i.index],i.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first===i&&(e.first=n),e.last===i&&(e.last=o),tr?e.size--:this.size--}return!!i},forEach:function(t){for(var e,i=s(this),n=ef(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:i.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!l(this,t)}}),cN(r,i?{get:function(t){var e=l(this,t);return e&&e.value},set:function(t,e){return a(this,0===t?0:t,e)}}:{add:function(t){return a(this,t=0===t?0:t,t)}}),tr&&oO(r,"size",{configurable:!0,get:function(){return s(this).size}}),o},setStrong:function(t,e,i){var n=e+" Iterator",o=iz(e),r=iz(n);nm(t,e,function(t,e){iB(this,{type:n,target:t,state:o(t),kind:e,last:void 0})},function(){for(var t=r(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?"keys"===e?nv(i.key,!1):"values"===e?nv(i.value,!1):nv([i.key,i.value],!1):(t.target=void 0,nv(void 0,!0))},i?"entries":"values",!i,!0),cF(e)}};cR("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},cH);var cW=N(tk.Map),cV=function(){function t(){n4(this,t),this.clear(),this._defaultIndex=0,this._groupIndex=0,this._defaultGroups=[{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},{border:"#FFA500",background:"#FFFF00",highlight:{border:"#FFA500",background:"#FFFFA3"},hover:{border:"#FFA500",background:"#FFFFA3"}},{border:"#FA0A10",background:"#FB7E81",highlight:{border:"#FA0A10",background:"#FFAFB1"},hover:{border:"#FA0A10",background:"#FFAFB1"}},{border:"#41A906",background:"#7BE141",highlight:{border:"#41A906",background:"#A1EC76"},hover:{border:"#41A906",background:"#A1EC76"}},{border:"#E129F0",background:"#EB7DF4",highlight:{border:"#E129F0",background:"#F0B3F5"},hover:{border:"#E129F0",background:"#F0B3F5"}},{border:"#7C29F0",background:"#AD85E4",highlight:{border:"#7C29F0",background:"#D3BDF0"},hover:{border:"#7C29F0",background:"#D3BDF0"}},{border:"#C37F00",background:"#FFA807",highlight:{border:"#C37F00",background:"#FFCA66"},hover:{border:"#C37F00",background:"#FFCA66"}},{border:"#4220FB",background:"#6E6EFD",highlight:{border:"#4220FB",background:"#9B9BFD"},hover:{border:"#4220FB",background:"#9B9BFD"}},{border:"#FD5A77",background:"#FFC0CB",highlight:{border:"#FD5A77",background:"#FFD1D9"},hover:{border:"#FD5A77",background:"#FFD1D9"}},{border:"#4AD63A",background:"#C2FABC",highlight:{border:"#4AD63A",background:"#E6FFE3"},hover:{border:"#4AD63A",background:"#E6FFE3"}},{border:"#990000",background:"#EE0000",highlight:{border:"#BB0000",background:"#FF3333"},hover:{border:"#BB0000",background:"#FF3333"}},{border:"#FF6000",background:"#FF6000",highlight:{border:"#FF6000",background:"#FF6000"},hover:{border:"#FF6000",background:"#FF6000"}},{border:"#97C2FC",background:"#2B7CE9",highlight:{border:"#D2E5FF",background:"#2B7CE9"},hover:{border:"#D2E5FF",background:"#2B7CE9"}},{border:"#399605",background:"#255C03",highlight:{border:"#399605",background:"#255C03"},hover:{border:"#399605",background:"#255C03"}},{border:"#B70054",background:"#FF007E",highlight:{border:"#B70054",background:"#FF007E"},hover:{border:"#B70054",background:"#FF007E"}},{border:"#AD85E4",background:"#7C29F0",highlight:{border:"#D3BDF0",background:"#7C29F0"},hover:{border:"#D3BDF0",background:"#7C29F0"}},{border:"#4557FA",background:"#000EA1",highlight:{border:"#6E6EFD",background:"#000EA1"},hover:{border:"#6E6EFD",background:"#000EA1"}},{border:"#FFC0CB",background:"#FD5A77",highlight:{border:"#FFD1D9",background:"#FD5A77"},hover:{border:"#FFD1D9",background:"#FD5A77"}},{border:"#C2FABC",background:"#74D66A",highlight:{border:"#E6FFE3",background:"#74D66A"},hover:{border:"#E6FFE3",background:"#74D66A"}},{border:"#EE0000",background:"#990000",highlight:{border:"#FF3333",background:"#BB0000"},hover:{border:"#FF3333",background:"#BB0000"}}],this.options={},this.defaultOptions={useDefaultGroups:!0},eK(this.options,this.defaultOptions)}return rH(t,[{key:"setOptions",value:function(t){var e=["useDefaultGroups"];if(void 0!==t){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&-1===ab(e).call(e,i)){var n=t[i];this.add(i,n)}}}},{key:"clear",value:function(){this._groups=new cW,this._groupNames=[]}},{key:"get",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=this._groups.get(t);if(void 0===i&&e){if(!1===this.options.useDefaultGroups&&this._groupNames.length>0){var n=this._groupIndex%this._groupNames.length;++this._groupIndex,(i={}).color=this._groups.get(this._groupNames[n]),this._groups.set(t,i)}else{var o=this._defaultIndex%this._defaultGroups.length;this._defaultIndex++,(i={}).color=this._defaultGroups[o],this._groups.set(t,i)}}return i}},{key:"add",value:function(t,e){return this._groups.has(t)||this._groupNames.push(t),this._groups.set(t,e),e}}]),t}();eM({target:"Number",stat:!0},{isNaN:function(t){return t!=t}});var cQ=N(tk.Number.isNaN),c$=F.isFinite;eM({target:"Number",stat:!0},{isFinite:Number.isFinite||function(t){return"number"==typeof t&&c$(t)}});var cq=N(tk.Number.isFinite),cU=oT.some;eM({target:"Array",proto:!0,forced:!sv("some")},{some:function(t){return cU(this,t,arguments.length>1?arguments[1]:void 0)}});var cY=e4("Array").some,cG=Array.prototype,cX=N(function(t){var e=t.some;return t===cG||t_(cG,t)&&e===cG.some?cY:e});function cK(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var cZ=N(aO);eM({target:"Object",stat:!0},{setPrototypeOf:na});var cJ=tk.Object.setPrototypeOf,c0=N(cJ),c1=N(e9);function c2(t,e){return(c2=c0?c1(c0).call(c0):function(t,e){return t.__proto__=e,t})(t,e)}function c5(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=cZ(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),oe(t,"prototype",{writable:!1}),e&&c2(t,e)}function c3(t,e){if(e&&("object"===rN(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return cK(t)}var c4=N(sK);function c8(t){return(c8=c0?c1(c4).call(c4):function(t){return t.__proto__||c4(t)})(t)}function c6(t,e,i){return(e=rF(e))in t?oe(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c9={exports:{}},c7={exports:{}};!function(t){function e(i){return t.exports=e="function"==typeof rm&&"symbol"==typeof rz?function(t){return typeof t}:function(t){return t&&"function"==typeof rm&&t.constructor===rm&&t!==rm.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(c7);var dt=c7.exports,de=Error,di=G("".replace),dn=String(new de("zxcasd").stack),dr=/\n\s*at [^:]*:[^\n]*/,ds=dr.test(dn),da=!j(function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",tu(1,7)),7!==t.stack)}),dl=function(t,e){if(ds&&"string"==typeof t&&!de.prepareStackTrace)for(;e--;)t=di(t,dr,"");return t},dh=Error.captureStackTrace,dc=function(t,e){tx(e)&&"cause"in e&&e_(t,"cause",e.cause)},dd=function(t,e,i,n){da&&(dh?dh(t,e):e_(t,"stack",dl(i,n)))},du=t4("toStringTag"),df=Error,dp=[].push,dg=function(t,e){var i,n=t_(dm,this);na?i=na(new df,n?i1(this):dm):e_(i=n?this:iX(dm),du,"Error"),void 0!==e&&e_(i,"message",function(t,e){return void 0===t?arguments.length<2?"":e:ib(t)}(e)),dd(i,dg,i.stack,1),arguments.length>2&&dc(i,arguments[2]);var o=[];return cA(t,dp,{that:o}),e_(i,"errors",o),i};na?na(dg,df):function(t,e,i){for(var n=ss(e),o=ep.f,r=to.f,s=0;s<n.length;s++){var a=n[s];tK(t,a)||i&&tK(i,a)||o(t,a,r(e,a))}}(dg,df,{name:!0});var dm=dg.prototype=iX(df.prototype,{constructor:tu(1,dg),message:tu(1,""),name:tu(1,"AggregateError")});eM({global:!0,constructor:!0,arity:2},{AggregateError:dg});var dv="process"===Z(F.process),dy=TypeError,db=function(t){if(nz(t))return t;throw new dy(tL(t)+" is not a constructor")},dw=t4("species"),dx=function(t,e){var i,n=ey(t).constructor;return void 0===n||tm(i=ey(n)[dw])?e:db(i)},dk=/(?:ipad|iphone|ipod).*applewebkit/i.test(tC),dO=F.setImmediate,dS=F.clearImmediate,d_=F.process,dC=F.Dispatch,dE=F.Function,dM=F.MessageChannel,dP=F.String,dT=0,dA={},dD="onreadystatechange";j(function(){y=F.location});var dI=function(t){if(tK(dA,t)){var e=dA[t];delete dA[t],e()}},dB=function(t){return function(){dI(t)}},dz=function(t){dI(t.data)},dR=function(t){F.postMessage(dP(t),y.protocol+"//"+y.host)};dO&&dS||(dO=function(t){aM(arguments.length,1);var e=tn(t)?t:dE(t),i=eZ(arguments,1);return dA[++dT]=function(){$(e,void 0,i)},b(dT),dT},dS=function(t){delete dA[t]},dv?b=function(t){d_.nextTick(dB(t))}:dC&&dC.now?b=function(t){dC.now(dB(t))}:dM&&!dk?(x=(w=new dM).port2,w.port1.onmessage=dz,b=ef(x.postMessage,x)):F.addEventListener&&tn(F.postMessage)&&!F.importScripts&&y&&"file:"!==y.protocol&&!j(dR)?(b=dR,F.addEventListener("message",dz,!1)):b=dD in en("script")?function(t){iH.appendChild(en("script"))[dD]=function(){iH.removeChild(this),dI(t)}}:function(t){setTimeout(dB(t),0)});var dN=dO,dL=function(){this.head=null,this.tail=null};dL.prototype={add:function(t){var e={item:t,next:null},i=this.tail;i?i.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var dF=/ipad|iphone|ipod/i.test(tC)&&"undefined"!=typeof Pebble,dj=/web0s(?!.*chrome)/i.test(tC),dH=to.f,dW=dN,dV=F.MutationObserver||F.WebKitMutationObserver,dQ=F.document,d$=F.process,dq=F.Promise,dU=dH(F,"queueMicrotask"),dY=dU&&dU.value;if(!dY){var dG=new dL,dX=function(){var t,e;for(dv&&(t=d$.domain)&&t.exit();e=dG.get();)try{e()}catch(t){throw dG.head&&k(),t}t&&t.enter()};dk||dv||dj||!dV||!dQ?!dF&&dq&&dq.resolve?((_=dq.resolve(void 0)).constructor=dq,C=ef(_.then,_),k=function(){C(dX)}):dv?k=function(){d$.nextTick(dX)}:(dW=ef(dW,F),k=function(){dW(dX)}):(O=!0,S=dQ.createTextNode(""),new dV(dX).observe(S,{characterData:!0}),k=function(){S.data=O=!O}),dY=function(t){dG.head||k(),dG.add(t)}}var dK=dY,dZ=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},dJ=F.Promise,d0="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,d1=!d0&&!dv&&"object"==typeof window&&"object"==typeof document,d2=dJ&&dJ.prototype,d5=t4("species"),d3=!1,d4=tn(F.PromiseRejectionEvent),d8={CONSTRUCTOR:ea("Promise",function(){var t=nC(dJ),e=t!==String(dJ);if(!e&&66===tA||!(d2.catch&&d2.finally))return!0;if(!tA||tA<51||!/native code/.test(t)){var i=new dJ(function(t){t(1)}),n=function(t){t(function(){},function(){})};if((i.constructor={})[d5]=n,!(d3=i.then(function(){})instanceof n))return!0}return!e&&(d1||d0)&&!d4}),REJECTION_EVENT:d4,SUBCLASSING:d3},d6={},d9=TypeError,d7=function(t){var e,i;this.promise=new t(function(t,n){if(void 0!==e||void 0!==i)throw new d9("Bad Promise constructor");e=t,i=n}),this.resolve=tj(e),this.reject=tj(i)};d6.f=function(t){return new d7(t)};var ut=function(t,e){try{1==arguments.length?console.error(t):console.error(t,e)}catch(t){}},ue="Promise",ui=d8.CONSTRUCTOR,un=d8.REJECTION_EVENT;d8.SUBCLASSING;var uo=iz(ue),ur=dJ&&dJ.prototype,us=dJ,ua=ur,ul=F.TypeError,uh=F.document,uc=F.process,ud=d6.f,uu=ud,uf=!!(uh&&uh.createEvent&&F.dispatchEvent),up="unhandledrejection",ug=function(t){var e;return!!(tx(t)&&tn(e=t.then))&&e},um=function(t,e){var i,n,o,r=e.value,s=1===e.state,a=s?t.ok:t.fail,l=t.resolve,h=t.reject,c=t.domain;try{a?(s||(2===e.rejection&&ux(e),e.rejection=1),!0===a?i=r:(c&&c.enter(),i=a(r),c&&(c.exit(),o=!0)),i===t.promise?h(new ul("Promise-chain cycle")):(n=ug(i))?ta(n,i,l,h):l(i)):h(r)}catch(t){c&&!o&&c.exit(),h(t)}},uv=function(t,e){t.notified||(t.notified=!0,dK(function(){for(var i,n=t.reactions;i=n.get();)um(i,t);t.notified=!1,e&&!t.rejection&&ub(t)}))},uy=function(t,e,i){var n,o;uf?((n=uh.createEvent("Event")).promise=e,n.reason=i,n.initEvent(t,!1,!0),F.dispatchEvent(n)):n={promise:e,reason:i},!un&&(o=F["on"+t])?o(n):t===up&&ut("Unhandled promise rejection",i)},ub=function(t){ta(dN,F,function(){var e,i=t.facade,n=t.value;if(uw(t)&&(e=dZ(function(){dv?uc.emit("unhandledRejection",n,i):uy(up,i,n)}),t.rejection=dv||uw(t)?2:1,e.error))throw e.value})},uw=function(t){return 1!==t.rejection&&!t.parent},ux=function(t){ta(dN,F,function(){var e=t.facade;dv?uc.emit("rejectionHandled",e):uy("rejectionhandled",e,t.value)})},uk=function(t,e,i){return function(n){t(e,n,i)}},uO=function(t,e,i){t.done||(t.done=!0,i&&(t=i),t.value=e,t.state=2,uv(t,!0))},uS=function(t,e,i){if(!t.done){t.done=!0,i&&(t=i);try{if(t.facade===e)throw new ul("Promise can't be resolved itself");var n=ug(e);n?dK(function(){var i={done:!1};try{ta(n,e,uk(uS,i,t),uk(uO,i,t))}catch(e){uO(i,e,t)}}):(t.value=e,t.state=1,uv(t,!1))}catch(e){uO({done:!1},e,t)}}};ui&&(ua=(us=function(t){cI(this,ua),tj(t),ta(E,this);var e=uo(this);try{t(uk(uS,e),uk(uO,e))}catch(t){uO(e,t)}}).prototype,(E=function(t){iB(this,{type:ue,done:!1,notified:!1,parent:!1,reactions:new dL,rejection:!1,state:0,value:void 0})}).prototype=i2(ua,"then",function(t,e){var i=uo(this),n=ud(dx(this,us));return i.parent=!0,n.ok=!tn(t)||t,n.fail=tn(e)&&e,n.domain=dv?uc.domain:void 0,0===i.state?i.reactions.add(n):dK(function(){um(n,i)}),n.promise}),M=function(){var t=new E,e=uo(t);this.promise=t,this.resolve=uk(uS,e),this.reject=uk(uO,e)},d6.f=ud=function(t){return t===us||t===P?new M(t):uu(t)}),eM({global:!0,constructor:!0,wrap:!0,forced:ui},{Promise:us}),nt(us,ue,!1,!0),cF(ue);var u_=d8.CONSTRUCTOR||!nU(function(t){dJ.all(t).then(void 0,function(){})});eM({target:"Promise",stat:!0,forced:u_},{all:function(t){var e=this,i=d6.f(e),n=i.resolve,o=i.reject,r=dZ(function(){var i=tj(e.resolve),r=[],s=0,a=1;cA(t,function(t){var l=s++,h=!1;a++,ta(i,e,t).then(function(t){!h&&(h=!0,r[l]=t,--a||n(r))},o)}),--a||n(r)});return r.error&&o(r.value),i.promise}});var uC=d8.CONSTRUCTOR;dJ&&dJ.prototype,eM({target:"Promise",proto:!0,forced:uC,real:!0},{catch:function(t){return this.then(void 0,t)}}),eM({target:"Promise",stat:!0,forced:u_},{race:function(t){var e=this,i=d6.f(e),n=i.reject,o=dZ(function(){var o=tj(e.resolve);cA(t,function(t){ta(o,e,t).then(i.resolve,n)})});return o.error&&n(o.value),i.promise}}),eM({target:"Promise",stat:!0,forced:d8.CONSTRUCTOR},{reject:function(t){var e=d6.f(this);return ta(e.reject,void 0,t),e.promise}});var uE=function(t,e){if(ey(t),tx(e)&&e.constructor===t)return e;var i=d6.f(t);return(0,i.resolve)(e),i.promise},uM=d8.CONSTRUCTOR,uP=tS("Promise"),uT=!uM;eM({target:"Promise",stat:!0,forced:!0},{resolve:function(t){return uE(uT&&this===uP?dJ:this,t)}}),eM({target:"Promise",stat:!0,forced:u_},{allSettled:function(t){var e=this,i=d6.f(e),n=i.resolve,o=i.reject,r=dZ(function(){var i=tj(e.resolve),o=[],r=0,s=1;cA(t,function(t){var a=r++,l=!1;s++,ta(i,e,t).then(function(t){!l&&(l=!0,o[a]={status:"fulfilled",value:t},--s||n(o))},function(t){!l&&(l=!0,o[a]={status:"rejected",reason:t},--s||n(o))})}),--s||n(o)});return r.error&&o(r.value),i.promise}});var uA="No one promise resolved";eM({target:"Promise",stat:!0,forced:u_},{any:function(t){var e=this,i=tS("AggregateError"),n=d6.f(e),o=n.resolve,r=n.reject,s=dZ(function(){var n=tj(e.resolve),s=[],a=0,l=1,h=!1;cA(t,function(t){var c=a++,d=!1;l++,ta(n,e,t).then(function(t){d||h||(h=!0,o(t))},function(t){!d&&!h&&(d=!0,s[c]=t,--l||r(new i(s,uA)))})}),--l||r(new i(s,uA))});return s.error&&r(s.value),n.promise}});var uD=dJ&&dJ.prototype;eM({target:"Promise",proto:!0,real:!0,forced:!!dJ&&j(function(){uD.finally.call({then:function(){}},function(){})})},{finally:function(t){var e=dx(this,tS("Promise")),i=tn(t);return this.then(i?function(i){return uE(e,t()).then(function(){return i})}:t,i?function(i){return uE(e,t()).then(function(){throw i})}:t)}});var uI=tk.Promise;eM({target:"Promise",stat:!0},{withResolvers:function(){var t=d6.f(this);return{promise:t.promise,resolve:t.resolve,reject:t.reject}}}),eM({target:"Promise",stat:!0,forced:!0},{try:function(t){var e=d6.f(this),i=dZ(t);return(i.error?e.reject:e.resolve)(i.value),e.promise}}),function(t){var e=dt.default;function i(){t.exports=i=function(){return o},t.exports.__esModule=!0,t.exports.default=t.exports;var n,o={},r=Object.prototype,s=r.hasOwnProperty,a=ot||function(t,e,i){t[e]=i.value},l="function"==typeof rm?rm:{},h=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function u(t,e,i){return ot(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,i){return t[e]=i}}function f(t,e,i,o){var r,s,l=aO((e&&e.prototype instanceof b?e:b).prototype);return a(l,"_invoke",{value:(r=new P(o||[]),s=g,function(e,o){if(s===m)throw Error("Generator is already running");if(s===v){if("throw"===e)throw o;return{value:n,done:!0}}for(r.method=e,r.arg=o;;){var a=r.delegate;if(a){var l=function t(e,i){var o=i.method,r=e.iterator[o];if(r===n)return i.delegate=null,"throw"===o&&e.iterator.return&&(i.method="return",i.arg=n,t(e,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),y;var s=p(r,e.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,y;var a=s.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=n),i.delegate=null,y):a:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,y)}(a,r);if(l){if(l===y)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(s===g)throw s=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);s=m;var h=p(t,i,r);if("normal"===h.type){if(s=r.done?v:"suspendedYield",h.arg===y)continue;return{value:h.arg,done:r.done}}"throw"===h.type&&(s=v,r.method="throw",r.arg=h.arg)}})}),l}function p(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}o.wrap=f;var g="suspendedStart",m="executing",v="completed",y={};function b(){}function w(){}function x(){}var k={};u(k,h,function(){return this});var O=sK&&sK(sK(T([])));O&&O!==r&&s.call(O,h)&&(k=O);var S=x.prototype=b.prototype=aO(k);function _(t){var e;sO(e=["next","throw","return"]).call(e,function(e){u(t,e,function(t){return this._invoke(e,t)})})}function C(t,i){var n;a(this,"_invoke",{value:function(o,r){function a(){return new i(function(n,a){!function n(o,r,a,l){var h=p(t[o],t,r);if("throw"!==h.type){var c=h.arg,d=c.value;return d&&"object"==e(d)&&s.call(d,"__await")?i.resolve(d.__await).then(function(t){n("next",t,a,l)},function(t){n("throw",t,a,l)}):i.resolve(d).then(function(t){c.value=t,a(c)},function(t){return n("throw",t,a,l)})}l(h.arg)}(o,r,n,a)})}return n=n?n.then(a,a):a()}})}function E(t){var e,i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),rG(e=this.tryEntries).call(e,i)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],sO(t).call(t,E,this),this.reset(!0)}function T(t){if(t||""===t){var i=t[h];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,r=function e(){for(;++o<t.length;)if(s.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=n,e.done=!0,e};return r.next=r}}throw TypeError(e(t)+" is not iterable")}return w.prototype=x,a(S,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=u(x,d,"GeneratorFunction"),o.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(t){return cJ?cJ(t,x):(t.__proto__=x,u(t,d,"GeneratorFunction")),t.prototype=aO(S),t},o.awrap=function(t){return{__await:t}},_(C.prototype),u(C.prototype,c,function(){return this}),o.AsyncIterator=C,o.async=function(t,e,i,n,r){void 0===r&&(r=uI);var s=new C(f(t,e,i,n),r);return o.isGeneratorFunction(e)?s:s.next().then(function(t){return t.done?t.value:s.next()})},_(S),u(S,d,"Generator"),u(S,h,function(){return this}),u(S,"toString",function(){return"[object Generator]"}),o.keys=function(t){var e=Object(t),i=[];for(var n in e)rG(i).call(i,n);return sP(i).call(i),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},o.values=T,P.prototype={constructor:P,reset:function(t){var e;if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,sO(e=this.tryEntries).call(e,M),!t)for(var i in this)"t"===i.charAt(0)&&s.call(this,i)&&!isNaN(+r5(i).call(i,1))&&(this[i]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,o){return a.type="throw",a.arg=t,e.next=i,o&&(e.method="next",e.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var l=s.call(r,"catchLoc"),h=s.call(r,"finallyLoc");if(l&&h){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!h)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=t,r.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),M(i),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var o=n.arg;M(i)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:T(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},o}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(c9);var uB=(0,c9.exports)();try{regeneratorRuntime=uB}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=uB:Function("r","regeneratorRuntime = r")(uB)}var uz=N(uB),uR=TypeError,uN=function(t){return function(e,i,n,o){tj(i);var r=tG(e),s=tg(r),a=eN(r),l=t?a-1:0,h=t?-1:1;if(n<2)for(;;){if(l in s){o=s[l],l+=h;break}if(l+=h,t?l<0:a<=l)throw new uR("Reduce of empty array with no initial value")}for(;t?l>=0:a>l;l+=h)l in s&&(o=i(o,s[l],l,r));return o}},uL={left:uN(!1),right:uN(!0)}.left;eM({target:"Array",proto:!0,forced:!dv&&tA>79&&tA<83||!sv("reduce")},{reduce:function(t){var e=arguments.length;return uL(this,t,e,e>1?arguments[1]:void 0)}});var uF=e4("Array").reduce,uj=Array.prototype,uH=N(function(t){var e=t.reduce;return t===uj||t_(uj,t)&&e===uj.reduce?uF:e}),uW=function(t,e,i,n,o,r,s,a){for(var l,h,c=o,d=0,u=!!s&&ef(s,a);d<n;)d in i&&(l=u?u(i[d],d,e):i[d],r>0&&oi(l)?(h=eN(l),c=uW(t,e,l,h,c,r-1)-1):(oo(c+1),t[c]=l),c++),d++;return c};eM({target:"Array",proto:!0},{flatMap:function(t){var e,i=tG(this),n=eN(i);return tj(t),(e=ol(i,0)).length=uW(e,i,i,n,0,1,t,arguments.length>1?arguments[1]:void 0),e}});var uV=e4("Array").flatMap,uQ=Array.prototype,u$=N(function(t){var e=t.flatMap;return t===uQ||t_(uQ,t)&&e===uQ.flatMap?uV:e});cR("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},cH);var uq=N(tk.Set),uU=N(rz),uY=N(nj),uG=Math.floor,uX=function(t,e){var i=t.length,n=uG(i/2);return i<8?uK(t,e):uZ(t,uX(ob(t,0,n),e),uX(ob(t,n),e),e)},uK=function(t,e){for(var i,n,o=t.length,r=1;r<o;){for(n=r,i=t[r];n&&e(t[n-1],i)>0;)t[n]=t[--n];n!==r++&&(t[n]=i)}return t},uZ=function(t,e,i,n){for(var o=e.length,r=i.length,s=0,a=0;s<o||a<r;)t[s+a]=s<o&&a<r?0>=n(e[s],i[a])?e[s++]:i[a++]:s<o?e[s++]:i[a++];return t},uJ=tC.match(/firefox\/(\d+)/i),u0=!!uJ&&+uJ[1],u1=/MSIE|Trident/.test(tC),u2=tC.match(/AppleWebKit\/(\d+)\./),u5=!!u2&&+u2[1],u3=[],u4=G(u3.sort),u8=G(u3.push),u6=j(function(){u3.sort(void 0)}),u9=j(function(){u3.sort(null)}),u7=sv("sort"),ft=!j(function(){if(tA)return tA<70;if(!u0||!(u0>3)){if(u1)return!0;if(u5)return u5<603;var t,e,i,n,o="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(n=0;n<47;n++)u3.push({k:e+n,v:i})}for(u3.sort(function(t,e){return e.v-t.v}),n=0;n<u3.length;n++)e=u3[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}});eM({target:"Array",proto:!0,forced:u6||!u9||!u7||!ft},{sort:function(t){void 0!==t&&tj(t);var e,i,n=tG(this);if(ft)return void 0===t?u4(n):u4(n,t);var o=[],r=eN(n);for(i=0;i<r;i++)i in n&&u8(o,n[i]);for(uX(o,function(e,i){return void 0===i?-1:void 0===e?1:void 0!==t?+t(e,i)||0:ib(e)>ib(i)?1:-1}),e=eN(o),i=0;i<e;)n[i]=o[i++];for(;i<r;)sD(n,i++);return n}});var fe=e4("Array").sort,fi=Array.prototype,fn=N(function(t){var e=t.sort;return t===fi||t_(fi,t)&&e===fi.sort?fe:e}),fo=e4("Array").keys,fr=Array.prototype,fs={DOMTokenList:!0,NodeList:!0},fa=N(function(t){var e=t.keys;return t===fr||t_(fr,t)&&e===fr.keys||tK(fs,iv(t))?fo:e}),fl=e4("Array").values,fh=Array.prototype,fc={DOMTokenList:!0,NodeList:!0},fd=N(function(t){var e=t.values;return t===fh||t_(fh,t)&&e===fh.values||tK(fc,iv(t))?fl:e}),fu=e4("Array").entries,ff=Array.prototype,fp={DOMTokenList:!0,NodeList:!0},fg=N(function(t){var e=t.entries;return t===ff||t_(ff,t)&&e===ff.entries||tK(fp,iv(t))?fu:e}),fm=N(ot),fv=tS("Reflect","construct"),fy=Object.prototype,fb=[].push,fw=j(function(){function t(){}return!(fv(function(){},[],t)instanceof t)}),fx=!j(function(){fv(function(){})}),fk=fw||fx;eM({target:"Reflect",stat:!0,forced:fk,sham:fk},{construct:function(t,e){db(t),ey(e);var i=arguments.length<3?t:db(arguments[2]);if(fx&&!fw)return fv(t,e,i);if(t===i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return $(fb,n,e),new($(e3,t,n))}var o=i.prototype,r=iX(tx(o)?o:fy),s=$(t,r,e);return tx(s)?s:r}});var fO=N(tk.Reflect.construct),fS=N(tk.Object.getOwnPropertySymbols),f_={exports:{}},fC=to.f;eM({target:"Object",stat:!0,forced:!tr||j(function(){fC(1)}),sham:!tr},{getOwnPropertyDescriptor:function(t,e){return fC(tb(t),e)}});var fE=tk.Object,fM=f_.exports=function(t,e){return fE.getOwnPropertyDescriptor(t,e)};fE.getOwnPropertyDescriptor.sham&&(fM.sham=!0);var fP=f_.exports,fT=N(fP);eM({target:"Object",stat:!0,sham:!tr},{getOwnPropertyDescriptors:function(t){for(var e,i,n=tb(t),o=to.f,r=ss(n),s={},a=0;r.length>a;)void 0!==(i=o(n,e=r[a++]))&&nR(s,e,i);return s}});var fA=N(tk.Object.getOwnPropertyDescriptors),fD={exports:{}},fI=ij.f;eM({target:"Object",stat:!0,forced:Object.defineProperties!==fI,sham:!tr},{defineProperties:fI});var fB=tk.Object,fz=fD.exports=function(t,e){return fB.defineProperties(t,e)};fB.defineProperties.sham&&(fz.sham=!0);var fR=N(fD.exports);let fN=new Uint8Array(16),fL=[];for(let t=0;t<256;++t)fL.push((t+256).toString(16).slice(1));var fF={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function fj(t,e,n){if(fF.randomUUID&&!e&&!t)return fF.randomUUID();let o=(t=t||{}).random||(t.rng||function(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(fN)})();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=o[t];return e}return function(t,e=0){return fL[t[e+0]]+fL[t[e+1]]+fL[t[e+2]]+fL[t[e+3]]+"-"+fL[t[e+4]]+fL[t[e+5]]+"-"+fL[t[e+6]]+fL[t[e+7]]+"-"+fL[t[e+8]]+fL[t[e+9]]+"-"+fL[t[e+10]]+fL[t[e+11]]+fL[t[e+12]]+fL[t[e+13]]+fL[t[e+14]]+fL[t[e+15]]}(o)}function fH(t,e){var i=sf(t);if(fS){var n=fS(t);e&&(n=s2(n).call(n,function(e){return fT(t,e).enumerable})),i.push.apply(i,n)}return i}function fW(t){for(var e=1;e<arguments.length;e++){var i,n,o=null!=arguments[e]?arguments[e]:{};e%2?sS(i=fH(Object(o),!0)).call(i,function(e){c6(t,e,o[e])}):fA?fR(t,fA(o)):sS(n=fH(Object(o))).call(n,function(e){fm(t,e,fT(o,e))})}return t}function fV(t){var e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=c8(t);return i=e?fO(n,arguments,c8(this).constructor):n.apply(this,arguments),c3(this,i)}}function fQ(t,e){var i=void 0!==st&&n3(t)||t["@@iterator"];if(!i){if(sl(t)||(i=function(t,e){if(t){if("string"==typeof t)return f$(t,void 0);var i,n=so(i=Object.prototype.toString.call(t)).call(i,8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return nG(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f$(t,void 0)}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function f$(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}var fq=function(){function t(e,i,n){var o,r,s;n4(this,t),c6(this,"_source",void 0),c6(this,"_transformers",void 0),c6(this,"_target",void 0),c6(this,"_listeners",{add:e7(o=this._add).call(o,this),remove:e7(r=this._remove).call(r,this),update:e7(s=this._update).call(s,this)}),this._source=e,this._transformers=i,this._target=n}return rH(t,[{key:"all",value:function(){return this._target.update(this._transformItems(this._source.get())),this}},{key:"start",value:function(){return this._source.on("add",this._listeners.add),this._source.on("remove",this._listeners.remove),this._source.on("update",this._listeners.update),this}},{key:"stop",value:function(){return this._source.off("add",this._listeners.add),this._source.off("remove",this._listeners.remove),this._source.off("update",this._listeners.update),this}},{key:"_transformItems",value:function(t){var e;return uH(e=this._transformers).call(e,function(t,e){return e(t)},t)}},{key:"_add",value:function(t,e){null!=e&&this._target.add(this._transformItems(this._source.get(e.items)))}},{key:"_update",value:function(t,e){null!=e&&this._target.update(this._transformItems(this._source.get(e.items)))}},{key:"_remove",value:function(t,e){null!=e&&this._target.remove(this._transformItems(e.oldData))}}]),t}(),fU=function(){function t(e){n4(this,t),c6(this,"_source",void 0),c6(this,"_transformers",[]),this._source=e}return rH(t,[{key:"filter",value:function(t){return this._transformers.push(function(e){return s2(e).call(e,t)}),this}},{key:"map",value:function(t){return this._transformers.push(function(e){return su(e).call(e,t)}),this}},{key:"flatMap",value:function(t){return this._transformers.push(function(e){return u$(e).call(e,t)}),this}},{key:"to",value:function(t){return new fq(this._source,this._transformers,t)}}]),t}();function fY(t){return"string"==typeof t||"number"==typeof t}var fG=function(){function t(e){n4(this,t),c6(this,"delay",void 0),c6(this,"max",void 0),c6(this,"_queue",[]),c6(this,"_timeout",null),c6(this,"_extended",null),this.delay=null,this.max=1/0,this.setOptions(e)}return rH(t,[{key:"setOptions",value:function(t){t&&void 0!==t.delay&&(this.delay=t.delay),t&&void 0!==t.max&&(this.max=t.max),this._flushIfNeeded()}},{key:"destroy",value:function(){if(this.flush(),this._extended){for(var t=this._extended.object,e=this._extended.methods,i=0;i<e.length;i++){var n=e[i];n.original?t[n.name]=n.original:delete t[n.name]}this._extended=null}}},{key:"replace",value:function(t,e){var i=this,n=t[e];if(!n)throw Error("Method "+e+" undefined");t[e]=function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];i.queue({args:e,fn:n,context:this})}}},{key:"queue",value:function(t){"function"==typeof t?this._queue.push({fn:t}):this._queue.push(t),this._flushIfNeeded()}},{key:"_flushIfNeeded",value:function(){var t=this;this._queue.length>this.max&&this.flush(),null!=this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this.queue.length>0&&"number"==typeof this.delay&&(this._timeout=aB(function(){t.flush()},this.delay))}},{key:"flush",value:function(){var t,e;sS(t=sL(e=this._queue).call(e,0)).call(t,function(t){t.fn.apply(t.context||t.fn,t.args||[])})}}],[{key:"extend",value:function(e,i){var n=new t(i);if(void 0!==e.flush)throw Error("Target object already has a property flush");e.flush=function(){n.flush()};var o=[{name:"flush",original:void 0}];if(i&&i.replace)for(var r=0;r<i.replace.length;r++){var s=i.replace[r];o.push({name:s,original:e[s]}),n.replace(e,s)}return n._extended={object:e,methods:o},n}}]),t}(),fX=function(){function t(){n4(this,t),c6(this,"_subscribers",{"*":[],add:[],remove:[],update:[]}),c6(this,"subscribe",t.prototype.on),c6(this,"unsubscribe",t.prototype.off)}return rH(t,[{key:"_trigger",value:function(t,e,i){var n,o;if("*"===t)throw Error("Cannot trigger event *");sS(n=sn(o=[]).call(o,r7(this._subscribers[t]),r7(this._subscribers["*"]))).call(n,function(n){n(t,e,null!=i?i:null)})}},{key:"on",value:function(t,e){"function"==typeof e&&this._subscribers[t].push(e)}},{key:"off",value:function(t,e){var i;this._subscribers[t]=s2(i=this._subscribers[t]).call(i,function(t){return t!==e})}}]),t}(),fK=function(){function t(e){n4(this,t),c6(this,"_pairs",void 0),this._pairs=e}return rH(t,[{key:uU,value:uz.mark(function t(){var e,i,n,o,r;return uz.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=fQ(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return o=(n=r9(i.value,2))[0],r=n[1],t.next=7,[o,r];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"entries",value:uz.mark(function t(){var e,i,n,o,r;return uz.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=fQ(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return o=(n=r9(i.value,2))[0],r=n[1],t.next=7,[o,r];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"keys",value:uz.mark(function t(){var e,i,n;return uz.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=fQ(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return n=r9(i.value,1)[0],t.next=7,n;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"values",value:uz.mark(function t(){var e,i,n;return uz.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=fQ(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return n=r9(i.value,2)[1],t.next=7,n;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"toIdArray",value:function(){var t;return su(t=r7(this._pairs)).call(t,function(t){return t[0]})}},{key:"toItemArray",value:function(){var t;return su(t=r7(this._pairs)).call(t,function(t){return t[1]})}},{key:"toEntryArray",value:function(){return r7(this._pairs)}},{key:"toObjectMap",value:function(){var t,e=aS(null),i=fQ(this._pairs);try{for(i.s();!(t=i.n()).done;){var n=r9(t.value,2),o=n[0],r=n[1];e[o]=r}}catch(t){i.e(t)}finally{i.f()}return e}},{key:"toMap",value:function(){return new cW(this._pairs)}},{key:"toIdSet",value:function(){return new uq(this.toIdArray())}},{key:"toItemSet",value:function(){return new uq(this.toItemArray())}},{key:"cache",value:function(){return new t(r7(this._pairs))}},{key:"distinct",value:function(t){var e,i=new uq,n=fQ(this._pairs);try{for(n.s();!(e=n.n()).done;){var o=r9(e.value,2),r=o[0],s=o[1];i.add(t(s,r))}}catch(t){n.e(t)}finally{n.f()}return i}},{key:"filter",value:function(e){var i=this._pairs;return new t(c6({},uU,uz.mark(function t(){var n,o,r,s,a;return uz.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=fQ(i),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=10;break}if(s=(r=r9(o.value,2))[0],!e(a=r[1],s)){t.next=8;break}return t.next=8,[s,a];case 8:t.next=3;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}},t,null,[[1,12,15,18]])})))}},{key:"forEach",value:function(t){var e,i=fQ(this._pairs);try{for(i.s();!(e=i.n()).done;){var n=r9(e.value,2),o=n[0],r=n[1];t(r,o)}}catch(t){i.e(t)}finally{i.f()}}},{key:"map",value:function(e){var i=this._pairs;return new t(c6({},uU,uz.mark(function t(){var n,o,r,s,a;return uz.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=fQ(i),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=9;break}return s=(r=r9(o.value,2))[0],a=r[1],t.next=7,[s,e(a,s)];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}},t,null,[[1,11,14,17]])})))}},{key:"max",value:function(t){var e=uY(this._pairs),i=e.next();if(i.done)return null;for(var n=i.value[1],o=t(i.value[1],i.value[0]);!(i=e.next()).done;){var r=r9(i.value,2),s=r[0],a=r[1],l=t(a,s);l>o&&(o=l,n=a)}return n}},{key:"min",value:function(t){var e=uY(this._pairs),i=e.next();if(i.done)return null;for(var n=i.value[1],o=t(i.value[1],i.value[0]);!(i=e.next()).done;){var r=r9(i.value,2),s=r[0],a=r[1],l=t(a,s);l<o&&(o=l,n=a)}return n}},{key:"reduce",value:function(t,e){var i,n=fQ(this._pairs);try{for(n.s();!(i=n.n()).done;){var o=r9(i.value,2),r=o[0],s=o[1];e=t(e,s,r)}}catch(t){n.e(t)}finally{n.f()}return e}},{key:"sort",value:function(e){var i=this;return new t(c6({},uU,function(){var t;return uY(fn(t=r7(i._pairs)).call(t,function(t,i){var n=r9(t,2),o=n[0],r=n[1],s=r9(i,2),a=s[0];return e(r,s[1],o,a)}))}))}}]),t}(),fZ=function(t){c5(i,t);var e=fV(i);function i(t,n){var o;return n4(this,i),c6(cK(o=e.call(this)),"flush",void 0),c6(cK(o),"length",void 0),c6(cK(o),"_options",void 0),c6(cK(o),"_data",void 0),c6(cK(o),"_idProp",void 0),c6(cK(o),"_queue",null),t&&!sl(t)&&(n=t,t=[]),o._options=n||{},o._data=new cW,o.length=0,o._idProp=o._options.fieldId||"id",t&&t.length&&o.add(t),o.setOptions(n),o}return rH(i,[{key:"idProp",get:function(){return this._idProp}},{key:"setOptions",value:function(t){t&&void 0!==t.queue&&(!1===t.queue?this._queue&&(this._queue.destroy(),this._queue=null):(this._queue||(this._queue=fG.extend(this,{replace:["add","update","remove"]})),t.queue&&"object"===rN(t.queue)&&this._queue.setOptions(t.queue)))}},{key:"add",value:function(t,e){var i,n=this,o=[];if(sl(t)){var r=su(t).call(t,function(t){return t[n._idProp]});if(cX(r).call(r,function(t){return n._data.has(t)}))throw Error("A duplicate id was found in the parameter array.");for(var s=0,a=t.length;s<a;s++)i=this._addItem(t[s]),o.push(i)}else if(t&&"object"===rN(t))i=this._addItem(t),o.push(i);else throw Error("Unknown dataType");return o.length&&this._trigger("add",{items:o},e),o}},{key:"update",value:function(t,e){var i=this,n=[],o=[],r=[],s=[],a=this._idProp,l=function(t){var e=t[a];if(null!=e&&i._data.has(e)){var l=eK({},i._data.get(e)),h=i._updateItem(t);o.push(h),s.push(t),r.push(l)}else{var c=i._addItem(t);n.push(c)}};if(sl(t))for(var h=0,c=t.length;h<c;h++)t[h]&&"object"===rN(t[h])?l(t[h]):console.warn("Ignoring input item, which is not an object at index "+h);else if(t&&"object"===rN(t))l(t);else throw Error("Unknown dataType");return n.length&&this._trigger("add",{items:n},e),o.length&&this._trigger("update",{items:o,oldData:r,data:s},e),sn(n).call(n,o)}},{key:"updateOnly",value:function(t,e){var i,n=this;sl(t)||(t=[t]);var o=su(i=su(t).call(t,function(t){var e=n._data.get(t[n._idProp]);if(null==e)throw Error("Updating non-existent items is not allowed.");return{oldData:e,update:t}})).call(i,function(t){var e=t.oldData,i=t.update,o=e[n._idProp],r=l9(e,i);return n._data.set(o,r),{id:o,oldData:e,updatedData:r}});if(!o.length)return[];var r={items:su(o).call(o,function(t){return t.id}),oldData:su(o).call(o,function(t){return t.oldData}),data:su(o).call(o,function(t){return t.updatedData})};return this._trigger("update",r,e),r.items}},{key:"get",value:function(t,e){var i,n,o=void 0,r=void 0,s=void 0;fY(t)?(o=t,s=e):sl(t)?(r=t,s=e):s=t;var a=s&&"Object"===s.returnType?"Object":"Array",l=s&&s2(s),h=[],c=void 0,d=void 0,u=void 0;if(null!=o)(c=this._data.get(o))&&l&&!l(c)&&(c=void 0);else if(null!=r)for(var f=0,p=r.length;f<p;f++)null!=(c=this._data.get(r[f]))&&(!l||l(c))&&h.push(c);else{d=r7(fa(i=this._data).call(i));for(var g=0,m=d.length;g<m;g++)u=d[g],null!=(c=this._data.get(u))&&(!l||l(c))&&h.push(c)}if(s&&s.order&&void 0==o&&this._sort(h,s.order),s&&s.fields){var v=s.fields;if(void 0!=o&&null!=c)c=this._filterFields(c,v);else for(var y=0,b=h.length;y<b;y++)h[y]=this._filterFields(h[y],v)}if("Object"==a){for(var w={},x=0,k=h.length;x<k;x++){var O=h[x];w[O[this._idProp]]=O}return w}return null!=o?null!==(n=c)&&void 0!==n?n:null:h}},{key:"getIds",value:function(t){var e=this._data,i=t&&s2(t),n=t&&t.order,o=r7(fa(e).call(e)),r=[];if(i){if(n){for(var s=[],a=0,l=o.length;a<l;a++){var h=o[a],c=this._data.get(h);null!=c&&i(c)&&s.push(c)}this._sort(s,n);for(var d=0,u=s.length;d<u;d++)r.push(s[d][this._idProp])}else for(var f=0,p=o.length;f<p;f++){var g=o[f],m=this._data.get(g);null!=m&&i(m)&&r.push(m[this._idProp])}}else if(n){for(var v=[],y=0,b=o.length;y<b;y++){var w=o[y];v.push(e.get(w))}this._sort(v,n);for(var x=0,k=v.length;x<k;x++)r.push(v[x][this._idProp])}else for(var O=0,S=o.length;O<S;O++){var _=o[O],C=e.get(_);null!=C&&r.push(C[this._idProp])}return r}},{key:"getDataSet",value:function(){return this}},{key:"forEach",value:function(t,e){var i=e&&s2(e),n=this._data,o=r7(fa(n).call(n));if(e&&e.order)for(var r=this.get(e),s=0,a=r.length;s<a;s++){var l=r[s],h=l[this._idProp];t(l,h)}else for(var c=0,d=o.length;c<d;c++){var u=o[c],f=this._data.get(u);null!=f&&(!i||i(f))&&t(f,u)}}},{key:"map",value:function(t,e){for(var i=e&&s2(e),n=[],o=this._data,r=r7(fa(o).call(o)),s=0,a=r.length;s<a;s++){var l=r[s],h=this._data.get(l);null!=h&&(!i||i(h))&&n.push(t(h,l))}return e&&e.order&&this._sort(n,e.order),n}},{key:"_filterFields",value:function(t,e){var i;return t?uH(i=sl(e)?e:sf(e)).call(i,function(e,i){return e[i]=t[i],e},{}):t}},{key:"_sort",value:function(t,e){if("string"==typeof e)fn(t).call(t,function(t,i){var n=t[e],o=i[e];return n>o?1:n<o?-1:0});else if("function"==typeof e)fn(t).call(t,e);else throw TypeError("Order must be a function or a string")}},{key:"remove",value:function(t,e){for(var i=[],n=[],o=sl(t)?t:[t],r=0,s=o.length;r<s;r++){var a=this._remove(o[r]);if(a){var l=a[this._idProp];null!=l&&(i.push(l),n.push(a))}}return i.length&&this._trigger("remove",{items:i,oldData:n},e),i}},{key:"_remove",value:function(t){var e;if(fY(t)?e=t:t&&"object"===rN(t)&&(e=t[this._idProp]),null!=e&&this._data.has(e)){var i=this._data.get(e)||null;return this._data.delete(e),--this.length,i}return null}},{key:"clear",value:function(t){for(var e,i=r7(fa(e=this._data).call(e)),n=[],o=0,r=i.length;o<r;o++)n.push(this._data.get(i[o]));return this._data.clear(),this.length=0,this._trigger("remove",{items:i,oldData:n},t),i}},{key:"max",value:function(t){var e,i,n=null,o=null,r=fQ(fd(e=this._data).call(e));try{for(r.s();!(i=r.n()).done;){var s=i.value,a=s[t];"number"==typeof a&&(null==o||a>o)&&(n=s,o=a)}}catch(t){r.e(t)}finally{r.f()}return n||null}},{key:"min",value:function(t){var e,i,n=null,o=null,r=fQ(fd(e=this._data).call(e));try{for(r.s();!(i=r.n()).done;){var s=i.value,a=s[t];"number"==typeof a&&(null==o||a<o)&&(n=s,o=a)}}catch(t){r.e(t)}finally{r.f()}return n||null}},{key:"distinct",value:function(t){for(var e=this._data,i=r7(fa(e).call(e)),n=[],o=0,r=0,s=i.length;r<s;r++){for(var a=i[r],l=e.get(a)[t],h=!1,c=0;c<o;c++)if(n[c]==l){h=!0;break}!h&&void 0!==l&&(n[o]=l,o++)}return n}},{key:"_addItem",value:function(t){var e,i=(null==t[e=this._idProp]&&(t[e]=fj()),t),n=i[this._idProp];if(this._data.has(n))throw Error("Cannot add item: item with id "+n+" already exists");return this._data.set(n,i),++this.length,n}},{key:"_updateItem",value:function(t){var e=t[this._idProp];if(null==e)throw Error("Cannot update item: item has no id (item: "+a_(t)+")");var i=this._data.get(e);if(!i)throw Error("Cannot update item: no item with id "+e+" found");return this._data.set(e,fW(fW({},i),t)),e}},{key:"stream",value:function(t){if(!t)return new fK(c6({},uU,e7(e=fg(this._data)).call(e,this._data)));var e,i=this._data;return new fK(c6({},uU,uz.mark(function e(){var n,o,r,s;return uz.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=fQ(t),e.prev=1,n.s();case 3:if((o=n.n()).done){e.next=11;break}if(r=o.value,!(null!=(s=i.get(r)))){e.next=9;break}return e.next=9,[r,s];case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[1,13,16,19]])})))}}]),i}(fX),fJ=function(t){c5(i,t);var e=fV(i);function i(t,n){var o,r;return n4(this,i),c6(cK(r=e.call(this)),"length",0),c6(cK(r),"_listener",void 0),c6(cK(r),"_data",void 0),c6(cK(r),"_ids",new uq),c6(cK(r),"_options",void 0),r._options=n||{},r._listener=e7(o=r._onEvent).call(o,cK(r)),r.setData(t),r}return rH(i,[{key:"idProp",get:function(){return this.getDataSet().idProp}},{key:"setData",value:function(t){if(this._data){this._data.off&&this._data.off("*",this._listener);var e=this._data.getIds({filter:s2(this._options)}),i=this._data.get(e);this._ids.clear(),this.length=0,this._trigger("remove",{items:e,oldData:i})}if(null!=t){this._data=t;for(var n=this._data.getIds({filter:s2(this._options)}),o=0,r=n.length;o<r;o++){var s=n[o];this._ids.add(s)}this.length=n.length,this._trigger("add",{items:n})}else this._data=new fZ;this._data.on&&this._data.on("*",this._listener)}},{key:"refresh",value:function(){for(var t=this._data.getIds({filter:s2(this._options)}),e=r7(this._ids),i={},n=[],o=[],r=[],s=0,a=t.length;s<a;s++){var l=t[s];i[l]=!0,this._ids.has(l)||(n.push(l),this._ids.add(l))}for(var h=0,c=e.length;h<c;h++){var d=e[h],u=this._data.get(d);null==u?console.error("If you see this, report it please."):i[d]||(o.push(d),r.push(u),this._ids.delete(d))}this.length+=n.length-o.length,n.length&&this._trigger("add",{items:n}),o.length&&this._trigger("remove",{items:o,oldData:r})}},{key:"get",value:function(t,e){if(null==this._data)return null;var i,n=null;fY(t)||sl(t)?(n=t,i=e):i=t;var o=eK({},this._options,i),r=s2(this._options),s=i&&s2(i);return(r&&s&&(o.filter=function(t){return r(t)&&s(t)}),null==n)?this._data.get(o):this._data.get(n,o)}},{key:"getIds",value:function(t){if(!this._data.length)return[];var e,i=s2(this._options),n=null!=t?s2(t):null;return e=n?i?function(t){return i(t)&&n(t)}:n:i,this._data.getIds({filter:e,order:t&&t.order})}},{key:"forEach",value:function(t,e){if(this._data){var i,n,o=s2(this._options),r=e&&s2(e);n=r?o?function(t){return o(t)&&r(t)}:r:o,sS(i=this._data).call(i,t,{filter:n,order:e&&e.order})}}},{key:"map",value:function(t,e){if(!this._data)return[];var i,n,o=s2(this._options),r=e&&s2(e);return n=r?o?function(t){return o(t)&&r(t)}:r:o,su(i=this._data).call(i,t,{filter:n,order:e&&e.order})}},{key:"getDataSet",value:function(){return this._data.getDataSet()}},{key:"stream",value:function(t){var e;return this._data.stream(t||c6({},uU,e7(e=fa(this._ids)).call(e,this._ids)))}},{key:"dispose",value:function(){null!==(t=this._data)&&void 0!==t&&t.off&&this._data.off("*",this._listener);var t,e,n="This data view has already been disposed of.",o={get:function(){throw Error(n)},set:function(){throw Error(n)},configurable:!1},r=fQ(sa(i.prototype));try{for(r.s();!(e=r.n()).done;){var s=e.value;fm(this,s,o)}}catch(t){r.e(t)}finally{r.f()}}},{key:"_onEvent",value:function(t,e,i){if(e&&e.items&&this._data){var n=e.items,o=[],r=[],s=[],a=[],l=[],h=[];switch(t){case"add":for(var c=0,d=n.length;c<d;c++){var u=n[c];this.get(u)&&(this._ids.add(u),o.push(u))}break;case"update":for(var f=0,p=n.length;f<p;f++){var g=n[f];this.get(g)?this._ids.has(g)?(r.push(g),l.push(e.data[f]),a.push(e.oldData[f])):(this._ids.add(g),o.push(g)):this._ids.has(g)&&(this._ids.delete(g),s.push(g),h.push(e.oldData[f]))}break;case"remove":for(var m=0,v=n.length;m<v;m++){var y=n[m];this._ids.has(y)&&(this._ids.delete(y),s.push(y),h.push(e.oldData[m]))}}this.length+=o.length-s.length,o.length&&this._trigger("add",{items:o},i),r.length&&this._trigger("update",{items:r,oldData:a,data:l},i),s.length&&this._trigger("remove",{items:s,oldData:h},i)}}}]),i}(fX);function f0(t,e){return"object"===rN(e)&&null!==e&&t===e.idProp&&"function"==typeof e.add&&"function"==typeof e.clear&&"function"==typeof e.distinct&&"function"==typeof sS(e)&&"function"==typeof e.get&&"function"==typeof e.getDataSet&&"function"==typeof e.getIds&&"number"==typeof e.length&&"function"==typeof su(e)&&"function"==typeof e.max&&"function"==typeof e.min&&"function"==typeof e.off&&"function"==typeof e.on&&"function"==typeof e.remove&&"function"==typeof e.setOptions&&"function"==typeof e.stream&&"function"==typeof e.update&&"function"==typeof e.updateOnly}function f1(t,e){return"object"===rN(e)&&null!==e&&t===e.idProp&&"function"==typeof sS(e)&&"function"==typeof e.get&&"function"==typeof e.getDataSet&&"function"==typeof e.getIds&&"number"==typeof e.length&&"function"==typeof su(e)&&"function"==typeof e.off&&"function"==typeof e.on&&"function"==typeof e.stream&&f0(t,e.getDataSet())}var f2=Object.freeze({__proto__:null,DELETE:l6,DataSet:fZ,DataStream:fK,DataView:fJ,Queue:fG,createNewDataPipeFrom:function(t){return new fU(t)},isDataSetLike:f0,isDataViewLike:f1}),f5=ar.trim,f3=G("".charAt),f4=F.parseFloat,f8=F.Symbol,f6=f8&&f8.iterator,f9=1/f4(at+"-0")!=-1/0||f6&&!j(function(){f4(Object(f6))})?function(t){var e=f5(ib(t)),i=f4(e);return 0===i&&"-"===f3(e,0)?-0:i}:f4;eM({global:!0,forced:parseFloat!==f9},{parseFloat:f9});var f7=N(tk.parseFloat),pt=om.f;eM({target:"Object",stat:!0,forced:j(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:pt});var pe=tk.Object,pi=N(function(t){return pe.getOwnPropertyNames(t)});function pn(t,e){var i=["node","edge","label"],n=!0,o=hN(e,"chosen");if("boolean"==typeof o)n=o;else if("object"===rN(o)){if(-1===ab(i).call(i,t))throw Error("choosify: subOption '"+t+"' should be one of '"+i.join("', '")+"'");var r=hN(e,["chosen",t]);("boolean"==typeof r||"function"==typeof r)&&(n=r)}return n}function po(t,e,i){if(t.width<=0||t.height<=0)return!1;if(void 0!==i){var n={x:e.x-i.x,y:e.y-i.y};if(0!==i.angle){var o=-i.angle;e={x:Math.cos(o)*n.x-Math.sin(o)*n.y,y:Math.sin(o)*n.x+Math.cos(o)*n.y}}else e=n}var r=t.x+t.width,s=t.y+t.width;return t.left<e.x&&r>e.x&&t.top<e.y&&s>e.y}function pr(t){return"string"==typeof t&&""!==t}function ps(t,e,i,n){var o=n.x,r=n.y;if("function"==typeof n.distanceToBorder){var s=n.distanceToBorder(t,e),a=Math.sin(e)*s,l=Math.cos(e)*s;l===s?(o+=s,r=n.y):a===s?(o=n.x,r-=s):(o+=l,r-=a)}else n.shape.width>n.shape.height?(o=n.x+.5*n.shape.width,r=n.y-i):(o=n.x+i,r=n.y-.5*n.shape.height);return{x:o,y:r}}var pa=function(){function t(e){n4(this,t),this.measureText=e,this.current=0,this.width=0,this.height=0,this.lines=[]}return rH(t,[{key:"_add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal";void 0===this.lines[t]&&(this.lines[t]={width:0,height:0,blocks:[]});var n=e;(void 0===e||""===e)&&(n=" ");var o=this.measureText(n,i),r=eK({},fd(o));r.text=e,r.width=o.width,r.mod=i,(void 0===e||""===e)&&(r.width=0),this.lines[t].blocks.push(r),this.lines[t].width+=r.width}},{key:"curWidth",value:function(){var t=this.lines[this.current];return void 0===t?0:t.width}},{key:"append",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";this._add(this.current,t,e)}},{key:"newLine",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";this._add(this.current,t,e),this.current++}},{key:"determineLineHeights",value:function(){for(var t=0;t<this.lines.length;t++){var e=this.lines[t],i=0;if(void 0!==e.blocks)for(var n=0;n<e.blocks.length;n++){var o=e.blocks[n];i<o.height&&(i=o.height)}e.height=i}}},{key:"determineLabelSize",value:function(){for(var t=0,e=0,i=0;i<this.lines.length;i++){var n=this.lines[i];n.width>t&&(t=n.width),e+=n.height}this.width=t,this.height=e}},{key:"removeEmptyBlocks",value:function(){for(var t=[],e=0;e<this.lines.length;e++){var i=this.lines[e];if(0!==i.blocks.length){if(e===this.lines.length-1&&0===i.width)continue;var n={};eK(n,i),n.blocks=[];for(var o=void 0,r=[],s=0;s<i.blocks.length;s++){var a=i.blocks[s];0!==a.width?r.push(a):void 0===o&&(o=a)}0===r.length&&void 0!==o&&r.push(o),n.blocks=r,t.push(n)}}return t}},{key:"finalize",value:function(){this.determineLineHeights(),this.determineLabelSize();var t=this.removeEmptyBlocks();return{width:this.width,height:this.height,lines:t}}}]),t}(),pl={"<b>":/<b>/,"<i>":/<i>/,"<code>":/<code>/,"</b>":/<\/b>/,"</i>":/<\/i>/,"</code>":/<\/code>/,"*":/\*/,_:/_/,"`":/`/,afterBold:/[^*]/,afterItal:/[^_]/,afterMono:/[^`]/},ph=function(){function t(e){n4(this,t),this.text=e,this.bold=!1,this.ital=!1,this.mono=!1,this.spacing=!1,this.position=0,this.buffer="",this.modStack=[],this.blocks=[]}return rH(t,[{key:"mod",value:function(){return 0===this.modStack.length?"normal":this.modStack[0]}},{key:"modName",value:function(){return 0===this.modStack.length?"normal":"mono"===this.modStack[0]?"mono":this.bold&&this.ital?"boldital":this.bold?"bold":this.ital?"ital":void 0}},{key:"emitBlock",value:function(){this.spacing&&(this.add(" "),this.spacing=!1),this.buffer.length>0&&(this.blocks.push({text:this.buffer,mod:this.modName()}),this.buffer="")}},{key:"add",value:function(t){" "===t&&(this.spacing=!0),this.spacing&&(this.buffer+=" ",this.spacing=!1)," "!=t&&(this.buffer+=t)}},{key:"parseWS",value:function(t){return!!/[ \t]/.test(t)&&(this.mono?this.add(t):this.spacing=!0,!0)}},{key:"setTag",value:function(t){this.emitBlock(),this[t]=!0,this.modStack.unshift(t)}},{key:"unsetTag",value:function(t){this.emitBlock(),this[t]=!1,this.modStack.shift()}},{key:"parseStartTag",value:function(t,e){return!!(!this.mono&&!this[t]&&this.match(e))&&(this.setTag(t),!0)}},{key:"match",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=r9(this.prepareRegExp(t),2),n=i[0],o=i[1],r=n.test(this.text.substr(this.position,o));return r&&e&&(this.position+=o-1),r}},{key:"parseEndTag",value:function(t,e,i){var n=this.mod()===t;return!!((n="mono"===t?n&&this.mono:n&&!this.mono)&&this.match(e))&&(void 0!==i?(this.position===this.text.length-1||this.match(i,!1))&&this.unsetTag(t):this.unsetTag(t),!0)}},{key:"replace",value:function(t,e){return!!this.match(t)&&(this.add(e),this.position+=length-1,!0)}},{key:"prepareRegExp",value:function(t){if(t instanceof RegExp)i=t,e=1;else{var e,i,n=pl[t];i=void 0!==n?n:new RegExp(t),e=t.length}return[i,e]}}]),t}(),pc=function(){function t(e,i,n,o){var r=this;n4(this,t),this.ctx=e,this.parent=i,this.selected=n,this.hover=o,this.lines=new pa(function(t,i){if(void 0===t)return 0;var s=r.parent.getFormattingValues(e,n,o,i),a=0;return""!==t&&(a=r.ctx.measureText(t).width),{width:a,values:s}})}return rH(t,[{key:"process",value:function(t){if(!pr(t))return this.lines.finalize();var e=this.parent.fontOptions,i=String(t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).split("\n"),n=i.length;if(e.multi)for(var o=0;o<n;o++){var r=this.splitBlocks(i[o],e.multi);if(void 0!==r){if(0===r.length){this.lines.newLine("");continue}if(e.maxWdt>0)for(var s=0;s<r.length;s++){var a=r[s].mod,l=r[s].text;this.splitStringIntoLines(l,a,!0)}else for(var h=0;h<r.length;h++){var c=r[h].mod,d=r[h].text;this.lines.append(d,c)}this.lines.newLine()}}else if(e.maxWdt>0)for(var u=0;u<n;u++)this.splitStringIntoLines(i[u]);else for(var f=0;f<n;f++)this.lines.newLine(i[f]);return this.lines.finalize()}},{key:"decodeMarkupSystem",value:function(t){var e="none";return"markdown"===t||"md"===t?e="markdown":(!0===t||"html"===t)&&(e="html"),e}},{key:"splitHtmlBlocks",value:function(t){for(var e=new ph(t);e.position<e.text.length;){var i=e.text.charAt(e.position);e.parseWS(i)||/</.test(i)&&(e.parseStartTag("bold","<b>")||e.parseStartTag("ital","<i>")||e.parseStartTag("mono","<code>")||e.parseEndTag("bold","</b>")||e.parseEndTag("ital","</i>")||e.parseEndTag("mono","</code>"))||/&/.test(i)&&(e.replace(e.text,"&lt;","<")||e.replace(e.text,"&amp;","&")||e.add("&"),1)||e.add(i),e.position++}return e.emitBlock(),e.blocks}},{key:"splitMarkdownBlocks",value:function(t){for(var e=new ph(t),i=!0;e.position<e.text.length;){var n,o=e.text.charAt(e.position);e.parseWS(o)||(n=o,/\\/.test(n)&&(e.position<this.text.length+1&&(e.position++,n=this.text.charAt(e.position),/ \t/.test(n)?e.spacing=!0:(e.add(n),i=!1)),1))||(i||e.spacing)&&(e.parseStartTag("bold","*")||e.parseStartTag("ital","_")||e.parseStartTag("mono","`"))||e.parseEndTag("bold","*","afterBold")||e.parseEndTag("ital","_","afterItal")||e.parseEndTag("mono","`","afterMono")||(e.add(o),i=!1),e.position++}return e.emitBlock(),e.blocks}},{key:"splitBlocks",value:function(t,e){var i=this.decodeMarkupSystem(e);return"none"===i?[{text:t,mod:"normal"}]:"markdown"===i?this.splitMarkdownBlocks(t):"html"===i?this.splitHtmlBlocks(t):void 0}},{key:"overMaxWidth",value:function(t){var e=this.ctx.measureText(t).width;return this.lines.curWidth()+e>this.parent.fontOptions.maxWdt}},{key:"getLongestFit",value:function(t){for(var e="",i=0;i<t.length;){var n=""===e?"":" ",o=e+n+t[i];if(this.overMaxWidth(o))break;e=o,i++}return i}},{key:"getLongestFitWord",value:function(t){for(var e=0;e<t.length&&!this.overMaxWidth(so(t).call(t,0,e));)e++;return e}},{key:"splitStringIntoLines",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.parent.getFormattingValues(this.ctx,this.selected,this.hover,e);for(var n=(t=(t=t.replace(/^( +)/g,"$1\r")).replace(/([^\r][^ ]*)( +)/g,"$1\r$2\r")).split("\r");n.length>0;){var o=this.getLongestFit(n);if(0===o){var r=n[0],s=this.getLongestFitWord(r);this.lines.newLine(so(r).call(r,0,s),e),n[0]=so(r).call(r,s)}else{var a=o;" "===n[o-1]?o--:" "===n[a]&&a++;var l=so(n).call(n,0,o).join("");o==n.length&&i?this.lines.append(l,e):this.lines.newLine(l,e),n=so(n).call(n,a)}}}}]),t}(),pd=["bold","ital","boldital","mono"],pu=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n4(this,t),this.body=e,this.pointToSelf=!1,this.baseSize=void 0,this.fontOptions={},this.setOptions(i),this.size={top:0,left:0,width:0,height:0,yLine:0},this.isEdgeLabel=n}return rH(t,[{key:"setOptions",value:function(t){if(this.elementOptions=t,this.initFontOptions(t.font),pr(t.label)?this.labelDirty=!0:t.label=void 0,void 0!==t.font&&null!==t.font){if("string"==typeof t.font)this.baseSize=this.fontOptions.size;else if("object"===rN(t.font)){var e=t.font.size;void 0!==e&&(this.baseSize=e)}}}},{key:"initFontOptions",value:function(e){var i=this;if(hx(pd,function(t){i.fontOptions[t]={}}),t.parseFontString(this.fontOptions,e)){this.fontOptions.vadjust=0;return}hx(e,function(t,e){null!=t&&"object"!==rN(t)&&(i.fontOptions[e]=t)})}},{key:"constrain",value:function(t){var e={constrainWidth:!1,maxWdt:-1,minWdt:-1,constrainHeight:!1,minHgt:-1,valign:"middle"},i=hN(t,"widthConstraint");if("number"==typeof i)e.maxWdt=Number(i),e.minWdt=Number(i);else if("object"===rN(i)){var n=hN(t,["widthConstraint","maximum"]);"number"==typeof n&&(e.maxWdt=Number(n));var o=hN(t,["widthConstraint","minimum"]);"number"==typeof o&&(e.minWdt=Number(o))}var r=hN(t,"heightConstraint");if("number"==typeof r)e.minHgt=Number(r);else if("object"===rN(r)){var s=hN(t,["heightConstraint","minimum"]);"number"==typeof s&&(e.minHgt=Number(s));var a=hN(t,["heightConstraint","valign"]);"string"==typeof a&&("top"===a||"bottom"===a)&&(e.valign=a)}return e}},{key:"update",value:function(t,e){this.setOptions(t,!0),this.propagateFonts(e),hm(this.fontOptions,this.constrain(e)),this.fontOptions.chooser=pn("label",e)}},{key:"adjustSizes",value:function(t){var e=t?t.right+t.left:0;this.fontOptions.constrainWidth&&(this.fontOptions.maxWdt-=e,this.fontOptions.minWdt-=e);var i=t?t.top+t.bottom:0;this.fontOptions.constrainHeight&&(this.fontOptions.minHgt-=i)}},{key:"addFontOptionsToPile",value:function(t,e){for(var i=0;i<e.length;++i)this.addFontToPile(t,e[i])}},{key:"addFontToPile",value:function(t,e){if(void 0!==e&&void 0!==e.font&&null!==e.font){var i=e.font;t.push(i)}}},{key:"getBasicOptions",value:function(e){for(var i={},n=0;n<e.length;++n){var o=e[n],r={};t.parseFontString(r,o)&&(o=r),hx(o,function(t,e){void 0!==t&&(Object.prototype.hasOwnProperty.call(i,e)||(-1!==ab(pd).call(pd,e)?i[e]={}:i[e]=t))})}return i}},{key:"getFontOption",value:function(e,i,n){for(var o,r=0;r<e.length;++r){var s=e[r];if(Object.prototype.hasOwnProperty.call(s,i)){if(null==(o=s[i]))continue;var a={};if(t.parseFontString(a,o)&&(o=a),Object.prototype.hasOwnProperty.call(o,n))return o[n]}}if(Object.prototype.hasOwnProperty.call(this.fontOptions,n))return this.fontOptions[n];throw Error("Did not find value for multi-font for property: '"+n+"'")}},{key:"getFontOptions",value:function(t,e){for(var i={},n=["color","size","face","mod","vadjust"],o=0;o<n.length;++o){var r=n[o];i[r]=this.getFontOption(t,e,r)}return i}},{key:"propagateFonts",value:function(t){var e=this,i=[];this.addFontOptionsToPile(i,t),this.fontOptions=this.getBasicOptions(i);for(var n=0;n<pd.length;++n)!function(){var t=pd[n],o=e.fontOptions[t];hx(e.getFontOptions(i,t),function(t,e){o[e]=t}),o.size=Number(o.size),o.vadjust=Number(o.vadjust)}()}},{key:"draw",value:function(t,e,i,n,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"middle";if(void 0!==this.elementOptions.label){var s=this.fontOptions.size*this.body.view.scale;this.elementOptions.label&&s<this.elementOptions.scaling.label.drawThreshold-1||(s>=this.elementOptions.scaling.label.maxVisible&&(s=Number(this.elementOptions.scaling.label.maxVisible)/this.body.view.scale),this.calculateLabelSize(t,n,o,e,i,r),this._drawBackground(t),this._drawText(t,e,this.size.yLine,r,s))}}},{key:"_drawBackground",value:function(t){if(void 0!==this.fontOptions.background&&"none"!==this.fontOptions.background){t.fillStyle=this.fontOptions.background;var e=this.getSize();t.fillRect(e.left,e.top,e.width,e.height)}}},{key:"_drawText",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle",o=arguments.length>4?arguments[4]:void 0,r=r9(this._setAlignment(t,e,i,n),2);e=r[0],i=r[1],t.textAlign="left",e-=this.size.width/2,this.fontOptions.valign&&this.size.height>this.size.labelHeight&&("top"===this.fontOptions.valign&&(i-=(this.size.height-this.size.labelHeight)/2),"bottom"===this.fontOptions.valign&&(i+=(this.size.height-this.size.labelHeight)/2));for(var s=0;s<this.lineCount;s++){var a=this.lines[s];if(a&&a.blocks){var l=0;this.isEdgeLabel||"center"===this.fontOptions.align?l+=(this.size.width-a.width)/2:"right"===this.fontOptions.align&&(l+=this.size.width-a.width);for(var h=0;h<a.blocks.length;h++){var c=a.blocks[h];t.font=c.font;var d=r9(this._getColor(c.color,o,c.strokeColor),2),u=d[0],f=d[1];c.strokeWidth>0&&(t.lineWidth=c.strokeWidth,t.strokeStyle=f,t.lineJoin="round"),t.fillStyle=u,c.strokeWidth>0&&t.strokeText(c.text,e+l,i+c.vadjust),t.fillText(c.text,e+l,i+c.vadjust),l+=c.width}i+=a.height}}}},{key:"_setAlignment",value:function(t,e,i,n){return this.isEdgeLabel&&"horizontal"!==this.fontOptions.align&&!1===this.pointToSelf?(e=0,i=0,"top"===this.fontOptions.align?(t.textBaseline="alphabetic",i-=4):"bottom"===this.fontOptions.align?(t.textBaseline="hanging",i+=4):t.textBaseline="middle"):t.textBaseline=n,[e,i]}},{key:"_getColor",value:function(t,e,i){var n=t||"#000000",o=i||"#ffffff";if(e<=this.elementOptions.scaling.label.drawThreshold){var r=Math.max(0,Math.min(1,1-(this.elementOptions.scaling.label.drawThreshold-e)));n=hO(n,r),o=hO(o,r)}return[n,o]}},{key:"getTextSize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._processLabel(t,e,i),{width:this.size.width,height:this.size.height,lineCount:this.lineCount}}},{key:"getSize",value:function(){var t=this.size.left,e=this.size.top-1;if(this.isEdgeLabel){var i=-(.5*this.size.width);switch(this.fontOptions.align){case"middle":t=i,e=-(.5*this.size.height);break;case"top":t=i,e=-(this.size.height+2);break;case"bottom":t=i,e=2}}return{left:t,top:e,width:this.size.width,height:this.size.height}}},{key:"calculateLabelSize",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"middle";this._processLabel(t,e,i),this.size.left=n-.5*this.size.width,this.size.top=o-.5*this.size.height,this.size.yLine=o+(1-this.lineCount)*.5*this.fontOptions.size,"hanging"===r&&(this.size.top+=.5*this.fontOptions.size,this.size.top+=4,this.size.yLine+=4)}},{key:"getFormattingValues",value:function(t,e,i,n){var o=function(t,e,i){return"normal"===e?"mod"===i?"":t[i]:void 0!==t[e][i]?t[e][i]:t[i]},r={color:o(this.fontOptions,n,"color"),size:o(this.fontOptions,n,"size"),face:o(this.fontOptions,n,"face"),mod:o(this.fontOptions,n,"mod"),vadjust:o(this.fontOptions,n,"vadjust"),strokeWidth:this.fontOptions.strokeWidth,strokeColor:this.fontOptions.strokeColor};(e||i)&&("normal"===n&&!0===this.fontOptions.chooser&&this.elementOptions.labelHighlightBold?r.mod="bold":"function"==typeof this.fontOptions.chooser&&this.fontOptions.chooser(r,this.elementOptions.id,e,i));var s="";return void 0!==r.mod&&""!==r.mod&&(s+=r.mod+" "),s+=r.size+"px "+r.face,t.font=s.replace(/"/g,""),r.font=t.font,r.height=r.size,r}},{key:"differentState",value:function(t,e){return t!==this.selectedState||e!==this.hoverState}},{key:"_processLabelText",value:function(t,e,i,n){return new pc(t,this,e,i).process(n)}},{key:"_processLabel",value:function(t,e,i){if(!1!==this.labelDirty||this.differentState(e,i)){var n=this._processLabelText(t,e,i,this.elementOptions.label);this.fontOptions.minWdt>0&&n.width<this.fontOptions.minWdt&&(n.width=this.fontOptions.minWdt),this.size.labelHeight=n.height,this.fontOptions.minHgt>0&&n.height<this.fontOptions.minHgt&&(n.height=this.fontOptions.minHgt),this.lines=n.lines,this.lineCount=n.lines.length,this.size.width=n.width,this.size.height=n.height,this.selectedState=e,this.hoverState=i,this.labelDirty=!1}}},{key:"visible",value:function(){return 0!==this.size.width&&0!==this.size.height&&void 0!==this.elementOptions.label&&!(this.fontOptions.size*this.body.view.scale<this.elementOptions.scaling.label.drawThreshold-1)}}],[{key:"parseFontString",value:function(t,e){if(!e||"string"!=typeof e)return!1;var i=e.split(" ");return t.size=+i[0].replace("px",""),t.face=i[1],t.color=i[2],!0}}]),t}(),pf=function(){function t(e,i,n){n4(this,t),this.body=i,this.labelModule=n,this.setOptions(e),this.top=void 0,this.left=void 0,this.height=void 0,this.width=void 0,this.radius=void 0,this.margin=void 0,this.refreshNeeded=!0,this.boundingBox={top:0,left:0,right:0,bottom:0}}return rH(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"_setMargins",value:function(t){this.margin={},this.options.margin&&("object"==rN(this.options.margin)?(this.margin.top=this.options.margin.top,this.margin.right=this.options.margin.right,this.margin.bottom=this.options.margin.bottom,this.margin.left=this.options.margin.left):(this.margin.top=this.options.margin,this.margin.right=this.options.margin,this.margin.bottom=this.options.margin,this.margin.left=this.options.margin)),t.adjustSizes(this.margin)}},{key:"_distanceToBorder",value:function(t,e){var i=this.options.borderWidth;return t&&this.resize(t),Math.min(Math.abs(this.width/2/Math.cos(e)),Math.abs(this.height/2/Math.sin(e)))+i}},{key:"enableShadow",value:function(t,e){e.shadow&&(t.shadowColor=e.shadowColor,t.shadowBlur=e.shadowSize,t.shadowOffsetX=e.shadowX,t.shadowOffsetY=e.shadowY)}},{key:"disableShadow",value:function(t,e){e.shadow&&(t.shadowColor="rgba(0,0,0,0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0)}},{key:"enableBorderDashes",value:function(t,e){if(!1!==e.borderDashes){if(void 0!==t.setLineDash){var i=e.borderDashes;!0===i&&(i=[5,15]),t.setLineDash(i)}else console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used."),this.options.shapeProperties.borderDashes=!1,e.borderDashes=!1}}},{key:"disableBorderDashes",value:function(t,e){!1!==e.borderDashes&&(void 0!==t.setLineDash?t.setLineDash([0]):(console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used."),this.options.shapeProperties.borderDashes=!1,e.borderDashes=!1))}},{key:"needsRefresh",value:function(t,e){return!0===this.refreshNeeded?(this.refreshNeeded=!1,!0):void 0===this.width||this.labelModule.differentState(t,e)}},{key:"initContextForDraw",value:function(t,e){var i=e.borderWidth/this.body.view.scale;t.lineWidth=Math.min(this.width,i),t.strokeStyle=e.borderColor,t.fillStyle=e.color}},{key:"performStroke",value:function(t,e){var i=e.borderWidth/this.body.view.scale;t.save(),i>0&&(this.enableBorderDashes(t,e),t.stroke(),this.disableBorderDashes(t,e)),t.restore()}},{key:"performFill",value:function(t,e){t.save(),t.fillStyle=e.color,this.enableShadow(t,e),aN(t).call(t),this.disableShadow(t,e),t.restore(),this.performStroke(t,e)}},{key:"_addBoundingBoxMargin",value:function(t){this.boundingBox.left-=t,this.boundingBox.top-=t,this.boundingBox.bottom+=t,this.boundingBox.right+=t}},{key:"_updateBoundingBox",value:function(t,e,i,n,o){void 0!==i&&this.resize(i,n,o),this.left=t-this.width/2,this.top=e-this.height/2,this.boundingBox.left=this.left,this.boundingBox.top=this.top,this.boundingBox.bottom=this.top+this.height,this.boundingBox.right=this.left+this.width}},{key:"updateBoundingBox",value:function(t,e,i,n,o){this._updateBoundingBox(t,e,i,n,o)}},{key:"getDimensionsFromLabel",value:function(t,e,i){this.textSize=this.labelModule.getTextSize(t,e,i);var n=this.textSize.width,o=this.textSize.height;return 0===n&&(n=14,o=14),{width:n,height:o}}}]),t}(),pp=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){var r;return n4(this,n),(r=i.call(this,t,e,o))._setMargins(o),r}return rH(n,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i);this.width=n.width+this.margin.right+this.margin.left,this.height=n.height+this.margin.top+this.margin.bottom,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this.initContextForDraw(t,r),ie(t,this.left,this.top,this.width,this.height,r.borderRadius),this.performFill(t,r),this.updateBoundingBox(e,i,t,n,o),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,o)}},{key:"updateBoundingBox",value:function(t,e,i,n,o){this._updateBoundingBox(t,e,i,n,o);var r=this.options.shapeProperties.borderRadius;this._addBoundingBoxMargin(r)}},{key:"distanceToBorder",value:function(t,e){t&&this.resize(t);var i=this.options.borderWidth;return Math.min(Math.abs(this.width/2/Math.cos(e)),Math.abs(this.height/2/Math.sin(e)))+i}}]),n}(pf),pg=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){var r;return n4(this,n),(r=i.call(this,t,e,o)).labelOffset=0,r.selected=!1,r}return rH(n,[{key:"setOptions",value:function(t,e,i){this.options=t,void 0===e&&void 0===i||this.setImages(e,i)}},{key:"setImages",value:function(t,e){e&&this.selected?(this.imageObj=e,this.imageObjAlt=t):(this.imageObj=t,this.imageObjAlt=e)}},{key:"switchImages",value:function(t){var e=t&&!this.selected||!t&&this.selected;if(this.selected=t,void 0!==this.imageObjAlt&&e){var i=this.imageObj;this.imageObj=this.imageObjAlt,this.imageObjAlt=i}}},{key:"_getImagePadding",value:function(){var t={top:0,right:0,bottom:0,left:0};if(this.options.imagePadding){var e=this.options.imagePadding;"object"==rN(e)?(t.top=e.top,t.right=e.right,t.bottom=e.bottom,t.left=e.left):(t.top=e,t.right=e,t.bottom=e,t.left=e)}return t}},{key:"_resizeImage",value:function(){var t,e;if(!1===this.options.shapeProperties.useImageSize){var i=1,n=1;this.imageObj.width&&this.imageObj.height&&(this.imageObj.width>this.imageObj.height?i=this.imageObj.width/this.imageObj.height:n=this.imageObj.height/this.imageObj.width),t=2*this.options.size*i,e=2*this.options.size*n}else{var o=this._getImagePadding();t=this.imageObj.width+o.left+o.right,e=this.imageObj.height+o.top+o.bottom}this.width=t,this.height=e,this.radius=.5*this.width}},{key:"_drawRawCircle",value:function(t,e,i,n){this.initContextForDraw(t,n),it(t,e,i,n.size),this.performFill(t,n)}},{key:"_drawImageAtPosition",value:function(t,e){if(0!=this.imageObj.width){t.globalAlpha=void 0!==e.opacity?e.opacity:1,this.enableShadow(t,e);var i=1;!0===this.options.shapeProperties.interpolation&&(i=this.imageObj.width/this.width/this.body.view.scale);var n=this._getImagePadding(),o=this.left+n.left,r=this.top+n.top,s=this.width-n.left-n.right,a=this.height-n.top-n.bottom;this.imageObj.drawImageAtPosition(t,i,o,r,s,a),this.disableShadow(t,e)}}},{key:"_drawImageLabel",value:function(t,e,i,n,o){var r=0;if(void 0!==this.height){r=.5*this.height;var s=this.labelModule.getTextSize(t,n,o);s.lineCount>=1&&(r+=s.height/2)}var a=i+r;this.options.label&&(this.labelOffset=r),this.labelModule.draw(t,e,a,n,o,"hanging")}}]),n}(pf),pm=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){var r;return n4(this,n),(r=i.call(this,t,e,o))._setMargins(o),r}return rH(n,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i),o=Math.max(n.width+this.margin.right+this.margin.left,n.height+this.margin.top+this.margin.bottom);this.options.size=o/2,this.width=o,this.height=o,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this._drawRawCircle(t,e,i,r),this.updateBoundingBox(e,i),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,i,n,o)}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size}},{key:"distanceToBorder",value:function(t){return t&&this.resize(t),.5*this.width}}]),n}(pg),pv=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o,r,s){var a;return n4(this,n),(a=i.call(this,t,e,o)).setImages(r,s),a}return rH(n,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(void 0===this.imageObj.src||void 0===this.imageObj.width||void 0===this.imageObj.height){var n=2*this.options.size;this.width=n,this.height=n,this.radius=.5*this.width;return}this.needsRefresh(e,i)&&this._resizeImage()}},{key:"draw",value:function(t,e,i,n,o,r){this.switchImages(n),this.resize();var s=e,a=i;"top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=e,this.top=i,s+=this.width/2,a+=this.height/2):(this.left=e-this.width/2,this.top=i-this.height/2),this._drawRawCircle(t,s,a,r),t.save(),t.clip(),this._drawImageAtPosition(t,r),t.restore(),this._drawImageLabel(t,s,a,n,o),this.updateBoundingBox(e,i)}},{key:"updateBoundingBox",value:function(t,e){"top-left"===this.options.shapeProperties.coordinateOrigin?(this.boundingBox.top=e,this.boundingBox.left=t,this.boundingBox.right=t+2*this.options.size,this.boundingBox.bottom=e+2*this.options.size):(this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size),this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset)}},{key:"distanceToBorder",value:function(t){return t&&this.resize(t),.5*this.width}}]),n}(pg),py=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{size:this.options.size};if(this.needsRefresh(e,i)){this.labelModule.getTextSize(t,e,i);var o,r,s=2*n.size;this.width=null!==(o=this.customSizeWidth)&&void 0!==o?o:s,this.height=null!==(r=this.customSizeHeight)&&void 0!==r?r:s,this.radius=.5*this.width}}},{key:"_drawShape",value:function(t,e,i,n,o,r,s,a){var l=this;return this.resize(t,r,s,a),this.left=n-this.width/2,this.top=o-this.height/2,this.initContextForDraw(t,a),(Object.prototype.hasOwnProperty.call(is,e)?is[e]:function(t){for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];CanvasRenderingContext2D.prototype[e].call(t,n)})(t,n,o,a.size),this.performFill(t,a),void 0!==this.options.icon&&void 0!==this.options.icon.code&&(t.font=(r?"bold ":"")+this.height/2+"px "+(this.options.icon.face||"FontAwesome"),t.fillStyle=this.options.icon.color||"black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.options.icon.code,n,o)),{drawExternalLabel:function(){if(void 0!==l.options.label){l.labelModule.calculateLabelSize(t,r,s,n,o,"hanging");var e=o+.5*l.height+.5*l.labelModule.size.height;l.labelModule.draw(t,n,e,r,s,"hanging")}l.updateBoundingBox(n,o)}}}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height))}}]),n}(pf);function pb(t,e){var i=sf(t);if(fS){var n=fS(t);e&&(n=s2(n).call(n,function(e){return fT(t,e).enumerable})),i.push.apply(i,n)}return i}var pw=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o,r){var s;return n4(this,n),(s=i.call(this,t,e,o,r)).ctxRenderer=r,s}return rH(n,[{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o,r),this.left=e-this.width/2,this.top=i-this.height/2,t.save();var s=this.ctxRenderer({ctx:t,id:this.options.id,x:e,y:i,state:{selected:n,hover:o},style:function(t){for(var e=1;e<arguments.length;e++){var i,n,o=null!=arguments[e]?arguments[e]:{};e%2?sS(i=pb(Object(o),!0)).call(i,function(e){c6(t,e,o[e])}):fA?fR(t,fA(o)):sS(n=pb(Object(o))).call(n,function(e){fm(t,e,fT(o,e))})}return t}({},r),label:this.options.label});if(null!=s.drawNode&&s.drawNode(),t.restore(),s.drawExternalLabel){var a=s.drawExternalLabel;s.drawExternalLabel=function(){t.save(),a(),t.restore()}}return s.nodeDimensions&&(this.customSizeWidth=s.nodeDimensions.width,this.customSizeHeight=s.nodeDimensions.height),s}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(py),px=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){var r;return n4(this,n),(r=i.call(this,t,e,o))._setMargins(o),r}return rH(n,[{key:"resize",value:function(t,e,i){if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i).width+this.margin.right+this.margin.left;this.width=n,this.height=n,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this.initContextForDraw(t,r),io(t,e-this.width/2,i-this.height/2,this.width,this.height),this.performFill(t,r),this.updateBoundingBox(e,i,t,n,o),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,o)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(pf),pk=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"diamond",4,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(py),pO=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"circle",2,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t){return t&&this.resize(t),this.options.size}}]),n}(py),pS=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i);this.height=2*n.height,this.width=n.width+n.height,this.radius=.5*this.width}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-.5*this.width,this.top=i-.5*this.height,this.initContextForDraw(t,r),ii(t,this.left,this.top,this.width,this.height),this.performFill(t,r),this.updateBoundingBox(e,i,t,n,o),this.labelModule.draw(t,e,i,n,o)}},{key:"distanceToBorder",value:function(t,e){t&&this.resize(t);var i=.5*this.width,n=.5*this.height,o=Math.sin(e)*i,r=Math.cos(e)*n;return i*n/Math.sqrt(o*o+r*r)}}]),n}(pf),p_=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){var r;return n4(this,n),(r=i.call(this,t,e,o))._setMargins(o),r}return rH(n,[{key:"resize",value:function(t,e,i){this.needsRefresh(e,i)&&(this.iconSize={width:Number(this.options.icon.size),height:Number(this.options.icon.size)},this.width=this.iconSize.width+this.margin.right+this.margin.left,this.height=this.iconSize.height+this.margin.top+this.margin.bottom,this.radius=.5*this.width)}},{key:"draw",value:function(t,e,i,n,o,r){var s=this;return this.resize(t,n,o),this.options.icon.size=this.options.icon.size||50,this.left=e-this.width/2,this.top=i-this.height/2,this._icon(t,e,i,n,o,r),{drawExternalLabel:function(){void 0!==s.options.label&&s.labelModule.draw(t,s.left+s.iconSize.width/2+s.margin.left,i+s.height/2+5,n),s.updateBoundingBox(e,i)}}}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-.5*this.options.icon.size,this.boundingBox.left=t-.5*this.options.icon.size,this.boundingBox.right=t+.5*this.options.icon.size,this.boundingBox.bottom=e+.5*this.options.icon.size,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height+5))}},{key:"_icon",value:function(t,e,i,n,o,r){var s=Number(this.options.icon.size);void 0!==this.options.icon.code?(t.font=[null!=this.options.icon.weight?this.options.icon.weight:n?"bold":"",(null!=this.options.icon.weight&&n?5:0)+s+"px",this.options.icon.face].join(" "),t.fillStyle=this.options.icon.color||"black",t.textAlign="center",t.textBaseline="middle",this.enableShadow(t,r),t.fillText(this.options.icon.code,e,i),this.disableShadow(t,r)):console.error("When using the icon shape, you need to define the code in the icon options object. This can be done per node or globally.")}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(pf),pC=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o,r,s){var a;return n4(this,n),(a=i.call(this,t,e,o)).setImages(r,s),a}return rH(n,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(void 0===this.imageObj.src||void 0===this.imageObj.width||void 0===this.imageObj.height){var n=2*this.options.size;this.width=n,this.height=n;return}this.needsRefresh(e,i)&&this._resizeImage()}},{key:"draw",value:function(t,e,i,n,o,r){t.save(),this.switchImages(n),this.resize();var s=e,a=i;if("top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=e,this.top=i,s+=this.width/2,a+=this.height/2):(this.left=e-this.width/2,this.top=i-this.height/2),!0===this.options.shapeProperties.useBorderWithImage){var l=this.options.borderWidth,h=this.options.borderWidthSelected||2*this.options.borderWidth,c=(n?h:l)/this.body.view.scale;t.lineWidth=Math.min(this.width,c),t.beginPath();var d=n?this.options.color.highlight.border:o?this.options.color.hover.border:this.options.color.border,u=n?this.options.color.highlight.background:o?this.options.color.hover.background:this.options.color.background;void 0!==r.opacity&&(d=hO(d,r.opacity),u=hO(u,r.opacity)),t.strokeStyle=d,t.fillStyle=u,t.rect(this.left-.5*t.lineWidth,this.top-.5*t.lineWidth,this.width+t.lineWidth,this.height+t.lineWidth),aN(t).call(t),this.performStroke(t,r),t.closePath()}this._drawImageAtPosition(t,r),this._drawImageLabel(t,s,a,n,o),this.updateBoundingBox(e,i),t.restore()}},{key:"updateBoundingBox",value:function(t,e){this.resize(),"top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=t,this.top=e):(this.left=t-this.width/2,this.top=e-this.height/2),this.boundingBox.left=this.left,this.boundingBox.top=this.top,this.boundingBox.bottom=this.top+this.height,this.boundingBox.right=this.left+this.width,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset))}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(pg),pE=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"square",2,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(py),pM=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"hexagon",4,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(py),pP=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"star",4,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(py),pT=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){var r;return n4(this,n),(r=i.call(this,t,e,o))._setMargins(o),r}return rH(n,[{key:"resize",value:function(t,e,i){this.needsRefresh(e,i)&&(this.textSize=this.labelModule.getTextSize(t,e,i),this.width=this.textSize.width+this.margin.right+this.margin.left,this.height=this.textSize.height+this.margin.top+this.margin.bottom,this.radius=.5*this.width)}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this.enableShadow(t,r),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,o),this.disableShadow(t,r),this.updateBoundingBox(e,i,t,n,o)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(pf),pA=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"triangle",3,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(py),pD=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"triangleDown",3,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),n}(py);function pI(t,e){var i=sf(t);if(fS){var n=fS(t);e&&(n=s2(n).call(n,function(e){return fT(t,e).enumerable})),i.push.apply(i,n)}return i}function pB(t){for(var e=1;e<arguments.length;e++){var i,n,o=null!=arguments[e]?arguments[e]:{};e%2?sS(i=pI(Object(o),!0)).call(i,function(e){c6(t,e,o[e])}):fA?fR(t,fA(o)):sS(n=pI(Object(o))).call(n,function(e){fm(t,e,fT(o,e))})}return t}var pz=function(){function t(e,i,n,o,r,s){n4(this,t),this.options=hB(r),this.globalOptions=r,this.defaultOptions=s,this.body=i,this.edges=[],this.id=void 0,this.imagelist=n,this.grouplist=o,this.x=void 0,this.y=void 0,this.baseSize=this.options.size,this.baseFontSize=this.options.font.size,this.predefinedPosition=!1,this.selected=!1,this.hover=!1,this.labelModule=new pu(this.body,this.options,!1),this.setOptions(e)}return rH(t,[{key:"attachEdge",value:function(t){var e;-1===ab(e=this.edges).call(e,t)&&this.edges.push(t)}},{key:"detachEdge",value:function(t){var e,i,n=ab(e=this.edges).call(e,t);-1!=n&&sL(i=this.edges).call(i,n,1)}},{key:"setOptions",value:function(e){var i=this.options.shape;if(e){if(void 0!==e.color&&(this._localColor=e.color),void 0!==e.id&&(this.id=e.id),void 0===this.id)throw Error("Node must have an id");t.checkMass(e,this.id),void 0!==e.x&&(null===e.x?(this.x=void 0,this.predefinedPosition=!1):(this.x=af(e.x),this.predefinedPosition=!0)),void 0!==e.y&&(null===e.y?(this.y=void 0,this.predefinedPosition=!1):(this.y=af(e.y),this.predefinedPosition=!0)),void 0!==e.size&&(this.baseSize=e.size),void 0!==e.value&&(e.value=f7(e.value)),t.parseOptions(this.options,e,!0,this.globalOptions,this.grouplist);var n=[e,this.options,this.defaultOptions];return this.chooser=pn("node",n),this._load_images(),this.updateLabelModule(e),void 0!==e.opacity&&t.checkOpacity(e.opacity)&&(this.options.opacity=e.opacity),this.updateShape(i),void 0!==e.hidden||void 0!==e.physics}}},{key:"_load_images",value:function(){if(("circularImage"===this.options.shape||"image"===this.options.shape)&&void 0===this.options.image)throw Error("Option image must be defined for node type '"+this.options.shape+"'");if(void 0!==this.options.image){if(void 0===this.imagelist)throw Error("Internal Error: No images provided");if("string"==typeof this.options.image)this.imageObj=this.imagelist.load(this.options.image,this.options.brokenImage,this.id);else{if(void 0===this.options.image.unselected)throw Error("No unselected image provided");this.imageObj=this.imagelist.load(this.options.image.unselected,this.options.brokenImage,this.id),void 0!==this.options.image.selected?this.imageObjAlt=this.imagelist.load(this.options.image.selected,this.options.brokenImage,this.id):this.imageObjAlt=void 0}}}},{key:"getFormattingValues",value:function(){var t={color:this.options.color.background,opacity:this.options.opacity,borderWidth:this.options.borderWidth,borderColor:this.options.color.border,size:this.options.size,borderDashes:this.options.shapeProperties.borderDashes,borderRadius:this.options.shapeProperties.borderRadius,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y};if(this.selected||this.hover?!0===this.chooser?this.selected?(null!=this.options.borderWidthSelected?t.borderWidth=this.options.borderWidthSelected:t.borderWidth*=2,t.color=this.options.color.highlight.background,t.borderColor=this.options.color.highlight.border,t.shadow=this.options.shadow.enabled):this.hover&&(t.color=this.options.color.hover.background,t.borderColor=this.options.color.hover.border,t.shadow=this.options.shadow.enabled):"function"==typeof this.chooser&&(this.chooser(t,this.options.id,this.selected,this.hover),!1===t.shadow&&(t.shadowColor!==this.options.shadow.color||t.shadowSize!==this.options.shadow.size||t.shadowX!==this.options.shadow.x||t.shadowY!==this.options.shadow.y)&&(t.shadow=!0)):t.shadow=this.options.shadow.enabled,void 0!==this.options.opacity){var e=this.options.opacity;t.borderColor=hO(t.borderColor,e),t.color=hO(t.color,e),t.shadowColor=hO(t.shadowColor,e)}return t}},{key:"updateLabelModule",value:function(e){(void 0===this.options.label||null===this.options.label)&&(this.options.label=""),t.updateGroupOptions(this.options,pB(pB({},e),{},{color:e&&e.color||this._localColor||void 0}),this.grouplist);var i=this.grouplist.get(this.options.group,!1),n=[e,this.options,i,this.globalOptions,this.defaultOptions];this.labelModule.update(this.options,n),void 0!==this.labelModule.baseSize&&(this.baseFontSize=this.labelModule.baseSize)}},{key:"updateShape",value:function(t){if(t===this.options.shape&&this.shape)this.shape.setOptions(this.options,this.imageObj,this.imageObjAlt);else switch(this.options.shape){case"box":this.shape=new pp(this.options,this.body,this.labelModule);break;case"circle":this.shape=new pm(this.options,this.body,this.labelModule);break;case"circularImage":this.shape=new pv(this.options,this.body,this.labelModule,this.imageObj,this.imageObjAlt);break;case"custom":this.shape=new pw(this.options,this.body,this.labelModule,this.options.ctxRenderer);break;case"database":this.shape=new px(this.options,this.body,this.labelModule);break;case"diamond":this.shape=new pk(this.options,this.body,this.labelModule);break;case"dot":this.shape=new pO(this.options,this.body,this.labelModule);break;case"ellipse":default:this.shape=new pS(this.options,this.body,this.labelModule);break;case"icon":this.shape=new p_(this.options,this.body,this.labelModule);break;case"image":this.shape=new pC(this.options,this.body,this.labelModule,this.imageObj,this.imageObjAlt);break;case"square":this.shape=new pE(this.options,this.body,this.labelModule);break;case"hexagon":this.shape=new pM(this.options,this.body,this.labelModule);break;case"star":this.shape=new pP(this.options,this.body,this.labelModule);break;case"text":this.shape=new pT(this.options,this.body,this.labelModule);break;case"triangle":this.shape=new pA(this.options,this.body,this.labelModule);break;case"triangleDown":this.shape=new pD(this.options,this.body,this.labelModule)}this.needsRefresh()}},{key:"select",value:function(){this.selected=!0,this.needsRefresh()}},{key:"unselect",value:function(){this.selected=!1,this.needsRefresh()}},{key:"needsRefresh",value:function(){this.shape.refreshNeeded=!0}},{key:"getTitle",value:function(){return this.options.title}},{key:"distanceToBorder",value:function(t,e){return this.shape.distanceToBorder(t,e)}},{key:"isFixed",value:function(){return this.options.fixed.x&&this.options.fixed.y}},{key:"isSelected",value:function(){return this.selected}},{key:"getValue",value:function(){return this.options.value}},{key:"getLabelSize",value:function(){return this.labelModule.size()}},{key:"setValueRange",value:function(t,e,i){if(void 0!==this.options.value){var n=this.options.scaling.customScalingFunction(t,e,i,this.options.value),o=this.options.scaling.max-this.options.scaling.min;if(!0===this.options.scaling.label.enabled){var r=this.options.scaling.label.max-this.options.scaling.label.min;this.options.font.size=this.options.scaling.label.min+n*r}this.options.size=this.options.scaling.min+n*o}else this.options.size=this.baseSize,this.options.font.size=this.baseFontSize;this.updateLabelModule()}},{key:"draw",value:function(t){var e=this.getFormattingValues();return this.shape.draw(t,this.x,this.y,this.selected,this.hover,e)||{}}},{key:"updateBoundingBox",value:function(t){this.shape.updateBoundingBox(this.x,this.y,t)}},{key:"resize",value:function(t){var e=this.getFormattingValues();this.shape.resize(t,this.selected,this.hover,e)}},{key:"getItemsOnPoint",value:function(t){var e=[];return this.labelModule.visible()&&po(this.labelModule.getSize(),t)&&e.push({nodeId:this.id,labelId:0}),po(this.shape.boundingBox,t)&&e.push({nodeId:this.id}),e}},{key:"isOverlappingWith",value:function(t){return this.shape.left<t.right&&this.shape.left+this.shape.width>t.left&&this.shape.top<t.bottom&&this.shape.top+this.shape.height>t.top}},{key:"isBoundingBoxOverlappingWith",value:function(t){return this.shape.boundingBox.left<t.right&&this.shape.boundingBox.right>t.left&&this.shape.boundingBox.top<t.bottom&&this.shape.boundingBox.bottom>t.top}}],[{key:"checkOpacity",value:function(t){return 0<=t&&t<=1}},{key:"checkCoordinateOrigin",value:function(t){return void 0===t||"center"===t||"top-left"===t}},{key:"updateGroupOptions",value:function(e,i,n){if(void 0!==n){var o,r=e.group;if(void 0!==i&&void 0!==i.group&&r!==i.group)throw Error("updateGroupOptions: group values in options don't match.");if(!("number"!=typeof r&&("string"!=typeof r||""==r))){var s=n.get(r);void 0===s.opacity||void 0!==i.opacity||t.checkOpacity(s.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+s.opacity),s.opacity=void 0);var a=s2(o=pi(i)).call(o,function(t){return null!=i[t]});a.push("font"),hg(a,e,s),e.color=h_(e.color)}}}},{key:"parseOptions",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0;if(hg(["color","fixed","shadow"],e,i,n),t.checkMass(i),void 0===e.opacity||t.checkOpacity(e.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+e.opacity),e.opacity=void 0),void 0===i.opacity||t.checkOpacity(i.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+i.opacity),i.opacity=void 0),i.shapeProperties&&!t.checkCoordinateOrigin(i.shapeProperties.coordinateOrigin)&&console.error("Invalid option for node coordinateOrigin, found: "+i.shapeProperties.coordinateOrigin),hz(e,i,"shadow",o),void 0!==i.color&&null!==i.color){var s=h_(i.color);hf(e.color,s)}else!0===n&&null===i.color&&(e.color=hB(o.color));void 0!==i.fixed&&null!==i.fixed&&("boolean"==typeof i.fixed?(e.fixed.x=i.fixed,e.fixed.y=i.fixed):(void 0!==i.fixed.x&&"boolean"==typeof i.fixed.x&&(e.fixed.x=i.fixed.x),void 0!==i.fixed.y&&"boolean"==typeof i.fixed.y&&(e.fixed.y=i.fixed.y))),!0===n&&null===i.font&&(e.font=hB(o.font)),t.updateGroupOptions(e,i,r),void 0!==i.scaling&&hz(e.scaling,i.scaling,"label",o.scaling)}},{key:"checkMass",value:function(t,e){if(void 0!==t.mass&&t.mass<=0){var i="";void 0!==e&&(i=" in node id: "+e),console.error("%cNegative or zero mass disallowed"+i+", setting mass to 1.",hQ),t.mass=1}}}]),t}();function pR(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}var pN=function(){function t(e,i,n,o){var r,s=this;if(n4(this,t),this.body=e,this.images=i,this.groups=n,this.layoutEngine=o,this.body.functions.createNode=e7(r=this.create).call(r,this),this.nodesListeners={add:function(t,e){s.add(e.items)},update:function(t,e){s.update(e.items,e.data,e.oldData)},remove:function(t,e){s.remove(e.items)}},this.defaultOptions={borderWidth:1,borderWidthSelected:void 0,brokenImage:void 0,color:{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},opacity:void 0,fixed:{x:!1,y:!1},font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:0,strokeColor:"#ffffff",align:"center",vadjust:0,multi:!1,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"monospace",vadjust:2}},group:void 0,hidden:!1,icon:{face:"FontAwesome",code:void 0,size:50,color:"#2B7CE9"},image:void 0,imagePadding:{top:0,right:0,bottom:0,left:0},label:void 0,labelHighlightBold:!0,level:void 0,margin:{top:5,right:5,bottom:5,left:5},mass:1,physics:!0,scaling:{min:10,max:30,label:{enabled:!1,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function(t,e,i,n){return e===t?.5:Math.max(0,1/(e-t)*(n-t))}},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},shape:"ellipse",shapeProperties:{borderDashes:!1,borderRadius:6,interpolation:!0,useImageSize:!1,useBorderWithImage:!1,coordinateOrigin:"center"},size:25,title:void 0,value:void 0,x:void 0,y:void 0},this.defaultOptions.mass<=0)throw"Internal error: mass in defaultOptions of NodesHandler may not be zero or negative";this.options=hB(this.defaultOptions),this.bindEventListeners()}return rH(t,[{key:"bindEventListeners",value:function(){var t,e,i=this;this.body.emitter.on("refreshNodes",e7(t=this.refresh).call(t,this)),this.body.emitter.on("refresh",e7(e=this.refresh).call(e,this)),this.body.emitter.on("destroy",function(){hx(i.nodesListeners,function(t,e){i.body.data.nodes&&i.body.data.nodes.off(e,t)}),delete i.body.functions.createNode,delete i.nodesListeners.add,delete i.nodesListeners.update,delete i.nodesListeners.remove,delete i.nodesListeners})}},{key:"setOptions",value:function(t){if(void 0!==t){if(pz.parseOptions(this.options,t),void 0!==t.opacity&&(cQ(t.opacity)||!cq(t.opacity)||t.opacity<0||t.opacity>1?console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+t.opacity):this.options.opacity=t.opacity),void 0!==t.shape)for(var e in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,e)&&this.body.nodes[e].updateShape();if(void 0!==t.font||void 0!==t.widthConstraint||void 0!==t.heightConstraint)for(var i=0,n=sf(this.body.nodes);i<n.length;i++){var o=n[i];this.body.nodes[o].updateLabelModule(),this.body.nodes[o].needsRefresh()}if(void 0!==t.size)for(var r in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,r)&&this.body.nodes[r].needsRefresh();(void 0!==t.hidden||void 0!==t.physics)&&this.body.emitter.emit("_dataChanged")}}},{key:"setData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.body.data.nodes;if(f1("id",t))this.body.data.nodes=t;else if(sl(t))this.body.data.nodes=new fZ,this.body.data.nodes.add(t);else if(t)throw TypeError("Array or DataSet expected");else this.body.data.nodes=new fZ;if(i&&hx(this.nodesListeners,function(t,e){i.off(e,t)}),this.body.nodes={},this.body.data.nodes){var n=this;hx(this.nodesListeners,function(t,e){n.body.data.nodes.on(e,t)});var o=this.body.data.nodes.getIds();this.add(o,!0)}!1===e&&this.body.emitter.emit("_dataChanged")}},{key:"add",value:function(t){for(var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],o=0;o<t.length;o++){e=t[o];var r=this.body.data.nodes.get(e),s=this.create(r);n.push(s),this.body.nodes[e]=s}this.layoutEngine.positionInitially(n),!1===i&&this.body.emitter.emit("_dataChanged")}},{key:"update",value:function(t,e,i){for(var n=this.body.nodes,o=!1,r=0;r<t.length;r++){var s=t[r],a=n[s],l=e[r];void 0!==a?a.setOptions(l)&&(o=!0):(o=!0,a=this.create(l),n[s]=a)}o||void 0===i||(o=cX(e).call(e,function(t,e){var n=i[e];return n&&n.level!==t.level})),!0===o?this.body.emitter.emit("_dataChanged"):this.body.emitter.emit("_dataUpdated")}},{key:"remove",value:function(t){for(var e=this.body.nodes,i=0;i<t.length;i++){var n=t[i];delete e[n]}this.body.emitter.emit("_dataChanged")}},{key:"create",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pz;return new e(t,this.body,this.images,this.groups,this.options,this.defaultOptions)}},{key:"refresh",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];hx(this.body.nodes,function(i,n){var o=t.body.data.nodes.get(n);void 0!==o&&(!0===e&&i.setOptions({x:null,y:null}),i.setOptions({fixed:!1}),i.setOptions(o))})}},{key:"getPositions",value:function(t){var e={};if(void 0!==t){if(!0===sl(t)){for(var i=0;i<t.length;i++)if(void 0!==this.body.nodes[t[i]]){var n=this.body.nodes[t[i]];e[t[i]]={x:Math.round(n.x),y:Math.round(n.y)}}}else if(void 0!==this.body.nodes[t]){var o=this.body.nodes[t];e[t]={x:Math.round(o.x),y:Math.round(o.y)}}}else for(var r=0;r<this.body.nodeIndices.length;r++){var s=this.body.nodes[this.body.nodeIndices[r]];e[this.body.nodeIndices[r]]={x:Math.round(s.x),y:Math.round(s.y)}}return e}},{key:"getPosition",value:function(t){if(void 0==t)throw TypeError("No id was specified for getPosition method.");if(void 0!=this.body.nodes[t])return{x:Math.round(this.body.nodes[t].x),y:Math.round(this.body.nodes[t].y)};throw ReferenceError("NodeId provided for getPosition does not exist. Provided: ".concat(t))}},{key:"storePositions",value:function(){var t,e=[],i=this.body.data.nodes.getDataSet(),n=function(t,e){var i=void 0!==st&&n3(t)||t["@@iterator"];if(!i){if(sl(t)||(i=function(t,e){if(t){if("string"==typeof t)return pR(t,void 0);var i,n=so(i=Object.prototype.toString.call(t)).call(i,8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return nG(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pR(t,void 0)}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(i.get());try{for(n.s();!(t=n.n()).done;){var o=t.value,r=o.id,s=this.body.nodes[r],a=Math.round(s.x),l=Math.round(s.y);(o.x!==a||o.y!==l)&&e.push({id:r,x:a,y:l})}}catch(t){n.e(t)}finally{n.f()}i.update(e)}},{key:"getBoundingBox",value:function(t){if(void 0!==this.body.nodes[t])return this.body.nodes[t].shape.boundingBox}},{key:"getConnectedNodes",value:function(t,e){var i=[];if(void 0!==this.body.nodes[t])for(var n=this.body.nodes[t],o={},r=0;r<n.edges.length;r++){var s=n.edges[r];"to"!==e&&s.toId==n.id?void 0===o[s.fromId]&&(i.push(s.fromId),o[s.fromId]=!0):"from"!==e&&s.fromId==n.id&&void 0===o[s.toId]&&(i.push(s.toId),o[s.toId]=!0)}return i}},{key:"getConnectedEdges",value:function(t){var e=[];if(void 0!==this.body.nodes[t])for(var i=this.body.nodes[t],n=0;n<i.edges.length;n++)e.push(i.edges[n].id);else console.error("NodeId provided for getConnectedEdges does not exist. Provided: ",t);return e}},{key:"moveNode",value:function(t,e,i){var n=this;void 0!==this.body.nodes[t]?(this.body.nodes[t].x=Number(e),this.body.nodes[t].y=Number(i),aB(function(){n.body.emitter.emit("startSimulation")},0)):console.error("Node id supplied to moveNode does not exist. Provided: ",t)}}]),t}();eM({target:"Reflect",stat:!0},{get:function t(e,i){var n,o,r=arguments.length<3?e:arguments[2];return ey(e)===r?e[i]:(n=to.f(e,i))?void 0!==n&&(tK(n,"value")||tK(n,"writable"))?n.value:void 0===n.get?void 0:ta(n.get,r):tx(o=i1(e))?t(o,i,r):void 0}});var pL=N(tk.Reflect.get),pF=N(fP);function pj(){return(pj="undefined"!=typeof Reflect&&pL?c1(pL).call(pL):function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c8(t)););return t}(t,e);if(n){var o=pF(n,e);return o.get?o.get.call(arguments.length<3?t:i):o.value}}).apply(this,arguments)}var pH=Math.hypot,pW=Math.abs,pV=Math.sqrt;eM({target:"Math",stat:!0,arity:2,forced:!!pH&&pH(1/0,NaN)!==1/0},{hypot:function(t,e){for(var i,n,o=0,r=0,s=arguments.length,a=0;r<s;)i=pW(arguments[r++]),a<i?(o=o*(n=a/i)*n+1,a=i):i>0?o+=(n=i/a)*n:o+=i;return a===1/0?1/0:a*pV(o)}});var pQ=N(tk.Math.hypot);function p$(t){var e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=c8(t);return i=e?fO(n,arguments,c8(this).constructor):n.apply(this,arguments),c3(this,i)}}var pq=function(){function t(){n4(this,t)}return rH(t,null,[{key:"transform",value:function(t,e){sl(t)||(t=[t]);for(var i=e.point.x,n=e.point.y,o=e.angle,r=e.length,s=0;s<t.length;++s){var a=t[s],l=a.x*Math.cos(o)-a.y*Math.sin(o),h=a.x*Math.sin(o)+a.y*Math.cos(o);a.x=i+r*l,a.y=n+r*h}}},{key:"drawPath",value:function(t,e){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;++i)t.lineTo(e[i].x,e[i].y);t.closePath()}}]),t}(),pU=function(t){c5(i,t);var e=p$(i);function i(){return n4(this,i),e.apply(this,arguments)}return rH(i,null,[{key:"draw",value:function(t,e){if(e.image){t.save(),t.translate(e.point.x,e.point.y),t.rotate(Math.PI/2+e.angle);var i=null!=e.imageWidth?e.imageWidth:e.image.width,n=null!=e.imageHeight?e.imageHeight:e.image.height;e.image.drawImageAtPosition(t,1,-i/2,0,i,n),t.restore()}return!1}}]),i}(pq),pY=function(t){c5(i,t);var e=p$(i);function i(){return n4(this,i),e.apply(this,arguments)}return rH(i,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:0},{x:-1,y:.3},{x:-.9,y:0},{x:-1,y:-.3}];return pq.transform(i,e),pq.drawPath(t,i),!0}}]),i}(pq),pG=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i=[{x:-1,y:0},{x:0,y:.3},{x:-.4,y:0},{x:0,y:-.3}];return pq.transform(i,e),pq.drawPath(t,i),!0}}]),t}(),pX=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i={x:-.4,y:0};pq.transform(i,e),t.strokeStyle=t.fillStyle,t.fillStyle="rgba(0, 0, 0, 0)";var n=Math.PI,o=e.angle-n/2,r=e.angle+n/2;return t.beginPath(),t.arc(i.x,i.y,.4*e.length,o,r,!1),t.stroke(),!0}}]),t}(),pK=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i={x:-.3,y:0};pq.transform(i,e),t.strokeStyle=t.fillStyle,t.fillStyle="rgba(0, 0, 0, 0)";var n=Math.PI,o=e.angle+n/2,r=e.angle+3*n/2;return t.beginPath(),t.arc(i.x,i.y,.4*e.length,o,r,!1),t.stroke(),!0}}]),t}(),pZ=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i=[{x:.02,y:0},{x:-1,y:.3},{x:-1,y:-.3}];return pq.transform(i,e),pq.drawPath(t,i),!0}}]),t}(),pJ=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.3},{x:0,y:-.3},{x:-1,y:0}];return pq.transform(i,e),pq.drawPath(t,i),!0}}]),t}(),p0=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i={x:-.4,y:0};return pq.transform(i,e),it(t,i.x,i.y,.4*e.length),!0}}]),t}(),p1=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.5},{x:0,y:-.5},{x:-.15,y:-.5},{x:-.15,y:.5}];return pq.transform(i,e),pq.drawPath(t,i),!0}}]),t}(),p2=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.3},{x:0,y:-.3},{x:-.6,y:-.3},{x:-.6,y:.3}];return pq.transform(i,e),pq.drawPath(t,i),!0}}]),t}(),p5=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:0},{x:-.5,y:-.3},{x:-1,y:0},{x:-.5,y:.3}];return pq.transform(i,e),pq.drawPath(t,i),!0}}]),t}(),p3=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i=[{x:-1,y:.3},{x:-.5,y:0},{x:-1,y:-.3},{x:0,y:0}];return pq.transform(i,e),pq.drawPath(t,i),!0}}]),t}(),p4=function(){function t(){n4(this,t)}return rH(t,null,[{key:"draw",value:function(t,e){var i;switch(e.type&&(i=e.type.toLowerCase()),i){case"image":return pU.draw(t,e);case"circle":return p0.draw(t,e);case"box":return p2.draw(t,e);case"crow":return pG.draw(t,e);case"curve":return pX.draw(t,e);case"diamond":return p5.draw(t,e);case"inv_curve":return pK.draw(t,e);case"triangle":return pZ.draw(t,e);case"inv_triangle":return pJ.draw(t,e);case"bar":return p1.draw(t,e);case"vee":return p3.draw(t,e);default:return pY.draw(t,e)}}}]),t}();function p8(t,e){var i=sf(t);if(fS){var n=fS(t);e&&(n=s2(n).call(n,function(e){return fT(t,e).enumerable})),i.push.apply(i,n)}return i}function p6(t){for(var e=1;e<arguments.length;e++){var i,n,o=null!=arguments[e]?arguments[e]:{};e%2?sS(i=p8(Object(o),!0)).call(i,function(e){c6(t,e,o[e])}):fA?fR(t,fA(o)):sS(n=p8(Object(o))).call(n,function(e){fm(t,e,fT(o,e))})}return t}var p9=function(){function t(e,i,n){n4(this,t),this._body=i,this._labelModule=n,this.color={},this.colorDirty=!0,this.hoverWidth=1.5,this.selectionWidth=2,this.setOptions(e),this.fromPoint=this.from,this.toPoint=this.to}return rH(t,[{key:"connect",value:function(){this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to]}},{key:"cleanup",value:function(){return!1}},{key:"setOptions",value:function(t){this.options=t,this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.id=this.options.id}},{key:"drawLine",value:function(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getViaNode();t.strokeStyle=this.getColor(t,e),t.lineWidth=e.width,!1!==e.dashes?this._drawDashedLine(t,e,o):this._drawLine(t,e,o)}},{key:"_drawLine",value:function(t,e,i,n,o){if(this.from!=this.to)this._line(t,e,i,n,o);else{var r=r9(this._getCircleData(t),3),s=r[0],a=r[1],l=r[2];this._circle(t,e,s,a,l)}}},{key:"_drawDashedLine",value:function(t,e,i,n,o){t.lineCap="round";var r=sl(e.dashes)?e.dashes:[5,5];if(void 0!==t.setLineDash){if(t.save(),t.setLineDash(r),t.lineDashOffset=0,this.from!=this.to)this._line(t,e,i);else{var s=r9(this._getCircleData(t),3),a=s[0],l=s[1],h=s[2];this._circle(t,e,a,l,h)}t.setLineDash([0]),t.lineDashOffset=0,t.restore()}else{if(this.from!=this.to)ir(t,this.from.x,this.from.y,this.to.x,this.to.y,r);else{var c=r9(this._getCircleData(t),3),d=c[0],u=c[1],f=c[2];this._circle(t,e,d,u,f)}this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}}},{key:"findBorderPosition",value:function(t,e,i){return this.from!=this.to?this._findBorderPosition(t,e,i):this._findBorderPositionCircle(t,e,i)}},{key:"findBorderPositions",value:function(t){if(this.from!=this.to)return{from:this._findBorderPosition(this.from,t),to:this._findBorderPosition(this.to,t)};var e,i=r9(so(e=this._getCircleData(t)).call(e,0,2),2),n=i[0],o=i[1];return{from:this._findBorderPositionCircle(this.from,t,{x:n,y:o,low:.25,high:.6,direction:-1}),to:this._findBorderPositionCircle(this.from,t,{x:n,y:o,low:.6,high:.8,direction:1})}}},{key:"_getCircleData",value:function(t){var e=this.options.selfReference.size;void 0!==t&&void 0===this.from.shape.width&&this.from.shape.resize(t);var i=ps(t,this.options.selfReference.angle,e,this.from);return[i.x,i.y,e]}},{key:"_pointOnCircle",value:function(t,e,i,n){var o=2*n*Math.PI;return{x:t+i*Math.cos(o),y:e-i*Math.sin(o)}}},{key:"_findBorderPositionCircle",value:function(t,e,i){var n,o=i.x,r=i.y,s=i.low,a=i.high,l=i.direction,h=this.options.selfReference.size,c=(s+a)*.5,d=0;!0===this.options.arrowStrikethrough&&(-1===l?d=this.options.endPointOffset.from:1===l&&(d=this.options.endPointOffset.to));var u=0;do{c=(s+a)*.5,n=this._pointOnCircle(o,r,h,c);var f=Math.atan2(t.y-n.y,t.x-n.x),p=t.distanceToBorder(e,f)+d-Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));if(.05>Math.abs(p))break;p>0?l>0?s=c:a=c:l>0?a=c:s=c,++u}while(s<=a&&u<10)return p6(p6({},n),{},{t:c})}},{key:"getLineWidth",value:function(t,e){return!0===t?Math.max(this.selectionWidth,.3/this._body.view.scale):!0===e?Math.max(this.hoverWidth,.3/this._body.view.scale):Math.max(this.options.width,.3/this._body.view.scale)}},{key:"getColor",value:function(t,e){if(!1===e.inheritsColor)return hO(e.color,e.opacity);if("both"===e.inheritsColor&&this.from.id!==this.to.id){var i=t.createLinearGradient(this.from.x,this.from.y,this.to.x,this.to.y),n=this.from.options.color.highlight.border,o=this.to.options.color.highlight.border;return!1===this.from.selected&&!1===this.to.selected?(n=hO(this.from.options.color.border,e.opacity),o=hO(this.to.options.color.border,e.opacity)):!0===this.from.selected&&!1===this.to.selected?o=this.to.options.color.border:!1===this.from.selected&&!0===this.to.selected&&(n=this.from.options.color.border),i.addColorStop(0,n),i.addColorStop(1,o),i}return"to"===e.inheritsColor?hO(this.to.options.color.border,e.opacity):hO(this.from.options.color.border,e.opacity)}},{key:"_circle",value:function(t,e,i,n,o){this.enableShadow(t,e);var r=0,s=2*Math.PI;if(!this.options.selfReference.renderBehindTheNode){var a=this.options.selfReference.angle,l=this.options.selfReference.angle+Math.PI,h=this._findBorderPositionCircle(this.from,t,{x:i,y:n,low:a,high:l,direction:-1}),c=this._findBorderPositionCircle(this.from,t,{x:i,y:n,low:a,high:l,direction:1});r=Math.atan2(h.y-n,h.x-i),s=Math.atan2(c.y-n,c.x-i)}t.beginPath(),t.arc(i,n,o,r,s,!1),t.stroke(),this.disableShadow(t,e)}},{key:"getDistanceToEdge",value:function(t,e,i,n,o,r){if(this.from!=this.to)return this._getDistanceToEdge(t,e,i,n,o,r);var s=r9(this._getCircleData(void 0),3),a=s[0],l=s[1],h=s[2],c=a-o,d=l-r;return Math.abs(Math.sqrt(c*c+d*d)-h)}},{key:"_getDistanceToLine",value:function(t,e,i,n,o,r){var s=i-t,a=n-e,l=((o-t)*s+(r-e)*a)/(s*s+a*a);l>1?l=1:l<0&&(l=0);var h=t+l*s-o,c=e+l*a-r;return Math.sqrt(h*h+c*c)}},{key:"getArrowData",value:function(t,e,i,n,o,r){var s,a,l,h,c,d,u,f=r.width;"from"===e?(l=this.from,h=this.to,c=r.fromArrowScale<0,d=Math.abs(r.fromArrowScale),u=r.fromArrowType):"to"===e?(l=this.to,h=this.from,c=r.toArrowScale<0,d=Math.abs(r.toArrowScale),u=r.toArrowType):(l=this.to,h=this.from,c=r.middleArrowScale<0,d=Math.abs(r.middleArrowScale),u=r.middleArrowType);var p=15*d+3*f;if(l!=h){var g=p/pQ(l.x-h.x,l.y-h.y);if("middle"!==e){if(!0===this.options.smooth.enabled){var m=this._findBorderPosition(l,t,{via:i}),v=this.getPoint(m.t+g*("from"===e?1:-1),i);s=Math.atan2(m.y-v.y,m.x-v.x),a=m}else s=Math.atan2(l.y-h.y,l.x-h.x),a=this._findBorderPosition(l,t)}else{var y=(c?-g:g)/2,b=this.getPoint(.5+y,i),w=this.getPoint(.5-y,i);s=Math.atan2(b.y-w.y,b.x-w.x),a=this.getPoint(.5,i)}}else{var x=r9(this._getCircleData(t),3),k=x[0],O=x[1],S=x[2];if("from"===e){var _=this.options.selfReference.angle,C=this.options.selfReference.angle+Math.PI,E=this._findBorderPositionCircle(this.from,t,{x:k,y:O,low:_,high:C,direction:-1});s=-2*E.t*Math.PI+1.5*Math.PI+.1*Math.PI,a=E}else if("to"===e){var M=this.options.selfReference.angle,P=this.options.selfReference.angle+Math.PI,T=this._findBorderPositionCircle(this.from,t,{x:k,y:O,low:M,high:P,direction:1});s=-2*T.t*Math.PI+1.5*Math.PI-1.1*Math.PI,a=T}else{var A=this.options.selfReference.angle/(2*Math.PI);a=this._pointOnCircle(k,O,S,A),s=-2*A*Math.PI+1.5*Math.PI+.1*Math.PI}}var D=a.x-.9*p*Math.cos(s),I=a.y-.9*p*Math.sin(s);return{point:a,core:{x:D,y:I},angle:s,length:p,type:u}}},{key:"drawArrowHead",value:function(t,e,i,n,o){t.strokeStyle=this.getColor(t,e),t.fillStyle=t.strokeStyle,t.lineWidth=e.width,p4.draw(t,o)&&(this.enableShadow(t,e),aN(t).call(t),this.disableShadow(t,e))}},{key:"enableShadow",value:function(t,e){!0===e.shadow&&(t.shadowColor=e.shadowColor,t.shadowBlur=e.shadowSize,t.shadowOffsetX=e.shadowX,t.shadowOffsetY=e.shadowY)}},{key:"disableShadow",value:function(t,e){!0===e.shadow&&(t.shadowColor="rgba(0,0,0,0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0)}},{key:"drawBackground",value:function(t,e){if(!1!==e.background){var i={strokeStyle:t.strokeStyle,lineWidth:t.lineWidth,dashes:t.dashes};t.strokeStyle=e.backgroundColor,t.lineWidth=e.backgroundSize,this.setStrokeDashed(t,e.backgroundDashes),t.stroke(),t.strokeStyle=i.strokeStyle,t.lineWidth=i.lineWidth,t.dashes=i.dashes,this.setStrokeDashed(t,e.dashes)}}},{key:"setStrokeDashed",value:function(t,e){if(!1!==e){if(void 0!==t.setLineDash){var i=sl(e)?e:[5,5];t.setLineDash(i)}else console.warn("setLineDash is not supported in this browser. The dashed stroke cannot be used.")}else void 0!==t.setLineDash?t.setLineDash([]):console.warn("setLineDash is not supported in this browser. The dashed stroke cannot be used.")}}]),t}();function p7(t,e){var i=sf(t);if(fS){var n=fS(t);e&&(n=s2(n).call(n,function(e){return fT(t,e).enumerable})),i.push.apply(i,n)}return i}function gt(t){for(var e=1;e<arguments.length;e++){var i,n,o=null!=arguments[e]?arguments[e]:{};e%2?sS(i=p7(Object(o),!0)).call(i,function(e){c6(t,e,o[e])}):fA?fR(t,fA(o)):sS(n=p7(Object(o))).call(n,function(e){fm(t,e,fT(o,e))})}return t}var ge=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"_findBorderPositionBezier",value:function(t,e){var i,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getViaCoordinates(),r=!1,s=1,a=0,l=this.to,h=this.options.endPointOffset?this.options.endPointOffset.to:0;t.id===this.from.id&&(l=this.from,r=!0,h=this.options.endPointOffset?this.options.endPointOffset.from:0),!1===this.options.arrowStrikethrough&&(h=0);var c=0;do{n=(a+s)*.5,i=this.getPoint(n,o);var d=Math.atan2(l.y-i.y,l.x-i.x),u=l.distanceToBorder(e,d)+h-Math.sqrt(Math.pow(i.x-l.x,2)+Math.pow(i.y-l.y,2));if(.2>Math.abs(u))break;u<0?!1===r?a=n:s=n:!1===r?s=n:a=n,++c}while(a<=s&&c<10)return gt(gt({},i),{},{t:n})}},{key:"_getDistanceToBezierEdge",value:function(t,e,i,n,o,r,s){var a,l,h,c,d,u=1e9,f=t,p=e;for(l=1;l<10;l++)c=Math.pow(1-(h=.1*l),2)*t+2*h*(1-h)*s.x+Math.pow(h,2)*i,d=Math.pow(1-h,2)*e+2*h*(1-h)*s.y+Math.pow(h,2)*n,l>0&&(u=(a=this._getDistanceToLine(f,p,c,d,o,r))<u?a:u),f=c,p=d;return u}},{key:"_bezierCurve",value:function(t,e,i,n){t.beginPath(),t.moveTo(this.fromPoint.x,this.fromPoint.y),null!=i&&null!=i.x?null!=n&&null!=n.x?t.bezierCurveTo(i.x,i.y,n.x,n.y,this.toPoint.x,this.toPoint.y):t.quadraticCurveTo(i.x,i.y,this.toPoint.x,this.toPoint.y):t.lineTo(this.toPoint.x,this.toPoint.y),this.drawBackground(t,e),this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}}]),n}(p9),gi=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){var r;return n4(this,n),(r=i.call(this,t,e,o)).via=r.via,r._boundFunction=function(){r.positionBezierNode()},r._body.emitter.on("_repositionBezierNodes",r._boundFunction),r}return rH(n,[{key:"setOptions",value:function(t){pj(c8(n.prototype),"setOptions",this).call(this,t);var e=!1;this.options.physics!==t.physics&&(e=!0),this.options=t,this.id=this.options.id,this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.setupSupportNode(),this.connect(),!0===e&&(this.via.setOptions({physics:this.options.physics}),this.positionBezierNode())}},{key:"connect",value:function(){this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],void 0===this.from||void 0===this.to||!1===this.options.physics?this.via.setOptions({physics:!1}):this.from.id===this.to.id?this.via.setOptions({physics:!1}):this.via.setOptions({physics:!0})}},{key:"cleanup",value:function(){return this._body.emitter.off("_repositionBezierNodes",this._boundFunction),void 0!==this.via&&(delete this._body.nodes[this.via.id],this.via=void 0,!0)}},{key:"setupSupportNode",value:function(){if(void 0===this.via){var t="edgeId:"+this.id,e=this._body.functions.createNode({id:t,shape:"circle",physics:!0,hidden:!0});this._body.nodes[t]=e,this.via=e,this.via.parentEdgeId=this.id,this.positionBezierNode()}}},{key:"positionBezierNode",value:function(){void 0!==this.via&&void 0!==this.from&&void 0!==this.to?(this.via.x=.5*(this.from.x+this.to.x),this.via.y=.5*(this.from.y+this.to.y)):void 0!==this.via&&(this.via.x=0,this.via.y=0)}},{key:"_line",value:function(t,e,i){this._bezierCurve(t,e,i)}},{key:"_getViaCoordinates",value:function(){return this.via}},{key:"getViaNode",value:function(){return this.via}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.via;if(this.from!==this.to)return{x:Math.pow(1-t,2)*this.fromPoint.x+2*t*(1-t)*e.x+Math.pow(t,2)*this.toPoint.x,y:Math.pow(1-t,2)*this.fromPoint.y+2*t*(1-t)*e.y+Math.pow(t,2)*this.toPoint.y};var i=r9(this._getCircleData(),3),n=i[0],o=i[1],r=i[2],s=2*Math.PI*(1-t);return{x:n+r*Math.sin(s),y:o+r-r*(1-Math.cos(s))}}},{key:"_findBorderPosition",value:function(t,e){return this._findBorderPositionBezier(t,e,this.via)}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){return this._getDistanceToBezierEdge(t,e,i,n,o,r,this.via)}}]),n}(ge),gn=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"_line",value:function(t,e,i){this._bezierCurve(t,e,i)}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}},{key:"_getViaCoordinates",value:function(){var t=this.options.smooth.roundness,e=this.options.smooth.type,i=Math.abs(this.from.x-this.to.x),n=Math.abs(this.from.y-this.to.y);if("discrete"===e||"diagonalCross"===e){o=r=i<=n?t*n:t*i,this.from.x>this.to.x&&(o=-o),this.from.y>=this.to.y&&(r=-r);var o,r,s=this.from.x+o,a=this.from.y+r;return"discrete"===e&&(i<=n?s=i<t*n?this.from.x:s:a=n<t*i?this.from.y:a),{x:s,y:a}}if("straightCross"===e){var l=(1-t)*i,h=(1-t)*n;return i<=n?(l=0,this.from.y<this.to.y&&(h=-h)):(this.from.x<this.to.x&&(l=-l),h=0),{x:this.to.x+l,y:this.to.y+h}}if("horizontal"===e){var c=(1-t)*i;return this.from.x<this.to.x&&(c=-c),{x:this.to.x+c,y:this.from.y}}if("vertical"===e){var d=(1-t)*n;return this.from.y<this.to.y&&(d=-d),{x:this.from.x,y:this.to.y+d}}if("curvedCW"===e){var u=Math.sqrt((i=this.to.x-this.from.x)*i+(n=this.from.y-this.to.y)*n),f=Math.PI,p=(Math.atan2(n,i)+(.5*t+.5)*f)%(2*f);return{x:this.from.x+(.5*t+.5)*u*Math.sin(p),y:this.from.y+(.5*t+.5)*u*Math.cos(p)}}if("curvedCCW"===e){var g=Math.sqrt((i=this.to.x-this.from.x)*i+(n=this.from.y-this.to.y)*n),m=Math.PI,v=(Math.atan2(n,i)+(-(.5*t)+.5)*m)%(2*m);return{x:this.from.x+(.5*t+.5)*g*Math.sin(v),y:this.from.y+(.5*t+.5)*g*Math.cos(v)}}y=b=i<=n?t*n:t*i,this.from.x>this.to.x&&(y=-y),this.from.y>=this.to.y&&(b=-b);var y,b,w=this.from.x+y,x=this.from.y+b;return i<=n?w=this.from.x<=this.to.x?this.to.x<w?this.to.x:w:this.to.x>w?this.to.x:w:x=this.from.y>=this.to.y?this.to.y>x?this.to.y:x:this.to.y<x?this.to.y:x,{x:w,y:x}}},{key:"_findBorderPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._findBorderPositionBezier(t,e,i.via)}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._getViaCoordinates();return this._getDistanceToBezierEdge(t,e,i,n,o,r,s)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getViaCoordinates();return{x:Math.pow(1-t,2)*this.fromPoint.x+2*t*(1-t)*e.x+Math.pow(t,2)*this.toPoint.x,y:Math.pow(1-t,2)*this.fromPoint.y+2*t*(1-t)*e.y+Math.pow(t,2)*this.toPoint.y}}}]),n}(ge),go=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"_line",value:function(t,e,i){var n=i[0],o=i[1];this._bezierCurve(t,e,n,o)}},{key:"_getViaCoordinates",value:function(){var t,e,i,n,o=this.from.x-this.to.x,r=this.from.y-this.to.y,s=this.options.smooth.roundness;return(Math.abs(o)>Math.abs(r)||!0===this.options.smooth.forceDirection||"horizontal"===this.options.smooth.forceDirection)&&"vertical"!==this.options.smooth.forceDirection?(e=this.from.y,n=this.to.y,t=this.from.x-s*o,i=this.to.x+s*o):(e=this.from.y-s*r,n=this.to.y+s*r,t=this.from.x,i=this.to.x),[{x:t,y:e},{x:i,y:n}]}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}},{key:"_findBorderPosition",value:function(t,e){return this._findBorderPositionBezier(t,e)}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._getViaCoordinates(),a=r9(s,2),l=a[0],h=a[1];return this._getDistanceToBezierEdge2(t,e,i,n,o,r,l,h)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getViaCoordinates(),i=r9(e,2),n=i[0],o=i[1],r=[Math.pow(1-t,3),3*t*Math.pow(1-t,2),3*Math.pow(t,2)*(1-t),Math.pow(t,3)];return{x:r[0]*this.fromPoint.x+r[1]*n.x+r[2]*o.x+r[3]*this.toPoint.x,y:r[0]*this.fromPoint.y+r[1]*n.y+r[2]*o.y+r[3]*this.toPoint.y}}}]),n}(function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"_getDistanceToBezierEdge2",value:function(t,e,i,n,o,r,s,a){for(var l=1e9,h=t,c=e,d=[0,0,0,0],u=1;u<10;u++){var f=.1*u;d[0]=Math.pow(1-f,3),d[1]=3*f*Math.pow(1-f,2),d[2]=3*Math.pow(f,2)*(1-f),d[3]=Math.pow(f,3);var p=d[0]*t+d[1]*s.x+d[2]*a.x+d[3]*i,g=d[0]*e+d[1]*s.y+d[2]*a.y+d[3]*n;if(u>0){var m=this._getDistanceToLine(h,c,p,g,o,r);l=m<l?m:l}h=p,c=g}return l}}]),n}(ge)),gr=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"_line",value:function(t,e){t.beginPath(),t.moveTo(this.fromPoint.x,this.fromPoint.y),t.lineTo(this.toPoint.x,this.toPoint.y),this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}},{key:"getViaNode",value:function(){}},{key:"getPoint",value:function(t){return{x:(1-t)*this.fromPoint.x+t*this.toPoint.x,y:(1-t)*this.fromPoint.y+t*this.toPoint.y}}},{key:"_findBorderPosition",value:function(t,e){var i=this.to,n=this.from;t.id===this.from.id&&(i=this.from,n=this.to);var o=Math.atan2(i.y-n.y,i.x-n.x),r=i.x-n.x,s=i.y-n.y,a=Math.sqrt(r*r+s*s),l=(a-t.distanceToBorder(e,o))/a;return{x:(1-l)*n.x+l*i.x,y:(1-l)*n.y+l*i.y,t:0}}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){return this._getDistanceToLine(t,e,i,n,o,r)}}]),n}(p9),gs=function(){function t(e,i,n,o,r){if(n4(this,t),void 0===i)throw Error("No body provided");this.options=hB(o),this.globalOptions=o,this.defaultOptions=r,this.body=i,this.imagelist=n,this.id=void 0,this.fromId=void 0,this.toId=void 0,this.selected=!1,this.hover=!1,this.labelDirty=!0,this.baseWidth=this.options.width,this.baseFontSize=this.options.font.size,this.from=void 0,this.to=void 0,this.edgeType=void 0,this.connected=!1,this.labelModule=new pu(this.body,this.options,!0),this.setOptions(e)}return rH(t,[{key:"setOptions",value:function(e){if(e){var i=void 0!==e.physics&&this.options.physics!==e.physics||void 0!==e.hidden&&(this.options.hidden||!1)!==(e.hidden||!1)||void 0!==e.from&&this.options.from!==e.from||void 0!==e.to&&this.options.to!==e.to;t.parseOptions(this.options,e,!0,this.globalOptions),void 0!==e.id&&(this.id=e.id),void 0!==e.from&&(this.fromId=e.from),void 0!==e.to&&(this.toId=e.to),void 0!==e.title&&(this.title=e.title),void 0!==e.value&&(e.value=f7(e.value));var n=[e,this.options,this.defaultOptions];return this.chooser=pn("edge",n),this.updateLabelModule(e),i=this.updateEdgeType()||i,this._setInteractionWidths(),this.connect(),i}}},{key:"getFormattingValues",value:function(){var t=!0===this.options.arrows.to||!0===this.options.arrows.to.enabled,e=!0===this.options.arrows.from||!0===this.options.arrows.from.enabled,i=!0===this.options.arrows.middle||!0===this.options.arrows.middle.enabled,n=this.options.color.inherit,o={toArrow:t,toArrowScale:this.options.arrows.to.scaleFactor,toArrowType:this.options.arrows.to.type,toArrowSrc:this.options.arrows.to.src,toArrowImageWidth:this.options.arrows.to.imageWidth,toArrowImageHeight:this.options.arrows.to.imageHeight,middleArrow:i,middleArrowScale:this.options.arrows.middle.scaleFactor,middleArrowType:this.options.arrows.middle.type,middleArrowSrc:this.options.arrows.middle.src,middleArrowImageWidth:this.options.arrows.middle.imageWidth,middleArrowImageHeight:this.options.arrows.middle.imageHeight,fromArrow:e,fromArrowScale:this.options.arrows.from.scaleFactor,fromArrowType:this.options.arrows.from.type,fromArrowSrc:this.options.arrows.from.src,fromArrowImageWidth:this.options.arrows.from.imageWidth,fromArrowImageHeight:this.options.arrows.from.imageHeight,arrowStrikethrough:this.options.arrowStrikethrough,color:n?void 0:this.options.color.color,inheritsColor:n,opacity:this.options.color.opacity,hidden:this.options.hidden,length:this.options.length,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y,dashes:this.options.dashes,width:this.options.width,background:this.options.background.enabled,backgroundColor:this.options.background.color,backgroundSize:this.options.background.size,backgroundDashes:this.options.background.dashes};if(this.selected||this.hover){if(!0===this.chooser){if(this.selected){var r=this.options.selectionWidth;"function"==typeof r?o.width=r(o.width):"number"==typeof r&&(o.width+=r),o.width=Math.max(o.width,.3/this.body.view.scale),o.color=this.options.color.highlight,o.shadow=this.options.shadow.enabled}else if(this.hover){var s=this.options.hoverWidth;"function"==typeof s?o.width=s(o.width):"number"==typeof s&&(o.width+=s),o.width=Math.max(o.width,.3/this.body.view.scale),o.color=this.options.color.hover,o.shadow=this.options.shadow.enabled}}else"function"==typeof this.chooser&&(this.chooser(o,this.options.id,this.selected,this.hover),void 0!==o.color&&(o.inheritsColor=!1),!1===o.shadow&&(o.shadowColor!==this.options.shadow.color||o.shadowSize!==this.options.shadow.size||o.shadowX!==this.options.shadow.x||o.shadowY!==this.options.shadow.y)&&(o.shadow=!0))}else o.shadow=this.options.shadow.enabled,o.width=Math.max(o.width,.3/this.body.view.scale);return o}},{key:"updateLabelModule",value:function(t){var e=[t,this.options,this.globalOptions,this.defaultOptions];this.labelModule.update(this.options,e),void 0!==this.labelModule.baseSize&&(this.baseFontSize=this.labelModule.baseSize)}},{key:"updateEdgeType",value:function(){var t=this.options.smooth,e=!1,i=!0;return void 0!==this.edgeType&&((this.edgeType instanceof gi&&!0===t.enabled&&"dynamic"===t.type||this.edgeType instanceof go&&!0===t.enabled&&"cubicBezier"===t.type||this.edgeType instanceof gn&&!0===t.enabled&&"dynamic"!==t.type&&"cubicBezier"!==t.type||this.edgeType instanceof gr&&!1===t.type.enabled)&&(i=!1),!0===i&&(e=this.cleanup())),!0===i?!0===t.enabled?"dynamic"===t.type?(e=!0,this.edgeType=new gi(this.options,this.body,this.labelModule)):"cubicBezier"===t.type?this.edgeType=new go(this.options,this.body,this.labelModule):this.edgeType=new gn(this.options,this.body,this.labelModule):this.edgeType=new gr(this.options,this.body,this.labelModule):this.edgeType.setOptions(this.options),e}},{key:"connect",value:function(){this.disconnect(),this.from=this.body.nodes[this.fromId]||void 0,this.to=this.body.nodes[this.toId]||void 0,this.connected=void 0!==this.from&&void 0!==this.to,!0===this.connected?(this.from.attachEdge(this),this.to.attachEdge(this)):(this.from&&this.from.detachEdge(this),this.to&&this.to.detachEdge(this)),this.edgeType.connect()}},{key:"disconnect",value:function(){this.from&&(this.from.detachEdge(this),this.from=void 0),this.to&&(this.to.detachEdge(this),this.to=void 0),this.connected=!1}},{key:"getTitle",value:function(){return this.title}},{key:"isSelected",value:function(){return this.selected}},{key:"getValue",value:function(){return this.options.value}},{key:"setValueRange",value:function(t,e,i){if(void 0!==this.options.value){var n=this.options.scaling.customScalingFunction(t,e,i,this.options.value),o=this.options.scaling.max-this.options.scaling.min;if(!0===this.options.scaling.label.enabled){var r=this.options.scaling.label.max-this.options.scaling.label.min;this.options.font.size=this.options.scaling.label.min+n*r}this.options.width=this.options.scaling.min+n*o}else this.options.width=this.baseWidth,this.options.font.size=this.baseFontSize;this._setInteractionWidths(),this.updateLabelModule()}},{key:"_setInteractionWidths",value:function(){"function"==typeof this.options.hoverWidth?this.edgeType.hoverWidth=this.options.hoverWidth(this.options.width):this.edgeType.hoverWidth=this.options.hoverWidth+this.options.width,"function"==typeof this.options.selectionWidth?this.edgeType.selectionWidth=this.options.selectionWidth(this.options.width):this.edgeType.selectionWidth=this.options.selectionWidth+this.options.width}},{key:"draw",value:function(t){var e=this.getFormattingValues();if(!e.hidden){var i=this.edgeType.getViaNode();this.edgeType.drawLine(t,e,this.selected,this.hover,i),this.drawLabel(t,i)}}},{key:"drawArrows",value:function(t){var e=this.getFormattingValues();if(!e.hidden){var i=this.edgeType.getViaNode(),n={};this.edgeType.fromPoint=this.edgeType.from,this.edgeType.toPoint=this.edgeType.to,e.fromArrow&&(n.from=this.edgeType.getArrowData(t,"from",i,this.selected,this.hover,e),!1===e.arrowStrikethrough&&(this.edgeType.fromPoint=n.from.core),e.fromArrowSrc&&(n.from.image=this.imagelist.load(e.fromArrowSrc)),e.fromArrowImageWidth&&(n.from.imageWidth=e.fromArrowImageWidth),e.fromArrowImageHeight&&(n.from.imageHeight=e.fromArrowImageHeight)),e.toArrow&&(n.to=this.edgeType.getArrowData(t,"to",i,this.selected,this.hover,e),!1===e.arrowStrikethrough&&(this.edgeType.toPoint=n.to.core),e.toArrowSrc&&(n.to.image=this.imagelist.load(e.toArrowSrc)),e.toArrowImageWidth&&(n.to.imageWidth=e.toArrowImageWidth),e.toArrowImageHeight&&(n.to.imageHeight=e.toArrowImageHeight)),e.middleArrow&&(n.middle=this.edgeType.getArrowData(t,"middle",i,this.selected,this.hover,e),e.middleArrowSrc&&(n.middle.image=this.imagelist.load(e.middleArrowSrc)),e.middleArrowImageWidth&&(n.middle.imageWidth=e.middleArrowImageWidth),e.middleArrowImageHeight&&(n.middle.imageHeight=e.middleArrowImageHeight)),e.fromArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,n.from),e.middleArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,n.middle),e.toArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,n.to)}}},{key:"drawLabel",value:function(t,e){if(void 0!==this.options.label){var i,n=this.from,o=this.to;if(this.labelModule.differentState(this.selected,this.hover)&&this.labelModule.getTextSize(t,this.selected,this.hover),n.id!=o.id){this.labelModule.pointToSelf=!1,i=this.edgeType.getPoint(.5,e),t.save();var r=this._getRotation(t);0!=r.angle&&(t.translate(r.x,r.y),t.rotate(r.angle)),this.labelModule.draw(t,i.x,i.y,this.selected,this.hover),t.restore()}else{this.labelModule.pointToSelf=!0;var s=ps(t,this.options.selfReference.angle,this.options.selfReference.size,n);i=this._pointOnCircle(s.x,s.y,this.options.selfReference.size,this.options.selfReference.angle),this.labelModule.draw(t,i.x,i.y,this.selected,this.hover)}}}},{key:"getItemsOnPoint",value:function(t){var e=[];if(this.labelModule.visible()){var i=this._getRotation();po(this.labelModule.getSize(),t,i)&&e.push({edgeId:this.id,labelId:0})}var n={left:t.x,top:t.y};return this.isOverlappingWith(n)&&e.push({edgeId:this.id}),e}},{key:"isOverlappingWith",value:function(t){if(!this.connected)return!1;var e=this.from.x,i=this.from.y,n=this.to.x,o=this.to.y,r=t.left,s=t.top;return 10>this.edgeType.getDistanceToEdge(e,i,n,o,r,s)}},{key:"_getRotation",value:function(t){var e=this.edgeType.getViaNode(),i=this.edgeType.getPoint(.5,e);void 0!==t&&this.labelModule.calculateLabelSize(t,this.selected,this.hover,i.x,i.y);var n={x:i.x,y:this.labelModule.size.yLine,angle:0};if(!this.labelModule.visible()||"horizontal"===this.options.font.align)return n;var o=this.from.y-this.to.y,r=this.from.x-this.to.x,s=Math.atan2(o,r);return(s<-1&&r<0||s>0&&r<0)&&(s+=Math.PI),n.angle=s,n}},{key:"_pointOnCircle",value:function(t,e,i,n){return{x:t+i*Math.cos(n),y:e-i*Math.sin(n)}}},{key:"select",value:function(){this.selected=!0}},{key:"unselect",value:function(){this.selected=!1}},{key:"cleanup",value:function(){return this.edgeType.cleanup()}},{key:"remove",value:function(){this.cleanup(),this.disconnect(),delete this.body.edges[this.id]}},{key:"endPointsValid",value:function(){return void 0!==this.body.nodes[this.fromId]&&void 0!==this.body.nodes[this.toId]}}],[{key:"parseOptions",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(hp(["endPointOffset","arrowStrikethrough","id","from","hidden","hoverWidth","labelHighlightBold","length","line","opacity","physics","scaling","selectionWidth","selfReferenceSize","selfReference","to","title","value","width","font","chosen","widthConstraint"],t,e,i),void 0!==e.endPointOffset&&void 0!==e.endPointOffset.from&&(cq(e.endPointOffset.from)?t.endPointOffset.from=e.endPointOffset.from:(t.endPointOffset.from=void 0!==n.endPointOffset.from?n.endPointOffset.from:0,console.error("endPointOffset.from is not a valid number"))),void 0!==e.endPointOffset&&void 0!==e.endPointOffset.to&&(cq(e.endPointOffset.to)?t.endPointOffset.to=e.endPointOffset.to:(t.endPointOffset.to=void 0!==n.endPointOffset.to?n.endPointOffset.to:0,console.error("endPointOffset.to is not a valid number"))),pr(e.label)?t.label=e.label:pr(t.label)||(t.label=void 0),hz(t,e,"smooth",n),hz(t,e,"shadow",n),hz(t,e,"background",n),void 0!==e.dashes&&null!==e.dashes?t.dashes=e.dashes:!0===i&&null===e.dashes&&(t.dashes=aS(n.dashes)),void 0!==e.scaling&&null!==e.scaling?(void 0!==e.scaling.min&&(t.scaling.min=e.scaling.min),void 0!==e.scaling.max&&(t.scaling.max=e.scaling.max),hz(t.scaling,e.scaling,"label",n.scaling)):!0===i&&null===e.scaling&&(t.scaling=aS(n.scaling)),void 0!==e.arrows&&null!==e.arrows){if("string"==typeof e.arrows){var r=e.arrows.toLowerCase();t.arrows.to.enabled=-1!=ab(r).call(r,"to"),t.arrows.middle.enabled=-1!=ab(r).call(r,"middle"),t.arrows.from.enabled=-1!=ab(r).call(r,"from")}else if("object"===rN(e.arrows))hz(t.arrows,e.arrows,"to",n.arrows),hz(t.arrows,e.arrows,"middle",n.arrows),hz(t.arrows,e.arrows,"from",n.arrows);else throw Error("The arrow newOptions can only be an object or a string. Refer to the documentation. You used:"+a_(e.arrows))}else!0===i&&null===e.arrows&&(t.arrows=aS(n.arrows));if(void 0!==e.color&&null!==e.color){var s=hc(e.color)?{color:e.color,highlight:e.color,hover:e.color,inherit:!1,opacity:1}:e.color,a=t.color;if(o)hm(a,n.color,!1,i);else for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&delete a[l];if(hc(a))a.color=a,a.highlight=a,a.hover=a,a.inherit=!1,void 0===s.opacity&&(a.opacity=1);else{var h=!1;void 0!==s.color&&(a.color=s.color,h=!0),void 0!==s.highlight&&(a.highlight=s.highlight,h=!0),void 0!==s.hover&&(a.hover=s.hover,h=!0),void 0!==s.inherit&&(a.inherit=s.inherit),void 0!==s.opacity&&(a.opacity=Math.min(1,Math.max(0,s.opacity))),!0===h?a.inherit=!1:void 0===a.inherit&&(a.inherit="from")}}else!0===i&&null===e.color&&(t.color=hB(n.color));!0===i&&null===e.font&&(t.font=hB(n.font)),Object.prototype.hasOwnProperty.call(e,"selfReferenceSize")&&(console.warn("The selfReferenceSize property has been deprecated. Please use selfReference property instead. The selfReference can be set like thise selfReference:{size:30, angle:Math.PI / 4}"),t.selfReference.size=e.selfReferenceSize)}}]),t}(),ga=function(){function t(e,i,n){var o,r=this;n4(this,t),this.body=e,this.images=i,this.groups=n,this.body.functions.createEdge=e7(o=this.create).call(o,this),this.edgesListeners={add:function(t,e){r.add(e.items)},update:function(t,e){r.update(e.items)},remove:function(t,e){r.remove(e.items)}},this.options={},this.defaultOptions={arrows:{to:{enabled:!1,scaleFactor:1,type:"arrow"},middle:{enabled:!1,scaleFactor:1,type:"arrow"},from:{enabled:!1,scaleFactor:1,type:"arrow"}},endPointOffset:{from:0,to:0},arrowStrikethrough:!0,color:{color:"#848484",highlight:"#848484",hover:"#848484",inherit:"from",opacity:1},dashes:!1,font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:2,strokeColor:"#ffffff",align:"horizontal",multi:!1,vadjust:0,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"courier new",vadjust:2}},hidden:!1,hoverWidth:1.5,label:void 0,labelHighlightBold:!0,length:void 0,physics:!0,scaling:{min:1,max:15,label:{enabled:!0,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function(t,e,i,n){return e===t?.5:Math.max(0,1/(e-t)*(n-t))}},selectionWidth:1.5,selfReference:{size:20,angle:Math.PI/4,renderBehindTheNode:!0},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},background:{enabled:!1,color:"rgba(111,111,111,1)",size:10,dashes:!1},smooth:{enabled:!0,type:"dynamic",forceDirection:"none",roundness:.5},title:void 0,width:1,value:void 0},hm(this.options,this.defaultOptions),this.bindEventListeners()}return rH(t,[{key:"bindEventListeners",value:function(){var t,e,i=this;this.body.emitter.on("_forceDisableDynamicCurves",function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];"dynamic"===t&&(t="continuous");var n=!1;for(var o in i.body.edges)if(Object.prototype.hasOwnProperty.call(i.body.edges,o)){var r=i.body.edges[o],s=i.body.data.edges.get(o);if(null!=s){var a=s.smooth;void 0!==a&&!0===a.enabled&&"dynamic"===a.type&&(void 0===t?r.setOptions({smooth:!1}):r.setOptions({smooth:{type:t}}),n=!0)}}!0===e&&!0===n&&i.body.emitter.emit("_dataChanged")}),this.body.emitter.on("_dataUpdated",function(){i.reconnectEdges()}),this.body.emitter.on("refreshEdges",e7(t=this.refresh).call(t,this)),this.body.emitter.on("refresh",e7(e=this.refresh).call(e,this)),this.body.emitter.on("destroy",function(){hx(i.edgesListeners,function(t,e){i.body.data.edges&&i.body.data.edges.off(e,t)}),delete i.body.functions.createEdge,delete i.edgesListeners.add,delete i.edgesListeners.update,delete i.edgesListeners.remove,delete i.edgesListeners})}},{key:"setOptions",value:function(t){if(void 0!==t){gs.parseOptions(this.options,t,!0,this.defaultOptions,!0);var e=!1;if(void 0!==t.smooth)for(var i in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,i)&&(e=this.body.edges[i].updateEdgeType()||e);if(void 0!==t.font)for(var n in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,n)&&this.body.edges[n].updateLabelModule();(void 0!==t.hidden||void 0!==t.physics||!0===e)&&this.body.emitter.emit("_dataChanged")}}},{key:"setData",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.body.data.edges;if(f1("id",t))this.body.data.edges=t;else if(sl(t))this.body.data.edges=new fZ,this.body.data.edges.add(t);else if(t)throw TypeError("Array or DataSet expected");else this.body.data.edges=new fZ;if(n&&hx(this.edgesListeners,function(t,e){n.off(e,t)}),this.body.edges={},this.body.data.edges){hx(this.edgesListeners,function(t,i){e.body.data.edges.on(i,t)});var o=this.body.data.edges.getIds();this.add(o,!0)}this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),!1===i&&this.body.emitter.emit("_dataChanged")}},{key:"add",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.body.edges,n=this.body.data.edges,o=0;o<t.length;o++){var r=t[o],s=i[r];s&&s.disconnect();var a=n.get(r,{showInternalIds:!0});i[r]=this.create(a)}this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),!1===e&&this.body.emitter.emit("_dataChanged")}},{key:"update",value:function(t){for(var e=this.body.edges,i=this.body.data.edges,n=!1,o=0;o<t.length;o++){var r=t[o],s=i.get(r),a=e[r];void 0!==a?(a.disconnect(),n=a.setOptions(s)||n,a.connect()):(this.body.edges[r]=this.create(s),n=!0)}!0===n?(this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),this.body.emitter.emit("_dataChanged")):this.body.emitter.emit("_dataUpdated")}},{key:"remove",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(0!==t.length){var i=this.body.edges;hx(t,function(t){var e=i[t];void 0!==e&&e.remove()}),e&&this.body.emitter.emit("_dataChanged")}}},{key:"refresh",value:function(){var t=this;hx(this.body.edges,function(e,i){var n=t.body.data.edges.get(i);void 0!==n&&e.setOptions(n)})}},{key:"create",value:function(t){return new gs(t,this.body,this.images,this.options,this.defaultOptions)}},{key:"reconnectEdges",value:function(){var t,e=this.body.nodes,i=this.body.edges;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(e[t].edges=[]);for(t in i)if(Object.prototype.hasOwnProperty.call(i,t)){var n=i[t];n.from=null,n.to=null,n.connect()}}},{key:"getConnectedNodes",value:function(t){var e=[];if(void 0!==this.body.edges[t]){var i=this.body.edges[t];void 0!==i.fromId&&e.push(i.fromId),void 0!==i.toId&&e.push(i.toId)}return e}},{key:"_updateState",value:function(){this._addMissingEdges(),this._removeInvalidEdges()}},{key:"_removeInvalidEdges",value:function(){var t=this,e=[];hx(this.body.edges,function(i,n){var o=t.body.nodes[i.toId],r=t.body.nodes[i.fromId];(void 0===o||!0!==o.isCluster)&&(void 0===r||!0!==r.isCluster)&&(void 0===o||void 0===r)&&e.push(n)}),this.remove(e,!1)}},{key:"_addMissingEdges",value:function(){var t=this.body.data.edges;if(null!=t){var e=this.body.edges,i=[];sS(t).call(t,function(t,n){void 0===e[n]&&i.push(n)}),this.add(i,!0)}}}]),t}(),gl=function(){function t(e,i,n){n4(this,t),this.body=e,this.physicsBody=i,this.barnesHutTree,this.setOptions(n),this._rng=ht("BARNES HUT SOLVER")}return rH(t,[{key:"setOptions",value:function(t){this.options=t,this.thetaInversed=1/this.options.theta,this.overlapAvoidanceFactor=1-Math.max(0,Math.min(1,this.options.avoidOverlap))}},{key:"solve",value:function(){if(0!==this.options.gravitationalConstant&&this.physicsBody.physicsNodeIndices.length>0){var t,e=this.body.nodes,i=this.physicsBody.physicsNodeIndices,n=i.length,o=this._formBarnesHutTree(e,i);this.barnesHutTree=o;for(var r=0;r<n;r++)(t=e[i[r]]).options.mass>0&&this._getForceContributions(o.root,t)}}},{key:"_getForceContributions",value:function(t,e){this._getForceContribution(t.children.NW,e),this._getForceContribution(t.children.NE,e),this._getForceContribution(t.children.SW,e),this._getForceContribution(t.children.SE,e)}},{key:"_getForceContribution",value:function(t,e){if(t.childrenCount>0){var i=t.centerOfMass.x-e.x,n=t.centerOfMass.y-e.y,o=Math.sqrt(i*i+n*n);o*t.calcSize>this.thetaInversed?this._calculateForces(o,i,n,e,t):4===t.childrenCount?this._getForceContributions(t,e):t.children.data.id!=e.id&&this._calculateForces(o,i,n,e,t)}}},{key:"_calculateForces",value:function(t,e,i,n,o){0===t&&(e=t=.1),this.overlapAvoidanceFactor<1&&n.shape.radius&&(t=Math.max(.1+this.overlapAvoidanceFactor*n.shape.radius,t-n.shape.radius));var r=this.options.gravitationalConstant*o.mass*n.options.mass/Math.pow(t,3),s=e*r;this.physicsBody.forces[n.id].x+=s,this.physicsBody.forces[n.id].y+=i*r}},{key:"_formBarnesHutTree",value:function(t,e){for(var i,n=e.length,o=t[e[0]].x,r=t[e[0]].y,s=t[e[0]].x,a=t[e[0]].y,l=1;l<n;l++){var h=t[e[l]],c=h.x,d=h.y;h.options.mass>0&&(c<o&&(o=c),c>s&&(s=c),d<r&&(r=d),d>a&&(a=d))}var u=Math.abs(s-o)-Math.abs(a-r);u>0?(r-=.5*u,a+=.5*u):(o+=.5*u,s-=.5*u);var f=Math.max(1e-5,Math.abs(s-o)),p=.5*f,g=.5*(o+s),m=.5*(r+a),v={root:{centerOfMass:{x:0,y:0},mass:0,range:{minX:g-p,maxX:g+p,minY:m-p,maxY:m+p},size:f,calcSize:1/f,children:{data:null},maxWidth:0,level:0,childrenCount:4}};this._splitBranch(v.root);for(var y=0;y<n;y++)(i=t[e[y]]).options.mass>0&&this._placeInTree(v.root,i);return v}},{key:"_updateBranchMass",value:function(t,e){var i=t.centerOfMass,n=t.mass+e.options.mass,o=1/n;i.x=i.x*t.mass+e.x*e.options.mass,i.x*=o,i.y=i.y*t.mass+e.y*e.options.mass,i.y*=o,t.mass=n;var r=Math.max(Math.max(e.height,e.radius),e.width);t.maxWidth=t.maxWidth<r?r:t.maxWidth}},{key:"_placeInTree",value:function(t,e,i){(!0!=i||void 0===i)&&this._updateBranchMass(t,e);var n,o=t.children.NW.range;n=o.maxX>e.x?o.maxY>e.y?"NW":"SW":o.maxY>e.y?"NE":"SE",this._placeInRegion(t,e,n)}},{key:"_placeInRegion",value:function(t,e,i){var n=t.children[i];switch(n.childrenCount){case 0:n.children.data=e,n.childrenCount=1,this._updateBranchMass(n,e);break;case 1:n.children.data.x===e.x&&n.children.data.y===e.y?(e.x+=this._rng(),e.y+=this._rng()):(this._splitBranch(n),this._placeInTree(n,e));break;case 4:this._placeInTree(n,e)}}},{key:"_splitBranch",value:function(t){var e=null;1===t.childrenCount&&(e=t.children.data,t.mass=0,t.centerOfMass.x=0,t.centerOfMass.y=0),t.childrenCount=4,t.children.data=null,this._insertRegion(t,"NW"),this._insertRegion(t,"NE"),this._insertRegion(t,"SW"),this._insertRegion(t,"SE"),null!=e&&this._placeInTree(t,e)}},{key:"_insertRegion",value:function(t,e){var i,n,o,r,s=.5*t.size;switch(e){case"NW":i=t.range.minX,n=t.range.minX+s,o=t.range.minY,r=t.range.minY+s;break;case"NE":i=t.range.minX+s,n=t.range.maxX,o=t.range.minY,r=t.range.minY+s;break;case"SW":i=t.range.minX,n=t.range.minX+s,o=t.range.minY+s,r=t.range.maxY;break;case"SE":i=t.range.minX+s,n=t.range.maxX,o=t.range.minY+s,r=t.range.maxY}t.children[e]={centerOfMass:{x:0,y:0},mass:0,range:{minX:i,maxX:n,minY:o,maxY:r},size:.5*t.size,calcSize:2*t.calcSize,children:{data:null},maxWidth:0,level:t.level+1,childrenCount:0}}},{key:"_debug",value:function(t,e){void 0!==this.barnesHutTree&&(t.lineWidth=1,this._drawBranch(this.barnesHutTree.root,t,e))}},{key:"_drawBranch",value:function(t,e,i){void 0===i&&(i="#FF0000"),4===t.childrenCount&&(this._drawBranch(t.children.NW,e),this._drawBranch(t.children.NE,e),this._drawBranch(t.children.SE,e),this._drawBranch(t.children.SW,e)),e.strokeStyle=i,e.beginPath(),e.moveTo(t.range.minX,t.range.minY),e.lineTo(t.range.maxX,t.range.minY),e.stroke(),e.beginPath(),e.moveTo(t.range.maxX,t.range.minY),e.lineTo(t.range.maxX,t.range.maxY),e.stroke(),e.beginPath(),e.moveTo(t.range.maxX,t.range.maxY),e.lineTo(t.range.minX,t.range.maxY),e.stroke(),e.beginPath(),e.moveTo(t.range.minX,t.range.maxY),e.lineTo(t.range.minX,t.range.minY),e.stroke()}}]),t}(),gh=function(){function t(e,i,n){n4(this,t),this._rng=ht("REPULSION SOLVER"),this.body=e,this.physicsBody=i,this.setOptions(n)}return rH(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o,r,s,a,l=this.body.nodes,h=this.physicsBody.physicsNodeIndices,c=this.physicsBody.forces,d=this.options.nodeDistance,u=-2/3/d,f=4/3,p=0;p<h.length-1;p++){s=l[h[p]];for(var g=p+1;g<h.length;g++)0===(i=Math.sqrt((t=(a=l[h[g]]).x-s.x)*t+(e=a.y-s.y)*e))&&(t=i=.1*this._rng()),i<2*d&&(n=t*(r=(i<.5*d?1:u*i+f)/i),o=e*r,c[s.id].x-=n,c[s.id].y-=o,c[a.id].x+=n,c[a.id].y+=o)}}}]),t}(),gc=function(){function t(e,i,n){n4(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return rH(t,[{key:"setOptions",value:function(t){this.options=t,this.overlapAvoidanceFactor=Math.max(0,Math.min(1,this.options.avoidOverlap||0))}},{key:"solve",value:function(){for(var t=this.body.nodes,e=this.physicsBody.physicsNodeIndices,i=this.physicsBody.forces,n=this.options.nodeDistance,o=0;o<e.length-1;o++)for(var r=t[e[o]],s=o+1;s<e.length;s++){var a=t[e[s]];if(r.level===a.level){var l=n+this.overlapAvoidanceFactor*((r.shape.radius||0)/2+(a.shape.radius||0)/2),h=a.x-r.x,c=a.y-r.y,d=Math.sqrt(h*h+c*c),u=void 0;u=d<l?-Math.pow(.05*d,2)+Math.pow(.05*l,2):0,0!==d&&(u/=d);var f=h*u,p=c*u;i[r.id].x-=f,i[r.id].y-=p,i[a.id].x+=f,i[a.id].y+=p}}}}]),t}(),gd=function(){function t(e,i,n){n4(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return rH(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o,r=this.physicsBody.physicsEdgeIndices,s=this.body.edges,a=0;a<r.length;a++)!0===(e=s[r[a]]).connected&&e.toId!==e.fromId&&void 0!==this.body.nodes[e.toId]&&void 0!==this.body.nodes[e.fromId]&&(void 0!==e.edgeType.via?(t=void 0===e.options.length?this.options.springLength:e.options.length,i=e.to,n=e.edgeType.via,o=e.from,this._calculateSpringForce(i,n,.5*t),this._calculateSpringForce(n,o,.5*t)):(t=void 0===e.options.length?1.5*this.options.springLength:e.options.length,this._calculateSpringForce(e.from,e.to,t)))}},{key:"_calculateSpringForce",value:function(t,e,i){var n=t.x-e.x,o=t.y-e.y,r=Math.max(Math.sqrt(n*n+o*o),.01),s=this.options.springConstant*(i-r)/r,a=n*s,l=o*s;void 0!==this.physicsBody.forces[t.id]&&(this.physicsBody.forces[t.id].x+=a,this.physicsBody.forces[t.id].y+=l),void 0!==this.physicsBody.forces[e.id]&&(this.physicsBody.forces[e.id].x-=a,this.physicsBody.forces[e.id].y-=l)}}]),t}(),gu=function(){function t(e,i,n){n4(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return rH(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o,r,s,a,l,h,c=this.body.edges,d=this.physicsBody.physicsEdgeIndices,u=this.physicsBody.physicsNodeIndices,f=this.physicsBody.forces,p=0;p<u.length;p++){var g=u[p];f[g].springFx=0,f[g].springFy=0}for(var m=0;m<d.length;m++)!0===(e=c[d[m]]).connected&&(t=void 0===e.options.length?this.options.springLength:e.options.length,a=0===(a=Math.sqrt((i=e.from.x-e.to.x)*i+(n=e.from.y-e.to.y)*n))?.01:a,o=i*(s=this.options.springConstant*(t-a)/a),r=n*s,e.to.level!=e.from.level?(void 0!==f[e.toId]&&(f[e.toId].springFx-=o,f[e.toId].springFy-=r),void 0!==f[e.fromId]&&(f[e.fromId].springFx+=o,f[e.fromId].springFy+=r)):(void 0!==f[e.toId]&&(f[e.toId].x-=.5*o,f[e.toId].y-=.5*r),void 0!==f[e.fromId]&&(f[e.fromId].x+=.5*o,f[e.fromId].y+=.5*r)));s=1;for(var v=0;v<u.length;v++){var y=u[v];l=Math.min(s,Math.max(-s,f[y].springFx)),h=Math.min(s,Math.max(-s,f[y].springFy)),f[y].x+=l,f[y].y+=h}for(var b=0,w=0,x=0;x<u.length;x++){var k=u[x];b+=f[k].x,w+=f[k].y}for(var O=b/u.length,S=w/u.length,_=0;_<u.length;_++){var C=u[_];f[C].x-=O,f[C].y-=S}}}]),t}(),gf=function(){function t(e,i,n){n4(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return rH(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o=this.body.nodes,r=this.physicsBody.physicsNodeIndices,s=this.physicsBody.forces,a=0;a<r.length;a++)i=Math.sqrt((t=-(n=o[r[a]]).x)*t+(e=-n.y)*e),this._calculateForces(i,t,e,s,n)}},{key:"_calculateForces",value:function(t,e,i,n,o){var r=0===t?0:this.options.centralGravity/t;n[o.id].x=e*r,n[o.id].y=i*r}}]),t}(),gp=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){var r;return n4(this,n),(r=i.call(this,t,e,o))._rng=ht("FORCE ATLAS 2 BASED REPULSION SOLVER"),r}return rH(n,[{key:"_calculateForces",value:function(t,e,i,n,o){0===t&&(e=t=.1*this._rng()),this.overlapAvoidanceFactor<1&&n.shape.radius&&(t=Math.max(.1+this.overlapAvoidanceFactor*n.shape.radius,t-n.shape.radius));var r=n.edges.length+1,s=this.options.gravitationalConstant*o.mass*n.options.mass*r/Math.pow(t,2),a=e*s;this.physicsBody.forces[n.id].x+=a,this.physicsBody.forces[n.id].y+=i*s}}]),n}(gl),gg=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o){return n4(this,n),i.call(this,t,e,o)}return rH(n,[{key:"_calculateForces",value:function(t,e,i,n,o){if(t>0){var r=o.edges.length+1,s=this.options.centralGravity*r*o.options.mass;n[o.id].x=e*s,n[o.id].y=i*s}}}]),n}(gf),gm=function(){function t(e){n4(this,t),this.body=e,this.physicsBody={physicsNodeIndices:[],physicsEdgeIndices:[],forces:{},velocities:{}},this.physicsEnabled=!0,this.simulationInterval=1e3/60,this.requiresTimeout=!0,this.previousStates={},this.referenceState={},this.freezeCache={},this.renderTimer=void 0,this.adaptiveTimestep=!1,this.adaptiveTimestepEnabled=!1,this.adaptiveCounter=0,this.adaptiveInterval=3,this.stabilized=!1,this.startedStabilization=!1,this.stabilizationIterations=0,this.ready=!1,this.options={},this.defaultOptions={enabled:!0,barnesHut:{theta:.5,gravitationalConstant:-2e3,centralGravity:.3,springLength:95,springConstant:.04,damping:.09,avoidOverlap:0},forceAtlas2Based:{theta:.5,gravitationalConstant:-50,centralGravity:.01,springConstant:.08,springLength:100,damping:.4,avoidOverlap:0},repulsion:{centralGravity:.2,springLength:200,springConstant:.05,nodeDistance:100,damping:.09,avoidOverlap:0},hierarchicalRepulsion:{centralGravity:0,springLength:100,springConstant:.01,nodeDistance:120,damping:.09},maxVelocity:50,minVelocity:.75,solver:"barnesHut",stabilization:{enabled:!0,iterations:1e3,updateInterval:50,onlyDynamicEdges:!1,fit:!0},timestep:.5,adaptiveTimestep:!0,wind:{x:0,y:0}},eK(this.options,this.defaultOptions),this.timestep=.5,this.layoutFailed=!1,this.bindEventListeners()}return rH(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("initPhysics",function(){t.initPhysics()}),this.body.emitter.on("_layoutFailed",function(){t.layoutFailed=!0}),this.body.emitter.on("resetPhysics",function(){t.stopSimulation(),t.ready=!1}),this.body.emitter.on("disablePhysics",function(){t.physicsEnabled=!1,t.stopSimulation()}),this.body.emitter.on("restorePhysics",function(){t.setOptions(t.options),!0===t.ready&&t.startSimulation()}),this.body.emitter.on("startSimulation",function(){!0===t.ready&&t.startSimulation()}),this.body.emitter.on("stopSimulation",function(){t.stopSimulation()}),this.body.emitter.on("destroy",function(){t.stopSimulation(!1),t.body.emitter.off()}),this.body.emitter.on("_dataChanged",function(){t.updatePhysicsData()})}},{key:"setOptions",value:function(t){if(void 0!==t){if(!1===t)this.options.enabled=!1,this.physicsEnabled=!1,this.stopSimulation();else if(!0===t)this.options.enabled=!0,this.physicsEnabled=!0,this.startSimulation();else{this.physicsEnabled=!0,hg(["stabilization"],this.options,t),hz(this.options,t,"stabilization"),void 0===t.enabled&&(this.options.enabled=!0),!1===this.options.enabled&&(this.physicsEnabled=!1,this.stopSimulation());var e=this.options.wind;e&&(("number"!=typeof e.x||cQ(e.x))&&(e.x=0),("number"!=typeof e.y||cQ(e.y))&&(e.y=0)),this.timestep=this.options.timestep}}this.init()}},{key:"init",value:function(){var t;"forceAtlas2Based"===this.options.solver?(t=this.options.forceAtlas2Based,this.nodesSolver=new gp(this.body,this.physicsBody,t),this.edgesSolver=new gd(this.body,this.physicsBody,t),this.gravitySolver=new gg(this.body,this.physicsBody,t)):("repulsion"===this.options.solver?(t=this.options.repulsion,this.nodesSolver=new gh(this.body,this.physicsBody,t),this.edgesSolver=new gd(this.body,this.physicsBody,t)):"hierarchicalRepulsion"===this.options.solver?(t=this.options.hierarchicalRepulsion,this.nodesSolver=new gc(this.body,this.physicsBody,t),this.edgesSolver=new gu(this.body,this.physicsBody,t)):(t=this.options.barnesHut,this.nodesSolver=new gl(this.body,this.physicsBody,t),this.edgesSolver=new gd(this.body,this.physicsBody,t)),this.gravitySolver=new gf(this.body,this.physicsBody,t)),this.modelOptions=t}},{key:"initPhysics",value:function(){!0===this.physicsEnabled&&!0===this.options.enabled?!0===this.options.stabilization.enabled?this.stabilize():(this.stabilized=!1,this.ready=!0,this.body.emitter.emit("fit",{},this.layoutFailed),this.startSimulation()):(this.ready=!0,this.body.emitter.emit("fit"))}},{key:"startSimulation",value:function(){if(!0===this.physicsEnabled&&!0===this.options.enabled){if(this.stabilized=!1,this.adaptiveTimestep=!1,this.body.emitter.emit("_resizeNodes"),void 0===this.viewFunction){var t;this.viewFunction=e7(t=this.simulationStep).call(t,this),this.body.emitter.on("initRedraw",this.viewFunction),this.body.emitter.emit("_startRendering")}}else this.body.emitter.emit("_redraw")}},{key:"stopSimulation",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.stabilized=!0,!0===t&&this._emitStabilized(),void 0!==this.viewFunction&&(this.body.emitter.off("initRedraw",this.viewFunction),this.viewFunction=void 0,!0===t&&this.body.emitter.emit("_stopRendering"))}},{key:"simulationStep",value:function(){var t=sm();this.physicsTick(),(sm()-t<.4*this.simulationInterval||!0===this.runDoubleSpeed)&&!1===this.stabilized&&(this.physicsTick(),this.runDoubleSpeed=!0),!0===this.stabilized&&this.stopSimulation()}},{key:"_emitStabilized",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stabilizationIterations;(this.stabilizationIterations>1||!0===this.startedStabilization)&&aB(function(){t.body.emitter.emit("stabilized",{iterations:e}),t.startedStabilization=!1,t.stabilizationIterations=0},0)}},{key:"physicsStep",value:function(){this.gravitySolver.solve(),this.nodesSolver.solve(),this.edgesSolver.solve(),this.moveNodes()}},{key:"adjustTimeStep",value:function(){!0===this._evaluateStepQuality()?this.timestep=1.2*this.timestep:this.timestep/1.2<this.options.timestep?this.timestep=this.options.timestep:(this.adaptiveCounter=-1,this.timestep=Math.max(this.options.timestep,this.timestep/1.2))}},{key:"physicsTick",value:function(){this._startStabilizing(),!0!==this.stabilized&&(!0===this.adaptiveTimestep&&!0===this.adaptiveTimestepEnabled?(this.adaptiveCounter%this.adaptiveInterval==0?(this.timestep=2*this.timestep,this.physicsStep(),this.revert(),this.timestep=.5*this.timestep,this.physicsStep(),this.physicsStep(),this.adjustTimeStep()):this.physicsStep(),this.adaptiveCounter+=1):(this.timestep=this.options.timestep,this.physicsStep()),!0===this.stabilized&&this.revert(),this.stabilizationIterations++)}},{key:"updatePhysicsData",value:function(){this.physicsBody.forces={},this.physicsBody.physicsNodeIndices=[],this.physicsBody.physicsEdgeIndices=[];var t=this.body.nodes,e=this.body.edges;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&!0===t[i].options.physics&&this.physicsBody.physicsNodeIndices.push(t[i].id);for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&!0===e[n].options.physics&&this.physicsBody.physicsEdgeIndices.push(e[n].id);for(var o=0;o<this.physicsBody.physicsNodeIndices.length;o++){var r=this.physicsBody.physicsNodeIndices[o];this.physicsBody.forces[r]={x:0,y:0},void 0===this.physicsBody.velocities[r]&&(this.physicsBody.velocities[r]={x:0,y:0})}for(var s in this.physicsBody.velocities)void 0===t[s]&&delete this.physicsBody.velocities[s]}},{key:"revert",value:function(){var t=sf(this.previousStates),e=this.body.nodes,i=this.physicsBody.velocities;this.referenceState={};for(var n=0;n<t.length;n++){var o=t[n];void 0!==e[o]?!0===e[o].options.physics&&(this.referenceState[o]={positions:{x:e[o].x,y:e[o].y}},i[o].x=this.previousStates[o].vx,i[o].y=this.previousStates[o].vy,e[o].x=this.previousStates[o].x,e[o].y=this.previousStates[o].y):delete this.previousStates[o]}}},{key:"_evaluateStepQuality",value:function(){var t=this.body.nodes,e=this.referenceState;for(var i in this.referenceState)if(Object.prototype.hasOwnProperty.call(this.referenceState,i)&&void 0!==t[i]&&Math.sqrt(Math.pow(t[i].x-e[i].positions.x,2)+Math.pow(t[i].y-e[i].positions.y,2))>.3)return!1;return!0}},{key:"moveNodes",value:function(){for(var t=this.physicsBody.physicsNodeIndices,e=0,i=0,n=0;n<t.length;n++){var o=t[n],r=this._performStep(o);e=Math.max(e,r),i+=r}this.adaptiveTimestepEnabled=i/t.length<5,this.stabilized=e<this.options.minVelocity}},{key:"calculateComponentVelocity",value:function(t,e,i){var n=this.modelOptions.damping*t;t+=(e-n)/i*this.timestep;var o=this.options.maxVelocity||1e9;return Math.abs(t)>o&&(t=t>0?o:-o),t}},{key:"_performStep",value:function(t){var e=this.body.nodes[t],i=this.physicsBody.forces[t];this.options.wind&&(i.x+=this.options.wind.x,i.y+=this.options.wind.y);var n=this.physicsBody.velocities[t];return this.previousStates[t]={x:e.x,y:e.y,vx:n.x,vy:n.y},!1===e.options.fixed.x?(n.x=this.calculateComponentVelocity(n.x,i.x,e.options.mass),e.x+=n.x*this.timestep):(i.x=0,n.x=0),!1===e.options.fixed.y?(n.y=this.calculateComponentVelocity(n.y,i.y,e.options.mass),e.y+=n.y*this.timestep):(i.y=0,n.y=0),Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}},{key:"_freezeNodes",value:function(){var t=this.body.nodes;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e].x&&t[e].y){var i=t[e].options.fixed;this.freezeCache[e]={x:i.x,y:i.y},i.x=!0,i.y=!0}}},{key:"_restoreFrozenNodes",value:function(){var t=this.body.nodes;for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&void 0!==this.freezeCache[e]&&(t[e].options.fixed.x=this.freezeCache[e].x,t[e].options.fixed.y=this.freezeCache[e].y);this.freezeCache={}}},{key:"stabilize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.stabilization.iterations;if("number"!=typeof e&&console.error("The stabilize method needs a numeric amount of iterations. Switching to default: ",e=this.options.stabilization.iterations),0===this.physicsBody.physicsNodeIndices.length){this.ready=!0;return}this.adaptiveTimestep=this.options.adaptiveTimestep,this.body.emitter.emit("_resizeNodes"),this.stopSimulation(),this.stabilized=!1,this.body.emitter.emit("_blockRedraw"),this.targetIterations=e,!0===this.options.stabilization.onlyDynamicEdges&&this._freezeNodes(),this.stabilizationIterations=0,aB(function(){return t._stabilizationBatch()},0)}},{key:"_startStabilizing",value:function(){return!0!==this.startedStabilization&&(this.body.emitter.emit("startStabilizing"),this.startedStabilization=!0,!0)}},{key:"_stabilizationBatch",value:function(){var t,e=this,i=function(){return!1===e.stabilized&&e.stabilizationIterations<e.targetIterations},n=function(){e.body.emitter.emit("stabilizationProgress",{iterations:e.stabilizationIterations,total:e.targetIterations})};this._startStabilizing()&&n();for(var o=0;i()&&o<this.options.stabilization.updateInterval;)this.physicsTick(),o++;n(),i()?aB(e7(t=this._stabilizationBatch).call(t,this),0):this._finalizeStabilization()}},{key:"_finalizeStabilization",value:function(){this.body.emitter.emit("_allowRedraw"),!0===this.options.stabilization.fit&&this.body.emitter.emit("fit"),!0===this.options.stabilization.onlyDynamicEdges&&this._restoreFrozenNodes(),this.body.emitter.emit("stabilizationIterationsDone"),this.body.emitter.emit("_requestRedraw"),!0===this.stabilized?this._emitStabilized():this.startSimulation(),this.ready=!0}},{key:"_drawForces",value:function(t){for(var e=0;e<this.physicsBody.physicsNodeIndices.length;e++){var i=this.physicsBody.physicsNodeIndices[e],n=this.body.nodes[i],o=this.physicsBody.forces[i],r=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.x,2)),s=Math.min(Math.max(5,r),15),a=3*s,l=hP((180-180*Math.min(1,Math.max(0,.03*r)))/360,1,1),h={x:n.x+20*o.x,y:n.y+20*o.y};t.lineWidth=s,t.strokeStyle=l,t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(h.x,h.y),t.stroke();var c=Math.atan2(o.y,o.x);t.fillStyle=l,p4.draw(t,{type:"arrow",point:h,angle:c,length:a}),aN(t).call(t)}}}]),t}(),gv=function(){function t(){n4(this,t)}return rH(t,null,[{key:"getRange",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=1e9,o=-1e9,r=1e9,s=-1e9;if(i.length>0)for(var a=0;a<i.length;a++)r>(e=t[i[a]]).shape.boundingBox.left&&(r=e.shape.boundingBox.left),s<e.shape.boundingBox.right&&(s=e.shape.boundingBox.right),n>e.shape.boundingBox.top&&(n=e.shape.boundingBox.top),o<e.shape.boundingBox.bottom&&(o=e.shape.boundingBox.bottom);return 1e9===r&&-1e9===s&&1e9===n&&-1e9===o&&(n=0,o=0,r=0,s=0),{minX:r,maxX:s,minY:n,maxY:o}}},{key:"getRangeCore",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=1e9,o=-1e9,r=1e9,s=-1e9;if(i.length>0)for(var a=0;a<i.length;a++)r>(e=t[i[a]]).x&&(r=e.x),s<e.x&&(s=e.x),n>e.y&&(n=e.y),o<e.y&&(o=e.y);return 1e9===r&&-1e9===s&&1e9===n&&-1e9===o&&(n=0,o=0,r=0,s=0),{minX:r,maxX:s,minY:n,maxY:o}}},{key:"findCenter",value:function(t){return{x:.5*(t.maxX+t.minX),y:.5*(t.maxY+t.minY)}}},{key:"cloneOptions",value:function(t,e){var i={};return void 0===e||"node"===e?(hm(i,t.options,!0),i.x=t.x,i.y=t.y,i.amountOfConnections=t.edges.length):hm(i,t.options,!0),i}}]),t}(),gy=function(t){c5(n,t);var e,i=(e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=c8(n);return t=e?fO(i,arguments,c8(this).constructor):i.apply(this,arguments),c3(this,t)});function n(t,e,o,r,s,a){var l;return n4(this,n),(l=i.call(this,t,e,o,r,s,a)).isCluster=!0,l.containedNodes={},l.containedEdges={},l}return rH(n,[{key:"_openChildCluster",value:function(t){var e=this,i=this.body.nodes[t];if(void 0===this.containedNodes[t])throw Error("node with id: "+t+" not in current cluster");if(!i.isCluster)throw Error("node with id: "+t+" is not a cluster");delete this.containedNodes[t],hx(i.edges,function(t){delete e.containedEdges[t.id]}),hx(i.containedNodes,function(t,i){e.containedNodes[i]=t}),i.containedNodes={},hx(i.containedEdges,function(t,i){e.containedEdges[i]=t}),i.containedEdges={},hx(i.edges,function(t){hx(e.edges,function(i){var n,o,r=ab(n=i.clusteringEdgeReplacingIds).call(n,t.id);-1!==r&&(hx(t.clusteringEdgeReplacingIds,function(t){i.clusteringEdgeReplacingIds.push(t),e.body.edges[t].edgeReplacedById=i.id}),sL(o=i.clusteringEdgeReplacingIds).call(o,r,1))})}),i.edges=[]}}]),n}(pz),gb=function(){function t(e){var i=this;n4(this,t),this.body=e,this.clusteredNodes={},this.clusteredEdges={},this.options={},this.defaultOptions={},eK(this.options,this.defaultOptions),this.body.emitter.on("_resetData",function(){i.clusteredNodes={},i.clusteredEdges={}})}return rH(t,[{key:"clusterByHubsize",value:function(t,e){void 0===t?t=this._getHubSize():"object"===rN(t)&&(e=this._checkOptions(t),t=this._getHubSize());for(var i=[],n=0;n<this.body.nodeIndices.length;n++){var o=this.body.nodes[this.body.nodeIndices[n]];o.edges.length>=t&&i.push(o.id)}for(var r=0;r<i.length;r++)this.clusterByConnection(i[r],e,!0);this.body.emitter.emit("_dataChanged")}},{key:"cluster",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(void 0===e.joinCondition)throw Error("Cannot call clusterByNodeData without a joinCondition function in the options.");e=this._checkOptions(e);var n={},o={};hx(this.body.nodes,function(i,r){i.options&&!0===e.joinCondition(i.options)&&(n[r]=i,hx(i.edges,function(e){void 0===t.clusteredEdges[e.id]&&(o[e.id]=e)}))}),this._cluster(n,o,e,i)}},{key:"clusterByEdgeCount",value:function(t,e){var i,n,o,r=this,s=!(arguments.length>2)||void 0===arguments[2]||arguments[2];e=this._checkOptions(e);for(var a=[],l={},h=0;h<this.body.nodeIndices.length;h++)!function(){var s={},c={},d=r.body.nodeIndices[h],u=r.body.nodes[d];if(void 0===l[d]){o=0,n=[];for(var f=0;f<u.edges.length;f++)i=u.edges[f],void 0===r.clusteredEdges[i.id]&&(i.toId!==i.fromId&&o++,n.push(i));if(o===t){for(var p=!0,g=0;g<n.length;g++){i=n[g];var m=r._getConnectedId(i,d);if(function(t){if(void 0===e.joinCondition||null===e.joinCondition)return!0;var i=gv.cloneOptions(t);return e.joinCondition(i)}(u))c[i.id]=i,s[d]=u,s[m]=r.body.nodes[m],l[d]=!0;else{p=!1;break}}if(sf(s).length>0&&sf(c).length>0&&!0===p){var v=function(){for(var t=0;t<a.length;++t)for(var e in s)if(void 0!==a[t].nodes[e])return a[t]}();if(void 0!==v){for(var y in s)void 0===v.nodes[y]&&(v.nodes[y]=s[y]);for(var b in c)void 0===v.edges[b]&&(v.edges[b]=c[b])}else a.push({nodes:s,edges:c})}}}}();for(var c=0;c<a.length;c++)this._cluster(a[c].nodes,a[c].edges,e,!1);!0===s&&this.body.emitter.emit("_dataChanged")}},{key:"clusterOutliers",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.clusterByEdgeCount(1,t,e)}},{key:"clusterBridges",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.clusterByEdgeCount(2,t,e)}},{key:"clusterByConnection",value:function(t,e){var i,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(void 0===t)throw Error("No nodeId supplied to clusterByConnection!");if(void 0===this.body.nodes[t])throw Error("The nodeId given to clusterByConnection does not exist!");var o=this.body.nodes[t];void 0===(e=this._checkOptions(e,o)).clusterNodeProperties.x&&(e.clusterNodeProperties.x=o.x),void 0===e.clusterNodeProperties.y&&(e.clusterNodeProperties.y=o.y),void 0===e.clusterNodeProperties.fixed&&(e.clusterNodeProperties.fixed={},e.clusterNodeProperties.fixed.x=o.options.fixed.x,e.clusterNodeProperties.fixed.y=o.options.fixed.y);var r={},s={},a=o.id,l=gv.cloneOptions(o);r[a]=o;for(var h=0;h<o.edges.length;h++){var c=o.edges[h];if(void 0===this.clusteredEdges[c.id]){var d=this._getConnectedId(c,a);if(void 0===this.clusteredNodes[d]){if(d!==a){if(void 0===e.joinCondition)s[c.id]=c,r[d]=this.body.nodes[d];else{var u=gv.cloneOptions(this.body.nodes[d]);!0===e.joinCondition(l,u)&&(s[c.id]=c,r[d]=this.body.nodes[d])}}else s[c.id]=c}}}var f=su(i=sf(r)).call(i,function(t){return r[t].id});for(var p in r)if(Object.prototype.hasOwnProperty.call(r,p))for(var g=r[p],m=0;m<g.edges.length;m++){var v=g.edges[m];ab(f).call(f,this._getConnectedId(v,g.id))>-1&&(s[v.id]=v)}this._cluster(r,s,e,n)}},{key:"_createClusterEdges",value:function(t,e,i,n){for(var o,r,s,a,l,h,c=sf(t),d=[],u=0;u<c.length;u++){s=t[r=c[u]];for(var f=0;f<s.edges.length;f++)o=s.edges[f],void 0===this.clusteredEdges[o.id]&&(o.toId==o.fromId?e[o.id]=o:o.toId==r?(a=i.id,h=l=o.fromId):(a=o.toId,l=i.id,h=a),void 0===t[h]&&d.push({edge:o,fromId:l,toId:a}))}for(var p=[],g=0;g<d.length;g++){var m=d[g],v=m.edge,y=function(t){for(var e=0;e<p.length;e++){var i=p[e],n=t.fromId===i.fromId&&t.toId===i.toId,o=t.fromId===i.toId&&t.toId===i.fromId;if(n||o)return i}return null}(m);null===y?(y=this._createClusteredEdge(m.fromId,m.toId,v,n),p.push(y)):y.clusteringEdgeReplacingIds.push(v.id),this.body.edges[v.id].edgeReplacedById=y.id,this._backupEdgeOptions(v),v.setOptions({physics:!1})}}},{key:"_checkOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===t.clusterEdgeProperties&&(t.clusterEdgeProperties={}),void 0===t.clusterNodeProperties&&(t.clusterNodeProperties={}),t}},{key:"_cluster",value:function(t,e,i){var n=!(arguments.length>3)||void 0===arguments[3]||arguments[3],o=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&void 0!==this.clusteredNodes[r]&&o.push(r);for(var s=0;s<o.length;++s)delete t[o[s]];if(0!=sf(t).length&&(1!=sf(t).length||!0==i.clusterNodeProperties.allowSingleNodeCluster)){var a=hm({},i.clusterNodeProperties);if(void 0!==i.processProperties){var l=[];for(var h in t)if(Object.prototype.hasOwnProperty.call(t,h)){var c=gv.cloneOptions(t[h]);l.push(c)}var d=[];for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)&&"clusterEdge:"!==u.substr(0,12)){var f=gv.cloneOptions(e[u],"edge");d.push(f)}if(!(a=i.processProperties(a,l,d)))throw Error("The processProperties function does not return properties!")}void 0===a.id&&(a.id="cluster:"+fj());var p=a.id;void 0===a.label&&(a.label="cluster");var g=void 0;void 0===a.x&&(g=this._getClusterPosition(t),a.x=g.x),void 0===a.y&&(void 0===g&&(g=this._getClusterPosition(t)),a.y=g.y),a.id=p;var m=this.body.functions.createNode(a,gy);m.containedNodes=t,m.containedEdges=e,m.clusterEdgeProperties=i.clusterEdgeProperties,this.body.nodes[a.id]=m,this._clusterEdges(t,e,a,i.clusterEdgeProperties),a.id=void 0,!0===n&&this.body.emitter.emit("_dataChanged")}}},{key:"_backupEdgeOptions",value:function(t){void 0===this.clusteredEdges[t.id]&&(this.clusteredEdges[t.id]={physics:t.options.physics})}},{key:"_restoreEdge",value:function(t){var e=this.clusteredEdges[t.id];void 0!==e&&(t.setOptions({physics:e.physics}),delete this.clusteredEdges[t.id])}},{key:"isCluster",value:function(t){return void 0!==this.body.nodes[t]?!0===this.body.nodes[t].isCluster:(console.error("Node does not exist."),!1)}},{key:"_getClusterPosition",value:function(t){for(var e,i=sf(t),n=t[i[0]].x,o=t[i[0]].x,r=t[i[0]].y,s=t[i[0]].y,a=1;a<i.length;a++)n=(e=t[i[a]]).x<n?e.x:n,o=e.x>o?e.x:o,r=e.y<r?e.y:r,s=e.y>s?e.y:s;return{x:.5*(n+o),y:.5*(r+s)}}},{key:"openCluster",value:function(t,e){var i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(void 0===t)throw Error("No clusterNodeId supplied to openCluster.");var n=this.body.nodes[t];if(void 0===n)throw Error("The clusterNodeId supplied to openCluster does not exist.");if(!0!==n.isCluster||void 0===n.containedNodes||void 0===n.containedEdges)throw Error("The node:"+t+" is not a valid cluster.");var o=this.findNode(t),r=ab(o).call(o,t)-1;if(r>=0){var s=o[r];this.body.nodes[s]._openChildCluster(t),delete this.body.nodes[t],!0===i&&this.body.emitter.emit("_dataChanged");return}var a=n.containedNodes,l=n.containedEdges;if(void 0!==e&&void 0!==e.releaseFunction&&"function"==typeof e.releaseFunction){var h={},c={x:n.x,y:n.y};for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d)){var u=this.body.nodes[d];h[d]={x:u.x,y:u.y}}var f=e.releaseFunction(c,h);for(var p in a)if(Object.prototype.hasOwnProperty.call(a,p)){var g=this.body.nodes[p];void 0!==f[p]&&(g.x=void 0===f[p].x?n.x:f[p].x,g.y=void 0===f[p].y?n.y:f[p].y)}}else hx(a,function(t){!1===t.options.fixed.x&&(t.x=n.x),!1===t.options.fixed.y&&(t.y=n.y)});for(var m in a)if(Object.prototype.hasOwnProperty.call(a,m)){var v=this.body.nodes[m];v.vx=n.vx,v.vy=n.vy,v.setOptions({physics:!0}),delete this.clusteredNodes[m]}for(var y=[],b=0;b<n.edges.length;b++)y.push(n.edges[b]);for(var w=0;w<y.length;w++){for(var x=y[w],k=this._getConnectedId(x,t),O=this.clusteredNodes[k],S=0;S<x.clusteringEdgeReplacingIds.length;S++){var _=x.clusteringEdgeReplacingIds[S],C=this.body.edges[_];if(void 0!==C){if(void 0!==O){var E=this.body.nodes[O.clusterId];E.containedEdges[C.id]=C,delete l[C.id];var M=C.fromId,P=C.toId;C.toId==k?P=O.clusterId:M=O.clusterId,this._createClusteredEdge(M,P,C,E.clusterEdgeProperties,{hidden:!1,physics:!0})}else this._restoreEdge(C)}}x.remove()}for(var T in l)Object.prototype.hasOwnProperty.call(l,T)&&this._restoreEdge(l[T]);delete this.body.nodes[t],!0===i&&this.body.emitter.emit("_dataChanged")}},{key:"getNodesInCluster",value:function(t){var e=[];if(!0===this.isCluster(t)){var i=this.body.nodes[t].containedNodes;for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.push(this.body.nodes[n].id)}return e}},{key:"findNode",value:function(t){for(var e,i=[],n=0;void 0!==this.clusteredNodes[t]&&n<100;){if(void 0===(e=this.body.nodes[t]))return[];i.push(e.id),t=this.clusteredNodes[t].clusterId,n++}return void 0===(e=this.body.nodes[t])?[]:(i.push(e.id),sT(i).call(i),i)}},{key:"updateClusteredNode",value:function(t,e){if(void 0===t)throw Error("No clusteredNodeId supplied to updateClusteredNode.");if(void 0===e)throw Error("No newOptions supplied to updateClusteredNode.");if(void 0===this.body.nodes[t])throw Error("The clusteredNodeId supplied to updateClusteredNode does not exist.");this.body.nodes[t].setOptions(e),this.body.emitter.emit("_dataChanged")}},{key:"updateEdge",value:function(t,e){if(void 0===t)throw Error("No startEdgeId supplied to updateEdge.");if(void 0===e)throw Error("No newOptions supplied to updateEdge.");if(void 0===this.body.edges[t])throw Error("The startEdgeId supplied to updateEdge does not exist.");for(var i=this.getClusteredEdges(t),n=0;n<i.length;n++)this.body.edges[i[n]].setOptions(e);this.body.emitter.emit("_dataChanged")}},{key:"getClusteredEdges",value:function(t){for(var e=[],i=0;void 0!==t&&void 0!==this.body.edges[t]&&i<100;)e.push(this.body.edges[t].id),t=this.body.edges[t].edgeReplacedById,i++;return sT(e).call(e),e}},{key:"getBaseEdge",value:function(t){return this.getBaseEdges(t)[0]}},{key:"getBaseEdges",value:function(t){for(var e=[t],i=[],n=[],o=0;e.length>0&&o<100;){var r=e.pop();if(void 0!==r){var s=this.body.edges[r];if(void 0!==s){o++;var a=s.clusteringEdgeReplacingIds;if(void 0===a)n.push(r);else for(var l=0;l<a.length;++l){var h=a[l];-1===ab(e).call(e,a)&&-1===ab(i).call(i,a)&&e.push(h)}i.push(r)}}}return n}},{key:"_getConnectedId",value:function(t,e){return t.toId!=e?t.toId:(t.fromId,t.fromId)}},{key:"_getHubSize",value:function(){for(var t=0,e=0,i=0,n=0,o=0;o<this.body.nodeIndices.length;o++){var r=this.body.nodes[this.body.nodeIndices[o]];r.edges.length>n&&(n=r.edges.length),t+=r.edges.length,e+=Math.pow(r.edges.length,2),i+=1}t/=i;var s=Math.sqrt((e/=i)-Math.pow(t,2)),a=Math.floor(t+2*s);return a>n&&(a=n),a}},{key:"_createClusteredEdge",value:function(t,e,i,n,o){var r=gv.cloneOptions(i,"edge");hm(r,n),r.from=t,r.to=e,r.id="clusterEdge:"+fj(),void 0!==o&&hm(r,o);var s=this.body.functions.createEdge(r);return s.clusteringEdgeReplacingIds=[i.id],s.connect(),this.body.edges[s.id]=s,s}},{key:"_clusterEdges",value:function(t,e,i,n){if(e instanceof gs){var o=e,r={};r[o.id]=o,e=r}if(t instanceof pz){var s=t,a={};a[s.id]=s,t=a}if(null==i)throw Error("_clusterEdges: parameter clusterNode required");for(var l in void 0===n&&(n=i.clusterEdgeProperties),this._createClusterEdges(t,e,i,n),e)if(Object.prototype.hasOwnProperty.call(e,l)&&void 0!==this.body.edges[l]){var h=this.body.edges[l];this._backupEdgeOptions(h),h.setOptions({physics:!1})}for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(this.clusteredNodes[c]={clusterId:i.id,node:this.body.nodes[c]},this.body.nodes[c].setOptions({physics:!1}))}},{key:"_getClusterNodeForNode",value:function(t){if(void 0!==t){var e=this.clusteredNodes[t];if(void 0!==e){var i=e.clusterId;if(void 0!==i)return this.body.nodes[i]}}}},{key:"_filter",value:function(t,e){var i=[];return hx(t,function(t){e(t)&&i.push(t)}),i}},{key:"_updateState",value:function(){var t,e=this,i=[],n={},o=function(t){hx(e.body.nodes,function(e){!0===e.isCluster&&t(e)})};for(t in this.clusteredNodes)Object.prototype.hasOwnProperty.call(this.clusteredNodes,t)&&void 0===this.body.nodes[t]&&i.push(t);o(function(t){for(var e=0;e<i.length;e++)delete t.containedNodes[i[e]]});for(var r=0;r<i.length;r++)delete this.clusteredNodes[i[r]];hx(this.clusteredEdges,function(t){var i=e.body.edges[t];void 0!==i&&i.endPointsValid()||(n[t]=t)}),o(function(t){hx(t.containedEdges,function(t,e){t.endPointsValid()||n[e]||(n[e]=e)})}),hx(this.body.edges,function(t,i){var o=!0,r=t.clusteringEdgeReplacingIds;if(void 0!==r){var s=0;hx(r,function(t){var i=e.body.edges[t];void 0!==i&&i.endPointsValid()&&(s+=1)}),o=s>0}t.endPointsValid()&&o||(n[i]=i)}),o(function(t){hx(n,function(i){delete t.containedEdges[i],hx(t.edges,function(o,r){if(o.id===i){t.edges[r]=null;return}o.clusteringEdgeReplacingIds=e._filter(o.clusteringEdgeReplacingIds,function(t){return!n[t]})}),t.edges=e._filter(t.edges,function(t){return null!==t})})}),hx(n,function(t){delete e.clusteredEdges[t]}),hx(n,function(t){delete e.body.edges[t]}),hx(sf(this.body.edges),function(t){var i=e.body.edges[t],n=e._isClusteredNode(i.fromId)||e._isClusteredNode(i.toId);if(n!==e._isClusteredEdge(i.id)){if(n){var o=e._getClusterNodeForNode(i.fromId);void 0!==o&&e._clusterEdges(e.body.nodes[i.fromId],i,o);var r=e._getClusterNodeForNode(i.toId);void 0!==r&&e._clusterEdges(e.body.nodes[i.toId],i,r)}else delete e._clusterEdges[t],e._restoreEdge(i)}});for(var s=!1,a=!0;a;)!function(){var t=[];o(function(e){var i=sf(e.containedNodes).length,n=!0===e.options.allowSingleNodeCluster;(n&&i<1||!n&&i<2)&&t.push(e.id)});for(var i=0;i<t.length;++i)e.openCluster(t[i],{},!1);a=t.length>0,s=s||a}();s&&this._updateState()}},{key:"_isClusteredNode",value:function(t){return void 0!==this.clusteredNodes[t]}},{key:"_isClusteredEdge",value:function(t){return void 0!==this.clusteredEdges[t]}}]),t}(),gw=function(){function t(e,i){var n;n4(this,t),void 0!==window&&(n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),void 0===n?window.requestAnimationFrame=function(t){t()}:window.requestAnimationFrame=n,this.body=e,this.canvas=i,this.redrawRequested=!1,this.renderTimer=void 0,this.requiresTimeout=!0,this.renderingActive=!1,this.renderRequests=0,this.allowRedraw=!0,this.dragging=!1,this.zooming=!1,this.options={},this.defaultOptions={hideEdgesOnDrag:!1,hideEdgesOnZoom:!1,hideNodesOnDrag:!1},eK(this.options,this.defaultOptions),this._determineBrowserMethod(),this.bindEventListeners()}return rH(t,[{key:"bindEventListeners",value:function(){var t,e=this;this.body.emitter.on("dragStart",function(){e.dragging=!0}),this.body.emitter.on("dragEnd",function(){e.dragging=!1}),this.body.emitter.on("zoom",function(){e.zooming=!0,window.clearTimeout(e.zoomTimeoutId),e.zoomTimeoutId=aB(function(){var t;e.zooming=!1,e7(t=e._requestRedraw).call(t,e)()},250)}),this.body.emitter.on("_resizeNodes",function(){e._resizeNodes()}),this.body.emitter.on("_redraw",function(){!1===e.renderingActive&&e._redraw()}),this.body.emitter.on("_blockRedraw",function(){e.allowRedraw=!1}),this.body.emitter.on("_allowRedraw",function(){e.allowRedraw=!0,e.redrawRequested=!1}),this.body.emitter.on("_requestRedraw",e7(t=this._requestRedraw).call(t,this)),this.body.emitter.on("_startRendering",function(){e.renderRequests+=1,e.renderingActive=!0,e._startRendering()}),this.body.emitter.on("_stopRendering",function(){e.renderRequests-=1,e.renderingActive=e.renderRequests>0,e.renderTimer=void 0}),this.body.emitter.on("destroy",function(){e.renderRequests=0,e.allowRedraw=!1,e.renderingActive=!1,!0===e.requiresTimeout?clearTimeout(e.renderTimer):window.cancelAnimationFrame(e.renderTimer),e.body.emitter.off()})}},{key:"setOptions",value:function(t){void 0!==t&&hp(["hideEdgesOnDrag","hideEdgesOnZoom","hideNodesOnDrag"],this.options,t)}},{key:"_requestNextFrame",value:function(t,e){if("undefined"!=typeof window){var i,n=window;return!0===this.requiresTimeout?i=aB(t,e):n.requestAnimationFrame&&(i=n.requestAnimationFrame(t)),i}}},{key:"_startRendering",value:function(){if(!0===this.renderingActive&&void 0===this.renderTimer){var t;this.renderTimer=this._requestNextFrame(e7(t=this._renderStep).call(t,this),this.simulationInterval)}}},{key:"_renderStep",value:function(){!0===this.renderingActive&&(this.renderTimer=void 0,!0===this.requiresTimeout&&this._startRendering(),this._redraw(),!1===this.requiresTimeout&&this._startRendering())}},{key:"redraw",value:function(){this.body.emitter.emit("setSize"),this._redraw()}},{key:"_requestRedraw",value:function(){var t=this;!0!==this.redrawRequested&&!1===this.renderingActive&&!0===this.allowRedraw&&(this.redrawRequested=!0,this._requestNextFrame(function(){t._redraw(!1)},0))}},{key:"_redraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!0===this.allowRedraw){this.body.emitter.emit("initRedraw"),this.redrawRequested=!1;var e={drawExternalLabels:null};(0===this.canvas.frame.canvas.width||0===this.canvas.frame.canvas.height)&&this.canvas.setSize(),this.canvas.setTransform();var i=this.canvas.getContext(),n=this.canvas.frame.canvas.clientWidth,o=this.canvas.frame.canvas.clientHeight;if(i.clearRect(0,0,n,o),0===this.canvas.frame.clientWidth)return;if(i.save(),i.translate(this.body.view.translation.x,this.body.view.translation.y),i.scale(this.body.view.scale,this.body.view.scale),i.beginPath(),this.body.emitter.emit("beforeDrawing",i),i.closePath(),!1===t&&(!1===this.dragging||!0===this.dragging&&!1===this.options.hideEdgesOnDrag)&&(!1===this.zooming||!0===this.zooming&&!1===this.options.hideEdgesOnZoom)&&this._drawEdges(i),!1===this.dragging||!0===this.dragging&&!1===this.options.hideNodesOnDrag){var r=this._drawNodes(i,t).drawExternalLabels;e.drawExternalLabels=r}!1===t&&(!1===this.dragging||!0===this.dragging&&!1===this.options.hideEdgesOnDrag)&&(!1===this.zooming||!0===this.zooming&&!1===this.options.hideEdgesOnZoom)&&this._drawArrows(i),null!=e.drawExternalLabels&&e.drawExternalLabels(),!1===t&&this._drawSelectionBox(i),i.beginPath(),this.body.emitter.emit("afterDrawing",i),i.closePath(),i.restore(),!0===t&&i.clearRect(0,0,n,o)}}},{key:"_resizeNodes",value:function(){this.canvas.setTransform();var t,e=this.canvas.getContext();e.save(),e.translate(this.body.view.translation.x,this.body.view.translation.y),e.scale(this.body.view.scale,this.body.view.scale);var i=this.body.nodes;for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&((t=i[n]).resize(e),t.updateBoundingBox(e,t.selected));e.restore()}},{key:"_drawNodes",value:function(t){for(var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.body.nodes,r=this.body.nodeIndices,s=[],a=[],l=this.canvas.DOMtoCanvas({x:-20,y:-20}),h=this.canvas.DOMtoCanvas({x:this.canvas.frame.canvas.clientWidth+20,y:this.canvas.frame.canvas.clientHeight+20}),c={top:l.y,left:l.x,bottom:h.y,right:h.x},d=[],u=0;u<r.length;u++)if((e=o[r[u]]).hover)a.push(r[u]);else if(e.isSelected())s.push(r[u]);else if(!0===n){var f=e.draw(t);null!=f.drawExternalLabel&&d.push(f.drawExternalLabel)}else if(!0===e.isBoundingBoxOverlappingWith(c)){var p=e.draw(t);null!=p.drawExternalLabel&&d.push(p.drawExternalLabel)}else e.updateBoundingBox(t,e.selected);var g=s.length,m=a.length;for(i=0;i<g;i++){var v=(e=o[s[i]]).draw(t);null!=v.drawExternalLabel&&d.push(v.drawExternalLabel)}for(i=0;i<m;i++){var y=(e=o[a[i]]).draw(t);null!=y.drawExternalLabel&&d.push(y.drawExternalLabel)}return{drawExternalLabels:function(){for(var t=0;t<d.length;t++)(0,d[t])()}}}},{key:"_drawEdges",value:function(t){for(var e=this.body.edges,i=this.body.edgeIndices,n=0;n<i.length;n++){var o=e[i[n]];!0===o.connected&&o.draw(t)}}},{key:"_drawArrows",value:function(t){for(var e=this.body.edges,i=this.body.edgeIndices,n=0;n<i.length;n++){var o=e[i[n]];!0===o.connected&&o.drawArrows(t)}}},{key:"_determineBrowserMethod",value:function(){if("undefined"!=typeof window){var t=navigator.userAgent.toLowerCase();this.requiresTimeout=!1,-1!=ab(t).call(t,"msie 9.0")?this.requiresTimeout=!0:-1!=ab(t).call(t,"safari")&&-1>=ab(t).call(t,"chrome")&&(this.requiresTimeout=!0)}else this.requiresTimeout=!0}},{key:"_drawSelectionBox",value:function(t){if(this.body.selectionBox.show){t.beginPath();var e=this.body.selectionBox.position.end.x-this.body.selectionBox.position.start.x,i=this.body.selectionBox.position.end.y-this.body.selectionBox.position.start.y;t.rect(this.body.selectionBox.position.start.x,this.body.selectionBox.position.start.y,e,i),t.fillStyle="rgba(151, 194, 252, 0.2)",t.fillRect(this.body.selectionBox.position.start.x,this.body.selectionBox.position.start.y,e,i),t.strokeStyle="rgba(151, 194, 252, 1)",t.stroke()}else t.closePath()}}]),t}(),gx=N(tk.setInterval);function gk(t,e){e.inputHandler=function(t){t.isFirst&&e(t)},t.on("hammer.input",e.inputHandler)}function gO(t,e){return e.inputHandler=function(t){t.isFinal&&e(t)},t.on("hammer.input",e.inputHandler)}var gS=function(){function t(e){n4(this,t),this.body=e,this.pixelRatio=1,this.cameraState={},this.initialized=!1,this.canvasViewCenter={},this._cleanupCallbacks=[],this.options={},this.defaultOptions={autoResize:!0,height:"100%",width:"100%"},eK(this.options,this.defaultOptions),this.bindEventListeners()}return rH(t,[{key:"bindEventListeners",value:function(){var t,e=this;this.body.emitter.once("resize",function(t){0!==t.width&&(e.body.view.translation.x=.5*t.width),0!==t.height&&(e.body.view.translation.y=.5*t.height)}),this.body.emitter.on("setSize",e7(t=this.setSize).call(t,this)),this.body.emitter.on("destroy",function(){e.hammerFrame.destroy(),e.hammer.destroy(),e._cleanUp()})}},{key:"setOptions",value:function(t){var e=this;if(void 0!==t&&hp(["width","height","autoResize"],this.options,t),this._cleanUp(),!0===this.options.autoResize){if(window.ResizeObserver){var i,n=new ResizeObserver(function(){!0===e.setSize()&&e.body.emitter.emit("_requestRedraw")}),o=this.frame;n.observe(o),this._cleanupCallbacks.push(function(){n.unobserve(o)})}else{var r=gx(function(){!0===e.setSize()&&e.body.emitter.emit("_requestRedraw")},1e3);this._cleanupCallbacks.push(function(){clearInterval(r)})}var s=e7(i=this._onResize).call(i,this);window.addEventListener("resize",s),this._cleanupCallbacks.push(function(){window.removeEventListener("resize",s)})}}},{key:"_cleanUp",value:function(){var t,e,i;sS(t=sT(e=sL(i=this._cleanupCallbacks).call(i,0)).call(e)).call(t,function(t){try{t()}catch(t){console.error(t)}})}},{key:"_onResize",value:function(){this.setSize(),this.body.emitter.emit("_redraw")}},{key:"_getCameraState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pixelRatio;!0===this.initialized&&(this.cameraState.previousWidth=this.frame.canvas.width/t,this.cameraState.previousHeight=this.frame.canvas.height/t,this.cameraState.scale=this.body.view.scale,this.cameraState.position=this.DOMtoCanvas({x:.5*this.frame.canvas.width/t,y:.5*this.frame.canvas.height/t}))}},{key:"_setCameraState",value:function(){if(void 0!==this.cameraState.scale&&0!==this.frame.canvas.clientWidth&&0!==this.frame.canvas.clientHeight&&0!==this.pixelRatio&&this.cameraState.previousWidth>0&&this.cameraState.previousHeight>0){var t=this.frame.canvas.width/this.pixelRatio/this.cameraState.previousWidth,e=this.frame.canvas.height/this.pixelRatio/this.cameraState.previousHeight,i=this.cameraState.scale;1!=t&&1!=e?i=.5*this.cameraState.scale*(t+e):1!=t?i=this.cameraState.scale*t:1!=e&&(i=this.cameraState.scale*e),this.body.view.scale=i;var n=this.DOMtoCanvas({x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight}),o={x:n.x-this.cameraState.position.x,y:n.y-this.cameraState.position.y};this.body.view.translation.x+=o.x*this.body.view.scale,this.body.view.translation.y+=o.y*this.body.view.scale}}},{key:"_prepareValue",value:function(t){if("number"==typeof t)return t+"px";if("string"==typeof t){if(-1!==ab(t).call(t,"%")||-1!==ab(t).call(t,"px"))return t;if(-1===ab(t).call(t,"%"))return t+"px"}throw Error("Could not use the value supplied for width or height:"+t)}},{key:"_create",value:function(){for(;this.body.container.hasChildNodes();)this.body.container.removeChild(this.body.container.firstChild);if(this.frame=document.createElement("div"),this.frame.className="vis-network",this.frame.style.position="relative",this.frame.style.overflow="hidden",this.frame.tabIndex=0,this.frame.canvas=document.createElement("canvas"),this.frame.canvas.style.position="relative",this.frame.appendChild(this.frame.canvas),this.frame.canvas.getContext)this._setPixelRatio(),this.setTransform();else{var t=document.createElement("DIV");t.style.color="red",t.style.fontWeight="bold",t.style.padding="10px",t.innerText="Error: your browser does not support HTML canvas",this.frame.canvas.appendChild(t)}this.body.container.appendChild(this.frame),this.body.view.scale=1,this.body.view.translation={x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight},this._bindHammer()}},{key:"_bindHammer",value:function(){var t=this;void 0!==this.hammer&&this.hammer.destroy(),this.drag={},this.pinch={},this.hammer=new hq(this.frame.canvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.get("pan").set({threshold:5,direction:hq.DIRECTION_ALL}),gk(this.hammer,function(e){t.body.eventListeners.onTouch(e)}),this.hammer.on("tap",function(e){t.body.eventListeners.onTap(e)}),this.hammer.on("doubletap",function(e){t.body.eventListeners.onDoubleTap(e)}),this.hammer.on("press",function(e){t.body.eventListeners.onHold(e)}),this.hammer.on("panstart",function(e){t.body.eventListeners.onDragStart(e)}),this.hammer.on("panmove",function(e){t.body.eventListeners.onDrag(e)}),this.hammer.on("panend",function(e){t.body.eventListeners.onDragEnd(e)}),this.hammer.on("pinch",function(e){t.body.eventListeners.onPinch(e)}),this.frame.canvas.addEventListener("wheel",function(e){t.body.eventListeners.onMouseWheel(e)}),this.frame.canvas.addEventListener("mousemove",function(e){t.body.eventListeners.onMouseMove(e)}),this.frame.canvas.addEventListener("contextmenu",function(e){t.body.eventListeners.onContext(e)}),this.hammerFrame=new hq(this.frame),gO(this.hammerFrame,function(e){t.body.eventListeners.onRelease(e)})}},{key:"setSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.width,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.height;t=this._prepareValue(t),e=this._prepareValue(e);var i=!1,n=this.frame.canvas.width,o=this.frame.canvas.height,r=this.pixelRatio;if(this._setPixelRatio(),t!=this.options.width||e!=this.options.height||this.frame.style.width!=t||this.frame.style.height!=e)this._getCameraState(r),this.frame.style.width=t,this.frame.style.height=e,this.frame.canvas.style.width="100%",this.frame.canvas.style.height="100%",this.frame.canvas.width=Math.round(this.frame.canvas.clientWidth*this.pixelRatio),this.frame.canvas.height=Math.round(this.frame.canvas.clientHeight*this.pixelRatio),this.options.width=t,this.options.height=e,this.canvasViewCenter={x:.5*this.frame.clientWidth,y:.5*this.frame.clientHeight},i=!0;else{var s=Math.round(this.frame.canvas.clientWidth*this.pixelRatio),a=Math.round(this.frame.canvas.clientHeight*this.pixelRatio);(this.frame.canvas.width!==s||this.frame.canvas.height!==a)&&this._getCameraState(r),this.frame.canvas.width!==s&&(this.frame.canvas.width=s,i=!0),this.frame.canvas.height!==a&&(this.frame.canvas.height=a,i=!0)}return!0===i&&(this.body.emitter.emit("resize",{width:Math.round(this.frame.canvas.width/this.pixelRatio),height:Math.round(this.frame.canvas.height/this.pixelRatio),oldWidth:Math.round(n/this.pixelRatio),oldHeight:Math.round(o/this.pixelRatio)}),this._setCameraState()),this.initialized=!0,i}},{key:"getContext",value:function(){return this.frame.canvas.getContext("2d")}},{key:"_determinePixelRatio",value:function(){var t=this.getContext();if(void 0===t)throw Error("Could not get canvax context");var e=1;return"undefined"!=typeof window&&(e=window.devicePixelRatio||1),e/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}},{key:"_setPixelRatio",value:function(){this.pixelRatio=this._determinePixelRatio()}},{key:"setTransform",value:function(){var t=this.getContext();if(void 0===t)throw Error("Could not get canvax context");t.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}},{key:"_XconvertDOMtoCanvas",value:function(t){return(t-this.body.view.translation.x)/this.body.view.scale}},{key:"_XconvertCanvasToDOM",value:function(t){return t*this.body.view.scale+this.body.view.translation.x}},{key:"_YconvertDOMtoCanvas",value:function(t){return(t-this.body.view.translation.y)/this.body.view.scale}},{key:"_YconvertCanvasToDOM",value:function(t){return t*this.body.view.scale+this.body.view.translation.y}},{key:"canvasToDOM",value:function(t){return{x:this._XconvertCanvasToDOM(t.x),y:this._YconvertCanvasToDOM(t.y)}}},{key:"DOMtoCanvas",value:function(t){return{x:this._XconvertDOMtoCanvas(t.x),y:this._YconvertDOMtoCanvas(t.y)}}}]),t}(),g_=function(){function t(e,i){var n,o,r=this;n4(this,t),this.body=e,this.canvas=i,this.animationSpeed=1/this.renderRefreshRate,this.animationEasingFunction="easeInOutQuint",this.easingTime=0,this.sourceScale=0,this.targetScale=0,this.sourceTranslation=0,this.targetTranslation=0,this.lockedOnNodeId=void 0,this.lockedOnNodeOffset=void 0,this.touchTime=0,this.viewFunction=void 0,this.body.emitter.on("fit",e7(n=this.fit).call(n,this)),this.body.emitter.on("animationFinished",function(){r.body.emitter.emit("_stopRendering")}),this.body.emitter.on("unlockNode",e7(o=this.releaseNode).call(o,this))}return rH(t,[{key:"setOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t}},{key:"fit",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=function(t,e){var i=eK({nodes:e,minZoomLevel:Number.MIN_VALUE,maxZoomLevel:1},null!=t?t:{});if(!sl(i.nodes))throw TypeError("Nodes has to be an array of ids.");if(0===i.nodes.length&&(i.nodes=e),!("number"==typeof i.minZoomLevel&&i.minZoomLevel>0))throw TypeError("Min zoom level has to be a number higher than zero.");if(!("number"==typeof i.maxZoomLevel&&i.minZoomLevel<=i.maxZoomLevel))throw TypeError("Max zoom level has to be a number higher than min zoom level.");return i}(t,this.body.nodeIndices);var o=this.canvas.frame.canvas.clientWidth,r=this.canvas.frame.canvas.clientHeight;if(0===o||0===r)i=1,e=gv.getRange(this.body.nodes,t.nodes);else if(!0===n){var s=0;for(var a in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,a)&&!0===this.body.nodes[a].predefinedPosition&&(s+=1);if(s>.5*this.body.nodeIndices.length){this.fit(t,!1);return}e=gv.getRange(this.body.nodes,t.nodes),i=(12.662/(this.body.nodeIndices.length+7.4147)+.0964822)*Math.min(o/600,r/600)}else{this.body.emitter.emit("_resizeNodes");var l=1.1*Math.abs((e=gv.getRange(this.body.nodes,t.nodes)).maxX-e.minX),h=1.1*Math.abs(e.maxY-e.minY),c=o/l,d=r/h;i=c<=d?c:d}i>t.maxZoomLevel?i=t.maxZoomLevel:i<t.minZoomLevel&&(i=t.minZoomLevel);var u={position:gv.findCenter(e),scale:i,animation:t.animation};this.moveTo(u)}},{key:"focus",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0!==this.body.nodes[t]){var i={x:this.body.nodes[t].x,y:this.body.nodes[t].y};e.position=i,e.lockedOnNode=t,this.moveTo(e)}else console.error("Node: "+t+" cannot be found.")}},{key:"moveTo",value:function(t){if(void 0===t){t={};return}if(null!=t.offset){if(null!=t.offset.x){if(t.offset.x=+t.offset.x,!cq(t.offset.x))throw TypeError('The option "offset.x" has to be a finite number.')}else t.offset.x=0;if(null!=t.offset.y){if(t.offset.y=+t.offset.y,!cq(t.offset.y))throw TypeError('The option "offset.y" has to be a finite number.')}else t.offset.x=0}else t.offset={x:0,y:0};if(null!=t.position){if(null!=t.position.x){if(t.position.x=+t.position.x,!cq(t.position.x))throw TypeError('The option "position.x" has to be a finite number.')}else t.position.x=0;if(null!=t.position.y){if(t.position.y=+t.position.y,!cq(t.position.y))throw TypeError('The option "position.y" has to be a finite number.')}else t.position.x=0}else t.position=this.getViewPosition();if(null!=t.scale){if(t.scale=+t.scale,!(t.scale>0))throw TypeError('The option "scale" has to be a number greater than zero.')}else t.scale=this.body.view.scale;void 0===t.animation&&(t.animation={duration:0}),!1===t.animation&&(t.animation={duration:0}),!0===t.animation&&(t.animation={}),void 0===t.animation.duration&&(t.animation.duration=1e3),void 0===t.animation.easingFunction&&(t.animation.easingFunction="easeInOutQuad"),this.animateView(t)}},{key:"animateView",value:function(t){if(void 0!==t){this.animationEasingFunction=t.animation.easingFunction,this.releaseNode(),!0===t.locked&&(this.lockedOnNodeId=t.lockedOnNode,this.lockedOnNodeOffset=t.offset),0!=this.easingTime&&this._transitionRedraw(!0),this.sourceScale=this.body.view.scale,this.sourceTranslation=this.body.view.translation,this.targetScale=t.scale,this.body.view.scale=this.targetScale;var e,i,n=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight}),o={x:n.x-t.position.x,y:n.y-t.position.y};this.targetTranslation={x:this.sourceTranslation.x+o.x*this.targetScale+t.offset.x,y:this.sourceTranslation.y+o.y*this.targetScale+t.offset.y},0===t.animation.duration?void 0!=this.lockedOnNodeId?(this.viewFunction=e7(e=this._lockedRedraw).call(e,this),this.body.emitter.on("initRedraw",this.viewFunction)):(this.body.view.scale=this.targetScale,this.body.view.translation=this.targetTranslation,this.body.emitter.emit("_requestRedraw")):(this.animationSpeed=1/(60*t.animation.duration*.001)||1/60,this.animationEasingFunction=t.animation.easingFunction,this.viewFunction=e7(i=this._transitionRedraw).call(i,this),this.body.emitter.on("initRedraw",this.viewFunction),this.body.emitter.emit("_startRendering"))}}},{key:"_lockedRedraw",value:function(){var t={x:this.body.nodes[this.lockedOnNodeId].x,y:this.body.nodes[this.lockedOnNodeId].y},e=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight}),i={x:e.x-t.x,y:e.y-t.y},n=this.body.view.translation,o={x:n.x+i.x*this.body.view.scale+this.lockedOnNodeOffset.x,y:n.y+i.y*this.body.view.scale+this.lockedOnNodeOffset.y};this.body.view.translation=o}},{key:"releaseNode",value:function(){void 0!==this.lockedOnNodeId&&void 0!==this.viewFunction&&(this.body.emitter.off("initRedraw",this.viewFunction),this.lockedOnNodeId=void 0,this.lockedOnNodeOffset=void 0)}},{key:"_transitionRedraw",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.easingTime+=this.animationSpeed,this.easingTime=!0===e?1:this.easingTime;var i=hR[this.animationEasingFunction](this.easingTime);this.body.view.scale=this.sourceScale+(this.targetScale-this.sourceScale)*i,this.body.view.translation={x:this.sourceTranslation.x+(this.targetTranslation.x-this.sourceTranslation.x)*i,y:this.sourceTranslation.y+(this.targetTranslation.y-this.sourceTranslation.y)*i},this.easingTime>=1&&(this.body.emitter.off("initRedraw",this.viewFunction),this.easingTime=0,void 0!=this.lockedOnNodeId&&(this.viewFunction=e7(t=this._lockedRedraw).call(t,this),this.body.emitter.on("initRedraw",this.viewFunction)),this.body.emitter.emit("animationFinished"))}},{key:"getScale",value:function(){return this.body.view.scale}},{key:"getViewPosition",value:function(){return this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight})}}]),t}();function gC(t){var e,i=t&&t.preventDefault||!1,n=t&&t.container||window,o={},r={keydown:{},keyup:{}},s={};for(e=97;e<=122;e++)s[String.fromCharCode(e)]={code:65+(e-97),shift:!1};for(e=65;e<=90;e++)s[String.fromCharCode(e)]={code:e,shift:!0};for(e=0;e<=9;e++)s[""+e]={code:48+e,shift:!1};for(e=1;e<=12;e++)s["F"+e]={code:111+e,shift:!1};for(e=0;e<=9;e++)s["num"+e]={code:96+e,shift:!1};s["num*"]={code:106,shift:!1},s["num+"]={code:107,shift:!1},s["num-"]={code:109,shift:!1},s["num/"]={code:111,shift:!1},s["num."]={code:110,shift:!1},s.left={code:37,shift:!1},s.up={code:38,shift:!1},s.right={code:39,shift:!1},s.down={code:40,shift:!1},s.space={code:32,shift:!1},s.enter={code:13,shift:!1},s.shift={code:16,shift:void 0},s.esc={code:27,shift:!1},s.backspace={code:8,shift:!1},s.tab={code:9,shift:!1},s.ctrl={code:17,shift:!1},s.alt={code:18,shift:!1},s.delete={code:46,shift:!1},s.pageup={code:33,shift:!1},s.pagedown={code:34,shift:!1},s["="]={code:187,shift:!1},s["-"]={code:189,shift:!1},s["]"]={code:221,shift:!1},s["["]={code:219,shift:!1};var a=function(t){h(t,"keydown")},l=function(t){h(t,"keyup")},h=function(t,e){if(void 0!==r[e][t.keyCode]){for(var n=r[e][t.keyCode],o=0;o<n.length;o++)void 0===n[o].shift?n[o].fn(t):!0==n[o].shift&&!0==t.shiftKey?n[o].fn(t):!1==n[o].shift&&!1==t.shiftKey&&n[o].fn(t);!0==i&&t.preventDefault()}};return o.bind=function(t,e,i){if(void 0===i&&(i="keydown"),void 0===s[t])throw Error("unsupported key: "+t);void 0===r[i][s[t].code]&&(r[i][s[t].code]=[]),r[i][s[t].code].push({fn:e,shift:s[t].shift})},o.bindAll=function(t,e){for(var i in void 0===e&&(e="keydown"),s)s.hasOwnProperty(i)&&o.bind(i,t,e)},o.getKey=function(t){for(var e in s)if(s.hasOwnProperty(e)&&(!0==t.shiftKey&&!0==s[e].shift&&t.keyCode==s[e].code||!1==t.shiftKey&&!1==s[e].shift&&t.keyCode==s[e].code||t.keyCode==s[e].code&&"shift"==e))return e;return"unknown key, currently not supported"},o.unbind=function(t,e,i){if(void 0===i&&(i="keydown"),void 0===s[t])throw Error("unsupported key: "+t);if(void 0!==e){var n=[],o=r[i][s[t].code];if(void 0!==o)for(var a=0;a<o.length;a++)o[a].fn==e&&o[a].shift==s[t].shift||n.push(r[i][s[t].code][a]);r[i][s[t].code]=n}else r[i][s[t].code]=[]},o.reset=function(){r={keydown:{},keyup:{}}},o.destroy=function(){r={keydown:{},keyup:{}},n.removeEventListener("keydown",a,!0),n.removeEventListener("keyup",l,!0)},n.addEventListener("keydown",a,!0),n.addEventListener("keyup",l,!0),o}var gE=Object.freeze({__proto__:null,default:gC}),gM=function(){function t(e,i){var n=this;n4(this,t),this.body=e,this.canvas=i,this.iconsCreated=!1,this.navigationHammers=[],this.boundFunctions={},this.touchTime=0,this.activated=!1,this.body.emitter.on("activate",function(){n.activated=!0,n.configureKeyboardBindings()}),this.body.emitter.on("deactivate",function(){n.activated=!1,n.configureKeyboardBindings()}),this.body.emitter.on("destroy",function(){void 0!==n.keycharm&&n.keycharm.destroy()}),this.options={}}return rH(t,[{key:"setOptions",value:function(t){void 0!==t&&(this.options=t,this.create())}},{key:"create",value:function(){!0===this.options.navigationButtons?!1===this.iconsCreated&&this.loadNavigationElements():!0===this.iconsCreated&&this.cleanNavigation(),this.configureKeyboardBindings()}},{key:"cleanNavigation",value:function(){if(0!=this.navigationHammers.length){for(var t=0;t<this.navigationHammers.length;t++)this.navigationHammers[t].destroy();this.navigationHammers=[]}this.navigationDOM&&this.navigationDOM.wrapper&&this.navigationDOM.wrapper.parentNode&&this.navigationDOM.wrapper.parentNode.removeChild(this.navigationDOM.wrapper),this.iconsCreated=!1}},{key:"loadNavigationElements",value:function(){var t=this;this.cleanNavigation(),this.navigationDOM={};var e=["up","down","left","right","zoomIn","zoomOut","zoomExtends"],i=["_moveUp","_moveDown","_moveLeft","_moveRight","_zoomIn","_zoomOut","_fit"];this.navigationDOM.wrapper=document.createElement("div"),this.navigationDOM.wrapper.className="vis-navigation",this.canvas.frame.appendChild(this.navigationDOM.wrapper);for(var n=0;n<e.length;n++){this.navigationDOM[e[n]]=document.createElement("div"),this.navigationDOM[e[n]].className="vis-button vis-"+e[n],this.navigationDOM.wrapper.appendChild(this.navigationDOM[e[n]]);var o,r,s=new hq(this.navigationDOM[e[n]]);"_fit"===i[n]?gk(s,e7(o=this._fit).call(o,this)):gk(s,e7(r=this.bindToRedraw).call(r,this,i[n])),this.navigationHammers.push(s)}var a=new hq(this.canvas.frame);gO(a,function(){t._stopMovement()}),this.navigationHammers.push(a),this.iconsCreated=!0}},{key:"bindToRedraw",value:function(t){if(void 0===this.boundFunctions[t]){var e;this.boundFunctions[t]=e7(e=this[t]).call(e,this),this.body.emitter.on("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_startRendering")}}},{key:"unbindFromRedraw",value:function(t){void 0!==this.boundFunctions[t]&&(this.body.emitter.off("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_stopRendering"),delete this.boundFunctions[t])}},{key:"_fit",value:function(){new Date().valueOf()-this.touchTime>700&&(this.body.emitter.emit("fit",{duration:700}),this.touchTime=new Date().valueOf())}},{key:"_stopMovement",value:function(){for(var t in this.boundFunctions)Object.prototype.hasOwnProperty.call(this.boundFunctions,t)&&(this.body.emitter.off("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_stopRendering"));this.boundFunctions={}}},{key:"_moveUp",value:function(){this.body.view.translation.y+=this.options.keyboard.speed.y}},{key:"_moveDown",value:function(){this.body.view.translation.y-=this.options.keyboard.speed.y}},{key:"_moveLeft",value:function(){this.body.view.translation.x+=this.options.keyboard.speed.x}},{key:"_moveRight",value:function(){this.body.view.translation.x-=this.options.keyboard.speed.x}},{key:"_zoomIn",value:function(){var t=this.body.view.scale,e=this.body.view.scale*(1+this.options.keyboard.speed.zoom),i=this.body.view.translation,n=e/t,o=(1-n)*this.canvas.canvasViewCenter.x+i.x*n,r=(1-n)*this.canvas.canvasViewCenter.y+i.y*n;this.body.view.scale=e,this.body.view.translation={x:o,y:r},this.body.emitter.emit("zoom",{direction:"+",scale:this.body.view.scale,pointer:null})}},{key:"_zoomOut",value:function(){var t=this.body.view.scale,e=this.body.view.scale/(1+this.options.keyboard.speed.zoom),i=this.body.view.translation,n=e/t,o=(1-n)*this.canvas.canvasViewCenter.x+i.x*n,r=(1-n)*this.canvas.canvasViewCenter.y+i.y*n;this.body.view.scale=e,this.body.view.translation={x:o,y:r},this.body.emitter.emit("zoom",{direction:"-",scale:this.body.view.scale,pointer:null})}},{key:"configureKeyboardBindings",value:function(){var t,e,i,n,o,r,s,a,l,h,c,d,u,f,p,g,m,v,y,b,w,x,k,O,S=this;void 0!==this.keycharm&&this.keycharm.destroy(),!0===this.options.keyboard.enabled&&(!0===this.options.keyboard.bindToWindow?this.keycharm=gC({container:window,preventDefault:!0}):this.keycharm=gC({container:this.canvas.frame,preventDefault:!0}),this.keycharm.reset(),!0===this.activated&&(e7(t=this.keycharm).call(t,"up",function(){S.bindToRedraw("_moveUp")},"keydown"),e7(e=this.keycharm).call(e,"down",function(){S.bindToRedraw("_moveDown")},"keydown"),e7(i=this.keycharm).call(i,"left",function(){S.bindToRedraw("_moveLeft")},"keydown"),e7(n=this.keycharm).call(n,"right",function(){S.bindToRedraw("_moveRight")},"keydown"),e7(o=this.keycharm).call(o,"=",function(){S.bindToRedraw("_zoomIn")},"keydown"),e7(r=this.keycharm).call(r,"num+",function(){S.bindToRedraw("_zoomIn")},"keydown"),e7(s=this.keycharm).call(s,"num-",function(){S.bindToRedraw("_zoomOut")},"keydown"),e7(a=this.keycharm).call(a,"-",function(){S.bindToRedraw("_zoomOut")},"keydown"),e7(l=this.keycharm).call(l,"[",function(){S.bindToRedraw("_zoomOut")},"keydown"),e7(h=this.keycharm).call(h,"]",function(){S.bindToRedraw("_zoomIn")},"keydown"),e7(c=this.keycharm).call(c,"pageup",function(){S.bindToRedraw("_zoomIn")},"keydown"),e7(d=this.keycharm).call(d,"pagedown",function(){S.bindToRedraw("_zoomOut")},"keydown"),e7(u=this.keycharm).call(u,"up",function(){S.unbindFromRedraw("_moveUp")},"keyup"),e7(f=this.keycharm).call(f,"down",function(){S.unbindFromRedraw("_moveDown")},"keyup"),e7(p=this.keycharm).call(p,"left",function(){S.unbindFromRedraw("_moveLeft")},"keyup"),e7(g=this.keycharm).call(g,"right",function(){S.unbindFromRedraw("_moveRight")},"keyup"),e7(m=this.keycharm).call(m,"=",function(){S.unbindFromRedraw("_zoomIn")},"keyup"),e7(v=this.keycharm).call(v,"num+",function(){S.unbindFromRedraw("_zoomIn")},"keyup"),e7(y=this.keycharm).call(y,"num-",function(){S.unbindFromRedraw("_zoomOut")},"keyup"),e7(b=this.keycharm).call(b,"-",function(){S.unbindFromRedraw("_zoomOut")},"keyup"),e7(w=this.keycharm).call(w,"[",function(){S.unbindFromRedraw("_zoomOut")},"keyup"),e7(x=this.keycharm).call(x,"]",function(){S.unbindFromRedraw("_zoomIn")},"keyup"),e7(k=this.keycharm).call(k,"pageup",function(){S.unbindFromRedraw("_zoomIn")},"keyup"),e7(O=this.keycharm).call(O,"pagedown",function(){S.unbindFromRedraw("_zoomOut")},"keyup")))}}]),t}();function gP(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}var gT=function(){function t(e,i,n){var o,r,s,a,l,h,c,d,u,f,p,g,m;n4(this,t),this.body=e,this.canvas=i,this.selectionHandler=n,this.navigationHandler=new gM(e,i),this.body.eventListeners.onTap=e7(o=this.onTap).call(o,this),this.body.eventListeners.onTouch=e7(r=this.onTouch).call(r,this),this.body.eventListeners.onDoubleTap=e7(s=this.onDoubleTap).call(s,this),this.body.eventListeners.onHold=e7(a=this.onHold).call(a,this),this.body.eventListeners.onDragStart=e7(l=this.onDragStart).call(l,this),this.body.eventListeners.onDrag=e7(h=this.onDrag).call(h,this),this.body.eventListeners.onDragEnd=e7(c=this.onDragEnd).call(c,this),this.body.eventListeners.onMouseWheel=e7(d=this.onMouseWheel).call(d,this),this.body.eventListeners.onPinch=e7(u=this.onPinch).call(u,this),this.body.eventListeners.onMouseMove=e7(f=this.onMouseMove).call(f,this),this.body.eventListeners.onRelease=e7(p=this.onRelease).call(p,this),this.body.eventListeners.onContext=e7(g=this.onContext).call(g,this),this.touchTime=0,this.drag={},this.pinch={},this.popup=void 0,this.popupObj=void 0,this.popupTimer=void 0,this.body.functions.getPointer=e7(m=this.getPointer).call(m,this),this.options={},this.defaultOptions={dragNodes:!0,dragView:!0,hover:!1,keyboard:{enabled:!1,speed:{x:10,y:10,zoom:.02},bindToWindow:!0,autoFocus:!0},navigationButtons:!1,tooltipDelay:300,zoomView:!0,zoomSpeed:1},eK(this.options,this.defaultOptions),this.bindEventListeners()}return rH(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("destroy",function(){clearTimeout(t.popupTimer),delete t.body.functions.getPointer})}},{key:"setOptions",value:function(t){void 0!==t&&(hg(["hideEdgesOnDrag","hideEdgesOnZoom","hideNodesOnDrag","keyboard","multiselect","selectable","selectConnectedEdges"],this.options,t),hz(this.options,t,"keyboard"),t.tooltip&&(eK(this.options.tooltip,t.tooltip),t.tooltip.color&&(this.options.tooltip.color=h_(t.tooltip.color)))),this.navigationHandler.setOptions(this.options)}},{key:"getPointer",value:function(t){return{x:t.x-hb(this.canvas.frame.canvas),y:t.y-hw(this.canvas.frame.canvas)}}},{key:"onTouch",value:function(t){new Date().valueOf()-this.touchTime>50&&(this.drag.pointer=this.getPointer(t.center),this.drag.pinched=!1,this.pinch.scale=this.body.view.scale,this.touchTime=new Date().valueOf())}},{key:"onTap",value:function(t){var e=this.getPointer(t.center),i=this.selectionHandler.options.multiselect&&(t.changedPointers[0].ctrlKey||t.changedPointers[0].metaKey);this.checkSelectionChanges(e,i),this.selectionHandler.commitAndEmit(e,t),this.selectionHandler.generateClickEvent("click",t,e)}},{key:"onDoubleTap",value:function(t){var e=this.getPointer(t.center);this.selectionHandler.generateClickEvent("doubleClick",t,e)}},{key:"onHold",value:function(t){var e=this.getPointer(t.center),i=this.selectionHandler.options.multiselect;this.checkSelectionChanges(e,i),this.selectionHandler.commitAndEmit(e,t),this.selectionHandler.generateClickEvent("click",t,e),this.selectionHandler.generateClickEvent("hold",t,e)}},{key:"onRelease",value:function(t){if(new Date().valueOf()-this.touchTime>10){var e=this.getPointer(t.center);this.selectionHandler.generateClickEvent("release",t,e),this.touchTime=new Date().valueOf()}}},{key:"onContext",value:function(t){var e=this.getPointer({x:t.clientX,y:t.clientY});this.selectionHandler.generateClickEvent("oncontext",t,e)}},{key:"checkSelectionChanges",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===e?this.selectionHandler.selectAdditionalOnPoint(t):this.selectionHandler.selectOnPoint(t)}},{key:"_determineDifference",value:function(t,e){var i=function(t,e){for(var i=[],n=0;n<t.length;n++){var o=t[n];-1===ab(e).call(e,o)&&i.push(o)}return i};return{nodes:i(t.nodes,e.nodes),edges:i(t.edges,e.edges)}}},{key:"onDragStart",value:function(t){if(!this.drag.dragging){void 0===this.drag.pointer&&this.onTouch(t);var e=this.selectionHandler.getNodeAt(this.drag.pointer);if(this.drag.dragging=!0,this.drag.selection=[],this.drag.translation=eK({},this.body.view.translation),this.drag.nodeId=void 0,t.srcEvent.shiftKey){this.body.selectionBox.show=!0;var i=this.getPointer(t.center);this.body.selectionBox.position.start={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)},this.body.selectionBox.position.end={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)}}else if(void 0!==e&&!0===this.options.dragNodes){this.drag.nodeId=e.id,!1===e.isSelected()&&this.selectionHandler.setSelection({nodes:[e.id]}),this.selectionHandler.generateClickEvent("dragStart",t,this.drag.pointer);var n,o=function(t,e){var i=void 0!==st&&n3(t)||t["@@iterator"];if(!i){if(sl(t)||(i=function(t,e){if(t){if("string"==typeof t)return gP(t,void 0);var i,n=so(i=Object.prototype.toString.call(t)).call(i,8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return nG(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gP(t,void 0)}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(this.selectionHandler.getSelectedNodes());try{for(o.s();!(n=o.n()).done;){var r=n.value,s={id:r.id,node:r,x:r.x,y:r.y,xFixed:r.options.fixed.x,yFixed:r.options.fixed.y};r.options.fixed.x=!0,r.options.fixed.y=!0,this.drag.selection.push(s)}}catch(t){o.e(t)}finally{o.f()}}else this.selectionHandler.generateClickEvent("dragStart",t,this.drag.pointer,void 0,!0)}}},{key:"onDrag",value:function(t){var e=this;if(!0!==this.drag.pinched){this.body.emitter.emit("unlockNode");var i=this.getPointer(t.center),n=this.drag.selection;if(n&&n.length&&!0===this.options.dragNodes){this.selectionHandler.generateClickEvent("dragging",t,i);var o=i.x-this.drag.pointer.x,r=i.y-this.drag.pointer.y;sS(n).call(n,function(t){var i=t.node;!1===t.xFixed&&(i.x=e.canvas._XconvertDOMtoCanvas(e.canvas._XconvertCanvasToDOM(t.x)+o)),!1===t.yFixed&&(i.y=e.canvas._YconvertDOMtoCanvas(e.canvas._YconvertCanvasToDOM(t.y)+r))}),this.body.emitter.emit("startSimulation")}else{if(t.srcEvent.shiftKey){if(this.selectionHandler.generateClickEvent("dragging",t,i,void 0,!0),void 0===this.drag.pointer){this.onDragStart(t);return}this.body.selectionBox.position.end={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)},this.body.emitter.emit("_requestRedraw")}if(!0===this.options.dragView&&!t.srcEvent.shiftKey){if(this.selectionHandler.generateClickEvent("dragging",t,i,void 0,!0),void 0===this.drag.pointer){this.onDragStart(t);return}var s=i.x-this.drag.pointer.x,a=i.y-this.drag.pointer.y;this.body.view.translation={x:this.drag.translation.x+s,y:this.drag.translation.y+a},this.body.emitter.emit("_requestRedraw")}}}}},{key:"onDragEnd",value:function(t){var e=this;if(this.drag.dragging=!1,this.body.selectionBox.show){this.body.selectionBox.show=!1;var i,n=this.body.selectionBox.position,o={minX:Math.min(n.start.x,n.end.x),minY:Math.min(n.start.y,n.end.y),maxX:Math.max(n.start.x,n.end.x),maxY:Math.max(n.start.y,n.end.y)},r=s2(i=this.body.nodeIndices).call(i,function(t){var i=e.body.nodes[t];return i.x>=o.minX&&i.x<=o.maxX&&i.y>=o.minY&&i.y<=o.maxY});sS(r).call(r,function(t){return e.selectionHandler.selectObject(e.body.nodes[t])});var s=this.getPointer(t.center);this.selectionHandler.commitAndEmit(s,t),this.selectionHandler.generateClickEvent("dragEnd",t,this.getPointer(t.center),void 0,!0),this.body.emitter.emit("_requestRedraw")}else{var a=this.drag.selection;a&&a.length?(sS(a).call(a,function(t){t.node.options.fixed.x=t.xFixed,t.node.options.fixed.y=t.yFixed}),this.selectionHandler.generateClickEvent("dragEnd",t,this.getPointer(t.center)),this.body.emitter.emit("startSimulation")):(this.selectionHandler.generateClickEvent("dragEnd",t,this.getPointer(t.center),void 0,!0),this.body.emitter.emit("_requestRedraw"))}}},{key:"onPinch",value:function(t){var e=this.getPointer(t.center);this.drag.pinched=!0,void 0===this.pinch.scale&&(this.pinch.scale=1);var i=this.pinch.scale*t.scale;this.zoom(i,e)}},{key:"zoom",value:function(t,e){if(!0===this.options.zoomView){var i=this.body.view.scale;t<1e-5&&(t=1e-5),t>10&&(t=10);var n=void 0;void 0!==this.drag&&!0===this.drag.dragging&&(n=this.canvas.DOMtoCanvas(this.drag.pointer));var o=this.body.view.translation,r=t/i,s=(1-r)*e.x+o.x*r,a=(1-r)*e.y+o.y*r;if(this.body.view.scale=t,this.body.view.translation={x:s,y:a},void 0!=n){var l=this.canvas.canvasToDOM(n);this.drag.pointer.x=l.x,this.drag.pointer.y=l.y}this.body.emitter.emit("_requestRedraw"),i<t?this.body.emitter.emit("zoom",{direction:"+",scale:this.body.view.scale,pointer:e}):this.body.emitter.emit("zoom",{direction:"-",scale:this.body.view.scale,pointer:e})}}},{key:"onMouseWheel",value:function(t){if(!0===this.options.zoomView){if(0!==t.deltaY){var e=this.body.view.scale;e*=1+(t.deltaY<0?1:-1)*(.1*this.options.zoomSpeed);var i=this.getPointer({x:t.clientX,y:t.clientY});this.zoom(e,i)}t.preventDefault()}}},{key:"onMouseMove",value:function(t){var e=this,i=this.getPointer({x:t.clientX,y:t.clientY}),n=!1;void 0!==this.popup&&(!1===this.popup.hidden&&this._checkHidePopup(i),!1===this.popup.hidden&&(n=!0,this.popup.setPosition(i.x+3,i.y-5),this.popup.show())),this.options.keyboard.autoFocus&&!1===this.options.keyboard.bindToWindow&&!0===this.options.keyboard.enabled&&this.canvas.frame.focus(),!1!==n||(void 0!==this.popupTimer&&(clearInterval(this.popupTimer),this.popupTimer=void 0),this.drag.dragging||(this.popupTimer=aB(function(){return e._checkShowPopup(i)},this.options.tooltipDelay))),!0===this.options.hover&&this.selectionHandler.hoverObject(t,i)}},{key:"_checkShowPopup",value:function(t){var e=this.canvas._XconvertDOMtoCanvas(t.x),i=this.canvas._YconvertDOMtoCanvas(t.y),n={left:e,top:i,right:e,bottom:i},o=void 0===this.popupObj?void 0:this.popupObj.id,r=!1,s="node";if(void 0===this.popupObj){for(var a,l=this.body.nodeIndices,h=this.body.nodes,c=[],d=0;d<l.length;d++)!0===(a=h[l[d]]).isOverlappingWith(n)&&(r=!0,void 0!==a.getTitle()&&c.push(l[d]));c.length>0&&(this.popupObj=h[c[c.length-1]],r=!0)}if(void 0===this.popupObj&&!1===r){for(var u,f=this.body.edgeIndices,p=this.body.edges,g=[],m=0;m<f.length;m++)!0===(u=p[f[m]]).isOverlappingWith(n)&&!0===u.connected&&void 0!==u.getTitle()&&g.push(f[m]);g.length>0&&(this.popupObj=p[g[g.length-1]],s="edge")}void 0!==this.popupObj?this.popupObj.id!==o&&(void 0===this.popup&&(this.popup=new hW(this.canvas.frame)),this.popup.popupTargetType=s,this.popup.popupTargetId=this.popupObj.id,this.popup.setPosition(t.x+3,t.y-5),this.popup.setText(this.popupObj.getTitle()),this.popup.show(),this.body.emitter.emit("showPopup",this.popupObj.id)):void 0!==this.popup&&(this.popup.hide(),this.body.emitter.emit("hidePopup"))}},{key:"_checkHidePopup",value:function(t){var e=this.selectionHandler._pointerToPositionObject(t),i=!1;if("node"===this.popup.popupTargetType){if(void 0!==this.body.nodes[this.popup.popupTargetId]&&!0===(i=this.body.nodes[this.popup.popupTargetId].isOverlappingWith(e))){var n=this.selectionHandler.getNodeAt(t);i=void 0!==n&&n.id===this.popup.popupTargetId}}else void 0===this.selectionHandler.getNodeAt(t)&&void 0!==this.body.edges[this.popup.popupTargetId]&&(i=this.body.edges[this.popup.popupTargetId].isOverlappingWith(e));!1===i&&(this.popupObj=void 0,this.popup.hide(),this.body.emitter.emit("hidePopup"))}}]),t}(),gA=cE.getWeakData,gD=oT.find,gI=oT.findIndex,gB=G([].splice),gz=0,gR=function(t){return t.frozen||(t.frozen=new gN)},gN=function(){this.entries=[]},gL=function(t,e){return gD(t.entries,function(t){return t[0]===e})};gN.prototype={get:function(t){var e=gL(this,t);if(e)return e[1]},has:function(t){return!!gL(this,t)},set:function(t,e){var i=gL(this,t);i?i[1]=e:this.entries.push([t,e])},delete:function(t){var e=gI(this.entries,function(e){return e[0]===t});return~e&&gB(this.entries,e,1),!!~e}};var gF={getConstructor:function(t,e,i,n){var o=t(function(t,o){cI(t,r),iB(t,{type:e,id:gz++,frozen:void 0}),tm(o)||cA(o,t[n],{that:t,AS_ENTRIES:i})}),r=o.prototype,s=iz(e),a=function(t,e,i){var n=s(t),o=gA(ey(e),!0);return!0===o?gR(n).set(e,i):o[n.id]=i,t};return cN(r,{delete:function(t){var e=s(this);if(!tx(t))return!1;var i=gA(t);return!0===i?gR(e).delete(t):i&&tK(i,e.id)&&delete i[e.id]},has:function(t){var e=s(this);if(!tx(t))return!1;var i=gA(t);return!0===i?gR(e).has(t):i&&tK(i,e.id)}}),cN(r,i?{get:function(t){var e=s(this);if(tx(t)){var i=gA(t);return!0===i?gR(e).get(t):i?i[e.id]:void 0}},set:function(t,e){return a(this,t,e)}}:{add:function(t){return a(this,t,!0)}}),o}},gj=function(t){return c(t)?h(t):l(t,{})},gH=Object,gW=Array.isArray,gV=gH.isExtensible,gQ=gH.isFrozen,g$=gH.isSealed,gq=gH.freeze,gU=gH.seal,gY={},gG={},gX=!F.ActiveXObject&&"ActiveXObject"in F,gK=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},gZ=cR("WeakMap",gK,gF),gJ=gZ.prototype,g0=G(gJ.set);if(iC){if(gX){T=gF.getConstructor(gK,"WeakMap",!0),cE.enable();var g1=G(gJ.delete),g2=G(gJ.has),g5=G(gJ.get);cN(gJ,{delete:function(t){if(tx(t)&&!gV(t)){var e=gj(this);return e.frozen||(e.frozen=new T),g1(this,t)||e.frozen.delete(t)}return g1(this,t)},has:function(t){if(tx(t)&&!gV(t)){var e=gj(this);return e.frozen||(e.frozen=new T),g2(this,t)||e.frozen.has(t)}return g2(this,t)},get:function(t){if(tx(t)&&!gV(t)){var e=gj(this);return e.frozen||(e.frozen=new T),g2(this,t)?g5(this,t):e.frozen.get(t)}return g5(this,t)},set:function(t,e){if(tx(t)&&!gV(t)){var i=gj(this);i.frozen||(i.frozen=new T),g2(this,t)?g0(this,t,e):i.frozen.set(t,e)}else g0(this,t,e);return this}})}else cw&&j(function(){var t=gq([]);return g0(new gZ,t,1),!gQ(t)})&&cN(gJ,{set:function(t,e){var i;return gW(t)&&(gQ(t)?i=gY:g$(t)&&(i=gG)),g0(this,t,e),i===gY&&gq(t),i===gG&&gU(t),this}})}var g3=N(tk.WeakMap);function g4(t,e,i,n){if("a"===i&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(t):n?n.value:e.get(t)}function g8(t,e,i,n,o){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!o)throw TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,i):o?o.value=i:e.set(t,i),i}function g6(t,e){var i=void 0!==st&&n3(t)||t["@@iterator"];if(!i){if(sl(t)||(i=function(t,e){if(t){if("string"==typeof t)return g9(t,void 0);var i,n=so(i=Object.prototype.toString.call(t)).call(i,8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return nG(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g9(t,void 0)}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function g9(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function g7(t,e){var i,n=new uq,o=g6(e);try{for(o.s();!(i=o.n()).done;){var r=i.value;t.has(r)||n.add(r)}}catch(t){o.e(t)}finally{o.f()}return n}"function"==typeof SuppressedError&&SuppressedError;var mt=function(){function t(){n4(this,t),A.set(this,new uq),D.set(this,new uq)}return rH(t,[{key:"size",get:function(){return g4(this,D,"f").size}},{key:"add",value:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=0;n<e.length;n++){var o=e[n];g4(this,D,"f").add(o)}}},{key:"delete",value:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=0;n<e.length;n++){var o=e[n];g4(this,D,"f").delete(o)}}},{key:"clear",value:function(){g4(this,D,"f").clear()}},{key:"getSelection",value:function(){return r7(g4(this,D,"f"))}},{key:"getChanges",value:function(){return{added:r7(g7(g4(this,A,"f"),g4(this,D,"f"))),deleted:r7(g7(g4(this,D,"f"),g4(this,A,"f"))),previous:r7(new uq(g4(this,A,"f"))),current:r7(new uq(g4(this,D,"f")))}}},{key:"commit",value:function(){var t=this.getChanges();g8(this,A,g4(this,D,"f"),"f"),g8(this,D,new uq(g4(this,A,"f")),"f");var e,i=g6(t.added);try{for(i.s();!(e=i.n()).done;)e.value.select()}catch(t){i.e(t)}finally{i.f()}var n,o=g6(t.deleted);try{for(o.s();!(n=o.n()).done;)n.value.unselect()}catch(t){o.e(t)}finally{o.f()}return t}}]),t}();A=new g3,D=new g3;var me=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};n4(this,t),I.set(this,new mt),B.set(this,new mt),z.set(this,void 0),g8(this,z,e,"f")}return rH(t,[{key:"sizeNodes",get:function(){return g4(this,I,"f").size}},{key:"sizeEdges",get:function(){return g4(this,B,"f").size}},{key:"getNodes",value:function(){return g4(this,I,"f").getSelection()}},{key:"getEdges",value:function(){return g4(this,B,"f").getSelection()}},{key:"addNodes",value:function(){var t;(t=g4(this,I,"f")).add.apply(t,arguments)}},{key:"addEdges",value:function(){var t;(t=g4(this,B,"f")).add.apply(t,arguments)}},{key:"deleteNodes",value:function(t){g4(this,I,"f").delete(t)}},{key:"deleteEdges",value:function(t){g4(this,B,"f").delete(t)}},{key:"clear",value:function(){g4(this,I,"f").clear(),g4(this,B,"f").clear()}},{key:"commit",value:function(){for(var t,e,i={nodes:g4(this,I,"f").commit(),edges:g4(this,B,"f").commit()},n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=g4(this,z,"f")).call.apply(t,sn(e=[this,i]).call(e,o)),i}}]),t}();function mi(t,e){var i=void 0!==st&&n3(t)||t["@@iterator"];if(!i){if(sl(t)||(i=function(t,e){if(t){if("string"==typeof t)return mn(t,void 0);var i,n=so(i=Object.prototype.toString.call(t)).call(i,8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return nG(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mn(t,void 0)}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function mn(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}I=new g3,B=new g3,z=new g3;var mo=function(){function t(e,i){var n=this;n4(this,t),this.body=e,this.canvas=i,this._selectionAccumulator=new me,this.hoverObj={nodes:{},edges:{}},this.options={},this.defaultOptions={multiselect:!1,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0},eK(this.options,this.defaultOptions),this.body.emitter.on("_dataChanged",function(){n.updateSelection()})}return rH(t,[{key:"setOptions",value:function(t){void 0!==t&&hp(["multiselect","hoverConnectedEdges","selectable","selectConnectedEdges"],this.options,t)}},{key:"selectOnPoint",value:function(t){var e=!1;if(!0===this.options.selectable){var i=this.getNodeAt(t)||this.getEdgeAt(t);this.unselectAll(),void 0!==i&&(e=this.selectObject(i)),this.body.emitter.emit("_requestRedraw")}return e}},{key:"selectAdditionalOnPoint",value:function(t){var e=!1;if(!0===this.options.selectable){var i=this.getNodeAt(t)||this.getEdgeAt(t);void 0!==i&&(e=!0,!0===i.isSelected()?this.deselectObject(i):this.selectObject(i),this.body.emitter.emit("_requestRedraw"))}return e}},{key:"_initBaseEvent",value:function(t,e){var i={};return i.pointer={DOM:{x:e.x,y:e.y},canvas:this.canvas.DOMtoCanvas(e)},i.event=t,i}},{key:"generateClickEvent",value:function(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=this._initBaseEvent(e,i);if(!0===o)r.nodes=[],r.edges=[];else{var s=this.getSelection();r.nodes=s.nodes,r.edges=s.edges}void 0!==n&&(r.previousSelection=n),"click"==t&&(r.items=this.getClickedItems(i)),void 0!==e.controlEdge&&(r.controlEdge=e.controlEdge),this.body.emitter.emit(t,r)}},{key:"selectObject",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.selectConnectedEdges;return void 0!==t&&(t instanceof pz?(!0===i&&(e=this._selectionAccumulator).addEdges.apply(e,r7(t.edges)),this._selectionAccumulator.addNodes(t)):this._selectionAccumulator.addEdges(t),!0)}},{key:"deselectObject",value:function(t){!0===t.isSelected()&&(t.selected=!1,this._removeFromSelection(t))}},{key:"_getAllNodesOverlappingWith",value:function(t){for(var e=[],i=this.body.nodes,n=0;n<this.body.nodeIndices.length;n++){var o=this.body.nodeIndices[n];i[o].isOverlappingWith(t)&&e.push(o)}return e}},{key:"_pointerToPositionObject",value:function(t){var e=this.canvas.DOMtoCanvas(t);return{left:e.x-1,top:e.y+1,right:e.x+1,bottom:e.y-1}}},{key:"getNodeAt",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=this._pointerToPositionObject(t),n=this._getAllNodesOverlappingWith(i);return n.length>0?!0===e?this.body.nodes[n[n.length-1]]:n[n.length-1]:void 0}},{key:"_getEdgesOverlappingWith",value:function(t,e){for(var i=this.body.edges,n=0;n<this.body.edgeIndices.length;n++){var o=this.body.edgeIndices[n];i[o].isOverlappingWith(t)&&e.push(o)}}},{key:"_getAllEdgesOverlappingWith",value:function(t){var e=[];return this._getEdgesOverlappingWith(t,e),e}},{key:"getEdgeAt",value:function(t){for(var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=this.canvas.DOMtoCanvas(t),n=10,o=null,r=this.body.edges,s=0;s<this.body.edgeIndices.length;s++){var a=this.body.edgeIndices[s],l=r[a];if(l.connected){var h=l.from.x,c=l.from.y,d=l.to.x,u=l.to.y,f=l.edgeType.getDistanceToEdge(h,c,d,u,i.x,i.y);f<n&&(o=a,n=f)}}return null===o?void 0:!0===e?this.body.edges[o]:o}},{key:"_addToHover",value:function(t){t instanceof pz?this.hoverObj.nodes[t.id]=t:this.hoverObj.edges[t.id]=t}},{key:"_removeFromSelection",value:function(t){if(t instanceof pz){var e;this._selectionAccumulator.deleteNodes(t),(e=this._selectionAccumulator).deleteEdges.apply(e,r7(t.edges))}else this._selectionAccumulator.deleteEdges(t)}},{key:"unselectAll",value:function(){this._selectionAccumulator.clear()}},{key:"getSelectedNodeCount",value:function(){return this._selectionAccumulator.sizeNodes}},{key:"getSelectedEdgeCount",value:function(){return this._selectionAccumulator.sizeEdges}},{key:"_hoverConnectedEdges",value:function(t){for(var e=0;e<t.edges.length;e++){var i=t.edges[e];i.hover=!0,this._addToHover(i)}}},{key:"emitBlurEvent",value:function(t,e,i){var n=this._initBaseEvent(t,e);!0===i.hover&&(i.hover=!1,i instanceof pz?(n.node=i.id,this.body.emitter.emit("blurNode",n)):(n.edge=i.id,this.body.emitter.emit("blurEdge",n)))}},{key:"emitHoverEvent",value:function(t,e,i){var n=this._initBaseEvent(t,e),o=!1;return!1===i.hover&&(i.hover=!0,this._addToHover(i),o=!0,i instanceof pz?(n.node=i.id,this.body.emitter.emit("hoverNode",n)):(n.edge=i.id,this.body.emitter.emit("hoverEdge",n))),o}},{key:"hoverObject",value:function(t,e){var i=this.getNodeAt(e);void 0===i&&(i=this.getEdgeAt(e));var n=!1;for(var o in this.hoverObj.nodes)Object.prototype.hasOwnProperty.call(this.hoverObj.nodes,o)&&(void 0===i||i instanceof pz&&i.id!=o||i instanceof gs)&&(this.emitBlurEvent(t,e,this.hoverObj.nodes[o]),delete this.hoverObj.nodes[o],n=!0);for(var r in this.hoverObj.edges)Object.prototype.hasOwnProperty.call(this.hoverObj.edges,r)&&(!0===n?(this.hoverObj.edges[r].hover=!1,delete this.hoverObj.edges[r]):(void 0===i||i instanceof gs&&i.id!=r||i instanceof pz&&!i.hover)&&(this.emitBlurEvent(t,e,this.hoverObj.edges[r]),delete this.hoverObj.edges[r],n=!0));if(void 0!==i){var s=sf(this.hoverObj.edges).length,a=sf(this.hoverObj.nodes).length,l=i instanceof gs&&0===s&&0===a,h=i instanceof pz&&0===s&&0===a;(n||l||h)&&(n=this.emitHoverEvent(t,e,i)),i instanceof pz&&!0===this.options.hoverConnectedEdges&&this._hoverConnectedEdges(i)}!0===n&&this.body.emitter.emit("_requestRedraw")}},{key:"commitWithoutEmitting",value:function(){this._selectionAccumulator.commit()}},{key:"commitAndEmit",value:function(t,e){var i=!1,n=this._selectionAccumulator.commit(),o={nodes:n.nodes.previous,edges:n.edges.previous};n.edges.deleted.length>0&&(this.generateClickEvent("deselectEdge",e,t,o),i=!0),n.nodes.deleted.length>0&&(this.generateClickEvent("deselectNode",e,t,o),i=!0),n.nodes.added.length>0&&(this.generateClickEvent("selectNode",e,t),i=!0),n.edges.added.length>0&&(this.generateClickEvent("selectEdge",e,t),i=!0),!0===i&&this.generateClickEvent("select",e,t)}},{key:"getSelection",value:function(){return{nodes:this.getSelectedNodeIds(),edges:this.getSelectedEdgeIds()}}},{key:"getSelectedNodes",value:function(){return this._selectionAccumulator.getNodes()}},{key:"getSelectedEdges",value:function(){return this._selectionAccumulator.getEdges()}},{key:"getSelectedNodeIds",value:function(){var t;return su(t=this._selectionAccumulator.getNodes()).call(t,function(t){return t.id})}},{key:"getSelectedEdgeIds",value:function(){var t;return su(t=this._selectionAccumulator.getEdges()).call(t,function(t){return t.id})}},{key:"setSelection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!t.nodes&&!t.edges)throw TypeError("Selection must be an object with nodes and/or edges properties");if((e.unselectAll||void 0===e.unselectAll)&&this.unselectAll(),t.nodes){var i,n=mi(t.nodes);try{for(n.s();!(i=n.n()).done;){var o=i.value,r=this.body.nodes[o];if(!r)throw RangeError('Node with id "'+o+'" not found');this.selectObject(r,e.highlightEdges)}}catch(t){n.e(t)}finally{n.f()}}if(t.edges){var s,a=mi(t.edges);try{for(a.s();!(s=a.n()).done;){var l=s.value,h=this.body.edges[l];if(!h)throw RangeError('Edge with id "'+l+'" not found');this.selectObject(h)}}catch(t){a.e(t)}finally{a.f()}}this.body.emitter.emit("_requestRedraw"),this._selectionAccumulator.commit()}},{key:"selectNodes",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!t||void 0===t.length)throw"Selection must be an array with ids";this.setSelection({nodes:t},{highlightEdges:e})}},{key:"selectEdges",value:function(t){if(!t||void 0===t.length)throw"Selection must be an array with ids";this.setSelection({edges:t})}},{key:"updateSelection",value:function(){for(var t in this._selectionAccumulator.getNodes())Object.prototype.hasOwnProperty.call(this.body.nodes,t.id)||this._selectionAccumulator.deleteNodes(t);for(var e in this._selectionAccumulator.getEdges())Object.prototype.hasOwnProperty.call(this.body.edges,e.id)||this._selectionAccumulator.deleteEdges(e)}},{key:"getClickedItems",value:function(t){for(var e=this.canvas.DOMtoCanvas(t),i=[],n=this.body.nodeIndices,o=this.body.nodes,r=n.length-1;r>=0;r--){var s=o[n[r]].getItemsOnPoint(e);i.push.apply(i,s)}for(var a=this.body.edgeIndices,l=this.body.edges,h=a.length-1;h>=0;h--){var c=l[a[h]].getItemsOnPoint(e);i.push.apply(i,c)}return i}}]),t}();function mr(t){var e=function(){if("undefined"==typeof Reflect||!fO||fO.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fO(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=c8(t);return i=e?fO(n,arguments,c8(this).constructor):n.apply(this,arguments),c3(this,i)}}var ms=function(){function t(){n4(this,t)}return rH(t,[{key:"abstract",value:function(){throw Error("Can't instantiate abstract class!")}},{key:"fake_use",value:function(){}},{key:"curveType",value:function(){return this.abstract()}},{key:"getPosition",value:function(t){return this.fake_use(t),this.abstract()}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.fake_use(t,e,i),this.abstract()}},{key:"getTreeSize",value:function(t){return this.fake_use(t),this.abstract()}},{key:"sort",value:function(t){this.fake_use(t),this.abstract()}},{key:"fix",value:function(t,e){this.fake_use(t,e),this.abstract()}},{key:"shift",value:function(t,e){this.fake_use(t,e),this.abstract()}}]),t}(),ma=function(t){c5(i,t);var e=mr(i);function i(t){var n;return n4(this,i),(n=e.call(this)).layout=t,n}return rH(i,[{key:"curveType",value:function(){return"horizontal"}},{key:"getPosition",value:function(t){return t.x}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0!==i&&this.layout.hierarchical.addToOrdering(t,i),t.x=e}},{key:"getTreeSize",value:function(t){var e=this.layout.hierarchical.getTreeSize(this.layout.body.nodes,t);return{min:e.min_x,max:e.max_x}}},{key:"sort",value:function(t){fn(t).call(t,function(t,e){return t.x-e.x})}},{key:"fix",value:function(t,e){t.y=this.layout.options.hierarchical.levelSeparation*e,t.options.fixed.y=!0}},{key:"shift",value:function(t,e){this.layout.body.nodes[t].x+=e}}]),i}(ms),ml=function(t){c5(i,t);var e=mr(i);function i(t){var n;return n4(this,i),(n=e.call(this)).layout=t,n}return rH(i,[{key:"curveType",value:function(){return"vertical"}},{key:"getPosition",value:function(t){return t.y}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0!==i&&this.layout.hierarchical.addToOrdering(t,i),t.y=e}},{key:"getTreeSize",value:function(t){var e=this.layout.hierarchical.getTreeSize(this.layout.body.nodes,t);return{min:e.min_y,max:e.max_y}}},{key:"sort",value:function(t){fn(t).call(t,function(t,e){return t.y-e.y})}},{key:"fix",value:function(t,e){t.x=this.layout.options.hierarchical.levelSeparation*e,t.options.fixed.x=!0}},{key:"shift",value:function(t,e){this.layout.body.nodes[t].y+=e}}]),i}(ms),mh=oT.every;eM({target:"Array",proto:!0,forced:!sv("every")},{every:function(t){return mh(this,t,arguments.length>1?arguments[1]:void 0)}});var mc=e4("Array").every,md=Array.prototype,mu=N(function(t){var e=t.every;return t===md||t_(md,t)&&e===md.every?mc:e});function mf(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function mp(t,e,i,n){var o,r,s,a=aS(null),l=uH(r=r7(fd(n).call(n))).call(r,function(t,e){return t+1+e.edges.length},0),h=i+"Id",c="to"===i?1:-1,d=function(t,e){var i=void 0!==st&&n3(t)||t["@@iterator"];if(!i){if(sl(t)||(i=function(t,e){if(t){if("string"==typeof t)return mf(t,void 0);var i,n=so(i=Object.prototype.toString.call(t)).call(i,8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return nG(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mf(t,void 0)}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(n);try{for(d.s();!(s=d.n()).done;)if(o=function(){var o,r,d=r9(s.value,2),u=d[0],f=d[1];if(!n.has(u)||!t(f))return 0;a[u]=0;for(var p=[f],g=0;o=p.pop();)if(r=function(){if(!n.has(u))return 0;var t,r,s,d=a[o.id]+c;if(sS(r=s2(s=o.edges).call(s,function(t){return t.connected&&t.to!==t.from&&t[i]!==o&&n.has(t.toId)&&n.has(t.fromId)})).call(r,function(t){var n=t[h],o=a[n];(null==o||e(d,o))&&(a[n]=d,p.push(t[i]))}),g>l)return{v:{v:(t=new uq,sS(n).call(n,function(e){var i;sS(i=e.edges).call(i,function(e){e.connected&&t.add(e)})}),sS(t).call(t,function(t){var e=t.from.id,i=t.to.id;null==a[e]&&(a[e]=0),(null==a[i]||a[e]>=a[i])&&(a[i]=a[e]+1)}),a)}};++g}(),0!==r&&r)return r.v}(),0!==o&&o)return o.v}catch(t){d.e(t)}finally{d.f()}return a}var mg=function(){function t(){n4(this,t),this.childrenReference={},this.parentReference={},this.trees={},this.distributionOrdering={},this.levels={},this.distributionIndex={},this.isTree=!1,this.treeIndex=-1}return rH(t,[{key:"addRelation",value:function(t,e){void 0===this.childrenReference[t]&&(this.childrenReference[t]=[]),this.childrenReference[t].push(e),void 0===this.parentReference[e]&&(this.parentReference[e]=[]),this.parentReference[e].push(t)}},{key:"checkIfTree",value:function(){for(var t in this.parentReference)if(this.parentReference[t].length>1){this.isTree=!1;return}this.isTree=!0}},{key:"numTrees",value:function(){return this.treeIndex+1}},{key:"setTreeIndex",value:function(t,e){void 0!==e&&void 0===this.trees[t.id]&&(this.trees[t.id]=e,this.treeIndex=Math.max(e,this.treeIndex))}},{key:"ensureLevel",value:function(t){void 0===this.levels[t]&&(this.levels[t]=0)}},{key:"getMaxLevel",value:function(t){var e=this,i={};return function t(n){if(void 0!==i[n])return i[n];var o=e.levels[n];if(e.childrenReference[n]){var r=e.childrenReference[n];if(r.length>0)for(var s=0;s<r.length;s++)o=Math.max(o,t(r[s]))}return i[n]=o,o}(t)}},{key:"levelDownstream",value:function(t,e){void 0===this.levels[e.id]&&(void 0===this.levels[t.id]&&(this.levels[t.id]=0),this.levels[e.id]=this.levels[t.id]+1)}},{key:"setMinLevelToZero",value:function(t){var e=1e9;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&void 0!==this.levels[i]&&(e=Math.min(this.levels[i],e));for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&void 0!==this.levels[n]&&(this.levels[n]-=e)}},{key:"getTreeSize",value:function(t,e){var i=1e9,n=-1e9,o=1e9,r=-1e9;for(var s in this.trees)if(Object.prototype.hasOwnProperty.call(this.trees,s)&&this.trees[s]===e){var a=t[s];i=Math.min(a.x,i),n=Math.max(a.x,n),o=Math.min(a.y,o),r=Math.max(a.y,r)}return{min_x:i,max_x:n,min_y:o,max_y:r}}},{key:"hasSameParent",value:function(t,e){var i=this.parentReference[t.id],n=this.parentReference[e.id];if(void 0===i||void 0===n)return!1;for(var o=0;o<i.length;o++)for(var r=0;r<n.length;r++)if(i[o]==n[r])return!0;return!1}},{key:"inSameSubNetwork",value:function(t,e){return this.trees[t.id]===this.trees[e.id]}},{key:"getLevels",value:function(){return sf(this.distributionOrdering)}},{key:"addToOrdering",value:function(t,e){void 0===this.distributionOrdering[e]&&(this.distributionOrdering[e]=[]);var i=!1,n=this.distributionOrdering[e];for(var o in n)if(n[o]===t){i=!0;break}i||(this.distributionOrdering[e].push(t),this.distributionIndex[t.id]=this.distributionOrdering[e].length-1)}}]),t}(),mm=function(){function t(e){n4(this,t),this.body=e,this._resetRNG(Math.random()+":"+sm()),this.setPhysics=!1,this.options={},this.optionsBackup={physics:{}},this.defaultOptions={randomSeed:void 0,improvedLayout:!0,clusterThreshold:150,hierarchical:{enabled:!1,levelSeparation:150,nodeSpacing:100,treeSpacing:200,blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,direction:"UD",sortMethod:"hubsize"}},eK(this.options,this.defaultOptions),this.bindEventListeners()}return rH(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("_dataChanged",function(){t.setupHierarchicalLayout()}),this.body.emitter.on("_dataLoaded",function(){t.layoutNetwork()}),this.body.emitter.on("_resetHierarchicalLayout",function(){t.setupHierarchicalLayout()}),this.body.emitter.on("_adjustEdgesForHierarchicalLayout",function(){if(!0===t.options.hierarchical.enabled){var e=t.direction.curveType();t.body.emitter.emit("_forceDisableDynamicCurves",e,!1)}})}},{key:"setOptions",value:function(t,e){if(void 0!==t){var i=this.options.hierarchical,n=i.enabled;if(hp(["randomSeed","improvedLayout","clusterThreshold"],this.options,t),hz(this.options,t,"hierarchical"),void 0!==t.randomSeed&&this._resetRNG(t.randomSeed),!0===i.enabled)return!0===n&&this.body.emitter.emit("refresh",!0),"RL"===i.direction||"DU"===i.direction?i.levelSeparation>0&&(i.levelSeparation*=-1):i.levelSeparation<0&&(i.levelSeparation*=-1),this.setDirectionStrategy(),this.body.emitter.emit("_resetHierarchicalLayout"),this.adaptAllOptionsForHierarchicalLayout(e);if(!0===n)return this.body.emitter.emit("refresh"),hm(e,this.optionsBackup)}return e}},{key:"_resetRNG",value:function(t){this.initialRandomSeed=t,this._rng=ht(this.initialRandomSeed)}},{key:"adaptAllOptionsForHierarchicalLayout",value:function(t){if(!0===this.options.hierarchical.enabled){var e=this.optionsBackup.physics;void 0===t.physics||!0===t.physics?(t.physics={enabled:void 0===e.enabled||e.enabled,solver:"hierarchicalRepulsion"},e.enabled=void 0===e.enabled||e.enabled,e.solver=e.solver||"barnesHut"):"object"===rN(t.physics)?(e.enabled=void 0===t.physics.enabled||t.physics.enabled,e.solver=t.physics.solver||"barnesHut",t.physics.solver="hierarchicalRepulsion"):!1!==t.physics&&(e.solver="barnesHut",t.physics={solver:"hierarchicalRepulsion"});var i=this.direction.curveType();if(void 0===t.edges)this.optionsBackup.edges={smooth:{enabled:!0,type:"dynamic"}},t.edges={smooth:!1};else if(void 0===t.edges.smooth)this.optionsBackup.edges={smooth:{enabled:!0,type:"dynamic"}},t.edges.smooth=!1;else if("boolean"==typeof t.edges.smooth)this.optionsBackup.edges={smooth:t.edges.smooth},t.edges.smooth={enabled:t.edges.smooth,type:i};else{var n=t.edges.smooth;void 0!==n.type&&"dynamic"!==n.type&&(i=n.type),this.optionsBackup.edges={smooth:{enabled:void 0===n.enabled||n.enabled,type:void 0===n.type?"dynamic":n.type,roundness:void 0===n.roundness?.5:n.roundness,forceDirection:void 0!==n.forceDirection&&n.forceDirection}},t.edges.smooth={enabled:void 0===n.enabled||n.enabled,type:i,roundness:void 0===n.roundness?.5:n.roundness,forceDirection:void 0!==n.forceDirection&&n.forceDirection}}this.body.emitter.emit("_forceDisableDynamicCurves",i)}return t}},{key:"positionInitially",value:function(t){if(!0!==this.options.hierarchical.enabled){this._resetRNG(this.initialRandomSeed);for(var e=t.length+50,i=0;i<t.length;i++){var n=t[i],o=2*Math.PI*this._rng();void 0===n.x&&(n.x=e*Math.cos(o)),void 0===n.y&&(n.y=e*Math.sin(o))}}}},{key:"layoutNetwork",value:function(){if(!0!==this.options.hierarchical.enabled&&!0===this.options.improvedLayout){for(var t=this.body.nodeIndices,e=0,i=0;i<t.length;i++)!0===this.body.nodes[t[i]].predefinedPosition&&(e+=1);if(e<.5*t.length){var n=0,o=this.options.clusterThreshold,r={clusterNodeProperties:{shape:"ellipse",label:"",group:"",font:{multi:!1}},clusterEdgeProperties:{label:"",font:{multi:!1},smooth:{enabled:!1}}};if(t.length>o){for(var s=t.length;t.length>o&&n<=10;){n+=1;var a=t.length;if(n%3==0?this.body.modules.clustering.clusterBridges(r):this.body.modules.clustering.clusterOutliers(r),a==t.length&&n%3!=0){this._declusterAll(),this.body.emitter.emit("_layoutFailed"),console.info("This network could not be positioned by this version of the improved layout algorithm. Please disable improvedLayout for better performance.");return}}this.body.modules.kamadaKawai.setOptions({springLength:Math.max(150,2*s)})}n>10&&console.info("The clustering didn't succeed within the amount of interations allowed, progressing with partial result."),this.body.modules.kamadaKawai.solve(t,this.body.edgeIndices,!0),this._shiftToCenter();for(var l=0;l<t.length;l++){var h=this.body.nodes[t[l]];!1===h.predefinedPosition&&(h.x+=(.5-this._rng())*70,h.y+=(.5-this._rng())*70)}this._declusterAll(),this.body.emitter.emit("_repositionBezierNodes")}}}},{key:"_shiftToCenter",value:function(){for(var t=gv.getRangeCore(this.body.nodes,this.body.nodeIndices),e=gv.findCenter(t),i=0;i<this.body.nodeIndices.length;i++){var n=this.body.nodes[this.body.nodeIndices[i]];n.x-=e.x,n.y-=e.y}}},{key:"_declusterAll",value:function(){for(var t=!0;!0===t;){t=!1;for(var e=0;e<this.body.nodeIndices.length;e++)!0===this.body.nodes[this.body.nodeIndices[e]].isCluster&&(t=!0,this.body.modules.clustering.openCluster(this.body.nodeIndices[e],{},!1));!0===t&&this.body.emitter.emit("_dataChanged")}}},{key:"getSeed",value:function(){return this.initialRandomSeed}},{key:"setupHierarchicalLayout",value:function(){if(!0===this.options.hierarchical.enabled&&this.body.nodeIndices.length>0){var t,e,i=!1,n=!1;for(e in this.lastNodeOnLevel={},this.hierarchical=new mg,this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,e)&&(void 0!==(t=this.body.nodes[e]).options.level?(i=!0,this.hierarchical.levels[e]=t.options.level):n=!0);if(!0===n&&!0===i)throw Error("To use the hierarchical layout, nodes require either no predefined levels or levels have to be defined for all nodes.");if(!0===n){var o=this.options.hierarchical.sortMethod;"hubsize"===o?this._determineLevelsByHubsize():"directed"===o?this._determineLevelsDirected():"custom"===o&&this._determineLevelsCustomCallback()}for(var r in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,r)&&this.hierarchical.ensureLevel(r);var s=this._getDistribution();this._generateMap(),this._placeNodesByHierarchy(s),this._condenseHierarchy(),this._shiftToCenter()}}},{key:"_condenseHierarchy",value:function(){var t=this,e=!1,i={},n=function(e,i){var n=t.hierarchical.trees;for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&n[o]===e&&t.direction.shift(o,i)},o=function(){for(var e=[],i=0;i<t.hierarchical.numTrees();i++)e.push(t.direction.getTreeSize(i));return e},r=function e(i,n){if(!n[i.id]&&(n[i.id]=!0,t.hierarchical.childrenReference[i.id])){var o=t.hierarchical.childrenReference[i.id];if(o.length>0)for(var r=0;r<o.length;r++)e(t.body.nodes[o[r]],n)}},s=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e9,n=1e9,o=1e9,r=1e9,s=-1e9;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var l=t.body.nodes[a],h=t.hierarchical.levels[l.id],c=t.direction.getPosition(l),d=r9(t._getSpaceAroundNode(l,e),2),u=d[0],f=d[1];n=Math.min(u,n),o=Math.min(f,o),h<=i&&(r=Math.min(c,r),s=Math.max(c,s))}return[r,s,n,o]},a=function(e,i,n){for(var o=t.hierarchical,r=0;r<i.length;r++){var s=i[r],a=o.distributionOrdering[s];if(a.length>1)for(var l=0;l<a.length-1;l++){var h=a[l],c=a[l+1];o.hasSameParent(h,c)&&o.inSameSubNetwork(h,c)&&e(h,c,n)}}},l=function(i,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=t.direction.getPosition(i),l=Math.abs(t.direction.getPosition(n)-a),h=t.options.hierarchical.nodeSpacing;if(l>h){var c={},d={};r(i,c),r(n,d);var u=Math.min(t.hierarchical.getMaxLevel(i.id),t.hierarchical.getMaxLevel(n.id)),f=s(c,u),p=s(d,u),g=f[1],m=p[0],v=p[2];if(Math.abs(g-m)>h){var y=g-m+h;y<-v+h&&(y=-v+h),y<0&&(t._shiftBlock(n.id,y),e=!0,!0===o&&t._centerParent(n))}}},h=function(n,o){for(var a,l,h,c,d,u,f,p=o.id,g=o.edges,m=t.hierarchical.levels[o.id],v=t.options.hierarchical.levelSeparation*t.options.hierarchical.levelSeparation,y={},b=[],w=0;w<g.length;w++){var x=g[w];if(x.toId!=x.fromId){var k=x.toId==p?x.from:x.to;y[g[w].id]=k,t.hierarchical.levels[k.id]<m&&b.push(x)}}var O=function(e,i){for(var n=0,o=0;o<i.length;o++)if(void 0!==y[i[o].id]){var r=t.direction.getPosition(y[i[o].id])-e;n+=r/Math.sqrt(r*r+v)}return n},S=function(e,i){for(var n=0,o=0;o<i.length;o++)if(void 0!==y[i[o].id]){var r=t.direction.getPosition(y[i[o].id])-e;n-=v*Math.pow(r*r+v,-1.5)}return n},_=function(e,i){for(var n=t.direction.getPosition(o),r={},s=0;s<e;s++){var a=O(n,i),l=S(n,i);if(void 0!==r[n-=Math.max(-40,Math.min(40,Math.round(a/l)))])break;r[n]=s}return n},C=_(n,b);(function(n){var a=t.direction.getPosition(o);if(void 0===i[o.id]){var l={};r(o,l),i[o.id]=l}var h=s(i[o.id]),c=h[2],d=h[3],u=n-a,f=0;u>0?f=Math.min(u,d-t.options.hierarchical.nodeSpacing):u<0&&(f=-Math.min(-u,c-t.options.hierarchical.nodeSpacing)),0!=f&&(t._shiftBlock(o.id,f),e=!0)})(C),a=C=_(n,g),l=t.direction.getPosition(o),c=(h=r9(t._getSpaceAroundNode(o),2))[0],d=h[1],u=a-l,f=l,u>0?f=Math.min(l+(d-t.options.hierarchical.nodeSpacing),a):u<0&&(f=Math.max(l-(c-t.options.hierarchical.nodeSpacing),a)),f!==l&&(t.direction.setPosition(o,f),e=!0)};!0===this.options.hierarchical.blockShifting&&(function(i){var n=t.hierarchical.getLevels();n=sT(n).call(n);for(var o=0;o<5&&(e=!1,a(l,n,!0),!0===e);o++);}(0),function(){for(var e in t.body.nodes)Object.prototype.hasOwnProperty.call(t.body.nodes,e)&&t._centerParent(t.body.nodes[e])}()),!0===this.options.hierarchical.edgeMinimization&&function(i){var n=t.hierarchical.getLevels();n=sT(n).call(n);for(var o=0;o<20;o++){e=!1;for(var r=0;r<n.length;r++)for(var s=n[r],a=t.hierarchical.distributionOrdering[s],l=0;l<a.length;l++)h(1e3,a[l]);if(!0!==e)break}}(0),!0===this.options.hierarchical.parentCentralization&&function(){var e=t.hierarchical.getLevels();e=sT(e).call(e);for(var i=0;i<e.length;i++)for(var n=e[i],o=t.hierarchical.distributionOrdering[n],r=0;r<o.length;r++)t._centerParent(o[r])}(),function(){for(var e=o(),i=0,r=0;r<e.length-1;r++)i+=e[r].max-e[r+1].min+t.options.hierarchical.treeSpacing,n(r+1,i)}()}},{key:"_getSpaceAroundNode",value:function(t,e){var i=!0;void 0===e&&(i=!1);var n=this.hierarchical.levels[t.id];if(void 0===n)return[0,0];var o=this.hierarchical.distributionIndex[t.id],r=this.direction.getPosition(t),s=this.hierarchical.distributionOrdering[n],a=1e9,l=1e9;if(0!==o){var h=s[o-1];(!0===i&&void 0===e[h.id]||!1===i)&&(a=r-this.direction.getPosition(h))}if(o!=s.length-1){var c=s[o+1];(!0===i&&void 0===e[c.id]||!1===i)&&(l=Math.min(l,this.direction.getPosition(c)-r))}return[a,l]}},{key:"_centerParent",value:function(t){if(this.hierarchical.parentReference[t.id])for(var e=this.hierarchical.parentReference[t.id],i=0;i<e.length;i++){var n=e[i],o=this.body.nodes[n],r=this.hierarchical.childrenReference[n];if(void 0!==r){var s=this._getCenterPosition(r),a=this.direction.getPosition(o),l=r9(this._getSpaceAroundNode(o),2),h=l[0],c=l[1],d=a-s;(d<0&&Math.abs(d)<c-this.options.hierarchical.nodeSpacing||d>0&&Math.abs(d)<h-this.options.hierarchical.nodeSpacing)&&this.direction.setPosition(o,s)}}}},{key:"_placeNodesByHierarchy",value:function(t){for(var e in this.positionedNodes={},t)if(Object.prototype.hasOwnProperty.call(t,e)){var i,n=sf(t[e]);n=this._indexArrayToNodes(n),fn(i=this.direction).call(i,n);for(var o=0,r=0;r<n.length;r++){var s=n[r];if(void 0===this.positionedNodes[s.id]){var a=this.options.hierarchical.nodeSpacing,l=a*o;o>0&&(l=this.direction.getPosition(n[r-1])+a),this.direction.setPosition(s,l,e),this._validatePositionAndContinue(s,e,l),o++}}}}},{key:"_placeBranchNodes",value:function(t,e){var i,n=this.hierarchical.childrenReference[t];if(void 0!==n){for(var o=[],r=0;r<n.length;r++)o.push(this.body.nodes[n[r]]);fn(i=this.direction).call(i,o);for(var s=0;s<o.length;s++){var a=o[s],l=this.hierarchical.levels[a.id];if(!(l>e)||void 0!==this.positionedNodes[a.id])return;var h=this.options.hierarchical.nodeSpacing,c=void 0;c=0===s?this.direction.getPosition(this.body.nodes[t]):this.direction.getPosition(o[s-1])+h,this.direction.setPosition(a,c,l),this._validatePositionAndContinue(a,l,c)}var d=this._getCenterPosition(o);this.direction.setPosition(this.body.nodes[t],d,e)}}},{key:"_validatePositionAndContinue",value:function(t,e,i){if(this.hierarchical.isTree){if(void 0!==this.lastNodeOnLevel[e]){var n=this.direction.getPosition(this.body.nodes[this.lastNodeOnLevel[e]]);if(i-n<this.options.hierarchical.nodeSpacing){var o=n+this.options.hierarchical.nodeSpacing-i,r=this._findCommonParent(this.lastNodeOnLevel[e],t.id);this._shiftBlock(r.withChild,o)}}this.lastNodeOnLevel[e]=t.id,this.positionedNodes[t.id]=!0,this._placeBranchNodes(t.id,e)}}},{key:"_indexArrayToNodes",value:function(t){for(var e=[],i=0;i<t.length;i++)e.push(this.body.nodes[t[i]]);return e}},{key:"_getDistribution",value:function(){var t,e,i={};for(t in this.body.nodes)if(Object.prototype.hasOwnProperty.call(this.body.nodes,t)){e=this.body.nodes[t];var n=void 0===this.hierarchical.levels[t]?0:this.hierarchical.levels[t];this.direction.fix(e,n),void 0===i[n]&&(i[n]={}),i[n][t]=e}return i}},{key:"_getActiveEdges",value:function(t){var e=this,i=[];return hx(t.edges,function(t){var n;-1!==ab(n=e.body.edgeIndices).call(n,t.id)&&i.push(t)}),i}},{key:"_getHubSizes",value:function(){var t=this,e={};hx(this.body.nodeIndices,function(i){var n=t.body.nodes[i];e[t._getActiveEdges(n).length]=!0});var i=[];return hx(e,function(t){i.push(Number(t))}),fn(i).call(i,function(t,e){return e-t}),i}},{key:"_determineLevelsByHubsize",value:function(){for(var t=this,e=function(e,i){t.hierarchical.levelDownstream(e,i)},i=this._getHubSizes(),n=0;n<i.length&&!function(){var o=i[n];if(0===o)return 1;hx(t.body.nodeIndices,function(i){var n=t.body.nodes[i];o===t._getActiveEdges(n).length&&t._crawlNetwork(e,i)})}();++n);}},{key:"_determineLevelsCustomCallback",value:function(){var t=this,e=function(t,e,i){};this._crawlNetwork(function(i,n,o){var r=t.hierarchical.levels[i.id];void 0===r&&(r=t.hierarchical.levels[i.id]=1e5);var s=e(gv.cloneOptions(i,"node"),gv.cloneOptions(n,"node"),gv.cloneOptions(o,"edge"));t.hierarchical.levels[n.id]=r+s}),this.hierarchical.setMinLevelToZero(this.body.nodes)}},{key:"_determineLevelsDirected",value:function(){var t,e,i,n=this,o=uH(i=this.body.nodeIndices).call(i,function(t,e){return t.set(e,n.body.nodes[e]),t},new cW);"roots"===this.options.hierarchical.shakeTowards?this.hierarchical.levels=mp(function(e){var i,n;return mu(i=s2(n=e.edges).call(n,function(e){return t.has(e.toId)})).call(i,function(t){return t.from===e})},function(t,e){return e<t},"to",t=o):this.hierarchical.levels=mp(function(t){var i,n;return mu(i=s2(n=t.edges).call(n,function(t){return e.has(t.toId)})).call(i,function(e){return e.to===t})},function(t,e){return e>t},"from",e=o),this.hierarchical.setMinLevelToZero(this.body.nodes)}},{key:"_generateMap",value:function(){var t=this;this._crawlNetwork(function(e,i){t.hierarchical.levels[i.id]>t.hierarchical.levels[e.id]&&t.hierarchical.addRelation(e.id,i.id)}),this.hierarchical.checkIfTree()}},{key:"_crawlNetwork",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},i=arguments.length>1?arguments[1]:void 0,n={},o=function i(o,r){if(void 0===n[o.id]){t.hierarchical.setTreeIndex(o,r),n[o.id]=!0;for(var s,a=t._getActiveEdges(o),l=0;l<a.length;l++){var h=a[l];!0===h.connected&&(s=h.toId==o.id?h.from:h.to,o.id!=s.id&&(e(o,s,h),i(s,r)))}}};if(void 0===i)for(var r=0,s=0;s<this.body.nodeIndices.length;s++){var a=this.body.nodeIndices[s];void 0===n[a]&&(o(this.body.nodes[a],r),r+=1)}else{var l=this.body.nodes[i];if(void 0===l){console.error("Node not found:",i);return}o(l)}}},{key:"_shiftBlock",value:function(t,e){var i=this,n={};!function t(o){if(!n[o]){n[o]=!0,i.direction.shift(o,e);var r=i.hierarchical.childrenReference[o];if(void 0!==r)for(var s=0;s<r.length;s++)t(r[s])}}(t)}},{key:"_findCommonParent",value:function(t,e){var i=this,n={};return function t(e,n){var o=i.hierarchical.parentReference[n];if(void 0!==o)for(var r=0;r<o.length;r++){var s=o[r];e[s]=!0,t(e,s)}}(n,t),function t(e,n){var o=i.hierarchical.parentReference[n];if(void 0!==o)for(var r=0;r<o.length;r++){var s=o[r];if(void 0!==e[s])return{foundParent:s,withChild:n};var a=t(e,s);if(null!==a.foundParent)return a}return{foundParent:null,withChild:n}}(n,e)}},{key:"setDirectionStrategy",value:function(){"UD"===this.options.hierarchical.direction||"DU"===this.options.hierarchical.direction?this.direction=new ma(this):this.direction=new ml(this)}},{key:"_getCenterPosition",value:function(t){for(var e=1e9,i=-1e9,n=0;n<t.length;n++){var o=void 0;if(void 0!==t[n].id)o=t[n];else{var r=t[n];o=this.body.nodes[r]}var s=this.direction.getPosition(o);e=Math.min(e,s),i=Math.max(i,s)}return .5*(e+i)}}]),t}();function mv(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}var my=function(){function t(e,i,n,o){var r,s,a=this;n4(this,t),this.body=e,this.canvas=i,this.selectionHandler=n,this.interactionHandler=o,this.editMode=!1,this.manipulationDiv=void 0,this.editModeDiv=void 0,this.closeDiv=void 0,this._domEventListenerCleanupQueue=[],this.temporaryUIFunctions={},this.temporaryEventFunctions=[],this.touchTime=0,this.temporaryIds={nodes:[],edges:[]},this.guiEnabled=!1,this.inMode=!1,this.selectedControlNode=void 0,this.options={},this.defaultOptions={enabled:!1,initiallyActive:!1,addNode:!0,addEdge:!0,editNode:void 0,editEdge:!0,deleteNode:!0,deleteEdge:!0,controlNodeStyle:{shape:"dot",size:6,color:{background:"#ff0000",border:"#3c3c3c",highlight:{background:"#07f968",border:"#3c3c3c"}},borderWidth:2,borderWidthSelected:2}},eK(this.options,this.defaultOptions),this.body.emitter.on("destroy",function(){a._clean()}),this.body.emitter.on("_dataChanged",e7(r=this._restore).call(r,this)),this.body.emitter.on("_resetData",e7(s=this._restore).call(s,this))}return rH(t,[{key:"_restore",value:function(){!1!==this.inMode&&(!0===this.options.initiallyActive?this.enableEditMode():this.disableEditMode())}},{key:"setOptions",value:function(t,e,i){void 0!==e&&(void 0!==e.locale?this.options.locale=e.locale:this.options.locale=i.locale,void 0!==e.locales?this.options.locales=e.locales:this.options.locales=i.locales),void 0!==t&&("boolean"==typeof t?this.options.enabled=t:(this.options.enabled=!0,hm(this.options,t)),!0===this.options.initiallyActive&&(this.editMode=!0),this._setup())}},{key:"toggleEditMode",value:function(){!0===this.editMode?this.disableEditMode():this.enableEditMode()}},{key:"enableEditMode",value:function(){this.editMode=!0,this._clean(),!0===this.guiEnabled&&(this.manipulationDiv.style.display="block",this.closeDiv.style.display="block",this.editModeDiv.style.display="none",this.showManipulatorToolbar())}},{key:"disableEditMode",value:function(){this.editMode=!1,this._clean(),!0===this.guiEnabled&&(this.manipulationDiv.style.display="none",this.closeDiv.style.display="none",this.editModeDiv.style.display="block",this._createEditButton())}},{key:"showManipulatorToolbar",value:function(){if(this._clean(),this.manipulationDOM={},!0===this.guiEnabled){this.editMode=!0,this.manipulationDiv.style.display="block",this.closeDiv.style.display="block";var t,e,i=this.selectionHandler.getSelectedNodeCount(),n=this.selectionHandler.getSelectedEdgeCount(),o=this.options.locales[this.options.locale],r=!1;!1!==this.options.addNode&&(this._createAddNodeButton(o),r=!0),!1!==this.options.addEdge&&(!0===r?this._createSeperator(1):r=!0,this._createAddEdgeButton(o)),1===i&&"function"==typeof this.options.editNode?(!0===r?this._createSeperator(2):r=!0,this._createEditNodeButton(o)):1===n&&0===i&&!1!==this.options.editEdge&&(!0===r?this._createSeperator(3):r=!0,this._createEditEdgeButton(o)),0!==i+n&&(i>0&&!1!==this.options.deleteNode?(!0===r&&this._createSeperator(4),this._createDeleteButton(o)):0===i&&!1!==this.options.deleteEdge&&(!0===r&&this._createSeperator(4),this._createDeleteButton(o))),this._bindElementEvents(this.closeDiv,e7(t=this.toggleEditMode).call(t,this)),this._temporaryBindEvent("select",e7(e=this.showManipulatorToolbar).call(e,this))}this.body.emitter.emit("_redraw")}},{key:"addNodeMode",value:function(){var t;if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="addNode",!0===this.guiEnabled){var e,i=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(i),this._createSeperator(),this._createDescription(i.addDescription||this.options.locales.en.addDescription),this._bindElementEvents(this.closeDiv,e7(e=this.toggleEditMode).call(e,this))}this._temporaryBindEvent("click",e7(t=this._performAddNode).call(t,this))}},{key:"editNode",value:function(){var t=this;!0!==this.editMode&&this.enableEditMode(),this._clean();var e=this.selectionHandler.getSelectedNodes()[0];if(void 0!==e){if(this.inMode="editNode","function"==typeof this.options.editNode){if(!0!==e.isCluster){var i=hm({},e.options,!1);if(i.x=e.x,i.y=e.y,2===this.options.editNode.length)this.options.editNode(i,function(e){null!=e&&"editNode"===t.inMode&&t.body.data.nodes.getDataSet().update(e),t.showManipulatorToolbar()});else throw Error("The function for edit does not support two arguments (data, callback)")}else alert(this.options.locales[this.options.locale].editClusterError||this.options.locales.en.editClusterError)}else throw Error("No function has been configured to handle the editing of nodes.")}else this.showManipulatorToolbar()}},{key:"addEdgeMode",value:function(){var t,e,i,n,o;if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="addEdge",!0===this.guiEnabled){var r,s=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(s),this._createSeperator(),this._createDescription(s.edgeDescription||this.options.locales.en.edgeDescription),this._bindElementEvents(this.closeDiv,e7(r=this.toggleEditMode).call(r,this))}this._temporaryBindUI("onTouch",e7(t=this._handleConnect).call(t,this)),this._temporaryBindUI("onDragEnd",e7(e=this._finishConnect).call(e,this)),this._temporaryBindUI("onDrag",e7(i=this._dragControlNode).call(i,this)),this._temporaryBindUI("onRelease",e7(n=this._finishConnect).call(n,this)),this._temporaryBindUI("onDragStart",e7(o=this._dragStartEdge).call(o,this)),this._temporaryBindUI("onHold",function(){})}},{key:"editEdgeMode",value:function(){if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="editEdge","object"===rN(this.options.editEdge)&&"function"==typeof this.options.editEdge.editWithoutDrag&&(this.edgeBeingEditedId=this.selectionHandler.getSelectedEdgeIds()[0],void 0!==this.edgeBeingEditedId)){var t=this.body.edges[this.edgeBeingEditedId];this._performEditEdge(t.from.id,t.to.id);return}if(!0===this.guiEnabled){var e,i=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(i),this._createSeperator(),this._createDescription(i.editEdgeDescription||this.options.locales.en.editEdgeDescription),this._bindElementEvents(this.closeDiv,e7(e=this.toggleEditMode).call(e,this))}if(this.edgeBeingEditedId=this.selectionHandler.getSelectedEdgeIds()[0],void 0!==this.edgeBeingEditedId){var n,o,r,s,a=this.body.edges[this.edgeBeingEditedId],l=this._getNewTargetNode(a.from.x,a.from.y),h=this._getNewTargetNode(a.to.x,a.to.y);this.temporaryIds.nodes.push(l.id),this.temporaryIds.nodes.push(h.id),this.body.nodes[l.id]=l,this.body.nodeIndices.push(l.id),this.body.nodes[h.id]=h,this.body.nodeIndices.push(h.id),this._temporaryBindUI("onTouch",e7(n=this._controlNodeTouch).call(n,this)),this._temporaryBindUI("onTap",function(){}),this._temporaryBindUI("onHold",function(){}),this._temporaryBindUI("onDragStart",e7(o=this._controlNodeDragStart).call(o,this)),this._temporaryBindUI("onDrag",e7(r=this._controlNodeDrag).call(r,this)),this._temporaryBindUI("onDragEnd",e7(s=this._controlNodeDragEnd).call(s,this)),this._temporaryBindUI("onMouseMove",function(){}),this._temporaryBindEvent("beforeDrawing",function(t){var e=a.edgeType.findBorderPositions(t);!1===l.selected&&(l.x=e.from.x,l.y=e.from.y),!1===h.selected&&(h.x=e.to.x,h.y=e.to.y)}),this.body.emitter.emit("_redraw")}else this.showManipulatorToolbar()}},{key:"deleteSelected",value:function(){var t=this;!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="delete";var e=this.selectionHandler.getSelectedNodeIds(),i=this.selectionHandler.getSelectedEdgeIds(),n=void 0;if(e.length>0){for(var o=0;o<e.length;o++)if(!0===this.body.nodes[e[o]].isCluster){alert(this.options.locales[this.options.locale].deleteClusterError||this.options.locales.en.deleteClusterError);return}"function"==typeof this.options.deleteNode&&(n=this.options.deleteNode)}else i.length>0&&"function"==typeof this.options.deleteEdge&&(n=this.options.deleteEdge);if("function"==typeof n){if(2===n.length)n({nodes:e,edges:i},function(e){null!=e&&"delete"===t.inMode&&(t.body.data.edges.getDataSet().remove(e.edges),t.body.data.nodes.getDataSet().remove(e.nodes)),t.body.emitter.emit("startSimulation"),t.showManipulatorToolbar()});else throw Error("The function for delete does not support two arguments (data, callback)")}else this.body.data.edges.getDataSet().remove(i),this.body.data.nodes.getDataSet().remove(e),this.body.emitter.emit("startSimulation"),this.showManipulatorToolbar()}},{key:"_setup",value:function(){!0===this.options.enabled?(this.guiEnabled=!0,this._createWrappers(),!1===this.editMode?this._createEditButton():this.showManipulatorToolbar()):(this._removeManipulationDOM(),this.guiEnabled=!1)}},{key:"_createWrappers",value:function(){if(void 0===this.manipulationDiv&&(this.manipulationDiv=document.createElement("div"),this.manipulationDiv.className="vis-manipulation",!0===this.editMode?this.manipulationDiv.style.display="block":this.manipulationDiv.style.display="none",this.canvas.frame.appendChild(this.manipulationDiv)),void 0===this.editModeDiv&&(this.editModeDiv=document.createElement("div"),this.editModeDiv.className="vis-edit-mode",!0===this.editMode?this.editModeDiv.style.display="none":this.editModeDiv.style.display="block",this.canvas.frame.appendChild(this.editModeDiv)),void 0===this.closeDiv){var t,e;this.closeDiv=document.createElement("button"),this.closeDiv.className="vis-close",this.closeDiv.setAttribute("aria-label",null!==(t=null===(e=this.options.locales[this.options.locale])||void 0===e?void 0:e.close)&&void 0!==t?t:this.options.locales.en.close),this.closeDiv.style.display=this.manipulationDiv.style.display,this.canvas.frame.appendChild(this.closeDiv)}}},{key:"_getNewTargetNode",value:function(t,e){var i=hm({},this.options.controlNodeStyle);i.id="targetNode"+fj(),i.hidden=!1,i.physics=!1,i.x=t,i.y=e;var n=this.body.functions.createNode(i);return n.shape.boundingBox={left:t,right:t,top:e,bottom:e},n}},{key:"_createEditButton",value:function(){this._clean(),this.manipulationDOM={},hh(this.editModeDiv);var t,e=this.options.locales[this.options.locale],i=this._createButton("editMode","vis-edit vis-edit-mode",e.edit||this.options.locales.en.edit);this.editModeDiv.appendChild(i),this._bindElementEvents(i,e7(t=this.toggleEditMode).call(t,this))}},{key:"_clean",value:function(){this.inMode=!1,!0===this.guiEnabled&&(hh(this.editModeDiv),hh(this.manipulationDiv),this._cleanupDOMEventListeners()),this._cleanupTemporaryNodesAndEdges(),this._unbindTemporaryUIs(),this._unbindTemporaryEvents(),this.body.emitter.emit("restorePhysics")}},{key:"_cleanupDOMEventListeners",value:function(){var t,e,i=function(t,e){var i=void 0!==st&&n3(t)||t["@@iterator"];if(!i){if(sl(t)||(i=function(t,e){if(t){if("string"==typeof t)return mv(t,void 0);var i,n=so(i=Object.prototype.toString.call(t)).call(i,8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return nG(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mv(t,void 0)}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(sL(t=this._domEventListenerCleanupQueue).call(t,0));try{for(i.s();!(e=i.n()).done;)(0,e.value)()}catch(t){i.e(t)}finally{i.f()}}},{key:"_removeManipulationDOM",value:function(){this._clean(),hh(this.manipulationDiv),hh(this.editModeDiv),hh(this.closeDiv),this.manipulationDiv&&this.canvas.frame.removeChild(this.manipulationDiv),this.editModeDiv&&this.canvas.frame.removeChild(this.editModeDiv),this.closeDiv&&this.canvas.frame.removeChild(this.closeDiv),this.manipulationDiv=void 0,this.editModeDiv=void 0,this.closeDiv=void 0}},{key:"_createSeperator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.manipulationDOM["seperatorLineDiv"+t]=document.createElement("div"),this.manipulationDOM["seperatorLineDiv"+t].className="vis-separator-line",this.manipulationDiv.appendChild(this.manipulationDOM["seperatorLineDiv"+t])}},{key:"_createAddNodeButton",value:function(t){var e,i=this._createButton("addNode","vis-add",t.addNode||this.options.locales.en.addNode);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,e7(e=this.addNodeMode).call(e,this))}},{key:"_createAddEdgeButton",value:function(t){var e,i=this._createButton("addEdge","vis-connect",t.addEdge||this.options.locales.en.addEdge);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,e7(e=this.addEdgeMode).call(e,this))}},{key:"_createEditNodeButton",value:function(t){var e,i=this._createButton("editNode","vis-edit",t.editNode||this.options.locales.en.editNode);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,e7(e=this.editNode).call(e,this))}},{key:"_createEditEdgeButton",value:function(t){var e,i=this._createButton("editEdge","vis-edit",t.editEdge||this.options.locales.en.editEdge);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,e7(e=this.editEdgeMode).call(e,this))}},{key:"_createDeleteButton",value:function(t){i=this.options.rtl?"vis-delete-rtl":"vis-delete";var e,i,n=this._createButton("delete",i,t.del||this.options.locales.en.del);this.manipulationDiv.appendChild(n),this._bindElementEvents(n,e7(e=this.deleteSelected).call(e,this))}},{key:"_createBackButton",value:function(t){var e,i=this._createButton("back","vis-back",t.back||this.options.locales.en.back);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,e7(e=this.showManipulatorToolbar).call(e,this))}},{key:"_createButton",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vis-label";return this.manipulationDOM[t+"Div"]=document.createElement("button"),this.manipulationDOM[t+"Div"].className="vis-button "+e,this.manipulationDOM[t+"Label"]=document.createElement("div"),this.manipulationDOM[t+"Label"].className=n,this.manipulationDOM[t+"Label"].innerText=i,this.manipulationDOM[t+"Div"].appendChild(this.manipulationDOM[t+"Label"]),this.manipulationDOM[t+"Div"]}},{key:"_createDescription",value:function(t){this.manipulationDOM.descriptionLabel=document.createElement("div"),this.manipulationDOM.descriptionLabel.className="vis-none",this.manipulationDOM.descriptionLabel.innerText=t,this.manipulationDiv.appendChild(this.manipulationDOM.descriptionLabel)}},{key:"_temporaryBindEvent",value:function(t,e){this.temporaryEventFunctions.push({event:t,boundFunction:e}),this.body.emitter.on(t,e)}},{key:"_temporaryBindUI",value:function(t,e){if(void 0!==this.body.eventListeners[t])this.temporaryUIFunctions[t]=this.body.eventListeners[t],this.body.eventListeners[t]=e;else throw Error("This UI function does not exist. Typo? You tried: "+t+" possible are: "+a_(sf(this.body.eventListeners)))}},{key:"_unbindTemporaryUIs",value:function(){for(var t in this.temporaryUIFunctions)Object.prototype.hasOwnProperty.call(this.temporaryUIFunctions,t)&&(this.body.eventListeners[t]=this.temporaryUIFunctions[t],delete this.temporaryUIFunctions[t]);this.temporaryUIFunctions={}}},{key:"_unbindTemporaryEvents",value:function(){for(var t=0;t<this.temporaryEventFunctions.length;t++){var e=this.temporaryEventFunctions[t].event,i=this.temporaryEventFunctions[t].boundFunction;this.body.emitter.off(e,i)}this.temporaryEventFunctions=[]}},{key:"_bindElementEvents",value:function(t,e){var i=new hq(t,{});gk(i,e),this._domEventListenerCleanupQueue.push(function(){i.destroy()});var n=function(t){var i=t.keyCode,n=t.key;("Enter"===n||" "===n||13===i||32===i)&&e()};t.addEventListener("keyup",n,!1),this._domEventListenerCleanupQueue.push(function(){t.removeEventListener("keyup",n,!1)})}},{key:"_cleanupTemporaryNodesAndEdges",value:function(){for(var t=0;t<this.temporaryIds.edges.length;t++){this.body.edges[this.temporaryIds.edges[t]].disconnect(),delete this.body.edges[this.temporaryIds.edges[t]];var e,i,n=ab(e=this.body.edgeIndices).call(e,this.temporaryIds.edges[t]);-1!==n&&sL(i=this.body.edgeIndices).call(i,n,1)}for(var o=0;o<this.temporaryIds.nodes.length;o++){delete this.body.nodes[this.temporaryIds.nodes[o]];var r,s,a=ab(r=this.body.nodeIndices).call(r,this.temporaryIds.nodes[o]);-1!==a&&sL(s=this.body.nodeIndices).call(s,a,1)}this.temporaryIds={nodes:[],edges:[]}}},{key:"_controlNodeTouch",value:function(t){this.selectionHandler.unselectAll(),this.lastTouch=this.body.functions.getPointer(t.center),this.lastTouch.translation=eK({},this.body.view.translation)}},{key:"_controlNodeDragStart",value:function(){var t=this.lastTouch,e=this.selectionHandler._pointerToPositionObject(t),i=this.body.nodes[this.temporaryIds.nodes[0]],n=this.body.nodes[this.temporaryIds.nodes[1]],o=this.body.edges[this.edgeBeingEditedId];this.selectedControlNode=void 0;var r=i.isOverlappingWith(e),s=n.isOverlappingWith(e);!0===r?(this.selectedControlNode=i,o.edgeType.from=i):!0===s&&(this.selectedControlNode=n,o.edgeType.to=n),void 0!==this.selectedControlNode&&this.selectionHandler.selectObject(this.selectedControlNode),this.body.emitter.emit("_redraw")}},{key:"_controlNodeDrag",value:function(t){this.body.emitter.emit("disablePhysics");var e=this.body.functions.getPointer(t.center),i=this.canvas.DOMtoCanvas(e);void 0!==this.selectedControlNode?(this.selectedControlNode.x=i.x,this.selectedControlNode.y=i.y):this.interactionHandler.onDrag(t),this.body.emitter.emit("_redraw")}},{key:"_controlNodeDragEnd",value:function(t){var e=this.body.functions.getPointer(t.center),i=this.selectionHandler._pointerToPositionObject(e),n=this.body.edges[this.edgeBeingEditedId];if(void 0!==this.selectedControlNode){this.selectionHandler.unselectAll();for(var o=this.selectionHandler._getAllNodesOverlappingWith(i),r=void 0,s=o.length-1;s>=0;s--)if(o[s]!==this.selectedControlNode.id){r=this.body.nodes[o[s]];break}if(void 0!==r&&void 0!==this.selectedControlNode){if(!0===r.isCluster)alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError);else{var a=this.body.nodes[this.temporaryIds.nodes[0]];this.selectedControlNode.id===a.id?this._performEditEdge(r.id,n.to.id):this._performEditEdge(n.from.id,r.id)}}else n.updateEdgeType(),this.body.emitter.emit("restorePhysics");this.body.emitter.emit("_redraw")}}},{key:"_handleConnect",value:function(t){if(new Date().valueOf()-this.touchTime>100){this.lastTouch=this.body.functions.getPointer(t.center),this.lastTouch.translation=eK({},this.body.view.translation),this.interactionHandler.drag.pointer=this.lastTouch,this.interactionHandler.drag.translation=this.lastTouch.translation;var e=this.lastTouch,i=this.selectionHandler.getNodeAt(e);if(void 0!==i){if(!0===i.isCluster)alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError);else{var n=this._getNewTargetNode(i.x,i.y);this.body.nodes[n.id]=n,this.body.nodeIndices.push(n.id);var o=this.body.functions.createEdge({id:"connectionEdge"+fj(),from:i.id,to:n.id,physics:!1,smooth:{enabled:!0,type:"continuous",roundness:.5}});this.body.edges[o.id]=o,this.body.edgeIndices.push(o.id),this.temporaryIds.nodes.push(n.id),this.temporaryIds.edges.push(o.id)}}this.touchTime=new Date().valueOf()}}},{key:"_dragControlNode",value:function(t){var e,i=this.body.functions.getPointer(t.center),n=this.selectionHandler._pointerToPositionObject(i),o=void 0;void 0!==this.temporaryIds.edges[0]&&(o=this.body.edges[this.temporaryIds.edges[0]].fromId);for(var r=this.selectionHandler._getAllNodesOverlappingWith(n),s=void 0,a=r.length-1;a>=0;a--)if(-1===ab(e=this.temporaryIds.nodes).call(e,r[a])){s=this.body.nodes[r[a]];break}if(t.controlEdge={from:o,to:s?s.id:void 0},this.selectionHandler.generateClickEvent("controlNodeDragging",t,i),void 0!==this.temporaryIds.nodes[0]){var l=this.body.nodes[this.temporaryIds.nodes[0]];l.x=this.canvas._XconvertDOMtoCanvas(i.x),l.y=this.canvas._YconvertDOMtoCanvas(i.y),this.body.emitter.emit("_redraw")}else this.interactionHandler.onDrag(t)}},{key:"_finishConnect",value:function(t){var e,i=this.body.functions.getPointer(t.center),n=this.selectionHandler._pointerToPositionObject(i),o=void 0;void 0!==this.temporaryIds.edges[0]&&(o=this.body.edges[this.temporaryIds.edges[0]].fromId);for(var r=this.selectionHandler._getAllNodesOverlappingWith(n),s=void 0,a=r.length-1;a>=0;a--)if(-1===ab(e=this.temporaryIds.nodes).call(e,r[a])){s=this.body.nodes[r[a]];break}this._cleanupTemporaryNodesAndEdges(),void 0!==s&&(!0===s.isCluster?alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError):void 0!==this.body.nodes[o]&&void 0!==this.body.nodes[s.id]&&this._performAddEdge(o,s.id)),t.controlEdge={from:o,to:s?s.id:void 0},this.selectionHandler.generateClickEvent("controlNodeDragEnd",t,i),this.body.emitter.emit("_redraw")}},{key:"_dragStartEdge",value:function(t){var e=this.lastTouch;this.selectionHandler.generateClickEvent("dragStart",t,e,void 0,!0)}},{key:"_performAddNode",value:function(t){var e=this,i={id:fj(),x:t.pointer.canvas.x,y:t.pointer.canvas.y,label:"new"};if("function"==typeof this.options.addNode){if(2===this.options.addNode.length)this.options.addNode(i,function(t){null!=t&&"addNode"===e.inMode&&e.body.data.nodes.getDataSet().add(t),e.showManipulatorToolbar()});else throw this.showManipulatorToolbar(),Error("The function for add does not support two arguments (data,callback)")}else this.body.data.nodes.getDataSet().add(i),this.showManipulatorToolbar()}},{key:"_performAddEdge",value:function(t,e){var i=this,n={from:t,to:e};if("function"==typeof this.options.addEdge){if(2===this.options.addEdge.length)this.options.addEdge(n,function(t){null!=t&&"addEdge"===i.inMode&&(i.body.data.edges.getDataSet().add(t),i.selectionHandler.unselectAll(),i.showManipulatorToolbar())});else throw Error("The function for connect does not support two arguments (data,callback)")}else this.body.data.edges.getDataSet().add(n),this.selectionHandler.unselectAll(),this.showManipulatorToolbar()}},{key:"_performEditEdge",value:function(t,e){var i=this,n={id:this.edgeBeingEditedId,from:t,to:e,label:this.body.data.edges.get(this.edgeBeingEditedId).label},o=this.options.editEdge;if("object"===rN(o)&&(o=o.editWithoutDrag),"function"==typeof o){if(2===o.length)o(n,function(t){null==t||"editEdge"!==i.inMode?(i.body.edges[n.id].updateEdgeType(),i.body.emitter.emit("_redraw")):(i.body.data.edges.getDataSet().update(t),i.selectionHandler.unselectAll()),i.showManipulatorToolbar()});else throw Error("The function for edit does not support two arguments (data, callback)")}else this.body.data.edges.getDataSet().update(n),this.selectionHandler.unselectAll(),this.showManipulatorToolbar()}}]),t}(),mb="string",mw="boolean",mx="number",mk="array",mO="object",mS=["arrow","bar","box","circle","crow","curve","diamond","image","inv_curve","inv_triangle","triangle","vee"],m_={borderWidth:{number:mx},borderWidthSelected:{number:mx,undefined:"undefined"},brokenImage:{string:mb,undefined:"undefined"},chosen:{label:{boolean:mw,function:"function"},node:{boolean:mw,function:"function"},__type__:{object:mO,boolean:mw}},color:{border:{string:mb},background:{string:mb},highlight:{border:{string:mb},background:{string:mb},__type__:{object:mO,string:mb}},hover:{border:{string:mb},background:{string:mb},__type__:{object:mO,string:mb}},__type__:{object:mO,string:mb}},opacity:{number:mx,undefined:"undefined"},fixed:{x:{boolean:mw},y:{boolean:mw},__type__:{object:mO,boolean:mw}},font:{align:{string:mb},color:{string:mb},size:{number:mx},face:{string:mb},background:{string:mb},strokeWidth:{number:mx},strokeColor:{string:mb},vadjust:{number:mx},multi:{boolean:mw,string:mb},bold:{color:{string:mb},size:{number:mx},face:{string:mb},mod:{string:mb},vadjust:{number:mx},__type__:{object:mO,string:mb}},boldital:{color:{string:mb},size:{number:mx},face:{string:mb},mod:{string:mb},vadjust:{number:mx},__type__:{object:mO,string:mb}},ital:{color:{string:mb},size:{number:mx},face:{string:mb},mod:{string:mb},vadjust:{number:mx},__type__:{object:mO,string:mb}},mono:{color:{string:mb},size:{number:mx},face:{string:mb},mod:{string:mb},vadjust:{number:mx},__type__:{object:mO,string:mb}},__type__:{object:mO,string:mb}},group:{string:mb,number:mx,undefined:"undefined"},heightConstraint:{minimum:{number:mx},valign:{string:mb},__type__:{object:mO,boolean:mw,number:mx}},hidden:{boolean:mw},icon:{face:{string:mb},code:{string:mb},size:{number:mx},color:{string:mb},weight:{string:mb,number:mx},__type__:{object:mO}},id:{string:mb,number:mx},image:{selected:{string:mb,undefined:"undefined"},unselected:{string:mb,undefined:"undefined"},__type__:{object:mO,string:mb}},imagePadding:{top:{number:mx},right:{number:mx},bottom:{number:mx},left:{number:mx},__type__:{object:mO,number:mx}},label:{string:mb,undefined:"undefined"},labelHighlightBold:{boolean:mw},level:{number:mx,undefined:"undefined"},margin:{top:{number:mx},right:{number:mx},bottom:{number:mx},left:{number:mx},__type__:{object:mO,number:mx}},mass:{number:mx},physics:{boolean:mw},scaling:{min:{number:mx},max:{number:mx},label:{enabled:{boolean:mw},min:{number:mx},max:{number:mx},maxVisible:{number:mx},drawThreshold:{number:mx},__type__:{object:mO,boolean:mw}},customScalingFunction:{function:"function"},__type__:{object:mO}},shadow:{enabled:{boolean:mw},color:{string:mb},size:{number:mx},x:{number:mx},y:{number:mx},__type__:{object:mO,boolean:mw}},shape:{string:["custom","ellipse","circle","database","box","text","image","circularImage","diamond","dot","star","triangle","triangleDown","square","icon","hexagon"]},ctxRenderer:{function:"function"},shapeProperties:{borderDashes:{boolean:mw,array:mk},borderRadius:{number:mx},interpolation:{boolean:mw},useImageSize:{boolean:mw},useBorderWithImage:{boolean:mw},coordinateOrigin:{string:["center","top-left"]},__type__:{object:mO}},size:{number:mx},title:{string:mb,dom:"dom",undefined:"undefined"},value:{number:mx,undefined:"undefined"},widthConstraint:{minimum:{number:mx},maximum:{number:mx},__type__:{object:mO,boolean:mw,number:mx}},x:{number:mx},y:{number:mx},__type__:{object:mO}},mC={configure:{enabled:{boolean:mw},filter:{boolean:mw,string:mb,array:mk,function:"function"},container:{dom:"dom"},showButton:{boolean:mw},__type__:{object:mO,boolean:mw,string:mb,array:mk,function:"function"}},edges:{arrows:{to:{enabled:{boolean:mw},scaleFactor:{number:mx},type:{string:mS},imageHeight:{number:mx},imageWidth:{number:mx},src:{string:mb},__type__:{object:mO,boolean:mw}},middle:{enabled:{boolean:mw},scaleFactor:{number:mx},type:{string:mS},imageWidth:{number:mx},imageHeight:{number:mx},src:{string:mb},__type__:{object:mO,boolean:mw}},from:{enabled:{boolean:mw},scaleFactor:{number:mx},type:{string:mS},imageWidth:{number:mx},imageHeight:{number:mx},src:{string:mb},__type__:{object:mO,boolean:mw}},__type__:{string:["from","to","middle"],object:mO}},endPointOffset:{from:{number:mx},to:{number:mx},__type__:{object:mO,number:mx}},arrowStrikethrough:{boolean:mw},background:{enabled:{boolean:mw},color:{string:mb},size:{number:mx},dashes:{boolean:mw,array:mk},__type__:{object:mO,boolean:mw}},chosen:{label:{boolean:mw,function:"function"},edge:{boolean:mw,function:"function"},__type__:{object:mO,boolean:mw}},color:{color:{string:mb},highlight:{string:mb},hover:{string:mb},inherit:{string:["from","to","both"],boolean:mw},opacity:{number:mx},__type__:{object:mO,string:mb}},dashes:{boolean:mw,array:mk},font:{color:{string:mb},size:{number:mx},face:{string:mb},background:{string:mb},strokeWidth:{number:mx},strokeColor:{string:mb},align:{string:["horizontal","top","middle","bottom"]},vadjust:{number:mx},multi:{boolean:mw,string:mb},bold:{color:{string:mb},size:{number:mx},face:{string:mb},mod:{string:mb},vadjust:{number:mx},__type__:{object:mO,string:mb}},boldital:{color:{string:mb},size:{number:mx},face:{string:mb},mod:{string:mb},vadjust:{number:mx},__type__:{object:mO,string:mb}},ital:{color:{string:mb},size:{number:mx},face:{string:mb},mod:{string:mb},vadjust:{number:mx},__type__:{object:mO,string:mb}},mono:{color:{string:mb},size:{number:mx},face:{string:mb},mod:{string:mb},vadjust:{number:mx},__type__:{object:mO,string:mb}},__type__:{object:mO,string:mb}},hidden:{boolean:mw},hoverWidth:{function:"function",number:mx},label:{string:mb,undefined:"undefined"},labelHighlightBold:{boolean:mw},length:{number:mx,undefined:"undefined"},physics:{boolean:mw},scaling:{min:{number:mx},max:{number:mx},label:{enabled:{boolean:mw},min:{number:mx},max:{number:mx},maxVisible:{number:mx},drawThreshold:{number:mx},__type__:{object:mO,boolean:mw}},customScalingFunction:{function:"function"},__type__:{object:mO}},selectionWidth:{function:"function",number:mx},selfReferenceSize:{number:mx},selfReference:{size:{number:mx},angle:{number:mx},renderBehindTheNode:{boolean:mw},__type__:{object:mO}},shadow:{enabled:{boolean:mw},color:{string:mb},size:{number:mx},x:{number:mx},y:{number:mx},__type__:{object:mO,boolean:mw}},smooth:{enabled:{boolean:mw},type:{string:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"]},roundness:{number:mx},forceDirection:{string:["horizontal","vertical","none"],boolean:mw},__type__:{object:mO,boolean:mw}},title:{string:mb,undefined:"undefined"},width:{number:mx},widthConstraint:{maximum:{number:mx},__type__:{object:mO,boolean:mw,number:mx}},value:{number:mx,undefined:"undefined"},__type__:{object:mO}},groups:{useDefaultGroups:{boolean:mw},__any__:m_,__type__:{object:mO}},interaction:{dragNodes:{boolean:mw},dragView:{boolean:mw},hideEdgesOnDrag:{boolean:mw},hideEdgesOnZoom:{boolean:mw},hideNodesOnDrag:{boolean:mw},hover:{boolean:mw},keyboard:{enabled:{boolean:mw},speed:{x:{number:mx},y:{number:mx},zoom:{number:mx},__type__:{object:mO}},bindToWindow:{boolean:mw},autoFocus:{boolean:mw},__type__:{object:mO,boolean:mw}},multiselect:{boolean:mw},navigationButtons:{boolean:mw},selectable:{boolean:mw},selectConnectedEdges:{boolean:mw},hoverConnectedEdges:{boolean:mw},tooltipDelay:{number:mx},zoomView:{boolean:mw},zoomSpeed:{number:mx},__type__:{object:mO}},layout:{randomSeed:{undefined:"undefined",number:mx,string:mb},improvedLayout:{boolean:mw},clusterThreshold:{number:mx},hierarchical:{enabled:{boolean:mw},levelSeparation:{number:mx},nodeSpacing:{number:mx},treeSpacing:{number:mx},blockShifting:{boolean:mw},edgeMinimization:{boolean:mw},parentCentralization:{boolean:mw},direction:{string:["UD","DU","LR","RL"]},sortMethod:{string:["hubsize","directed"]},shakeTowards:{string:["leaves","roots"]},__type__:{object:mO,boolean:mw}},__type__:{object:mO}},manipulation:{enabled:{boolean:mw},initiallyActive:{boolean:mw},addNode:{boolean:mw,function:"function"},addEdge:{boolean:mw,function:"function"},editNode:{function:"function"},editEdge:{editWithoutDrag:{function:"function"},__type__:{object:mO,boolean:mw,function:"function"}},deleteNode:{boolean:mw,function:"function"},deleteEdge:{boolean:mw,function:"function"},controlNodeStyle:m_,__type__:{object:mO,boolean:mw}},nodes:m_,physics:{enabled:{boolean:mw},barnesHut:{theta:{number:mx},gravitationalConstant:{number:mx},centralGravity:{number:mx},springLength:{number:mx},springConstant:{number:mx},damping:{number:mx},avoidOverlap:{number:mx},__type__:{object:mO}},forceAtlas2Based:{theta:{number:mx},gravitationalConstant:{number:mx},centralGravity:{number:mx},springLength:{number:mx},springConstant:{number:mx},damping:{number:mx},avoidOverlap:{number:mx},__type__:{object:mO}},repulsion:{centralGravity:{number:mx},springLength:{number:mx},springConstant:{number:mx},nodeDistance:{number:mx},damping:{number:mx},__type__:{object:mO}},hierarchicalRepulsion:{centralGravity:{number:mx},springLength:{number:mx},springConstant:{number:mx},nodeDistance:{number:mx},damping:{number:mx},avoidOverlap:{number:mx},__type__:{object:mO}},maxVelocity:{number:mx},minVelocity:{number:mx},solver:{string:["barnesHut","repulsion","hierarchicalRepulsion","forceAtlas2Based"]},stabilization:{enabled:{boolean:mw},iterations:{number:mx},updateInterval:{number:mx},onlyDynamicEdges:{boolean:mw},fit:{boolean:mw},__type__:{object:mO,boolean:mw}},timestep:{number:mx},adaptiveTimestep:{boolean:mw},wind:{x:{number:mx},y:{number:mx},__type__:{object:mO}},__type__:{object:mO,boolean:mw}},autoResize:{boolean:mw},clickToUse:{boolean:mw},locale:{string:mb},locales:{__any__:{any:"any"},__type__:{object:mO}},height:{string:mb},width:{string:mb},__type__:{object:mO}},mE={nodes:{borderWidth:[1,0,10,1],borderWidthSelected:[2,0,10,1],color:{border:["color","#2B7CE9"],background:["color","#97C2FC"],highlight:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]},hover:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]}},opacity:[0,0,1,.1],fixed:{x:!1,y:!1},font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[0,0,50,1],strokeColor:["color","#ffffff"]},hidden:!1,labelHighlightBold:!0,physics:!0,scaling:{min:[10,0,200,1],max:[30,0,200,1],label:{enabled:!1,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},shape:["ellipse","box","circle","database","diamond","dot","square","star","text","triangle","triangleDown","hexagon"],shapeProperties:{borderDashes:!1,borderRadius:[6,0,20,1],interpolation:!0,useImageSize:!1},size:[25,0,200,1]},edges:{arrows:{to:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"},middle:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"},from:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"}},endPointOffset:{from:[0,-10,10,1],to:[0,-10,10,1]},arrowStrikethrough:!0,color:{color:["color","#848484"],highlight:["color","#848484"],hover:["color","#848484"],inherit:["from","to","both",!0,!1],opacity:[1,0,1,.05]},dashes:!1,font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[2,0,50,1],strokeColor:["color","#ffffff"],align:["horizontal","top","middle","bottom"]},hidden:!1,hoverWidth:[1.5,0,5,.1],labelHighlightBold:!0,physics:!0,scaling:{min:[1,0,100,1],max:[15,0,100,1],label:{enabled:!0,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},selectionWidth:[1.5,0,5,.1],selfReferenceSize:[20,0,200,1],selfReference:{size:[20,0,200,1],angle:[Math.PI/2,-6*Math.PI,6*Math.PI,Math.PI/8],renderBehindTheNode:!0},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},smooth:{enabled:!0,type:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"],forceDirection:["horizontal","vertical","none"],roundness:[.5,0,1,.05]},width:[1,0,30,1]},layout:{hierarchical:{enabled:!1,levelSeparation:[150,20,500,5],nodeSpacing:[100,20,500,5],treeSpacing:[200,20,500,5],blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,direction:["UD","DU","LR","RL"],sortMethod:["hubsize","directed"],shakeTowards:["leaves","roots"]}},interaction:{dragNodes:!0,dragView:!0,hideEdgesOnDrag:!1,hideEdgesOnZoom:!1,hideNodesOnDrag:!1,hover:!1,keyboard:{enabled:!1,speed:{x:[10,0,40,1],y:[10,0,40,1],zoom:[.02,0,.1,.005]},bindToWindow:!0,autoFocus:!0},multiselect:!1,navigationButtons:!1,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0,tooltipDelay:[300,0,1e3,25],zoomView:!0,zoomSpeed:[1,.1,2,.1]},manipulation:{enabled:!1,initiallyActive:!1},physics:{enabled:!0,barnesHut:{theta:[.5,.1,1,.05],gravitationalConstant:[-2e3,-3e4,0,50],centralGravity:[.3,0,10,.05],springLength:[95,0,500,5],springConstant:[.04,0,1.2,.005],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},forceAtlas2Based:{theta:[.5,.1,1,.05],gravitationalConstant:[-50,-500,0,1],centralGravity:[.01,0,1,.005],springLength:[95,0,500,5],springConstant:[.08,0,1.2,.005],damping:[.4,0,1,.01],avoidOverlap:[0,0,1,.01]},repulsion:{centralGravity:[.2,0,10,.05],springLength:[200,0,500,5],springConstant:[.05,0,1.2,.005],nodeDistance:[100,0,500,5],damping:[.09,0,1,.01]},hierarchicalRepulsion:{centralGravity:[.2,0,10,.05],springLength:[100,0,500,5],springConstant:[.01,0,1.2,.005],nodeDistance:[120,0,500,5],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},maxVelocity:[50,0,150,1],minVelocity:[.1,.01,.5,.01],solver:["barnesHut","forceAtlas2Based","repulsion","hierarchicalRepulsion"],timestep:[.5,.01,1,.01],wind:{x:[0,-10,10,.1],y:[0,-10,10,.1]}}},mM=function(t,e,i){var n;return!!(sX(t).call(t,"physics")&&sX(n=mE.physics.solver).call(n,e))&&i.physics.solver!==e&&"wind"!==e},mP=Object.freeze({__proto__:null,allOptions:mC,configuratorHideOption:mM,configureOptions:mE}),mT=function(){function t(){n4(this,t)}return rH(t,[{key:"getDistances",value:function(t,e,i){for(var n={},o=t.edges,r=0;r<e.length;r++){var s=e[r],a={};n[s]=a;for(var l=0;l<e.length;l++)a[e[l]]=r==l?0:1e9}for(var h=0;h<i.length;h++){var c=o[i[h]];!0===c.connected&&void 0!==n[c.fromId]&&void 0!==n[c.toId]&&(n[c.fromId][c.toId]=1,n[c.toId][c.fromId]=1)}for(var d=e.length,u=0;u<d;u++)for(var f=e[u],p=n[f],g=0;g<d-1;g++)for(var m=e[g],v=n[m],y=g+1;y<d;y++){var b=e[y],w=n[b],x=Math.min(v[b],v[f]+p[b]);v[b]=x,w[m]=x}return n}}]),t}(),mA=function(){function t(e,i,n){n4(this,t),this.body=e,this.springLength=i,this.springConstant=n,this.distanceSolver=new mT}return rH(t,[{key:"setOptions",value:function(t){t&&(t.springLength&&(this.springLength=t.springLength),t.springConstant&&(this.springConstant=t.springConstant))}},{key:"solve",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.distanceSolver.getDistances(this.body,t,e);this._createL_matrix(n),this._createK_matrix(n),this._createE_matrix();for(var o=0,r=Math.max(1e3,Math.min(10*this.body.nodeIndices.length,6e3)),s=1e9,a=0,l=0,h=0,c=0,d=0;s>.01&&o<r;){o+=1;var u=r9(this._getHighestEnergyNode(i),4);for(a=u[0],s=u[1],l=u[2],h=u[3],c=s,d=0;c>1&&d<5;){d+=1,this._moveNode(a,l,h);var f=r9(this._getEnergy(a),3);c=f[0],l=f[1],h=f[2]}}}},{key:"_getHighestEnergyNode",value:function(t){for(var e=this.body.nodeIndices,i=this.body.nodes,n=0,o=e[0],r=0,s=0,a=0;a<e.length;a++){var l=e[a];if(!0!==i[l].predefinedPosition||!0===i[l].isCluster&&!0===t||!0!==i[l].options.fixed.x||!0!==i[l].options.fixed.y){var h=r9(this._getEnergy(l),3),c=h[0],d=h[1],u=h[2];n<c&&(n=c,o=l,r=d,s=u)}}return[o,n,r,s]}},{key:"_getEnergy",value:function(t){var e=r9(this.E_sums[t],2),i=e[0],n=e[1];return[Math.sqrt(Math.pow(i,2)+Math.pow(n,2)),i,n]}},{key:"_moveNode",value:function(t,e,i){for(var n=this.body.nodeIndices,o=this.body.nodes,r=0,s=0,a=0,l=o[t].x,h=o[t].y,c=this.K_matrix[t],d=this.L_matrix[t],u=0;u<n.length;u++){var f=n[u];if(f!==t){var p=o[f].x,g=o[f].y,m=c[f],v=d[f],y=1/Math.pow(Math.pow(l-p,2)+Math.pow(h-g,2),1.5);r+=m*(1-v*Math.pow(h-g,2)*y),s+=v*(l-p)*(h-g)*y*m,a+=m*(1-v*Math.pow(l-p,2)*y)}}var b=r,w=s,x=(e/b+i/w)/(w/b-a/w);o[t].x+=-(w*x+e)/b,o[t].y+=x,this._updateE_matrix(t)}},{key:"_createL_matrix",value:function(t){var e=this.body.nodeIndices,i=this.springLength;this.L_matrix=[];for(var n=0;n<e.length;n++){this.L_matrix[e[n]]={};for(var o=0;o<e.length;o++)this.L_matrix[e[n]][e[o]]=i*t[e[n]][e[o]]}}},{key:"_createK_matrix",value:function(t){var e=this.body.nodeIndices,i=this.springConstant;this.K_matrix=[];for(var n=0;n<e.length;n++){this.K_matrix[e[n]]={};for(var o=0;o<e.length;o++)this.K_matrix[e[n]][e[o]]=i*Math.pow(t[e[n]][e[o]],-2)}}},{key:"_createE_matrix",value:function(){var t=this.body.nodeIndices,e=this.body.nodes;this.E_matrix={},this.E_sums={};for(var i=0;i<t.length;i++)this.E_matrix[t[i]]=[];for(var n=0;n<t.length;n++){for(var o=t[n],r=e[o].x,s=e[o].y,a=0,l=0,h=n;h<t.length;h++){var c=t[h];if(c!==o){var d=e[c].x,u=e[c].y,f=1/Math.sqrt(Math.pow(r-d,2)+Math.pow(s-u,2));this.E_matrix[o][h]=[this.K_matrix[o][c]*(r-d-this.L_matrix[o][c]*(r-d)*f),this.K_matrix[o][c]*(s-u-this.L_matrix[o][c]*(s-u)*f)],this.E_matrix[c][n]=this.E_matrix[o][h],a+=this.E_matrix[o][h][0],l+=this.E_matrix[o][h][1]}}this.E_sums[o]=[a,l]}}},{key:"_updateE_matrix",value:function(t){for(var e=this.body.nodeIndices,i=this.body.nodes,n=this.E_matrix[t],o=this.K_matrix[t],r=this.L_matrix[t],s=i[t].x,a=i[t].y,l=0,h=0,c=0;c<e.length;c++){var d=e[c];if(d!==t){var u=n[c],f=u[0],p=u[1],g=i[d].x,m=i[d].y,v=1/Math.sqrt(Math.pow(s-g,2)+Math.pow(a-m,2)),y=o[d]*(s-g-r[d]*(s-g)*v),b=o[d]*(a-m-r[d]*(a-m)*v);n[c]=[y,b],l+=y,h+=b;var w=this.E_sums[d];w[0]+=y-f,w[1]+=b-p}}this.E_sums[t]=[l,h]}}]),t}();function mD(t,e,i){var n,o,r,s,a=this;if(!(this instanceof mD))throw SyntaxError("Constructor must be called with the new operator");this.options={},this.defaultOptions={locale:"en",locales:cf,clickToUse:!1},eK(this.options,this.defaultOptions),this.body={container:t,nodes:{},nodeIndices:[],edges:{},edgeIndices:[],emitter:{on:e7(n=this.on).call(n,this),off:e7(o=this.off).call(o,this),emit:e7(r=this.emit).call(r,this),once:e7(s=this.once).call(s,this)},eventListeners:{onTap:function(){},onTouch:function(){},onDoubleTap:function(){},onHold:function(){},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},onMouseWheel:function(){},onPinch:function(){},onMouseMove:function(){},onRelease:function(){},onContext:function(){}},data:{nodes:null,edges:null},functions:{createNode:function(){},createEdge:function(){},getPointer:function(){}},modules:{},view:{scale:1,translation:{x:0,y:0}},selectionBox:{show:!1,position:{start:{x:0,y:0},end:{x:0,y:0}}}},this.bindEventListeners(),this.images=new cg(function(){return a.body.emitter.emit("_requestRedraw")}),this.groups=new cV,this.canvas=new gS(this.body),this.selectionHandler=new mo(this.body,this.canvas),this.interactionHandler=new gT(this.body,this.canvas,this.selectionHandler),this.view=new g_(this.body,this.canvas),this.renderer=new gw(this.body,this.canvas),this.physics=new gm(this.body),this.layoutEngine=new mm(this.body),this.clustering=new gb(this.body),this.manipulation=new my(this.body,this.canvas,this.selectionHandler,this.interactionHandler),this.nodesHandler=new pN(this.body,this.images,this.groups,this.layoutEngine),this.edgesHandler=new ga(this.body,this.images,this.groups),this.body.modules.kamadaKawai=new mA(this.body,150,.05),this.body.modules.clustering=this.clustering,this.canvas._create(),this.setOptions(i),this.setData(e)}function mI(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(t[e].redundant=t[e].used,t[e].used=[])}function mB(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e].redundant){for(var i=0;i<t[e].redundant.length;i++)t[e].redundant[i].parentNode.removeChild(t[e].redundant[i]);t[e].redundant=[]}}function mz(t,e,i){var n;return Object.prototype.hasOwnProperty.call(e,t)?e[t].redundant.length>0?(n=e[t].redundant[0],e[t].redundant.shift()):(n=document.createElementNS("http://www.w3.org/2000/svg",t),i.appendChild(n)):(n=document.createElementNS("http://www.w3.org/2000/svg",t),e[t]={used:[],redundant:[]},i.appendChild(n)),e[t].used.push(n),n}il(mD.prototype),mD.prototype.setOptions=function(t){var e=this;if(null===t&&(t=void 0),void 0!==t){if(!0===h$.validate(t,mC)&&console.error("%cErrors have been found in the supplied options object.",hQ),hp(["locale","locales","clickToUse"],this.options,t),void 0!==t.locale&&(t.locale=function(t,e){try{var i=e.split(/[-_ /]/,2),n=r9(i,2),o=n[0],r=n[1],s=null!=o?o.toLowerCase():null,a=null!=r?r.toUpperCase():null;if(s&&a){var l,h=s+"-"+a;if(Object.prototype.hasOwnProperty.call(t,h))return h;console.warn(sn(l="Unknown variant ".concat(a," of language ")).call(l,s,"."))}if(s){if(Object.prototype.hasOwnProperty.call(t,s))return s;console.warn("Unknown language ".concat(s))}return console.warn("Unknown locale ".concat(e,", falling back to English.")),"en"}catch(t){return console.error(t),console.warn("Unexpected error while normalizing locale ".concat(e,", falling back to English.")),"en"}}(t.locales||this.options.locales,t.locale)),t=this.layoutEngine.setOptions(t.layout,t),this.canvas.setOptions(t),this.groups.setOptions(t.groups),this.nodesHandler.setOptions(t.nodes),this.edgesHandler.setOptions(t.edges),this.physics.setOptions(t.physics),this.manipulation.setOptions(t.manipulation,t,this.options),this.interactionHandler.setOptions(t.interaction),this.renderer.setOptions(t.interaction),this.selectionHandler.setOptions(t.interaction),void 0!==t.groups&&this.body.emitter.emit("refreshNodes"),"configure"in t&&(this.configurator||(this.configurator=new hH(this,this.body.container,mE,this.canvas.pixelRatio,mM)),this.configurator.setOptions(t.configure)),this.configurator&&!0===this.configurator.options.enabled){var i={nodes:{},edges:{},layout:{},interaction:{},manipulation:{},physics:{},global:{}};hm(i.nodes,this.nodesHandler.options),hm(i.edges,this.edgesHandler.options),hm(i.layout,this.layoutEngine.options),hm(i.interaction,this.selectionHandler.options),hm(i.interaction,this.renderer.options),hm(i.interaction,this.interactionHandler.options),hm(i.manipulation,this.manipulation.options),hm(i.physics,this.physics.options),hm(i.global,this.canvas.options),hm(i.global,this.options),this.configurator.setModuleOptions(i)}void 0!==t.clickToUse?!0===t.clickToUse?void 0===this.activator&&(this.activator=new hi(this.canvas.frame),this.activator.on("change",function(){e.body.emitter.emit("activate")})):(void 0!==this.activator&&(this.activator.destroy(),delete this.activator),this.body.emitter.emit("activate")):this.body.emitter.emit("activate"),this.canvas.setSize(),this.body.emitter.emit("startSimulation")}},mD.prototype._updateVisibleIndices=function(){var t=this.body.nodes,e=this.body.edges;for(var i in this.body.nodeIndices=[],this.body.edgeIndices=[],t)Object.prototype.hasOwnProperty.call(t,i)&&!this.clustering._isClusteredNode(i)&&!1===t[i].options.hidden&&this.body.nodeIndices.push(t[i].id);for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=e[n],r=t[o.fromId],s=t[o.toId],a=void 0!==r&&void 0!==s;!this.clustering._isClusteredEdge(n)&&!1===o.options.hidden&&a&&!1===r.options.hidden&&!1===s.options.hidden&&this.body.edgeIndices.push(o.id)}},mD.prototype.bindEventListeners=function(){var t=this;this.body.emitter.on("_dataChanged",function(){t.edgesHandler._updateState(),t.body.emitter.emit("_dataUpdated")}),this.body.emitter.on("_dataUpdated",function(){t.clustering._updateState(),t._updateVisibleIndices(),t._updateValueRange(t.body.nodes),t._updateValueRange(t.body.edges),t.body.emitter.emit("startSimulation"),t.body.emitter.emit("_requestRedraw")})},mD.prototype.setData=function(t){if(this.body.emitter.emit("resetPhysics"),this.body.emitter.emit("_resetData"),this.selectionHandler.unselectAll(),t&&t.dot&&(t.nodes||t.edges))throw SyntaxError('Data must contain either parameter "dot" or  parameter pair "nodes" and "edges", but not both.');if(this.setOptions(t&&t.options),t&&t.dot){console.warn("The dot property has been deprecated. Please use the static convertDot method to convert DOT into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertDot(dotString);");var e=ch(t.dot);this.setData(e);return}if(t&&t.gephi){console.warn("The gephi property has been deprecated. Please use the static convertGephi method to convert gephi into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertGephi(gephiJson);");var i=cd(t.gephi);this.setData(i);return}this.nodesHandler.setData(t&&t.nodes,!0),this.edgesHandler.setData(t&&t.edges,!0),this.body.emitter.emit("_dataChanged"),this.body.emitter.emit("_dataLoaded"),this.body.emitter.emit("initPhysics")},mD.prototype.destroy=function(){for(var t in this.body.emitter.emit("destroy"),this.body.emitter.off(),this.off(),delete this.groups,delete this.canvas,delete this.selectionHandler,delete this.interactionHandler,delete this.view,delete this.renderer,delete this.physics,delete this.layoutEngine,delete this.clustering,delete this.manipulation,delete this.nodesHandler,delete this.edgesHandler,delete this.configurator,delete this.images,this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,t)&&delete this.body.nodes[t];for(var e in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,e)&&delete this.body.edges[e];hh(this.body.container)},mD.prototype._updateValueRange=function(t){var e,i=void 0,n=void 0,o=0;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var r=t[e].getValue();void 0!==r&&(i=void 0===i?r:Math.min(r,i),n=void 0===n?r:Math.max(r,n),o+=r)}if(void 0!==i&&void 0!==n)for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&t[e].setValueRange(i,n,o)},mD.prototype.isActive=function(){return!this.activator||this.activator.active},mD.prototype.setSize=function(){return this.canvas.setSize.apply(this.canvas,arguments)},mD.prototype.canvasToDOM=function(){return this.canvas.canvasToDOM.apply(this.canvas,arguments)},mD.prototype.DOMtoCanvas=function(){return this.canvas.DOMtoCanvas.apply(this.canvas,arguments)},mD.prototype.findNode=function(){return this.clustering.findNode.apply(this.clustering,arguments)},mD.prototype.isCluster=function(){return this.clustering.isCluster.apply(this.clustering,arguments)},mD.prototype.openCluster=function(){return this.clustering.openCluster.apply(this.clustering,arguments)},mD.prototype.cluster=function(){return this.clustering.cluster.apply(this.clustering,arguments)},mD.prototype.getNodesInCluster=function(){return this.clustering.getNodesInCluster.apply(this.clustering,arguments)},mD.prototype.clusterByConnection=function(){return this.clustering.clusterByConnection.apply(this.clustering,arguments)},mD.prototype.clusterByHubsize=function(){return this.clustering.clusterByHubsize.apply(this.clustering,arguments)},mD.prototype.updateClusteredNode=function(){return this.clustering.updateClusteredNode.apply(this.clustering,arguments)},mD.prototype.getClusteredEdges=function(){return this.clustering.getClusteredEdges.apply(this.clustering,arguments)},mD.prototype.getBaseEdge=function(){return this.clustering.getBaseEdge.apply(this.clustering,arguments)},mD.prototype.getBaseEdges=function(){return this.clustering.getBaseEdges.apply(this.clustering,arguments)},mD.prototype.updateEdge=function(){return this.clustering.updateEdge.apply(this.clustering,arguments)},mD.prototype.clusterOutliers=function(){return this.clustering.clusterOutliers.apply(this.clustering,arguments)},mD.prototype.getSeed=function(){return this.layoutEngine.getSeed.apply(this.layoutEngine,arguments)},mD.prototype.enableEditMode=function(){return this.manipulation.enableEditMode.apply(this.manipulation,arguments)},mD.prototype.disableEditMode=function(){return this.manipulation.disableEditMode.apply(this.manipulation,arguments)},mD.prototype.addNodeMode=function(){return this.manipulation.addNodeMode.apply(this.manipulation,arguments)},mD.prototype.editNode=function(){return this.manipulation.editNode.apply(this.manipulation,arguments)},mD.prototype.editNodeMode=function(){return console.warn("Deprecated: Please use editNode instead of editNodeMode."),this.manipulation.editNode.apply(this.manipulation,arguments)},mD.prototype.addEdgeMode=function(){return this.manipulation.addEdgeMode.apply(this.manipulation,arguments)},mD.prototype.editEdgeMode=function(){return this.manipulation.editEdgeMode.apply(this.manipulation,arguments)},mD.prototype.deleteSelected=function(){return this.manipulation.deleteSelected.apply(this.manipulation,arguments)},mD.prototype.getPositions=function(){return this.nodesHandler.getPositions.apply(this.nodesHandler,arguments)},mD.prototype.getPosition=function(){return this.nodesHandler.getPosition.apply(this.nodesHandler,arguments)},mD.prototype.storePositions=function(){return this.nodesHandler.storePositions.apply(this.nodesHandler,arguments)},mD.prototype.moveNode=function(){return this.nodesHandler.moveNode.apply(this.nodesHandler,arguments)},mD.prototype.getBoundingBox=function(){return this.nodesHandler.getBoundingBox.apply(this.nodesHandler,arguments)},mD.prototype.getConnectedNodes=function(t){return void 0!==this.body.nodes[t]?this.nodesHandler.getConnectedNodes.apply(this.nodesHandler,arguments):this.edgesHandler.getConnectedNodes.apply(this.edgesHandler,arguments)},mD.prototype.getConnectedEdges=function(){return this.nodesHandler.getConnectedEdges.apply(this.nodesHandler,arguments)},mD.prototype.startSimulation=function(){return this.physics.startSimulation.apply(this.physics,arguments)},mD.prototype.stopSimulation=function(){return this.physics.stopSimulation.apply(this.physics,arguments)},mD.prototype.stabilize=function(){return this.physics.stabilize.apply(this.physics,arguments)},mD.prototype.getSelection=function(){return this.selectionHandler.getSelection.apply(this.selectionHandler,arguments)},mD.prototype.setSelection=function(){return this.selectionHandler.setSelection.apply(this.selectionHandler,arguments)},mD.prototype.getSelectedNodes=function(){return this.selectionHandler.getSelectedNodeIds.apply(this.selectionHandler,arguments)},mD.prototype.getSelectedEdges=function(){return this.selectionHandler.getSelectedEdgeIds.apply(this.selectionHandler,arguments)},mD.prototype.getNodeAt=function(){var t=this.selectionHandler.getNodeAt.apply(this.selectionHandler,arguments);return void 0!==t&&void 0!==t.id?t.id:t},mD.prototype.getEdgeAt=function(){var t=this.selectionHandler.getEdgeAt.apply(this.selectionHandler,arguments);return void 0!==t&&void 0!==t.id?t.id:t},mD.prototype.selectNodes=function(){return this.selectionHandler.selectNodes.apply(this.selectionHandler,arguments)},mD.prototype.selectEdges=function(){return this.selectionHandler.selectEdges.apply(this.selectionHandler,arguments)},mD.prototype.unselectAll=function(){this.selectionHandler.unselectAll.apply(this.selectionHandler,arguments),this.selectionHandler.commitWithoutEmitting.apply(this.selectionHandler),this.redraw()},mD.prototype.redraw=function(){return this.renderer.redraw.apply(this.renderer,arguments)},mD.prototype.getScale=function(){return this.view.getScale.apply(this.view,arguments)},mD.prototype.getViewPosition=function(){return this.view.getViewPosition.apply(this.view,arguments)},mD.prototype.fit=function(){return this.view.fit.apply(this.view,arguments)},mD.prototype.moveTo=function(){return this.view.moveTo.apply(this.view,arguments)},mD.prototype.focus=function(){return this.view.focus.apply(this.view,arguments)},mD.prototype.releaseNode=function(){return this.view.releaseNode.apply(this.view,arguments)},mD.prototype.getOptionsFromConfigurator=function(){var t={};return this.configurator&&(t=this.configurator.getOptions.apply(this.configurator)),t};var mR=Object.freeze({__proto__:null,cleanupElements:mB,drawBar:function(t,e,i,n,o,r,s,a){if(0!=n){n<0&&(n*=-1,e-=n);var l=mz("rect",r,s);l.setAttributeNS(null,"x",t-.5*i),l.setAttributeNS(null,"y",e),l.setAttributeNS(null,"width",i),l.setAttributeNS(null,"height",n),l.setAttributeNS(null,"class",o),a&&l.setAttributeNS(null,"style",a)}},drawPoint:function(t,e,i,n,o,r){var s;if("circle"==i.style?((s=mz("circle",n,o)).setAttributeNS(null,"cx",t),s.setAttributeNS(null,"cy",e),s.setAttributeNS(null,"r",.5*i.size)):((s=mz("rect",n,o)).setAttributeNS(null,"x",t-.5*i.size),s.setAttributeNS(null,"y",e-.5*i.size),s.setAttributeNS(null,"width",i.size),s.setAttributeNS(null,"height",i.size)),void 0!==i.styles&&s.setAttributeNS(null,"style",i.styles),s.setAttributeNS(null,"class",i.className+" vis-point"),r){var a=mz("text",n,o);r.xOffset&&(t+=r.xOffset),r.yOffset&&(e+=r.yOffset),r.content&&(a.textContent=r.content),r.className&&a.setAttributeNS(null,"class",r.className+" vis-label"),a.setAttributeNS(null,"x",t),a.setAttributeNS(null,"y",e)}return s},getDOMElement:function(t,e,i,n){var o;return Object.prototype.hasOwnProperty.call(e,t)?e[t].redundant.length>0?(o=e[t].redundant[0],e[t].redundant.shift()):(o=document.createElement(t),void 0!==n?i.insertBefore(o,n):i.appendChild(o)):(o=document.createElement(t),e[t]={used:[],redundant:[]},void 0!==n?i.insertBefore(o,n):i.appendChild(o)),e[t].used.push(o),o},getSVGElement:mz,prepareElements:mI,resetElements:function(t){mI(t),mB(t),mI(t)}}),mN={Images:cg,dotparser:cc,gephiParser:cu,allOptions:mP,convertDot:ch,convertGephi:cd},mL=Object.freeze({__proto__:null,DOMutil:mR,DataSet:fZ,DataView:fJ,Hammer:hq,Network:mD,Queue:fG,data:f2,keycharm:gE,network:mN,util:hU})}),w("b5jdx").register(new URL("",import.meta.url).toString(),JSON.parse('["8Z793","index.88d096f7.js","awxPV","althread_web_bg.06f5965c.wasm","eb2m0","index.a46ad4ad.css"]'));const k={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return O(this.context.count)},getNextContextId(){return O(this.context.count++)}};function O(t){let e=String(t),i=e.length-1;return k.context.id+(i?String.fromCharCode(96+i):"")+e}const S=Symbol("solid-proxy"),_="function"==typeof Proxy;Symbol("solid-track"),Symbol("solid-dev-component");const C={equals:(t,e)=>t===e};let E=Z;const M={owned:null,cleanups:null,context:null,owner:null};var P=null;let T=null,A=null,D=null,I=null,B=0;function z(t,e){let i={value:t,observers:null,observerSlots:null,comparator:(e=e?Object.assign({},C,e):C).equals||void 0};return[$.bind(i),t=>("function"==typeof t&&(t=t(T&&T.running&&T.sources.has(i)?i.tValue:i.value)),q(i,t))]}function R(t,e,i){U(G(t,e,!1,1))}function N(e,i,n){E=J;let o=G(e,i,!1,1),r=t&&Q(t);r&&(o.suspense=r),n&&n.render||(o.user=!0),I?I.push(o):U(o)}function L(t,e,i){i=i?Object.assign({},C,i):C;let n=G(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=i.equals||void 0,U(n),$.bind(n)}function F(t){if(null===A)return t();let e=A;A=null;try{return t()}finally{A=e}}function j(t,e,i){let n;let o=Array.isArray(t),r=i&&i.defer;return i=>{let s;if(o){s=Array(t.length);for(let e=0;e<t.length;e++)s[e]=t[e]()}else s=t();if(r)return r=!1,i;let a=F(()=>e(s,n,i));return n=s,a}}function H(t){return null===P||(null===P.cleanups?P.cleanups=[t]:P.cleanups.push(t)),t}const[,W]=z(!1);function V(t,e){let i=Symbol("context");return{id:i,Provider:function(t){let e;return R(()=>e=F(()=>(P.context={...P.context,[i]:t.value},function(t){let e=L(t),i=L(()=>(function t(e){if("function"==typeof e&&!e.length)return t(e());if(Array.isArray(e)){let i=[];for(let n=0;n<e.length;n++){let o=t(e[n]);Array.isArray(o)?i.push.apply(i,o):i.push(o)}return i}return e})(e()));return i.toArray=()=>{let t=i();return Array.isArray(t)?t:null!=t?[t]:[]},i}(()=>t.children))),void 0),e},defaultValue:t}}function Q(t){let e;return P&&P.context&&void 0!==(e=P.context[t.id])?e:t.defaultValue}function $(){let t=T&&T.running;if(this.sources&&(t?this.tState:this.state)){if((t?this.tState:this.state)===1)U(this);else{let t=D;D=null,K(()=>tt(this),!1),D=t}}if(A){let t=this.observers?this.observers.length:0;A.sources?(A.sources.push(this),A.sourceSlots.push(t)):(A.sources=[this],A.sourceSlots=[t]),this.observers?(this.observers.push(A),this.observerSlots.push(A.sources.length-1)):(this.observers=[A],this.observerSlots=[A.sources.length-1])}return t&&T.sources.has(this)?this.tValue:this.value}function q(t,e,i){let n=T&&T.running&&T.sources.has(t)?t.tValue:t.value;if(!t.comparator||!t.comparator(n,e)){if(T){let n=T.running;(n||!i&&T.sources.has(t))&&(T.sources.add(t),t.tValue=e),n||(t.value=e)}else t.value=e;t.observers&&t.observers.length&&K(()=>{for(let e=0;e<t.observers.length;e+=1){let i=t.observers[e],n=T&&T.running;n&&T.disposed.has(i)||((n?i.tState:i.state)||(i.pure?D.push(i):I.push(i),i.observers&&function t(e){let i=T&&T.running;for(let n=0;n<e.observers.length;n+=1){let o=e.observers[n];(i?o.tState:o.state)||(i?o.tState=2:o.state=2,o.pure?D.push(o):I.push(o),o.observers&&t(o))}}(i)),n?i.tState=1:i.state=1)}if(D.length>1e6)throw D=[],Error()},!1)}return e}function U(t){if(!t.fn)return;te(t);let e=B;Y(t,T&&T.running&&T.sources.has(t)?t.tValue:t.value,e),T&&!T.running&&T.sources.has(t)&&queueMicrotask(()=>{K(()=>{T&&(T.running=!0),A=P=t,Y(t,t.tValue,e),A=P=null},!1)})}function Y(t,e,i){let n;let o=P,r=A;A=P=t;try{n=t.fn(e)}catch(e){return t.pure&&(T&&T.running?(t.tState=1,t.tOwned&&t.tOwned.forEach(te),t.tOwned=void 0):(t.state=1,t.owned&&t.owned.forEach(te),t.owned=null)),t.updatedAt=i+1,ti(e)}finally{A=r,P=o}(!t.updatedAt||t.updatedAt<=i)&&(null!=t.updatedAt&&"observers"in t?q(t,n,!0):T&&T.running&&t.pure?(T.sources.add(t),t.tValue=n):t.value=n,t.updatedAt=i)}function G(t,e,i,n=1,o){let r={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:P,context:P?P.context:null,pure:i};return T&&T.running&&(r.state=0,r.tState=n),null===P||P!==M&&(T&&T.running&&P.pure?P.tOwned?P.tOwned.push(r):P.tOwned=[r]:P.owned?P.owned.push(r):P.owned=[r]),r}function X(t){let e=T&&T.running;if((e?t.tState:t.state)===0)return;if((e?t.tState:t.state)===2)return tt(t);if(t.suspense&&F(t.suspense.inFallback))return t.suspense.effects.push(t);let i=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<B);){if(e&&T.disposed.has(t))return;(e?t.tState:t.state)&&i.push(t)}for(let n=i.length-1;n>=0;n--){if(t=i[n],e){let e=t,o=i[n+1];for(;(e=e.owner)&&e!==o;)if(T.disposed.has(e))return}if((e?t.tState:t.state)===1)U(t);else if((e?t.tState:t.state)===2){let e=D;D=null,K(()=>tt(t,i[0]),!1),D=e}}}function K(t,e){if(D)return t();let i=!1;e||(D=[]),I?i=!0:I=[],B++;try{let e=t();return function(t){let e;if(D&&(Z(D),D=null),t)return;if(T){if(T.promises.size||T.queue.size){if(T.running){T.running=!1,T.effects.push.apply(T.effects,I),I=null,W(!0);return}}else{let t=T.sources,i=T.disposed;for(let t of(I.push.apply(I,T.effects),e=T.resolve,I))"tState"in t&&(t.state=t.tState),delete t.tState;T=null,K(()=>{for(let t of i)te(t);for(let e of t){if(e.value=e.tValue,e.owned)for(let t=0,i=e.owned.length;t<i;t++)te(e.owned[t]);e.tOwned&&(e.owned=e.tOwned),delete e.tValue,delete e.tOwned,e.tState=0}W(!1)},!1)}}let i=I;I=null,i.length&&K(()=>E(i),!1),e&&e()}(i),e}catch(t){i||(I=null),D=null,ti(t)}}function Z(t){for(let e=0;e<t.length;e++)X(t[e])}function J(t){let e,i=0;for(e=0;e<t.length;e++){let n=t[e];n.user?t[i++]=n:X(n)}if(k.context){if(k.count){k.effects||(k.effects=[]),k.effects.push(...t.slice(0,i));return}k.context=void 0}for(k.effects&&(k.done||!k.count)&&(t=[...k.effects,...t],i+=k.effects.length,delete k.effects),e=0;e<i;e++)X(t[e])}function tt(t,e){let i=T&&T.running;i?t.tState=0:t.state=0;for(let n=0;n<t.sources.length;n+=1){let o=t.sources[n];if(o.sources){let t=i?o.tState:o.state;1===t?o!==e&&(!o.updatedAt||o.updatedAt<B)&&X(o):2===t&&tt(o,e)}}}function te(t){let e;if(t.sources)for(;t.sources.length;){let e=t.sources.pop(),i=t.sourceSlots.pop(),n=e.observers;if(n&&n.length){let t=n.pop(),o=e.observerSlots.pop();i<n.length&&(t.sourceSlots[o]=i,n[i]=t,e.observerSlots[i]=o)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)te(t.tOwned[e]);delete t.tOwned}if(T&&T.running&&t.pure)!function t(e,i){if(i||(e.tState=0,T.disposed.add(e)),e.owned)for(let i=0;i<e.owned.length;i++)t(e.owned[i])}(t,!0);else if(t.owned){for(e=t.owned.length-1;e>=0;e--)te(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}T&&T.running?t.tState=0:t.state=0}function ti(t,e=P){throw t instanceof Error?t:Error("string"==typeof t?t:"Unknown error",{cause:t})}function tn(t,e){return F(()=>t(e||{}))}function to(){return!0}Symbol("fallback");const tr={get:(t,e,i)=>e===S?i:t.get(e),has:(t,e)=>e===S||t.has(e),set:to,deleteProperty:to,getOwnPropertyDescriptor:(t,e)=>({configurable:!0,enumerable:!0,get:()=>t.get(e),set:to,deleteProperty:to}),ownKeys:t=>t.keys()};function ts(t){return(t="function"==typeof t?t():t)?t:{}}function ta(){for(let t=0,e=this.length;t<e;++t){let e=this[t]();if(void 0!==e)return e}}function tl(...t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];e=e||!!n&&S in n,t[i]="function"==typeof n?(e=!0,L(n)):n}if(_&&e)return new Proxy({get(e){for(let i=t.length-1;i>=0;i--){let n=ts(t[i])[e];if(void 0!==n)return n}},has(e){for(let i=t.length-1;i>=0;i--)if(e in ts(t[i]))return!0;return!1},keys(){let e=[];for(let i=0;i<t.length;i++)e.push(...Object.keys(ts(t[i])));return[...new Set(e)]}},tr);let i={},n=Object.create(null);for(let e=t.length-1;e>=0;e--){let o=t[e];if(!o)continue;let r=Object.getOwnPropertyNames(o);for(let t=r.length-1;t>=0;t--){let e=r[t];if("__proto__"===e||"constructor"===e)continue;let s=Object.getOwnPropertyDescriptor(o,e);if(n[e]){let t=i[e];t&&(s.get?t.push(s.get.bind(o)):void 0!==s.value&&t.push(()=>s.value))}else n[e]=s.get?{enumerable:!0,configurable:!0,get:ta.bind(i[e]=[s.get.bind(o)])}:void 0!==s.value?s:void 0}}let o={},r=Object.keys(n);for(let t=r.length-1;t>=0;t--){let e=r[t],i=n[e];i&&i.get?Object.defineProperty(o,e,i):o[e]=i?i.value:void 0}return o}function th(t,...e){if(_&&S in t){let i=new Set(e.length>1?e.flat():e[0]),n=e.map(e=>new Proxy({get:i=>e.includes(i)?t[i]:void 0,has:i=>e.includes(i)&&i in t,keys:()=>e.filter(e=>e in t)},tr));return n.push(new Proxy({get:e=>i.has(e)?void 0:t[e],has:e=>!i.has(e)&&e in t,keys:()=>Object.keys(t).filter(t=>!i.has(t))},tr)),n}let i={},n=e.map(()=>({}));for(let o of Object.getOwnPropertyNames(t)){let r=Object.getOwnPropertyDescriptor(t,o),s=!r.get&&!r.set&&r.enumerable&&r.writable&&r.configurable,a=!1,l=0;for(let t of e)t.includes(o)&&(a=!0,s?n[l][o]=r.value:Object.defineProperty(n[l],o,r)),++l;a||(s?i[o]=r.value:Object.defineProperty(i,o,r))}return[...n,i]}let tc=0;const td=t=>`Stale read from <${t}>.`;function tu(t){let e=t.keyed,i=L(()=>t.when,void 0,{equals:(t,i)=>e?t===i:!t==!i});return L(()=>{let n=i();if(n){let o=t.children;return"function"==typeof o&&o.length>0?F(()=>o(e?n:()=>{if(!F(i))throw td("Show");return t.when})):o}return t.fallback},void 0,void 0)}const tf=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline","allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"]),tp=new Set(["innerHTML","textContent","innerText","children"]),tg=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),tm=Object.assign(Object.create(null),{class:"className",formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}}),tv=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),ty=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),tb={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},tw="_$DX_DELEGATE";function tx(t,e,i){let n;let o=()=>{let e=document.createElement("template");return e.innerHTML=t,i?e.content.firstChild.firstChild:e.content.firstChild},r=e?()=>F(()=>document.importNode(n||(n=o()),!0)):()=>(n||(n=o())).cloneNode(!0);return r.cloneNode=r,r}function tk(t,e=window.document){let i=e[tw]||(e[tw]=new Set);for(let n=0,o=t.length;n<o;n++){let o=t[n];i.has(o)||(i.add(o),e.addEventListener(o,tP))}}function tO(t,e,i){tC(t)||(null==i?t.removeAttribute(e):t.setAttribute(e,i))}function tS(t,e,i){return F(()=>t(e,i))}function t_(t,e,i,n){if(void 0===i||n||(n=[]),"function"!=typeof e)return tT(t,e,n,i);R(n=>tT(t,e(),n,i),n)}function tC(t){return!!k.context&&!k.done&&(!t||t.isConnected)}function tE(t,e,i){let n=e.trim().split(/\s+/);for(let e=0,o=n.length;e<o;e++)t.classList.toggle(n[e],i)}function tM(t,e,i,n,o,r,s){var a,l;let h,c,d,u,f;if("style"===e)return function(t,e,i){let n,o;if(!e)return i?tO(t,"style"):e;let r=t.style;if("string"==typeof e)return r.cssText=e;for(o in"string"==typeof i&&(r.cssText=i=void 0),i||(i={}),e||(e={}),i)null==e[o]&&r.removeProperty(o),delete i[o];for(o in e)(n=e[o])!==i[o]&&(r.setProperty(o,n),i[o]=n);return i}(t,i,n);if("classList"===e)return function(t,e,i={}){let n,o;let r=Object.keys(e||{}),s=Object.keys(i);for(n=0,o=s.length;n<o;n++){let o=s[n];o&&"undefined"!==o&&!e[o]&&(tE(t,o,!1),delete i[o])}for(n=0,o=r.length;n<o;n++){let o=r[n],s=!!e[o];o&&"undefined"!==o&&i[o]!==s&&s&&(tE(t,o,!0),i[o]=s)}return i}(t,i,n);if(i===n)return n;if("ref"===e)r||i(t);else if("on:"===e.slice(0,3)){let o=e.slice(3);n&&t.removeEventListener(o,n,"function"!=typeof n&&n),i&&t.addEventListener(o,i,"function"!=typeof i&&i)}else if("oncapture:"===e.slice(0,10)){let o=e.slice(10);n&&t.removeEventListener(o,n,!0),i&&t.addEventListener(o,i,!0)}else if("on"===e.slice(0,2)){let o=e.slice(2).toLowerCase(),r=tv.has(o);if(!r&&n){let e=Array.isArray(n)?n[0]:n;t.removeEventListener(o,e)}(r||i)&&(!function(t,e,i,n){if(n)Array.isArray(i)?(t[`$$${e}`]=i[0],t[`$$${e}Data`]=i[1]):t[`$$${e}`]=i;else if(Array.isArray(i)){let n=i[0];t.addEventListener(e,i[0]=e=>n.call(t,i[1],e))}else t.addEventListener(e,i,"function"!=typeof i&&i)}(t,o,i,r),r&&tk([o]))}else if("attr:"===e.slice(0,5))tO(t,e.slice(5),i);else if("bool:"===e.slice(0,5))a=e.slice(5),tC(t)||(i?t.setAttribute(a,""):t.removeAttribute(a));else if((f="prop:"===e.slice(0,5))||(d=tp.has(e))||!o&&((u=function(t,e){let i=tm[t];return"object"==typeof i?i[e]?i.$:void 0:i}(e,t.tagName))||(c=tf.has(e)))||(h=t.nodeName.includes("-")||"is"in s)){if(f)e=e.slice(5),c=!0;else if(tC(t))return i;"class"===e||"className"===e?tC(t)||(null==i?t.removeAttribute("class"):t.className=i):!h||c||d?t[u||e]=i:t[e.toLowerCase().replace(/-([a-z])/g,(t,e)=>e.toUpperCase())]=i}else{let n=o&&e.indexOf(":")>-1&&tb[e.split(":")[0]];n?(l=e,tC(t)||(null==i?t.removeAttributeNS(n,l):t.setAttributeNS(n,l,i))):tO(t,tg[e]||e,i)}return i}function tP(t){if(k.registry&&k.events&&k.events.find(([e,i])=>i===t))return;let e=t.target,i=`$$${t.type}`,n=t.target,o=t.currentTarget,r=e=>Object.defineProperty(t,"target",{configurable:!0,value:e}),s=()=>{let n=e[i];if(n&&!e.disabled){let o=e[`${i}Data`];if(void 0!==o?n.call(e,o,t):n.call(e,t),t.cancelBubble)return}return e.host&&"string"!=typeof e.host&&!e.host._$host&&e.contains(t.target)&&r(e.host),!0},a=()=>{for(;s()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get:()=>e||document}),k.registry&&!k.done&&(k.done=_$HY.done=!0),t.composedPath){let i=t.composedPath();r(i[0]);for(let t=0;t<i.length-2&&(e=i[t],s());t++){if(e._$host){e=e._$host,a();break}if(e.parentNode===o)break}}else a();r(n)}function tT(t,e,i,n,o){let r=tC(t);if(r){i||(i=[...t.childNodes]);let e=[];for(let t=0;t<i.length;t++){let n=i[t];8===n.nodeType&&"!$"===n.data.slice(0,2)?n.remove():e.push(n)}i=e}for(;"function"==typeof i;)i=i();if(e===i)return i;let s=typeof e,a=void 0!==n;if(t=a&&i[0]&&i[0].parentNode||t,"string"===s||"number"===s){if(r||"number"===s&&(e=e.toString())===i)return i;if(a){let o=i[0];o&&3===o.nodeType?o.data!==e&&(o.data=e):o=document.createTextNode(e),i=tD(t,i,n,o)}else i=""!==i&&"string"==typeof i?t.firstChild.data=e:t.textContent=e}else if(null==e||"boolean"===s){if(r)return i;i=tD(t,i,n)}else if("function"===s)return R(()=>{let o=e();for(;"function"==typeof o;)o=o();i=tT(t,o,i,n)}),()=>i;else if(Array.isArray(e)){let s=[],l=i&&Array.isArray(i);if(function t(e,i,n,o){let r=!1;for(let s=0,a=i.length;s<a;s++){let a=i[s],l=n&&n[e.length],h;if(null==a||!0===a||!1===a);else if("object"==(h=typeof a)&&a.nodeType)e.push(a);else if(Array.isArray(a))r=t(e,a,l)||r;else if("function"===h){if(o){for(;"function"==typeof a;)a=a();r=t(e,Array.isArray(a)?a:[a],Array.isArray(l)?l:[l])||r}else e.push(a),r=!0}else{let t=String(a);l&&3===l.nodeType&&l.data===t?e.push(l):e.push(document.createTextNode(t))}}return r}(s,e,i,o))return R(()=>i=tT(t,s,i,n,!0)),()=>i;if(r){if(!s.length)return i;if(void 0===n)return i=[...t.childNodes];let e=s[0];if(e.parentNode!==t)return i;let o=[e];for(;(e=e.nextSibling)!==n;)o.push(e);return i=o}if(0===s.length){if(i=tD(t,i,n),a)return i}else l?0===i.length?tA(t,s,n):function(t,e,i){let n=i.length,o=e.length,r=n,s=0,a=0,l=e[o-1].nextSibling,h=null;for(;s<o||a<r;){if(e[s]===i[a]){s++,a++;continue}for(;e[o-1]===i[r-1];)o--,r--;if(o===s){let e=r<n?a?i[a-1].nextSibling:i[r-a]:l;for(;a<r;)t.insertBefore(i[a++],e)}else if(r===a)for(;s<o;)h&&h.has(e[s])||e[s].remove(),s++;else if(e[s]===i[r-1]&&i[a]===e[o-1]){let n=e[--o].nextSibling;t.insertBefore(i[a++],e[s++].nextSibling),t.insertBefore(i[--r],n),e[o]=i[r]}else{if(!h){h=new Map;let t=a;for(;t<r;)h.set(i[t],t++)}let n=h.get(e[s]);if(null!=n){if(a<n&&n<r){let l=s,c=1,d;for(;++l<o&&l<r&&null!=(d=h.get(e[l]))&&d===n+c;)c++;if(c>n-a){let o=e[s];for(;a<n;)t.insertBefore(i[a++],o)}else t.replaceChild(i[a++],e[s++])}else s++}else e[s++].remove()}}}(t,i,s):(i&&tD(t),tA(t,s));i=s}else if(e.nodeType){if(r&&e.parentNode)return i=a?[e]:e;if(Array.isArray(i)){if(a)return i=tD(t,i,n,e);tD(t,i,null,e)}else null!=i&&""!==i&&t.firstChild?t.replaceChild(e,t.firstChild):t.appendChild(e);i=e}return i}function tA(t,e,i=null){for(let n=0,o=e.length;n<o;n++)t.insertBefore(e[n],i)}function tD(t,e,i,n){if(void 0===i)return t.textContent="";let o=n||document.createTextNode("");if(e.length){let n=!1;for(let r=e.length-1;r>=0;r--){let s=e[r];if(o!==s){let e=s.parentNode===t;n||r?e&&s.remove():e?t.replaceChild(o,s):t.insertBefore(o,i)}else n=!0}}else t.insertBefore(o,i);return[o]}function tI(t){let[e,i]=th(t,["component"]),n=L(()=>e.component);return L(()=>{let t=n();switch(typeof t){case"function":return F(()=>t(i));case"string":let e,o;let r=ty.has(t),s=k.context?tC()&&(e=k.registry.get(o=k.getNextContextId()))?(k.completed&&k.completed.add(e),k.registry.delete(o),e):(void 0)():function(t,e=!1){return e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t)}(t,r);return!function(t,e={},i,n){let o={};R(()=>o.children=tT(t,e.children,o.children)),R(()=>"function"==typeof e.ref&&tS(e.ref,t)),R(()=>(function(t,e,i,n,o={},r=!1){for(let n in e||(e={}),o)if(!(n in e)){if("children"===n)continue;o[n]=tM(t,n,null,o[n],i,r,e)}for(let s in e){if("children"===s){n||tT(t,e.children);continue}let a=e[s];o[s]=tM(t,s,a,o[s],i,r,e)}})(t,e,i,!0,o,!0))}(s,i,r),s}})}Symbol();var tB=new Map,tz=(t,e)=>{if(tB.has(t))return tB.get(t);let i=V(e);return tB.set(t,i),i},tR=t=>{let e=tB.get(t);if(e)return Q(e)},tN=/((?:--)?(?:\w+-?)+)\s*:\s*([^;]*)/g;function tL(t,e){return"string"==typeof e&&(e=function(t){let e;let i={};for(;e=tN.exec(t);)i[e[1]]=e[2];return i}(e)),{...t,...e}}var tF=(t,e)=>(t&&("function"==typeof t?t(e):t[0](t[1],e)),e.defaultPrevented),tj=(t,e)=>{let i=t.compareDocumentPosition(e);return i&Node.DOCUMENT_POSITION_PRECEDING||i&Node.DOCUMENT_POSITION_CONTAINS?1:i&Node.DOCUMENT_POSITION_FOLLOWING||i&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:0},tH=t=>"function"==typeof t?t():t,tW=t=>(...e)=>{for(let i of t)i&&i(...e)},tV=(...t)=>tW(t),tQ=(...t)=>t.some(t=>!!t()),t$=t=>"function"==typeof t&&t.length>0,tq=t=>t?"":void 0,tU=t=>{let[e,i]=th(t,["as"]),n=L(()=>e.as??"div");return L(()=>{let t=n();switch(typeof t){case"function":return F(()=>t(i));case"string":return tn(tI,tl({component:t},i))}})},tY=t=>{let e;let i=!1;return()=>i?e:(i=!0,e=L(t))},tG=function(t){let[e,i]=z(t.initialValue),n=()=>t.value?.()!==void 0,o=()=>n()?t.value?.():e();return[o,e=>F(()=>{let r;return Object.is(r="function"==typeof e?e(o()):e,o())||(n()||i(r),t.onChange?.(r)),r})]},tX=t=>{let[e,i]=z(0);N(()=>{let e=tH(t.element);if(!e)return;o(e);let i=new ResizeObserver(n);i.observe(e),H(()=>{i.disconnect()})});let n=([t])=>{o(t.target)},o=e=>{switch(tH(t.dimension)){case"width":i(e.offsetWidth);break;case"height":i(e.offsetHeight)}};return e},tK=V(),tZ=t=>void 0===t?tK:tz(`resizable-${t}`),tJ=V(),t0=t=>void 0===t?tJ:tz(`resizable-internal-${t}`),t1=t=>{if(void 0===t){let t=Q(tJ);if(!t)throw Error("[corvu]: Resizable context not found. Make sure to wrap Resizable components in <Resizable.Root>");return t}let e=tR(`resizable-internal-${t}`);if(!e)throw Error(`[corvu]: Resizable context with id "${t}" not found. Make sure to wrap Resizable components in <Resizable.Root contextId="${t}">`);return e},t2=(t,e)=>{if("number"==typeof t)return t;if(!t.endsWith("px"))throw Error(`[corvu] Sizes must be a number or a string ending with 'px'. Got ${t}`);return t3(parseFloat(t)/e)},t5=t=>[t.panels.filter(e=>t.focusedElement.compareDocumentPosition(e.data.element)&Node.DOCUMENT_POSITION_PRECEDING),t.panels.filter(e=>t.focusedElement.compareDocumentPosition(e.data.element)&Node.DOCUMENT_POSITION_FOLLOWING)],t3=t=>parseFloat(t.toFixed(6)),t4=null,t8=null,t6=0,t9={1:"e-resize",2:"w-resize",3:"ew-resize",4:"s-resize",8:"n-resize",12:"ns-resize",5:"se-resize",9:"ne-resize",6:"sw-resize",10:"nw-resize"},t7=null,et=()=>{if(!t4){t8&&(t7=null,t8.remove(),t8=null);return}let t=t9[t6]??null;if(null===t)switch(t4){case"horizontal":t="col-resize";break;case"vertical":t="row-resize";break;case"both":t="move"}t!==t7&&(t7=t,t8||(t8=document.createElement("style"),document.head.appendChild(t8)),t8.innerHTML=`*{cursor: ${t}!important;}`)},ee=(t,e)=>{switch(t){case"horizontal":1===e?(t6|=1,t6&=-3):2===e?(t6|=2,t6&=-2):3===e?t6|=3:t6&=-4;break;case"vertical":1===e?(t6|=4,t6&=-9):2===e?(t6|=8,t6&=-5):3===e?t6|=12:t6&=-13}et()},ei=()=>{t6=0,et()},en=t=>{t4=t,et()},eo=t=>{if(t3(t.distributablePercentage)!==t3(t.desiredPercentage)){let e=null;e=!0===t.betweenCollapse?3:t.desiredPercentage<t.distributablePercentage&&!0!==t.revertConstraints||t.desiredPercentage>t.distributablePercentage&&!0===t.revertConstraints?1:2,ee(t.orientation,e)}else ee(t.orientation,0)},er=[],es=null,ea=null,el=(t,e)=>1>=Math.abs(t-e),eh=t=>{for(let e of(er.push(t),er))for(let t of er){if(e.orientation===t.orientation||e.element===t.element)continue;let i=e.element.getBoundingClientRect(),n=t.element.getBoundingClientRect();if("horizontal"===e.orientation&&(i.left>n.right||i.right<n.left)||"vertical"===e.orientation&&(i.top>n.bottom||i.bottom<n.top))continue;let o="horizontal"===e.orientation?el(i.top,n.bottom):el(i.left,n.right),r="horizontal"===e.orientation?el(i.bottom,n.top):el(i.right,n.left);o&&e.startIntersection.setHandle(t),r&&e.endIntersection.setHandle(t)}return{onDragStart:(e,i)=>ed(t,e,i),onHoveredChange:e=>{ea=e;let i=!!es,n=null;K(()=>{switch(e){case"handle":{let e=t.startIntersection.handle(),o=t.endIntersection.handle();i||(t.setActive(!0),e?.setActive(!1),o?.setActive(!1)),e?.setHoveredAsIntersection(!1),o?.setHoveredAsIntersection(!1),n=t.orientation;break}case"startIntersection":{let e=t.startIntersection.handle();i||e?.setActive(!0),e?.setHoveredAsIntersection(!0),n="both";break}case"endIntersection":{let e=t.endIntersection.handle();i||e?.setActive(!0),e?.setHoveredAsIntersection(!0),n="both";break}case null:{let e=t.startIntersection.handle(),o=t.endIntersection.handle();i||t.focused()||(t.setActive(!1),e?.setActive(!1),o?.setActive(!1)),e?.setHoveredAsIntersection(!1),o?.setHoveredAsIntersection(!1),n=null}}!i&&t.handleCursorStyle()&&en(n)},!1)}}},ec=t=>{er.splice(er.indexOf(t),1)},ed=(t,e,i)=>{es={x:e.clientX,y:e.clientY},K(()=>{t.setDragging(!0),"startIntersection"===i&&t.startIntersection.handle()?.setDragging(!0),"endIntersection"===i&&t.endIntersection.handle()?.setDragging(!0)},!1),window.addEventListener("pointermove",eu),window.addEventListener("touchmove",ef),window.addEventListener("pointerup",em),window.addEventListener("touchend",em),window.addEventListener("contextmenu",em)},eu=t=>eg(t.clientX,t.clientY,t.altKey),ef=t=>{t.touches[0]&&eg(t.touches[0].clientX,t.touches[0].clientY,t.altKey)},ep=!1,eg=(t,e,i)=>{if(es)for(let n of(er.some(t=>t.dragging()&&"only"===t.altKey)&&(i=!0),er.some(t=>t.dragging()&&!1===t.altKey)&&(i=!1),ep!==i&&(es={x:t,y:e},ep=i),er))n.dragging()&&n.onDrag("horizontal"===n.orientation?t-es.x:e-es.y,i)},em=t=>{K(()=>{for(let e of er)e.dragging()?(e.setDragging(!1),e.onDragEnd(t),e.hovered()||e.hoveredAsIntersection()||e.setActive(!1),!ea&&e.handleCursorStyle()&&en(null)):tQ(e.hovered,e.focused,e.hoveredAsIntersection)&&(e.setActive(!0),e.handleCursorStyle()&&en(e.orientation))},!1),ei(),es=null,window.removeEventListener("pointermove",eu),window.removeEventListener("touchmove",ef),window.removeEventListener("pointerup",em),window.removeEventListener("touchend",em),window.removeEventListener("contextmenu",em)},ev=tx("<div data-corvu-resizable-handle-start-intersection>"),ey=tx("<div data-corvu-resizable-handle-end-intersection>"),eb=V(),ew=t=>void 0===t?eb:tz(`resizable-panel-${t}`),ex=t=>{let e=t.desiredPercentage>=0?1/0:-1/0,i=t.initialSizes;for(let n of t.resizeActions){let o=!0!==n.negate?t.desiredPercentage:-t.desiredPercentage,[r,s,a]=ek({desiredPercentage:o,side:"preceding",panels:n.precedingPanels,initialSizes:i,initialSizesStartIndex:0,collapsible:t.collapsible,rootSize:t.resizableData.rootSize}),[l,h,c]=ek({desiredPercentage:o,side:"following",panels:n.followingPanels,initialSizes:i,initialSizesStartIndex:n.precedingPanels.length,collapsible:t.collapsible,rootSize:t.resizableData.rootSize});!0===n.negate&&(r=-r,l=-l),a&&(l=r),c&&(r=l),e=t.desiredPercentage>=0?Math.min(e,Math.min(r,l)):Math.max(e,Math.max(r,l)),i=[...s,...h]}return e},ek=t=>{let e=eO({side:t.side,desiredPercentage:t.desiredPercentage}),i=0,n=t.initialSizes.slice(t.initialSizesStartIndex,t.initialSizesStartIndex+t.panels.length);for(let o="preceding"===t.side?t.panels.length-1:0;"preceding"===t.side?o>=0:o<t.panels.length;"preceding"===t.side?o--:o++){let r=t.panels[o],s=t.initialSizes[o+t.initialSizesStartIndex],a=t2(r.data.collapsedSize??0,t.rootSize);if(r.data.collapsible&&s===a)continue;let l=t.desiredPercentage-i;if(0===l)break;switch(e){case"precedingDecreasing":{let e=t2(r.data.minSize,t.rootSize);n[o]=Math.max(e,s+l),i+=n[o]-s;break}case"followingDecreasing":{let e=t2(r.data.minSize,t.rootSize);n[o]=Math.max(e,s-l),i-=n[o]-s;break}case"precedingIncreasing":{let e=t2(r.data.maxSize,t.rootSize);n[o]=Math.min(e,s+l),i+=n[o]-s;break}case"followingIncreasing":{let e=t2(r.data.maxSize,t.rootSize);n[o]=Math.min(e,s-l),i-=n[o]-s}}}if(!t.collapsible||i===t.desiredPercentage)return[i,n,!1];let o="preceding"===t.side?t.panels.length-1:0,r=t.panels[o];if(!r.data.collapsible)return[i,n,!1];let s=t.desiredPercentage-i,a=!1,l=t.initialSizes[o+t.initialSizesStartIndex],h=t2(r.data.collapsedSize??0,t.rootSize),c=t2(r.data.collapseThreshold??0,t.rootSize),d=l===h;if("precedingDecreasing"===e&&!d&&Math.abs(s)>c)i-=n[o]-l,n[o]=h,i+=n[o]-l,a=!0;else if("precedingIncreasing"===e&&d&&Math.abs(s)>c){let e=t2(r.data.minSize,t.rootSize);if(n[o]=e,Math.abs(s)>e-h){let e=t2(r.data.maxSize,t.rootSize);n[o]=Math.min(e,l+s)}else a=!0;i+=n[o]-l}else if("followingDecreasing"===e&&!d&&Math.abs(s)>c)i+=n[o]-l,n[o]=h,i-=n[o]-l,a=!0;else if("followingIncreasing"===e&&d&&Math.abs(s)>c){let e=t2(r.data.minSize,t.rootSize);if(n[o]=e,Math.abs(s)>e-h){let e=t2(r.data.maxSize,t.rootSize);n[o]=Math.min(e,l-s)}else a=!0;i-=n[o]-l}return[i,n,a]},eO=t=>{switch(t.side){case"preceding":return t.desiredPercentage>=0?"precedingIncreasing":"precedingDecreasing";case"following":return t.desiredPercentage>=0?"followingDecreasing":"followingIncreasing"}},eS=t=>{let e=t.initialSizes;for(let i of t.resizeActions){let[,n]=ek({desiredPercentage:i.deltaPercentage,side:"preceding",panels:i.precedingPanels,initialSizes:e,initialSizesStartIndex:0,collapsible:t.collapsible,rootSize:t.resizableData.rootSize}),[,o]=ek({desiredPercentage:i.deltaPercentage,side:"following",panels:i.followingPanels,initialSizes:e,initialSizesStartIndex:i.precedingPanels.length,collapsible:t.collapsible,rootSize:t.resizableData.rootSize});e=[...n,...o]}let i=(e=e.map(t3)).reduce((t,e)=>t+e,0);if(1!==i){let t=(i-1)/e.length;e=e.map(e=>e-t)}t.resizableData.setSizes(e.map(t3))},e_=t=>{let[e,i]=t5({panels:t.panels,focusedElement:t.panel.data.element}),n=t.panels.indexOf(t.panel);if(0===n?t.strategy="following":n===t.panels.length-1&&(t.strategy="preceding"),"both"===t.strategy){let n=[...e,t.panel],o=[t.panel,...i],r=ex({desiredPercentage:t.deltaPercentage/2,initialSizes:t.initialSizes,collapsible:!0,resizeActions:[{precedingPanels:n,followingPanels:i},{precedingPanels:e,followingPanels:o,negate:!0}],resizableData:{rootSize:t.resizableData.rootSize}});eS({initialSizes:t.initialSizes,collapsible:!0,resizeActions:[{precedingPanels:n,followingPanels:i,deltaPercentage:r},{precedingPanels:e,followingPanels:o,deltaPercentage:-r}],resizableData:t.resizableData})}else{e="preceding"===t.strategy?e:[...e,t.panel],i="following"===t.strategy?i:[t.panel,...i],"preceding"===t.strategy&&(t.deltaPercentage=-t.deltaPercentage);let n=ex({desiredPercentage:t.deltaPercentage,initialSizes:t.initialSizes,collapsible:t.collapsible,resizeActions:[{precedingPanels:e,followingPanels:i}],resizableData:{rootSize:t.resizableData.rootSize}});eS({initialSizes:t.initialSizes,collapsible:!0,resizeActions:[{precedingPanels:e,followingPanels:i,deltaPercentage:n}],resizableData:t.resizableData})}},eC=t=>{if(t.altKey&&t.panels.length>2){let e=t.panels.filter(e=>t.handle.compareDocumentPosition(e.data.element)&Node.DOCUMENT_POSITION_PRECEDING).length-1,i=0===e;i&&(e++,t.deltaPercentage=-t.deltaPercentage);let n=t.panels[e],o=t.initialSizes[e],r=t2(n.data.minSize,t.resizableData.rootSize)-o,s=t2(n.data.maxSize,t.resizableData.rootSize)-o,a=Math.max(r,Math.min(2*t.deltaPercentage,s))/2,[l,h]=t5({panels:t.panels,focusedElement:n.data.element}),c=[...l,n],d=[n,...h],u=ex({desiredPercentage:a,initialSizes:t.initialSizes,collapsible:!1,resizeActions:[{precedingPanels:c,followingPanels:h},{precedingPanels:l,followingPanels:d,negate:!0}],resizableData:{rootSize:t.resizableData.rootSize}});!0===t.resizableData.handleCursorStyle&&eo({orientation:t.resizableData.orientation,desiredPercentage:t.deltaPercentage,distributablePercentage:u,revertConstraints:i}),eS({initialSizes:t.initialSizes,collapsible:!1,resizeActions:[{precedingPanels:c,followingPanels:h,deltaPercentage:u},{precedingPanels:l,followingPanels:d,deltaPercentage:-u}],resizableData:t.resizableData})}else{let[e,i]=t5({panels:t.panels,focusedElement:t.handle}),n=ex({desiredPercentage:t.deltaPercentage,initialSizes:t.initialSizes,collapsible:!0,resizeActions:[{precedingPanels:e,followingPanels:i}],resizableData:{rootSize:t.resizableData.rootSize}});if(eS({initialSizes:t.initialSizes,collapsible:!0,resizeActions:[{precedingPanels:e,followingPanels:i,deltaPercentage:n}],resizableData:t.resizableData}),t.resizableData.handleCursorStyle){let o=t3(t.deltaPercentage),r=t3(n),s=!1,a=e[e.length-1];if(a.data.collapsible){let e=t2(a.data.collapsedSize??0,t.resizableData.rootSize);(a.size()===e&&o>r||a.size()!==e&&o<r)&&(s=!0)}let l=i[0];if(l.data.collapsible){let e=t2(l.data.collapsedSize??0,t.resizableData.rootSize);(l.size()===e&&o<r||l.size()!==e&&o>r)&&(s=!0)}eo({orientation:t.resizableData.orientation,desiredPercentage:t.deltaPercentage,distributablePercentage:n,betweenCollapse:s})}}},eE=Object.assign(t=>{let[e,i]=th(tl({orientation:"horizontal",initialSizes:[],keyboardDelta:.1,handleCursorStyle:!0},t),["orientation","sizes","onSizesChange","initialSizes","keyboardDelta","handleCursorStyle","contextId","ref","style","children"]),[n,o]=tG({value:()=>e.sizes,initialValue:[],onChange:e.onSizesChange}),[r,s]=z(null),a=tX({element:r,dimension:()=>"horizontal"===e.orientation?"width":"height"}),[l,h]=z([]),c=[],d=t=>{let i=l().filter(e=>t.element.compareDocumentPosition(e.data.element)&Node.DOCUMENT_POSITION_PRECEDING).length,r=void 0===c[i]||c[i]===t.id,s=void 0!==n()[i],d=null;null!==t.initialSize?d=t2(t.initialSize,a()):void 0!==e.initialSizes[i]&&r&&(d=t2(e.initialSizes[i],a())),d=d??.5,o(e=>{let n=[...e],o=n.reduce((t,e)=>t+e,0);if((r&&!s||!r)&&1===o){let t=d/n.length;n=n.map(e=>e-t)}return r?(s||(n[i]=d),c[i]=t.id):(n.splice(i,0,d),c.splice(i,0,t.id)),n});let u=L(()=>{let e=c.indexOf(t.id);return n()[e]});N(()=>t.onResize?.(u()));let m={data:t,size:u,resize:(e,i)=>f(c.indexOf(t.id),e,i),collapse:e=>p(c.indexOf(t.id),e),expand:e=>g(c.indexOf(t.id),e)};return h(t=>{let e=[...t];return e.push(m),e.sort((t,e)=>tj(t.data.element,e.data.element)),e}),m},u=t=>{h(e=>e.filter(e=>e.data.id!==t));let e=c.indexOf(t);c.splice(e,1),o(t=>{let i=[...t];i.splice(e,1);let n=(i.reduce((t,e)=>t+e,0)-1)/i.length;return i.map(t=>t+n)})};N(()=>{void 0!==e.onSizesChange&&e.onSizesChange(n())});let f=(t,i,r)=>{F(()=>{let s=l()[t];if(!s)return;let h=t2(s.data.minSize,a()),c=t2(s.data.maxSize,a());e_({deltaPercentage:Math.max(h,Math.min(t2(i,a()),c))-n()[t],strategy:r??"both",panel:s,panels:l(),initialSizes:l().map(t=>t.size()),collapsible:!1,resizableData:{rootSize:a(),orientation:e.orientation,setSizes:o}})})},p=(t,i)=>{F(()=>{let r=l()[t];if(!r)return;let s=n()[t],h=t2(r.data.collapsedSize??0,a());r.data.collapsible&&s!==h&&e_({deltaPercentage:h-s,strategy:i??"both",panel:r,panels:l(),initialSizes:l().map(t=>t.size()),collapsible:!0,resizableData:{rootSize:a(),orientation:e.orientation,setSizes:o}})})},g=(t,i)=>{F(()=>{let r=l()[t];if(!r)return;let s=n()[t],h=t2(r.data.collapsedSize??0,a());r.data.collapsible&&s===h&&e_({deltaPercentage:t2(r.data.minSize,a())-s,strategy:i??"both",panel:r,panels:l(),initialSizes:l().map(t=>t.size()),collapsible:!0,resizableData:{rootSize:a(),orientation:e.orientation,setSizes:o}})})},m=null,v=!1,y=(t,i,n)=>{(null===m||v!==n)&&(m=l().map(t=>t.size()),v=n),eC({deltaPercentage:i/a(),altKey:n,handle:t,panels:l(),initialSizes:m,resizableData:{rootSize:a(),handleCursorStyle:e.handleCursorStyle,orientation:e.orientation,setSizes:o}})},b=(t,i,n)=>{if("Enter"===i.key){let[e,i]=t5({panels:l(),focusedElement:t}),n=e[e.length-1];if((!n||!n.data.collapsible)&&(!(n=i[0])||!n.data.collapsible))return;n.size()===t2(n.data.collapsedSize??0,a())?n.expand("following"):n.collapse("following");return}let r=null;if("horizontal"===e.orientation&&"ArrowLeft"===i.key||"vertical"===e.orientation&&"ArrowUp"===i.key||"Home"===i.key?r=i.shiftKey||"Home"===i.key?-1:-t2(e.keyboardDelta,a()):("horizontal"===e.orientation&&"ArrowRight"===i.key||"vertical"===e.orientation&&"ArrowDown"===i.key||"End"===i.key)&&(r=i.shiftKey||"End"===i.key?1:t2(e.keyboardDelta,a())),null===r)return;i.preventDefault();let s=l().map(t=>t.size());eC({deltaPercentage:r,altKey:n,handle:t,panels:l(),initialSizes:s,resizableData:{rootSize:a(),handleCursorStyle:!1,orientation:e.orientation,setSizes:o}})},w={get sizes(){return n()},setSizes:o,get orientation(){return e.orientation},get keyboardDelta(){return e.keyboardDelta},get handleCursorStyle(){return e.handleCursorStyle},resize:f,collapse:p,expand:g},x=tY(()=>e.children),k=()=>{let t=x()();return t$(t)?t(w):t};return L(()=>{let t=tZ(e.contextId),r=t0(e.contextId);return tn(t.Provider,{value:{sizes:n,setSizes:o,orientation:()=>e.orientation,keyboardDelta:()=>e.keyboardDelta,handleCursorStyle:()=>e.handleCursorStyle,resize:f,collapse:p,expand:g},get children(){return tn(r.Provider,{value:{sizes:n,setSizes:o,orientation:()=>e.orientation,keyboardDelta:()=>e.keyboardDelta,handleCursorStyle:()=>e.handleCursorStyle,rootSize:a,panels:l,registerPanel:d,unregisterPanel:u,onDrag:y,onDragEnd:()=>m=null,onKeyDown:b,resize:f,collapse:p,expand:g},get children(){return tn(tU,tl({as:"div",ref(t){var i=tV(s,e.ref);"function"==typeof i&&i(t)},get style(){return tL({display:"flex","flex-direction":"horizontal"===e.orientation?"row":"column"},e.style)},get"data-orientation"(){return e.orientation},"data-corvu-resizable-root":""},i,{get children(){return F(()=>k())}}))}})}})})},{Panel:t=>{let[e,i]=th(tl({initialSize:null,minSize:0,maxSize:1,collapsible:!1,collapsedSize:0,collapseThreshold:.05,panelId:k.context?k.getNextContextId():`cl-${tc++}`},t),["initialSize","minSize","maxSize","collapsible","collapsedSize","collapseThreshold","onResize","onCollapse","onExpand","contextId","panelId","ref","style","children"]),[n,o]=z(null),r=L(()=>t1(e.contextId)),[s,a]=z(null);N(()=>{let t=n();if(!t)return;let i=r(),o=F(()=>i.registerPanel({id:e.panelId,element:t,initialSize:e.initialSize,minSize:e.minSize,maxSize:e.maxSize,collapsible:e.collapsible,collapsedSize:e.collapsedSize,collapseThreshold:e.collapseThreshold,onResize:e.onResize}));a(o),H(()=>{i.unregisterPanel(o.data.id)})});let l=()=>{let t=s();return t?t.size():"number"==typeof e.initialSize?e.initialSize:1},h=L(t=>{let i=s();if(!0!==e.collapsible)return!1;let n=!!i&&i.size()===t2(e.collapsedSize,r().rootSize());return i&&t!==n&&(n&&void 0!==e.onCollapse?e.onCollapse(i.size()):n||void 0===e.onExpand||e.onExpand(i.size())),n}),c=(t,e)=>{let i=s();i&&i.resize(t,e??"both")},d=t=>{let e=s();e&&e.collapse(t??"both")},u=t=>{let e=s();e&&e.expand(t??"both")},f={get size(){return l()},get minSize(){return e.minSize},get maxSize(){return e.maxSize},get collapsible(){return e.collapsible},get collapsedSize(){return e.collapsedSize},get collapseThreshold(){return e.collapseThreshold},get collapsed(){return h()},resize:c,collapse:d,expand:u,get panelId(){return e.panelId}},p=tY(()=>e.children),g=()=>{let t=p()();return t$(t)?t(f):t};return L(()=>tn(ew(e.contextId).Provider,{value:{size:l,minSize:()=>e.minSize,maxSize:()=>e.maxSize,collapsible:()=>e.collapsible,collapsedSize:()=>e.collapsedSize,collapseThreshold:()=>e.collapseThreshold,collapsed:h,resize:c,collapse:d,expand:u,panelId:()=>e.panelId},get children(){return tn(tU,tl({as:"div",ref(t){var i=tV(o,e.ref);"function"==typeof i&&i(t)},get style(){return tL({"flex-basis":100*l()+"%"},e.style)},get id(){return e.panelId},get"data-collapsed"(){return tq(h())},get"data-expanded"(){return tq(!0===e.collapsible&&!h())},get"data-orientation"(){return r().orientation()},"data-corvu-resizable-panel":""},i,{get children(){return F(()=>g())}}))}}))},Handle:t=>{let[e,i]=th(tl({startIntersection:!0,endIntersection:!0,altKey:!0},t),["startIntersection","endIntersection","altKey","onHandleDragStart","onHandleDrag","onHandleDragEnd","contextId","ref","style","disabled","children","onMouseEnter","onMouseLeave","onKeyDown","onKeyUp","onFocus","onBlur","onPointerDown"]),[n,o]=z(null),[r,s]=z(!1),[a,l]=z(null),[h,c]=z(!1),[d,u]=z(!1),[f,p]=z(!1),[g,m]=z(null),[v,y]=z(null),b=L(()=>t1(e.contextId)),w=L(()=>{let t=n();if(!t)return;let[e,i]=t5({panels:b().panels(),focusedElement:t}),o=e[e.length-1]?.data.id,r=i.reduce((t,e)=>t-t2(e.data.minSize,b().rootSize()),1),s=e.reduce((t,e)=>t+t2(e.data.minSize,b().rootSize()),0),a=e.reduce((t,e)=>t+t2(e.size(),b().rootSize()),0);return{ariaControls:o,ariaValueMax:t3(r),ariaValueMin:t3(s),ariaValueNow:t3(a)}}),x=null;return N(()=>{if(!0===e.disabled)return;let t=n();if(!t)return;let i={element:t,orientation:b().orientation(),handleCursorStyle:b().handleCursorStyle,altKey:e.altKey,startIntersection:{handle:g,setHandle:t=>{!0===e.startIntersection&&m(t)}},endIntersection:{handle:v,setHandle:t=>{!0===e.endIntersection&&y(t)}},hovered:a,focused:h,hoveredAsIntersection:r,setHoveredAsIntersection:s,active:d,setActive:u,dragging:f,setDragging:p,onDrag:(i,n)=>{if(void 0!==e.onHandleDrag){let t=new CustomEvent("drag",{cancelable:!0});if(e.onHandleDrag(t),t.defaultPrevented)return}b().onDrag(t,i,n)},onDragEnd:t=>{e.onHandleDragEnd?.(t),b().onDragEnd()}};x=eh(i),H(()=>{ec(i),x=null})}),N(j(a,()=>{x?.onHoveredChange(a())})),tn(tU,tl({as:"button",ref(t){var i=tV(o,e.ref);"function"==typeof i&&i(t)},get style(){return tL({position:"relative",cursor:b().handleCursorStyle()?"inherit":void 0,"touch-action":"none","flex-shrink":0},e.style)},get disabled(){return e.disabled},onBlur:t=>{!tF(e.onBlur,t)&&(c(!1),a()||u(!1))},onFocus:t=>{tF(e.onFocus,t)||a()||(c(!0),u(!0))},onKeyDown:t=>{if(tF(e.onKeyDown,t)||f())return;let i=n();if(!i)return;let o="only"===e.altKey||!1!==e.altKey&&t.altKey;b().onKeyDown(i,t,o)},onKeyUp:t=>{tF(e.onKeyUp,t)||"Tab"!==t.key||c(!0)},onMouseEnter:t=>{tF(e.onMouseEnter,t)||!0===e.disabled||l("handle")},onMouseLeave:t=>{tF(e.onMouseLeave,t)||l(null)},onPointerDown:t=>{if(tF(e.onPointerDown,t)||tF(e.onHandleDragStart,t))return;let i=t.target,n="handle";i.hasAttribute("data-corvu-resizable-handle-start-intersection")&&(n="startIntersection"),i.hasAttribute("data-corvu-resizable-handle-end-intersection")&&(n="endIntersection"),x?.onDragStart(t,n)},role:"separator",get"aria-controls"(){return w()?.ariaControls},get"aria-orientation"(){return b().orientation()},get"aria-valuemax"(){return w()?.ariaValueMax},get"aria-valuemin"(){return w()?.ariaValueMin},get"aria-valuenow"(){return w()?.ariaValueNow},get"data-active"(){return tq(d())},get"data-dragging"(){return tq(f())},get"data-orientation"(){return b().orientation()},"data-corvu-resizable-handle":""},i,{get children(){return[tn(tu,{get when(){return g()},get children(){var k=ev();return k.addEventListener("mouseleave",t=>{n()?.contains(t.relatedTarget)===!0?l("handle"):l(null)}),k.addEventListener("mouseenter",()=>l("startIntersection")),k.style.setProperty("position","absolute"),k.style.setProperty("aspect-ratio","1 / 1"),k.style.setProperty("top","0"),k.style.setProperty("left","0"),k.style.setProperty("z-index","1"),R(t=>{var e="horizontal"===b().orientation()?void 0:"100%",i="horizontal"===b().orientation()?"100%":void 0,n="horizontal"===b().orientation()?"translate3d(0, -100%, 0)":"translate3d(-100%, 0, 0)";return e!==t.e&&(null!=(t.e=e)?k.style.setProperty("height",e):k.style.removeProperty("height")),i!==t.t&&(null!=(t.t=i)?k.style.setProperty("width",i):k.style.removeProperty("width")),n!==t.a&&(null!=(t.a=n)?k.style.setProperty("transform",n):k.style.removeProperty("transform")),t},{e:void 0,t:void 0,a:void 0}),k}}),L(()=>e.children),tn(tu,{get when(){return v()},get children(){var O=ey();return O.addEventListener("mouseleave",t=>{n()?.contains(t.relatedTarget)===!0?l("handle"):l(null)}),O.addEventListener("mouseenter",()=>l("endIntersection")),O.style.setProperty("position","absolute"),O.style.setProperty("aspect-ratio","1 / 1"),O.style.setProperty("bottom","0"),O.style.setProperty("right","0"),O.style.setProperty("z-index","1"),R(t=>{var e="horizontal"===b().orientation()?void 0:"100%",i="horizontal"===b().orientation()?"100%":void 0,n="horizontal"===b().orientation()?"translate3d(0, 100%, 0)":"translate3d(100%, 0, 0)";return e!==t.e&&(null!=(t.e=e)?O.style.setProperty("height",e):O.style.removeProperty("height")),i!==t.t&&(null!=(t.t=i)?O.style.setProperty("width",i):O.style.removeProperty("width")),n!==t.a&&(null!=(t.a=n)?O.style.setProperty("transform",n):O.style.removeProperty("transform")),t},{e:void 0,t:void 0,a:void 0}),O}})]}}))},useContext:t=>{if(void 0===t){let t=Q(tK);if(!t)throw Error("[corvu]: Resizable context not found. Make sure to wrap Resizable components in <Resizable.Root>");return t}let e=tR(`resizable-${t}`);if(!e)throw Error(`[corvu]: Resizable context with id "${t}" not found. Make sure to wrap Resizable components in <Resizable.Root contextId="${t}">`);return e},usePanelContext:t=>{if(void 0===t){let t=Q(eb);if(!t)throw Error("[corvu]: Resizable panel context not found. Make sure to call usePanelContext under <Resizable.Panel>");return t}let e=tR(`resizable-panel-${t}`);if(!e)throw Error(`[corvu]: Resizable context with id "${t}" not found. Make sure to call usePanelContext under <Resizable.Panel contextId="${t}">`);return e}});const eM=Array(128).fill(void 0);eM.push(void 0,null,!0,!1);let eP=eM.length;function eT(t){let e=eM[t];return t<132||(eM[t]=eP,eP=t),e}function eA(t){eP===eM.length&&eM.push(eM.length+1);let e=eP;return eP=eM[e],eM[e]=t,e}const eD="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&eD.decode();let eI=null;function eB(){return(null===eI||0===eI.byteLength)&&(eI=new Uint8Array(e.memory.buffer)),eI}function ez(t,e){return t>>>=0,eD.decode(eB().subarray(t,t+e))}let eR=0;const eN="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},eL="function"==typeof eN.encodeInto?function(t,e){return eN.encodeInto(t,e)}:function(t,e){let i=eN.encode(t);return e.set(i),{read:t.length,written:i.length}};function eF(t,e,i){if(void 0===i){let i=eN.encode(t),n=e(i.length,1)>>>0;return eB().subarray(n,n+i.length).set(i),eR=i.length,n}let n=t.length,o=e(n,1)>>>0,r=eB(),s=0;for(;s<n;s++){let e=t.charCodeAt(s);if(e>127)break;r[o+s]=e}if(s!==n){0!==s&&(t=t.slice(s)),o=i(o,n,n=s+3*t.length,1)>>>0;let e=eL(t,eB().subarray(o+s,o+n));s+=e.written,o=i(o,n,s,1)>>>0}return eR=s,o}let ej=null;function eH(){return(null===ej||!0===ej.buffer.detached||void 0===ej.buffer.detached&&ej.buffer!==e.memory.buffer)&&(ej=new DataView(e.memory.buffer)),ej}function eW(t){let i,n;try{let c=e.__wbindgen_add_to_stack_pointer(-16),d=eF(t,e.__wbindgen_malloc,e.__wbindgen_realloc),u=eR;e.compile(c,d,u);var o=eH().getInt32(c+0,!0),r=eH().getInt32(c+4,!0),s=eH().getInt32(c+8,!0),a=eH().getInt32(c+12,!0),l=o,h=r;if(a)throw l=0,h=0,eT(s);return i=l,n=h,ez(l,h)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(i,n,1)}}function eV(t,i){try{return t.apply(this,i)}catch(t){e.__wbindgen_exn_store(eA(t))}}async function eQ(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"!=t.headers.get("Content-Type"))console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e);else throw e}let i=await t.arrayBuffer();return await WebAssembly.instantiate(i,e)}{let i=await WebAssembly.instantiate(t,e);return i instanceof WebAssembly.Instance?{instance:i,module:t}:i}}var e$={};async function eq(t){if(void 0!==e)return e;void 0!==t&&Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead"),void 0===t&&(t=new URL(e$));let i=function(){let t={};return t.wbg={},t.wbg.__wbindgen_as_number=function(t){return+eM[t]},t.wbg.__wbindgen_object_drop_ref=function(t){eT(t)},t.wbg.__wbindgen_object_clone_ref=function(t){return eA(eM[t])},t.wbg.__wbindgen_is_string=function(t){return"string"==typeof eM[t]},t.wbg.__wbindgen_error_new=function(t,e){return eA(Error(ez(t,e)))},t.wbg.__wbindgen_is_object=function(t){let e=eM[t];return"object"==typeof e&&null!==e},t.wbg.__wbindgen_number_new=function(t){return eA(t)},t.wbg.__wbindgen_bigint_from_i64=function(t){return eA(t)},t.wbg.__wbindgen_bigint_from_u64=function(t){return eA(BigInt.asUintN(64,t))},t.wbg.__wbindgen_string_new=function(t,e){return eA(ez(t,e))},t.wbg.__wbg_set_f975102236d3c502=function(t,e,i){eM[t][eT(e)]=eT(i)},t.wbg.__wbg_crypto_1d1f22824a6a080c=function(t){return eA(eM[t].crypto)},t.wbg.__wbg_process_4a72847cc503995b=function(t){return eA(eM[t].process)},t.wbg.__wbg_versions_f686565e586dd935=function(t){return eA(eM[t].versions)},t.wbg.__wbg_node_104a2ff8d6ea03a2=function(t){return eA(eM[t].node)},t.wbg.__wbg_require_cca90b1a94a0255b=function(){return eV(function(){return eA(module.require)},arguments)},t.wbg.__wbindgen_is_function=function(t){return"function"==typeof eM[t]},t.wbg.__wbg_msCrypto_eb05e62b530a1508=function(t){return eA(eM[t].msCrypto)},t.wbg.__wbg_randomFillSync_5c9c955aa56b6049=function(){return eV(function(t,e){eM[t].randomFillSync(eT(e))},arguments)},t.wbg.__wbg_getRandomValues_3aa56aa6edec874c=function(){return eV(function(t,e){eM[t].getRandomValues(eM[e])},arguments)},t.wbg.__wbg_new_a220cf903aa02ca2=function(){return eA([])},t.wbg.__wbg_newnoargs_76313bd6ff35d0f2=function(t,e){return eA(Function(ez(t,e)))},t.wbg.__wbg_new_8608a2b51a5f6737=function(){return eA(new Map)},t.wbg.__wbg_call_1084a111329e68ce=function(){return eV(function(t,e){return eA(eM[t].call(eM[e]))},arguments)},t.wbg.__wbg_new_525245e2b9901204=function(){return eA({})},t.wbg.__wbg_self_3093d5d1f7bcb682=function(){return eV(function(){return eA(self.self)},arguments)},t.wbg.__wbg_window_3bcfc4d31bc012f8=function(){return eV(function(){return eA(window.window)},arguments)},t.wbg.__wbg_globalThis_86b222e13bdf32ed=function(){return eV(function(){return eA(globalThis.globalThis)},arguments)},t.wbg.__wbg_global_e5a3fe56f8be9485=function(){return eV(function(){return eA(v.global)},arguments)},t.wbg.__wbindgen_is_undefined=function(t){return void 0===eM[t]},t.wbg.__wbg_set_673dda6c73d19609=function(t,e,i){eM[t][e>>>0]=eT(i)},t.wbg.__wbg_call_89af060b4e1523f2=function(){return eV(function(t,e,i){return eA(eM[t].call(eM[e],eM[i]))},arguments)},t.wbg.__wbg_set_49185437f0ab06f8=function(t,e,i){return eA(eM[t].set(eM[e],eM[i]))},t.wbg.__wbg_buffer_b7b08af79b0b0974=function(t){return eA(eM[t].buffer)},t.wbg.__wbg_newwithbyteoffsetandlength_8a2cb9ca96b27ec9=function(t,e,i){return eA(new Uint8Array(eM[t],e>>>0,i>>>0))},t.wbg.__wbg_new_ea1883e1e5e86686=function(t){return eA(new Uint8Array(eM[t]))},t.wbg.__wbg_set_d1e79e2388520f18=function(t,e,i){eM[t].set(eM[e],i>>>0)},t.wbg.__wbg_newwithlength_ec548f448387c968=function(t){return eA(new Uint8Array(t>>>0))},t.wbg.__wbg_subarray_7c2e3576afe181d1=function(t,e,i){return eA(eM[t].subarray(e>>>0,i>>>0))},t.wbg.__wbindgen_debug_string=function(t,i){let n=eF(function t(e){let i;let n=typeof e;if("number"==n||"boolean"==n||null==e)return`${e}`;if("string"==n)return`"${e}"`;if("symbol"==n){let t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==n){let t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){let i=e.length,n="[";i>0&&(n+=t(e[0]));for(let o=1;o<i;o++)n+=", "+t(e[o]);return n+"]"}let o=/\[object ([^\]]+)\]/.exec(toString.call(e));if(!(o.length>1))return toString.call(e);if("Object"==(i=o[1]))try{return"Object("+JSON.stringify(e)+")"}catch(t){return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:i}(eM[i]),e.__wbindgen_malloc,e.__wbindgen_realloc),o=eR;eH().setInt32(t+4,o,!0),eH().setInt32(t+0,n,!0)},t.wbg.__wbindgen_throw=function(t,e){throw Error(ez(t,e))},t.wbg.__wbindgen_memory=function(){return eA(e.memory)},t}();("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));let{instance:n,module:o}=await eQ(await t,i);return e=n.exports,eq.__wbindgen_wasm_module=o,ej=null,eI=null,e}e$=new URL("althread_web_bg.06f5965c.wasm",import.meta.url).toString();let eU=[],eY=[];function eG(t){return t>=127462&&t<=127487}function eX(t,e,i){if(e==t.length)return e;e&&eZ(t.charCodeAt(e))&&eJ(t.charCodeAt(e-1))&&e--;let n=eK(t,e);for(e+=e0(n);e<t.length;){let o=eK(t,e);if(8205==n||8205==o||i&&function(t){if(t<768)return!1;for(let e=0,i=eU.length;;){let n=e+i>>1;if(t<eU[n])i=n;else{if(!(t>=eY[n]))return!0;e=n+1}if(e==i)return!1}}(o))e+=e0(o),n=o;else if(eG(o)){let i=0,n=e-2;for(;n>=0&&eG(eK(t,n));)i++,n-=2;if(i%2==0)break;e+=2}else break}return e}function eK(t,e){let i=t.charCodeAt(e);if(!eJ(i)||e+1==t.length)return i;let n=t.charCodeAt(e+1);return eZ(n)?(i-55296<<10)+(n-56320)+65536:i}function eZ(t){return t>=56320&&t<57344}function eJ(t){return t>=55296&&t<56320}function e0(t){return t<65536?1:2}(()=>{let t="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let e=0,i=0;e<t.length;e++)(e%2?eY:eU).push(i+=t[e])})();class e1{lineAt(t){if(t<0||t>this.length)throw RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){[t,e]=e7(this,t,e);let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),e5.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){[t,e]=e7(this,t,e);let i=[];return this.decompose(t,e,i,0),e5.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new e4(this),o=new e4(t);for(let t=e,r=e;;){if(n.next(t),o.next(t),t=0,n.lineBreak!=o.lineBreak||n.done!=o.done||n.value!=o.value)return!1;if(r+=n.value.length,n.done||r>=i)return!0}}iter(t=1){return new e4(this,t)}iterRange(t,e=this.length){return new e8(this,t,e)}iterLines(t,e){let i;if(null==t)i=this.iter();else{null==e&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new e6(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(0==t.length)throw RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new e2(t):e5.from(e2.split(t,[])):e1.empty}}class e2 extends e1{constructor(t,e=function(t){let e=-1;for(let i of t)e+=i.length+1;return e}(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let o=0;;o++){let r=this.text[o],s=n+r.length;if((e?i:s)>=t)return new e9(n,s,i,r);n=s+1,i++}}decompose(t,e,i,n){let o=t<=0&&e>=this.length?this:new e2(e3(this.text,[""],t,e),Math.min(e,this.length)-Math.max(0,t));if(1&n){let t=i.pop(),e=e3(o.text,t.text.slice(),0,o.length);if(e.length<=32)i.push(new e2(e,t.length+o.length));else{let t=e.length>>1;i.push(new e2(e.slice(0,t)),new e2(e.slice(t)))}}else i.push(o)}replace(t,e,i){if(!(i instanceof e2))return super.replace(t,e,i);[t,e]=e7(this,t,e);let n=e3(this.text,e3(i.text,e3(this.text,[""],0,t)),e),o=this.length+i.length-(e-t);return n.length<=32?new e2(n,o):e5.from(e2.split(n,[]),o)}sliceString(t,e=this.length,i="\n"){[t,e]=e7(this,t,e);let n="";for(let o=0,r=0;o<=e&&r<this.text.length;r++){let s=this.text[r],a=o+s.length;o>t&&r&&(n+=i),t<a&&e>o&&(n+=s.slice(Math.max(0,t-o),e-o)),o=a+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let o of t)i.push(o),n+=o.length+1,32==i.length&&(e.push(new e2(i,n)),i=[],n=-1);return n>-1&&e.push(new e2(i,n)),e}}class e5 extends e1{constructor(t,e){for(let i of(super(),this.children=t,this.length=e,this.lines=0,t))this.lines+=i.lines}lineInner(t,e,i,n){for(let o=0;;o++){let r=this.children[o],s=n+r.length,a=i+r.lines-1;if((e?a:s)>=t)return r.lineInner(t,e,i,n);n=s+1,i=a+1}}decompose(t,e,i,n){for(let o=0,r=0;r<=e&&o<this.children.length;o++){let s=this.children[o],a=r+s.length;if(t<=a&&e>=r){let o=n&((r<=t?1:0)|(a>=e?2:0));r>=t&&a<=e&&!o?i.push(s):s.decompose(t-r,e-r,i,o)}r=a+1}}replace(t,e,i){if([t,e]=e7(this,t,e),i.lines<this.lines)for(let n=0,o=0;n<this.children.length;n++){let r=this.children[n],s=o+r.length;if(t>=o&&e<=s){let a=r.replace(t-o,e-o,i),l=this.lines-r.lines+a.lines;if(a.lines<l>>4&&a.lines>l>>6){let o=this.children.slice();return o[n]=a,new e5(o,this.length-(e-t)+i.length)}return super.replace(o,s,a)}o=s+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i="\n"){[t,e]=e7(this,t,e);let n="";for(let o=0,r=0;o<this.children.length&&r<=e;o++){let s=this.children[o],a=r+s.length;r>t&&o&&(n+=i),t<a&&e>r&&(n+=s.sliceString(t-r,e-r,i)),r=a+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof e5))return 0;let i=0,[n,o,r,s]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,o+=e){if(n==r||o==s)return i;let a=this.children[n],l=t.children[o];if(a!=l)return i+a.scanIdentical(l,e);i+=a.length+1}}static from(t,e=t.reduce((t,e)=>t+e.length+1,-1)){let i=0;for(let e of t)i+=e.lines;if(i<32){let i=[];for(let e of t)e.flatten(i);return new e2(i,e)}let n=Math.max(32,i>>5),o=n<<1,r=n>>1,s=[],a=0,l=-1,h=[];function c(){0!=a&&(s.push(1==h.length?h[0]:e5.from(h,l)),l=-1,a=h.length=0)}for(let e of t)!function t(e){let i;if(e.lines>o&&e instanceof e5)for(let i of e.children)t(i);else e.lines>r&&(a>r||!a)?(c(),s.push(e)):e instanceof e2&&a&&(i=h[h.length-1])instanceof e2&&e.lines+i.lines<=32?(a+=e.lines,l+=e.length+1,h[h.length-1]=new e2(i.text.concat(e.text),i.length+1+e.length)):(a+e.lines>n&&c(),a+=e.lines,l+=e.length+1,h.push(e))}(e);return c(),1==s.length?s[0]:new e5(s,e)}}function e3(t,e,i=0,n=1e9){for(let o=0,r=0,s=!0;r<t.length&&o<=n;r++){let a=t[r],l=o+a.length;l>=i&&(l>n&&(a=a.slice(0,n-o)),o<i&&(a=a.slice(i-o)),s?(e[e.length-1]+=a,s=!1):e.push(a)),o=l+1}return e}e1.empty=new e2([""],0);class e4{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof e2?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],o=this.offsets[i],r=o>>1,s=n instanceof e2?n.text.length:n.children.length;if(r==(e>0?s:0)){if(0==i)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&o)==(e>0?0:1)){if(this.offsets[i]+=e,0==t)return this.lineBreak=!0,this.value="\n",this;t--}else if(n instanceof e2){let o=n.text[r+(e<0?-1:0)];if(this.offsets[i]+=e,o.length>Math.max(0,t))return this.value=0==t?o:e>0?o.slice(t):o.slice(0,o.length-t),this;t-=o.length}else{let o=n.children[r+(e<0?-1:0)];t>o.length?(t-=o.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(o),this.offsets.push(e>0?1:(o instanceof e2?o.text.length:o.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class e8{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new e4(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class e6{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(e1.prototype[Symbol.iterator]=function(){return this.iter()},e4.prototype[Symbol.iterator]=e8.prototype[Symbol.iterator]=e6.prototype[Symbol.iterator]=function(){return this});class e9{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}}function e7(t,e,i){return[e=Math.max(0,Math.min(t.length,e)),Math.max(e,Math.min(t.length,i))]}function it(t,e,i=!0,n=!0){return function(t,e,i=!0,n=!0){return(i?eX:function(t,e,i){for(;e>0;){let n=eX(t,e-2,i);if(n<e)return n;e--}return 0})(t,e,n)}(t,e,i,n)}function ie(t,e){let i=t.charCodeAt(e);if(!(i>=55296&&i<56320)||e+1==t.length)return i;let n=t.charCodeAt(e+1);return n>=56320&&n<57344?(i-55296<<10)+(n-56320)+65536:i}function ii(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(((t-=65536)>>10)+55296,(1023&t)+56320)}function io(t){return t<65536?1:2}const ir=/\r\n?|\n/;var is=((s=is||(is={}))[s.Simple=0]="Simple",s[s.TrackDel=1]="TrackDel",s[s.TrackBefore=2]="TrackBefore",s[s.TrackAfter=3]="TrackAfter",s);class ia{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let o=this.sections[e++],r=this.sections[e++];r<0?(t(i,n,o),n+=o):n+=r,i+=o}}iterChangedRanges(t,e=!1){id(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new ia(t)}composeDesc(t){return this.empty?t:t.empty?this:ip(this,t)}mapDesc(t,e=!1){return t.empty?this:iu(this,t,e)}mapPos(t,e=-1,i=is.Simple){let n=0,o=0;for(let r=0;r<this.sections.length;){let s=this.sections[r++],a=this.sections[r++],l=n+s;if(a<0){if(l>t)return o+(t-n);o+=s}else{if(i!=is.Simple&&l>=t&&(i==is.TrackDel&&n<t&&l>t||i==is.TrackBefore&&n<t||i==is.TrackAfter&&l>t))return null;if(l>t||l==t&&e<0&&!s)return t==n||e<0?o:o+a;o+=a}n=l}if(t>n)throw RangeError(`Position ${t} is out of range for changeset of length ${n}`);return o}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let o=this.sections[i++],r=this.sections[i++],s=n+o;if(r>=0&&n<=e&&s>=t)return!(n<t)||!(s>e)||"cover";n=s}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(t=>"number"!=typeof t))throw RangeError("Invalid JSON representation of ChangeDesc");return new ia(t)}static create(t){return new ia(t)}}class il extends ia{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw RangeError("Applying change set to a document with the wrong length");return id(this,(e,i,n,o,r)=>t=t.replace(n,n+(i-e),r),!1),t}mapDesc(t,e=!1){return iu(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,o=0;n<e.length;n+=2){let r=e[n],s=e[n+1];if(s>=0){e[n]=s,e[n+1]=r;let a=n>>1;for(;i.length<a;)i.push(e1.empty);i.push(r?t.slice(o,o+r):e1.empty)}o+=r}return new il(e,i)}compose(t){return this.empty?t:t.empty?this:ip(this,t,!0)}map(t,e=!1){return t.empty?this:iu(this,t,e,!0)}iterChanges(t,e=!1){id(this,t,e)}get desc(){return ia.create(this.sections)}filter(t){let e=[],i=[],n=[],o=new ig(this);t:for(let r=0,s=0;;){let a=r==t.length?1e9:t[r++];for(;s<a||s==a&&0==o.len;){if(o.done)break t;let t=Math.min(o.len,a-s);ih(n,t,-1);let r=-1==o.ins?-1:0==o.off?o.ins:0;ih(e,t,r),r>0&&ic(i,e,o.text),o.forward(t),s+=t}let l=t[r++];for(;s<l;){if(o.done)break t;let t=Math.min(o.len,l-s);ih(e,t,-1),ih(n,t,-1==o.ins?-1:0==o.off?o.ins:0),o.forward(t),s+=t}}return{changes:new il(e,i),filtered:ia.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):0==n?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],o=[],r=0,s=null;function a(t=!1){if(!t&&!n.length)return;r<e&&ih(n,e-r,-1);let i=new il(n,o);s=s?s.compose(i.map(s)):i,n=[],o=[],r=0}return!function t(l){if(Array.isArray(l))for(let e of l)t(e);else if(l instanceof il){if(l.length!=e)throw RangeError(`Mismatched change set length (got ${l.length}, expected ${e})`);a(),s=s?s.compose(l.map(s)):l}else{let{from:t,to:s=t,insert:h}=l;if(t>s||t<0||s>e)throw RangeError(`Invalid change range ${t} to ${s} (in doc of length ${e})`);let c=h?"string"==typeof h?e1.of(h.split(i||ir)):h:e1.empty,d=c.length;if(t==s&&0==d)return;t<r&&a(),t>r&&ih(n,t-r,-1),ih(n,s-t,d),ic(o,n,c),r=s}}(t),a(!s),s}static empty(t){return new il(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let o=t[n];if("number"==typeof o)e.push(o,-1);else if(!Array.isArray(o)||"number"!=typeof o[0]||o.some((t,e)=>e&&"string"!=typeof t))throw RangeError("Invalid JSON representation of ChangeSet");else if(1==o.length)e.push(o[0],0);else{for(;i.length<n;)i.push(e1.empty);i[n]=e1.of(o.slice(1)),e.push(o[0],i[n].length)}}return new il(e,i)}static createSet(t,e){return new il(t,e)}}function ih(t,e,i,n=!1){if(0==e&&i<=0)return;let o=t.length-2;o>=0&&i<=0&&i==t[o+1]?t[o]+=e:o>=0&&0==e&&0==t[o]?t[o+1]+=i:n?(t[o]+=e,t[o+1]+=i):t.push(e,i)}function ic(t,e,i){if(0==i.length)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(i);else{for(;t.length<n;)t.push(e1.empty);t.push(i)}}function id(t,e,i){let n=t.inserted;for(let o=0,r=0,s=0;s<t.sections.length;){let a=t.sections[s++],l=t.sections[s++];if(l<0)o+=a,r+=a;else{let h=o,c=r,d=e1.empty;for(;h+=a,c+=l,l&&n&&(d=d.append(n[s-2>>1])),!i&&s!=t.sections.length&&!(t.sections[s+1]<0);)a=t.sections[s++],l=t.sections[s++];e(o,h,r,c,d),o=h,r=c}}}function iu(t,e,i,n=!1){let o=[],r=n?[]:null,s=new ig(t),a=new ig(e);for(let t=-1;;){if(s.done&&a.len||a.done&&s.len)throw Error("Mismatched change set lengths");if(-1==s.ins&&-1==a.ins){let t=Math.min(s.len,a.len);ih(o,t,-1),s.forward(t),a.forward(t)}else if(a.ins>=0&&(s.ins<0||t==s.i||0==s.off&&(a.len<s.len||a.len==s.len&&!i))){let e=a.len;for(ih(o,a.ins,-1);e;){let i=Math.min(s.len,e);s.ins>=0&&t<s.i&&s.len<=i&&(ih(o,0,s.ins),r&&ic(r,o,s.text),t=s.i),s.forward(i),e-=i}a.next()}else if(s.ins>=0){let e=0,i=s.len;for(;i;)if(-1==a.ins){let t=Math.min(i,a.len);e+=t,i-=t,a.forward(t)}else if(0==a.ins&&a.len<i)i-=a.len,a.next();else break;ih(o,e,t<s.i?s.ins:0),r&&t<s.i&&ic(r,o,s.text),t=s.i,s.forward(s.len-i)}else if(s.done&&a.done)return r?il.createSet(o,r):ia.create(o);else throw Error("Mismatched change set lengths")}}function ip(t,e,i=!1){let n=[],o=i?[]:null,r=new ig(t),s=new ig(e);for(let t=!1;;){if(r.done&&s.done)return o?il.createSet(n,o):ia.create(n);if(0==r.ins)ih(n,r.len,0,t),r.next();else if(0!=s.len||s.done){if(r.done||s.done)throw Error("Mismatched change set lengths");{let e=Math.min(r.len2,s.len),i=n.length;if(-1==r.ins){let i=-1==s.ins?-1:s.off?0:s.ins;ih(n,e,i,t),o&&i&&ic(o,n,s.text)}else -1==s.ins?(ih(n,r.off?0:r.len,e,t),o&&ic(o,n,r.textBit(e))):(ih(n,r.off?0:r.len,s.off?0:s.ins,t),o&&!s.off&&ic(o,n,s.text));t=(r.ins>e||s.ins>=0&&s.len>e)&&(t||n.length>i),r.forward2(e),s.forward(e)}}else ih(n,0,s.ins,t),o&&ic(o,n,s.text),s.next()}}class ig{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return -2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?e1.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?e1.empty:e[i].slice(this.off,null==t?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){-1==this.ins?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class im{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let t=7&this.flags;return 7==t?null:t}get goalColumn(){let t=this.flags>>6;return 0xffffff==t?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new im(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return iv.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return iv.range(this.anchor,i)}eq(t,e=!1){return this.anchor==t.anchor&&this.head==t.head&&(!e||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||"number"!=typeof t.anchor||"number"!=typeof t.head)throw RangeError("Invalid JSON representation for SelectionRange");return iv.range(t.anchor,t.head)}static create(t,e,i){return new im(t,e,i)}}class iv{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:iv.create(this.ranges.map(i=>i.map(t,e)),this.mainIndex)}eq(t,e=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(t.ranges[i],e))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new iv([this.main],0)}addRange(t,e=!0){return iv.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,iv.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw RangeError("Invalid JSON representation for EditorSelection");return new iv(t.ranges.map(t=>im.fromJSON(t)),t.main)}static single(t,e=t){return new iv([iv.range(t,e)],0)}static create(t,e=0){if(0==t.length)throw RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let o=t[n];if(o.empty?o.from<=i:o.from<i)return iv.normalized(t.slice(),e);i=o.to}return new iv(t,e)}static cursor(t,e=0,i,n){return im.create(t,t,(0==e?0:e<0?8:16)|(null==i?7:Math.min(6,i))|(null!=n?n:0xffffff)<<6)}static range(t,e,i,n){let o=(null!=i?i:0xffffff)<<6|(null==n?7:Math.min(6,n));return e<t?im.create(e,t,48|o):im.create(t,e,(e>t?8:0)|o)}static normalized(t,e=0){let i=t[e];t.sort((t,e)=>t.from-e.from),e=t.indexOf(i);for(let i=1;i<t.length;i++){let n=t[i],o=t[i-1];if(n.empty?n.from<=o.to:n.from<o.to){let r=o.from,s=Math.max(n.to,o.to);i<=e&&e--,t.splice(--i,2,n.anchor>n.head?iv.range(s,r):iv.range(r,s))}}return new iv(t,e)}}function iy(t,e){for(let i of t.ranges)if(i.to>e)throw RangeError("Selection points outside of document")}let ib=0;class iw{constructor(t,e,i,n,o){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.id=ib++,this.default=t([]),this.extensions="function"==typeof o?o(this):o}get reader(){return this}static define(t={}){return new iw(t.combine||(t=>t),t.compareInput||((t,e)=>t===e),t.compare||(t.combine?(t,e)=>t===e:ix),!!t.static,t.enables)}of(t){return new ik([],this,0,t)}compute(t,e){if(this.isStatic)throw Error("Can't compute a static facet");return new ik(t,this,1,e)}computeN(t,e){if(this.isStatic)throw Error("Can't compute a static facet");return new ik(t,this,2,e)}from(t,e){return e||(e=t=>t),this.compute([t],i=>e(i.field(t)))}}function ix(t,e){return t==e||t.length==e.length&&t.every((t,i)=>t===e[i])}class ik{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=ib++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,o=this.id,r=t[o]>>1,s=2==this.type,a=!1,l=!1,h=[];for(let i of this.dependencies)"doc"==i?a=!0:"selection"==i?l=!0:((null!==(e=t[i.id])&&void 0!==e?e:1)&1)==0&&h.push(t[i.id]);return{create:t=>(t.values[r]=i(t),1),update(t,e){if(a&&e.docChanged||l&&(e.docChanged||e.selection)||iS(t,h)){let e=i(t);if(s?!iO(e,t.values[r],n):!n(e,t.values[r]))return t.values[r]=e,1}return 0},reconfigure:(t,e)=>{let a,l=e.config.address[o];if(null!=l){let o=iz(e,l);if(this.dependencies.every(i=>i instanceof iw?e.facet(i)===t.facet(i):!(i instanceof iC)||e.field(i,!1)==t.field(i,!1))||(s?iO(a=i(t),o,n):n(a=i(t),o)))return t.values[r]=o,0}else a=i(t);return t.values[r]=a,1}}}}function iO(t,e,i){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0}function iS(t,e){let i=!1;for(let n of e)1&iB(t,n)&&(i=!0);return i}const i_=iw.define({static:!0});class iC{constructor(t,e,i,n,o){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=o,this.provides=void 0}static define(t){let e=new iC(ib++,t.create,t.update,t.compare||((t,e)=>t===e),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(i_).find(t=>t.field==this);return((null==e?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:t=>(t.values[e]=this.create(t),1),update:(t,i)=>{let n=t.values[e],o=this.updateF(n,i);return this.compareF(n,o)?0:(t.values[e]=o,1)},reconfigure:(t,i)=>null!=i.config.address[this.id]?(t.values[e]=i.field(this),0):(t.values[e]=this.create(t),1)}}init(t){return[this,i_.of({field:this,create:t})]}get extension(){return this}}const iE={lowest:4,low:3,default:2,high:1,highest:0};function iM(t){return e=>new iT(e,t)}const iP={highest:iM(iE.highest),high:iM(iE.high),default:iM(iE.default),low:iM(iE.low),lowest:iM(iE.lowest)};class iT{constructor(t,e){this.inner=t,this.prec=e}}class iA{of(t){return new iD(this,t)}reconfigure(t){return iA.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class iD{constructor(t,e){this.compartment=t,this.inner=e}}class iI{constructor(t,e,i,n,o,r){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=o,this.facets=r,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return null==e?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n,o,r=[],s=Object.create(null),a=new Map;for(let i of(n=[[],[],[],[],[]],o=new Map,!function t(i,r){let s=o.get(i);if(null!=s){if(s<=r)return;let t=n[s].indexOf(i);t>-1&&n[s].splice(t,1),i instanceof iD&&a.delete(i.compartment)}if(o.set(i,r),Array.isArray(i))for(let e of i)t(e,r);else if(i instanceof iD){if(a.has(i.compartment))throw RangeError("Duplicate use of compartment in extensions");let n=e.get(i.compartment)||i.inner;a.set(i.compartment,n),t(n,r)}else if(i instanceof iT)t(i.inner,i.prec);else if(i instanceof iC)n[r].push(i),i.provides&&t(i.provides,r);else if(i instanceof ik)n[r].push(i),i.facet.extensions&&t(i.facet.extensions,iE.default);else{let e=i.extension;if(!e)throw Error(`Unrecognized extension value in extension set (${i}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);t(e,r)}}(t,iE.default),n.reduce((t,e)=>t.concat(e))))i instanceof iC?r.push(i):(s[i.facet.id]||(s[i.facet.id]=[])).push(i);let l=Object.create(null),h=[],c=[];for(let t of r)l[t.id]=c.length<<1,c.push(e=>t.slot(e));let d=null==i?void 0:i.config.facets;for(let t in s){let e=s[t],n=e[0].facet,o=d&&d[t]||[];if(e.every(t=>0==t.type)){if(l[n.id]=h.length<<1|1,ix(o,e))h.push(i.facet(n));else{let t=n.combine(e.map(t=>t.value));h.push(i&&n.compare(t,i.facet(n))?i.facet(n):t)}}else{for(let t of e)0==t.type?(l[t.id]=h.length<<1|1,h.push(t.value)):(l[t.id]=c.length<<1,c.push(e=>t.dynamicSlot(e)));l[n.id]=c.length<<1,c.push(t=>(function(t,e,i){let n=i.map(e=>t[e.id]),o=i.map(t=>t.type),r=n.filter(t=>!(1&t)),s=t[e.id]>>1;function a(t){let i=[];for(let e=0;e<n.length;e++){let r=iz(t,n[e]);if(2==o[e])for(let t of r)i.push(t);else i.push(r)}return e.combine(i)}return{create(t){for(let e of n)iB(t,e);return t.values[s]=a(t),1},update(t,i){if(!iS(t,r))return 0;let n=a(t);return e.compare(n,t.values[s])?0:(t.values[s]=n,1)},reconfigure(t,o){let r=iS(t,n),l=o.config.facets[e.id],h=o.facet(e);if(l&&!r&&ix(i,l))return t.values[s]=h,0;let c=a(t);return e.compare(c,h)?(t.values[s]=h,0):(t.values[s]=c,1)}}})(t,n,e))}}return new iI(t,a,c.map(t=>t(l)),l,h,s)}}function iB(t,e){if(1&e)return 2;let i=e>>1,n=t.status[i];if(4==n)throw Error("Cyclic dependency between fields and/or facets");if(2&n)return n;t.status[i]=4;let o=t.computeSlot(t,t.config.dynamicSlots[i]);return t.status[i]=2|o}function iz(t,e){return 1&e?t.config.staticValues[e>>1]:t.values[e>>1]}const iR=iw.define(),iN=iw.define({combine:t=>t.some(t=>t),static:!0}),iL=iw.define({combine:t=>t.length?t[0]:void 0,static:!0}),iF=iw.define(),ij=iw.define(),iH=iw.define(),iW=iw.define({combine:t=>!!t.length&&t[0]});class iV{constructor(t,e){this.type=t,this.value=e}static define(){return new iQ}}class iQ{of(t){return new iV(this,t)}}class i${constructor(t){this.map=t}of(t){return new iq(this,t)}}class iq{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return void 0===e?void 0:e==this.value?this:new iq(this.type,e)}is(t){return this.type==t}static define(t={}){return new i$(t.map||(t=>t))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let t=n.map(e);t&&i.push(t)}return i}}iq.reconfigure=iq.define(),iq.appendConfig=iq.define();class iU{constructor(t,e,i,n,o,r){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=o,this.scrollIntoView=r,this._doc=null,this._state=null,i&&iy(i,e.newLength),o.some(t=>t.type==iU.time)||(this.annotations=o.concat(iU.time.of(Date.now())))}static create(t,e,i,n,o,r){return new iU(t,e,i,n,o,r)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(iU.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&"."==e[t.length]))}}function iY(t,e,i){var n;let o,r,s;return i?(o=e.changes,r=il.empty(e.changes.length),s=t.changes.compose(e.changes)):(o=e.changes.map(t.changes),r=t.changes.mapDesc(e.changes,!0),s=t.changes.compose(o)),{changes:s,selection:e.selection?e.selection.map(r):null===(n=t.selection)||void 0===n?void 0:n.map(o),effects:iq.mapEffects(t.effects,o).concat(iq.mapEffects(e.effects,r)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function iG(t,e,i){let n=e.selection,o=iK(e.annotations);return e.userEvent&&(o=o.concat(iU.userEvent.of(e.userEvent))),{changes:e.changes instanceof il?e.changes:il.of(e.changes||[],i,t.facet(iL)),selection:n&&(n instanceof iv?n:iv.single(n.anchor,n.head)),effects:iK(e.effects),annotations:o,scrollIntoView:!!e.scrollIntoView}}iU.time=iV.define(),iU.userEvent=iV.define(),iU.addToHistory=iV.define(),iU.remote=iV.define();const iX=[];function iK(t){return null==t?iX:Array.isArray(t)?t:[t]}var iZ=((a=iZ||(iZ={}))[a.Word=0]="Word",a[a.Space=1]="Space",a[a.Other=2]="Other",a);const iJ=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{i=RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(t){}class i0{constructor(t,e,i,n,o,r){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=o,r&&(r._state=this);for(let t=0;t<this.config.dynamicSlots.length;t++)iB(this,t<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(null==i){if(e)throw RangeError("Field is not present in this state");return}return iB(this,i),iz(this,i)}update(...t){return function t(e,i,n){let o=iG(e,i.length?i[0]:{},e.doc.length);i.length&&!1===i[0].filter&&(n=!1);for(let t=1;t<i.length;t++){!1===i[t].filter&&(n=!1);let r=!!i[t].sequential;o=iY(o,iG(e,i[t],r?o.changes.newLength:e.doc.length),r)}let r=iU.create(e,o.changes,o.selection,o.effects,o.annotations,o.scrollIntoView);return function(t){let e=t.startState,i=e.facet(iH),n=t;for(let o=i.length-1;o>=0;o--){let r=i[o](t);r&&Object.keys(r).length&&(n=iY(n,iG(e,r,t.changes.newLength),!0))}return n==t?t:iU.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}(n?function(e){let i=e.startState,n=!0;for(let t of i.facet(iF)){let i=t(e);if(!1===i){n=!1;break}Array.isArray(i)&&(n=!0===n?i:function(t,e){let i=[];for(let n=0,o=0;;){let r,s;if(n<t.length&&(o==e.length||e[o]>=t[n]))r=t[n++],s=t[n++];else{if(!(o<e.length))return i;r=e[o++],s=e[o++]}!i.length||i[i.length-1]<r?i.push(r,s):i[i.length-1]<s&&(i[i.length-1]=s)}}(n,i))}if(!0!==n){let t,o;if(!1===n)o=e.changes.invertedDesc,t=il.empty(i.doc.length);else{let i=e.changes.filter(n);t=i.changes,o=i.filtered.mapDesc(i.changes).invertedDesc}e=iU.create(i,t,e.selection&&e.selection.map(o),iq.mapEffects(e.effects,o),e.annotations,e.scrollIntoView)}let o=i.facet(ij);for(let n=o.length-1;n>=0;n--){let r=o[n](e);e=r instanceof iU?r:Array.isArray(r)&&1==r.length&&r[0]instanceof iU?r[0]:t(i,iK(r),!1)}return e}(r):r)}(this,t,!0)}applyTransaction(t){let e,i=this.config,{base:n,compartments:o}=i;for(let e of t.effects)e.is(iA.reconfigure)?(i&&(o=new Map,i.compartments.forEach((t,e)=>o.set(e,t)),i=null),o.set(e.value.compartment,e.value.extension)):e.is(iq.reconfigure)?(i=null,n=e.value):e.is(iq.appendConfig)&&(i=null,n=iK(n).concat(e.value));e=i?t.startState.values.slice():new i0(i=iI.resolve(n,o,this),this.doc,this.selection,i.dynamicSlots.map(()=>null),(t,e)=>e.reconfigure(t,this),null).values;let r=t.startState.facet(iN)?t.newSelection:t.newSelection.asSingle();new i0(i,t.newDoc,r,e,(e,i)=>i.update(e,t),t)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:iv.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),o=[i.range],r=iK(i.effects);for(let i=1;i<e.ranges.length;i++){let s=t(e.ranges[i]),a=this.changes(s.changes),l=a.map(n);for(let t=0;t<i;t++)o[t]=o[t].map(l);let h=n.mapDesc(a,!0);o.push(s.range.map(h)),n=n.compose(l),r=iq.mapEffects(r,l).concat(iq.mapEffects(iK(s.effects),h))}return{changes:n,selection:iv.create(o,e.mainIndex),effects:r}}changes(t=[]){return t instanceof il?t:il.of(t,this.doc.length,this.facet(i0.lineSeparator))}toText(t){return e1.of(t.split(this.facet(i0.lineSeparator)||ir))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return null==e?t.default:(iB(this,e),iz(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof iC&&null!=this.config.address[n.id]&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||"string"!=typeof t.doc)throw RangeError("Invalid JSON representation for EditorState");let n=[];if(i){for(let e in i)if(Object.prototype.hasOwnProperty.call(t,e)){let o=i[e],r=t[e];n.push(o.init(t=>o.spec.fromJSON(r,t)))}}return i0.create({doc:t.doc,selection:iv.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=iI.resolve(t.extensions||[],new Map),i=t.doc instanceof e1?t.doc:e1.of((t.doc||"").split(e.staticFacet(i0.lineSeparator)||ir)),n=t.selection?t.selection instanceof iv?t.selection:iv.single(t.selection.anchor,t.selection.head):iv.single(0);return iy(n,i.length),e.staticFacet(iN)||(n=n.asSingle()),new i0(e,i,n,e.dynamicSlots.map(()=>null),(t,e)=>e.create(t),null)}get tabSize(){return this.facet(i0.tabSize)}get lineBreak(){return this.facet(i0.lineSeparator)||"\n"}get readOnly(){return this.facet(iW)}phrase(t,...e){for(let e of this.facet(i0.phrases))if(Object.prototype.hasOwnProperty.call(e,t)){t=e[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(t,i)=>{if("$"==i)return"$";let n=+(i||1);return!n||n>e.length?t:e[n-1]})),t}languageDataAt(t,e,i=-1){let n=[];for(let o of this.facet(iR))for(let r of o(this,e,i))Object.prototype.hasOwnProperty.call(r,t)&&n.push(r[t]);return n}charCategorizer(t){var e;return e=this.languageDataAt("wordChars",t).join(""),t=>{if(!/\S/.test(t))return iZ.Space;if(function(t){if(i)return i.test(t);for(let e=0;e<t.length;e++){let i=t[e];if(/\w/.test(i)||i>"Â"&&(i.toUpperCase()!=i.toLowerCase()||iJ.test(i)))return!0}return!1}(t))return iZ.Word;for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return iZ.Word;return iZ.Other}}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),o=this.charCategorizer(t),r=t-i,s=t-i;for(;r>0;){let t=it(e,r,!1);if(o(e.slice(t,r))!=iZ.Word)break;r=t}for(;s<n;){let t=it(e,s);if(o(e.slice(s,t))!=iZ.Word)break;s=t}return r==s?null:iv.range(r+i,s+i)}}function i1(t,e,i={}){let n={};for(let e of t)for(let t of Object.keys(e)){let o=e[t],r=n[t];if(void 0===r)n[t]=o;else if(r===o||void 0===o);else if(Object.hasOwnProperty.call(i,t))n[t]=i[t](r,o);else throw Error("Config merge conflict for field "+t)}for(let t in e)void 0===n[t]&&(n[t]=e[t]);return n}i0.allowMultipleSelections=iN,i0.tabSize=iw.define({combine:t=>t.length?t[0]:4}),i0.lineSeparator=iL,i0.readOnly=iW,i0.phrases=iw.define({compare(t,e){let i=Object.keys(t),n=Object.keys(e);return i.length==n.length&&i.every(i=>t[i]==e[i])}}),i0.languageData=iR,i0.changeFilter=iF,i0.transactionFilter=ij,i0.transactionExtender=iH,iA.reconfigure=iq.define();class i2{eq(t){return this==t}range(t,e=t){return i5.create(t,e,this)}}i2.prototype.startSide=i2.prototype.endSide=0,i2.prototype.point=!1,i2.prototype.mapMode=is.TrackDel;class i5{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new i5(t,e,i)}}function i3(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class i4{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let o=i?this.to:this.from;for(let r=n,s=o.length;;){if(r==s)return r;let n=r+s>>1,a=o[n]-t||(i?this.value[n].endSide:this.value[n].startSide)-e;if(n==r)return a>=0?r:s;a>=0?s=n:r=n+1}}between(t,e,i,n){for(let o=this.findIndex(e,-1e9,!0),r=this.findIndex(i,1e9,!1,o);o<r;o++)if(!1===n(this.from[o]+t,this.to[o]+t,this.value[o]))return!1}map(t,e){let i=[],n=[],o=[],r=-1,s=-1;for(let a=0;a<this.value.length;a++){let l=this.value[a],h=this.from[a]+t,c=this.to[a]+t,d,u;if(h==c){let t=e.mapPos(h,l.startSide,l.mapMode);if(null==t||(d=u=t,l.startSide!=l.endSide&&(u=e.mapPos(h,l.endSide))<d))continue}else if((d=e.mapPos(h,l.startSide))>(u=e.mapPos(c,l.endSide))||d==u&&l.startSide>0&&l.endSide<=0)continue;0>(u-d||l.endSide-l.startSide)||(r<0&&(r=d),l.point&&(s=Math.max(s,u-d)),i.push(l),n.push(d-r),o.push(u-r))}return{mapped:i.length?new i4(n,o,i,s):null,pos:r}}}class i8{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new i8(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:o=this.length}=t,r=t.filter;if(0==e.length&&!r)return this;if(i&&(e=e.slice().sort(i3)),this.isEmpty)return e.length?i8.of(e):this;let s=new i7(this,null,-1).goto(0),a=0,l=[],h=new i6;for(;s.value||a<e.length;)if(a<e.length&&(s.from-e[a].from||s.startSide-e[a].value.startSide)>=0){let t=e[a++];h.addInner(t.from,t.to,t.value)||l.push(t)}else 1==s.rangeIndex&&s.chunkIndex<this.chunk.length&&(a==e.length||this.chunkEnd(s.chunkIndex)<e[a].from)&&(!r||n>this.chunkEnd(s.chunkIndex)||o<this.chunkPos[s.chunkIndex])&&h.addChunk(this.chunkPos[s.chunkIndex],this.chunk[s.chunkIndex])?s.nextChunk():((!r||n>s.to||o<s.from||r(s.from,s.to,s.value))&&!h.addInner(s.from,s.to,s.value)&&l.push(i5.create(s.from,s.to,s.value)),s.next());return h.finishInner(this.nextLayer.isEmpty&&!l.length?i8.empty:this.nextLayer.update({add:l,filter:r,filterFrom:n,filterTo:o}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let o=0;o<this.chunk.length;o++){let r=this.chunkPos[o],s=this.chunk[o],a=t.touchesRange(r,r+s.length);if(!1===a)n=Math.max(n,s.maxPoint),e.push(s),i.push(t.mapPos(r));else if(!0===a){let{mapped:o,pos:a}=s.map(r,t);o&&(n=Math.max(n,o.maxPoint),e.push(o),i.push(a))}}let o=this.nextLayer.map(t);return 0==e.length?o:new i8(i,e,o||i8.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let o=this.chunkPos[n],r=this.chunk[n];if(e>=o&&t<=o+r.length&&!1===r.between(o,t-o,e-o,i))return}this.nextLayer.between(t,e,i)}}iter(t=0){return nt.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return nt.from(t).goto(e)}static compare(t,e,i,n,o=-1){let r=t.filter(t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=o),s=e.filter(t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=o),a=i9(r,s,i),l=new ni(r,a,o),h=new ni(s,a,o);i.iterGaps((t,e,i)=>nn(l,t,h,e,i,n)),i.empty&&0==i.length&&nn(l,0,h,0,0,n)}static eq(t,e,i=0,n){null==n&&(n=0x3b9ac9ff);let o=t.filter(t=>!t.isEmpty&&0>e.indexOf(t)),r=e.filter(e=>!e.isEmpty&&0>t.indexOf(e));if(o.length!=r.length)return!1;if(!o.length)return!0;let s=i9(o,r),a=new ni(o,s,0).goto(i),l=new ni(r,s,0).goto(i);for(;;){if(a.to!=l.to||!no(a.active,l.active)||a.point&&(!l.point||!a.point.eq(l.point)))return!1;if(a.to>n)return!0;a.next(),l.next()}}static spans(t,e,i,n,o=-1){let r=new ni(t,null,o).goto(e),s=e,a=r.openStart;for(;;){let t=Math.min(r.to,i);if(r.point){let i=r.activeForPoint(r.to),o=r.pointFrom<e?i.length+1:r.point.startSide<0?i.length:Math.min(i.length,a);n.point(s,t,r.point,i,o,r.pointRank),a=Math.min(r.openEnd(t),i.length)}else t>s&&(n.span(s,t,r.active,a),a=r.openEnd(t));if(r.to>i)return a+(r.point&&r.to>i?1:0);s=r.to,r.next()}}static of(t,e=!1){let i=new i6;for(let n of t instanceof i5?[t]:e?function(t){if(t.length>1)for(let e=t[0],i=1;i<t.length;i++){let n=t[i];if(i3(e,n)>0)return t.slice().sort(i3);e=n}return t}(t):t)i.add(n.from,n.to,n.value);return i.finish()}static join(t){if(!t.length)return i8.empty;let e=t[t.length-1];for(let i=t.length-2;i>=0;i--)for(let n=t[i];n!=i8.empty;n=n.nextLayer)e=new i8(n.chunkPos,n.chunk,e,Math.max(n.maxPoint,e.maxPoint));return e}}i8.empty=new i8([],[],null,-1),i8.empty.nextLayer=i8.empty;class i6{finishChunk(t){this.chunks.push(new i4(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new i6)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&0>(t-this.lastFrom||i.startSide-this.last.startSide))throw Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if(0>(t-this.lastTo||e.value[0].startSide-this.last.endSide))return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(i8.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return t;let e=i8.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function i9(t,e,i){let n=new Map;for(let e of t)for(let t=0;t<e.chunk.length;t++)e.chunk[t].maxPoint<=0&&n.set(e.chunk[t],e.chunkPos[t]);let o=new Set;for(let t of e)for(let e=0;e<t.chunk.length;e++){let r=n.get(t.chunk[e]);null==r||(i?i.mapPos(r):r)!=t.chunkPos[e]||(null==i?void 0:i.touchesRange(r,r+t.chunk[e].length))||o.add(t.chunk[e])}return o}class i7{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let e=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(e)||this.layer.chunkEnd(this.chunkIndex)<t||e.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){0>(this.to-t||this.endSide-e)&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class nt{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let o=0;o<t.length;o++)for(let r=t[o];!r.isEmpty;r=r.nextLayer)r.maxPoint>=i&&n.push(new i7(r,e,i,o));return 1==n.length?n[0]:new nt(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let t=this.heap.length>>1;t>=0;t--)ne(this.heap,t);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let t=this.heap.length>>1;t>=0;t--)ne(this.heap,t);0>(this.to-t||this.value.endSide-e)&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),ne(this.heap,0)}}}function ne(t,e){for(let i=t[e];;){let n=(e<<1)+1;if(n>=t.length)break;let o=t[n];if(n+1<t.length&&o.compare(t[n+1])>=0&&(o=t[n+1],n++),0>i.compare(o))break;t[n]=i,t[e]=o,e=n}}class ni{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=nt.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&0>(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e);)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){nr(this.active,t),nr(this.activeTo,t),nr(this.activeRank,t),this.minActive=na(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:o}=this.cursor;for(;e<this.activeRank.length&&(o-this.activeRank[e]||n-this.activeTo[e])>0;)e++;ns(this.active,e,i),ns(this.activeTo,e,n),ns(this.activeRank,e,o),t&&ns(t,e,this.cursor.from),this.minActive=na(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&0>(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&nr(i,n)}else if(this.cursor.value){if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let t=this.cursor.value;if(t.point){if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=t,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=t.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else this.addActive(i),this.cursor.next()}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let e=i.length-1;e>=0&&i[e]<t;e--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function nn(t,e,i,n,o,r){t.goto(e),i.goto(n);let s=n+o,a=n,l=n-e;for(;;){let e=t.to+l-i.to,n=e||t.endSide-i.endSide,o=n<0?t.to+l:i.to,h=Math.min(o,s);if(t.point||i.point?t.point&&i.point&&(t.point==i.point||t.point.eq(i.point))&&no(t.activeForPoint(t.to),i.activeForPoint(i.to))||r.comparePoint(a,h,t.point,i.point):h>a&&!no(t.active,i.active)&&r.compareRange(a,h,t.active,i.active),o>s)break;(e||t.openEnd!=i.openEnd)&&r.boundChange&&r.boundChange(o),a=o,n<=0&&t.next(),n>=0&&i.next()}}function no(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!=e[i]&&!t[i].eq(e[i]))return!1;return!0}function nr(t,e){for(let i=e,n=t.length-1;i<n;i++)t[i]=t[i+1];t.pop()}function ns(t,e,i){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=i}function na(t,e){let i=-1,n=1e9;for(let o=0;o<e.length;o++)0>(e[o]-n||t[o].endSide-t[i].endSide)&&(i=o,n=e[o]);return i}function nl(t,e,i=t.length){let n=0;for(let o=0;o<i;)9==t.charCodeAt(o)?(n+=e-n%e,o++):(n++,o=it(t,o));return n}function nh(t,e,i,n){for(let n=0,o=0;;){if(o>=e)return n;if(n==t.length)break;o+=9==t.charCodeAt(n)?i-o%i:1,n=it(t,n)}return!0===n?-1:t.length}const nc="undefined"==typeof Symbol?"__Í¼":Symbol.for("Í¼"),nd="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),nu="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class nf{constructor(t,e){this.rules=[];let{finish:i}=e||{};function n(t){return/^@/.test(t)?[t]:t.split(/,\s*/)}for(let e in t)!function t(e,o,r,s){let a=[],l=/^@(\w+)\b/.exec(e[0]),h=l&&"keyframes"==l[1];if(l&&null==o)return r.push(e[0]+";");for(let i in o){let s=o[i];if(/&/.test(i))t(i.split(/,\s*/).map(t=>e.map(e=>t.replace(/&/,e))).reduce((t,e)=>t.concat(e)),s,r);else if(s&&"object"==typeof s){if(!l)throw RangeError("The value of a property ("+i+") should be a primitive value.");t(n(i),s,a,h)}else null!=s&&a.push(i.replace(/_.*/,"").replace(/[A-Z]/g,t=>"-"+t.toLowerCase())+": "+s+";")}(a.length||h)&&r.push((!i||l||s?e:e.map(i)).join(", ")+" {"+a.join(" ")+"}")}(n(e),t[e],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let t=nu[nc]||1;return nu[nc]=t+1,"Í¼"+t.toString(36)}static mount(t,e,i){let n=t[nd],o=i&&i.nonce;n?o&&n.setNonce(o):n=new ng(t,o),n.mount(Array.isArray(e)?e:[e],t)}}let np=new Map;class ng{constructor(t,e){let i=t.ownerDocument||t,n=i.defaultView;if(!t.head&&t.adoptedStyleSheets&&n.CSSStyleSheet){let e=np.get(i);if(e)return t[nd]=e;this.sheet=new n.CSSStyleSheet,np.set(i,this)}else this.styleTag=i.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);this.modules=[],t[nd]=this}mount(t,e){let i=this.sheet,n=0,o=0;for(let e=0;e<t.length;e++){let r=t[e],s=this.modules.indexOf(r);if(s<o&&s>-1&&(this.modules.splice(s,1),o--,s=-1),-1==s){if(this.modules.splice(o++,0,r),i)for(let t=0;t<r.rules.length;t++)i.insertRule(r.rules[t],n++)}else{for(;o<s;)n+=this.modules[o++].rules.length;n+=r.rules.length,o++}}if(i)0>e.adoptedStyleSheets.indexOf(this.sheet)&&(e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets]);else{let t="";for(let e=0;e<this.modules.length;e++)t+=this.modules[e].getRules()+"\n";this.styleTag.textContent=t;let i=e.head||e;this.styleTag.parentNode!=i&&i.insertBefore(this.styleTag,i.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}for(var nm={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},nv={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},ny="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),nb="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),nw=0;nw<10;nw++)nm[48+nw]=nm[96+nw]=String(nw);for(var nw=1;nw<=24;nw++)nm[nw+111]="F"+nw;for(var nw=65;nw<=90;nw++)nm[nw]=String.fromCharCode(nw+32),nv[nw]=String.fromCharCode(nw);for(var nx in nm)nv.hasOwnProperty(nx)||(nv[nx]=nm[nx]);function nk(t){return(11==t.nodeType?t.getSelection?t:t.ownerDocument:t).getSelection()}function nO(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function nS(t,e){if(!e.anchorNode)return!1;try{return nO(t,e.anchorNode)}catch(t){return!1}}function n_(t){return 3==t.nodeType?nR(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function nC(t,e,i,n){return!!i&&(nP(t,e,i,n,-1)||nP(t,e,i,n,1))}function nE(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function nM(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function nP(t,e,i,n,o){for(;;){if(t==i&&e==n)return!0;if(e==(o<0?0:nT(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=nE(t)+(o<0?0:1),t=i}else{if(1!=t.nodeType||1==(t=t.childNodes[e+(o<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=o<0?nT(t):0}}}function nT(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function nA(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function nD(t,e){let i=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||1>Math.abs(e.width-t.offsetWidth))&&(i=1),(n>.995&&n<1.005||!isFinite(n)||1>Math.abs(e.height-t.offsetHeight))&&(n=1),{scaleX:i,scaleY:n}}class nI{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?nT(e):0),i,Math.min(t.focusOffset,i?nT(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let nB=null;function nz(t){if(t.setActive)return t.setActive();if(nB)return t.focus(nB);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==nB?{get preventScroll(){return nB={preventScroll:!0},!0}}:void 0),!nB){nB=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],o=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=o&&(i.scrollLeft=o)}}}function nR(t,e,i=e){let o=n||(n=document.createRange());return o.setEnd(t,i),o.setStart(t,e),o}function nN(t,e,i,n){let o={key:e,code:e,keyCode:i,which:i,cancelable:!0};n&&({altKey:o.altKey,ctrlKey:o.ctrlKey,shiftKey:o.shiftKey,metaKey:o.metaKey}=n);let r=new KeyboardEvent("keydown",o);r.synthetic=!0,t.dispatchEvent(r);let s=new KeyboardEvent("keyup",o);return s.synthetic=!0,t.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function nL(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function nF(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function nj(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n>0)return{node:i,offset:n};if(1==i.nodeType&&n>0){if("false"==i.contentEditable)return null;n=nT(i=i.childNodes[n-1])}else{if(!i.parentNode||nM(i))return null;n=nE(i),i=i.parentNode}}}function nH(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n<i.nodeValue.length)return{node:i,offset:n};if(1==i.nodeType&&n<i.childNodes.length){if("false"==i.contentEditable)return null;i=i.childNodes[n],n=0}else{if(!i.parentNode||nM(i))return null;n=nE(i)+1,i=i.parentNode}}}class nW{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new nW(t.parentNode,nE(t),e)}static after(t,e){return new nW(t.parentNode,nE(t)+1,e)}}const nV=[];class nQ{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(2&this.flags){let i=this.dom,n=null,o;for(let r of this.children){if(7&r.flags){if(!r.dom&&(o=n?n.nextSibling:i.firstChild)){let t=nQ.get(o);(!t||!t.parent&&t.canReuseDOM(r))&&r.reuseDOM(o)}r.sync(t,e),r.flags&=-8}if(o=n?n.nextSibling:i.firstChild,e&&!e.written&&e.node==i&&o!=r.dom&&(e.written=!0),r.dom.parentNode==i)for(;o&&o!=r.dom;)o=n$(o);else i.insertBefore(r.dom,o);n=r.dom}for((o=n?n.nextSibling:i.firstChild)&&e&&e.node==i&&(e.written=!0);o;)o=n$(o)}else if(1&this.flags)for(let i of this.children)7&i.flags&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==nT(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!nQ.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,o=-1,r=-1,s=-1;for(let a=0,l=i,h=i;a<this.children.length;a++){let i=this.children[a],c=l+i.length;if(l<t&&c>e)return i.domBoundsAround(t,e,l);if(c>=t&&-1==n&&(n=a,o=l),l>e&&i.dom.parentNode==this.dom){r=a,s=h;break}h=c,l=c+i.breakAfter}return{from:o,to:s<0?i+this.length:s,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:r<this.children.length&&r>=0?this.children[r].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,7&this.flags&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=nV){this.markDirty();for(let n=t;n<e;n++){let t=this.children[n];t.parent==this&&0>i.indexOf(t)&&t.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new nq(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,o,r){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}function n$(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}nQ.prototype.breakAfter=0;class nq{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function nU(t,e,i,n,o,r,s,a,l){let{children:h}=t,c=h.length?h[e]:null,d=r.length?r[r.length-1]:null,u=d?d.breakAfter:s;if(!(e==n&&c&&!s&&!u&&r.length<2&&c.merge(i,o,r.length?d:null,0==i,a,l))){if(n<h.length){let t=h[n];t&&(o<t.length||t.breakAfter&&(null==d?void 0:d.breakAfter))?(e==n&&(t=t.split(o),o=0),!u&&d&&t.merge(0,o,d,!0,0,l)?r[r.length-1]=t:((o||t.children.length&&!t.children[0].length)&&t.merge(0,o,null,!1,0,l),r.push(t))):(null==t?void 0:t.breakAfter)&&(d?d.breakAfter=1:s=1),n++}for(c&&(c.breakAfter=s,i>0&&(!s&&r.length&&c.merge(i,c.length,r[0],!1,a,0)?c.breakAfter=r.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,a,0),e++));e<n&&r.length;)if(h[n-1].become(r[r.length-1]))n--,r.pop(),l=r.length?0:a;else if(h[e].become(r[0]))e++,r.shift(),a=r.length?0:l;else break;!r.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,a,l)&&e--,(e<n||r.length)&&t.replaceChildren(e,n,r)}}function nY(t,e,i,n,o,r){let s=t.childCursor(),{i:a,off:l}=s.findPos(i,1),{i:h,off:c}=s.findPos(e,-1),d=e-i;for(let t of n)d+=t.length;t.length+=d,nU(t,h,c,a,l,n,0,o,r)}let nG="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},nX="undefined"!=typeof document?document:{documentElement:{style:{}}};const nK=/Edge\/(\d+)/.exec(nG.userAgent),nZ=/MSIE \d/.test(nG.userAgent),nJ=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nG.userAgent),n0=!!(nZ||nJ||nK),n1=!n0&&/gecko\/(\d+)/i.test(nG.userAgent),n2=!n0&&/Chrome\/(\d+)/.exec(nG.userAgent),n5="webkitFontSmoothing"in nX.documentElement.style,n3=!n0&&/Apple Computer/.test(nG.vendor),n4=n3&&(/Mobile\/\w+/.test(nG.userAgent)||nG.maxTouchPoints>2);var n8={mac:n4||/Mac/.test(nG.platform),windows:/Win/.test(nG.platform),linux:/Linux|X11/.test(nG.platform),ie:n0,ie_version:nZ?nX.documentMode||6:nJ?+nJ[1]:nK?+nK[1]:0,gecko:n1,gecko_version:n1?+(/Firefox\/(\d+)/.exec(nG.userAgent)||[0,0])[1]:0,chrome:!!n2,chrome_version:n2?+n2[1]:0,ios:n4,android:/Android\b/.test(nG.userAgent),webkit:n5,safari:n3,webkit_version:n5?+(/\bAppleWebKit\/(\d+)/.exec(nG.userAgent)||[0,0])[1]:0,tabSize:null!=nX.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class n6 extends nQ{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return!(8&this.flags)&&(!i||i instanceof n6&&!(this.length-(e-t)+i.length>256)&&!(8&i.flags))&&(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new n6(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=8&this.flags,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new nW(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return function(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let o=e,r=e,s=0;0==e&&i<0||e==n&&i>=0?!(n8.chrome||n8.gecko)&&(e?(o--,s=1):r<n&&(r++,s=-1)):i<0?o--:r<n&&r++;let a=nR(t,o,r).getClientRects();if(!a.length)return null;let l=a[(s?s<0:i>=0)?0:a.length-1];return n8.safari&&!s&&0==l.width&&(l=Array.prototype.find.call(a,t=>t.width)||l),s?nA(l,s<0):l||null}(this.dom,t,e)}}class n9 extends nQ{constructor(t,e=[],i=0){for(let n of(super(),this.mark=t,this.children=e,this.length=i,e))n.setParent(this)}setAttrs(t){if(nL(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,o,r){return(!i||!!(i instanceof n9&&i.mark.eq(this.mark))&&(!t||!(o<=0))&&(!(e<this.length)||!(r<=0)))&&(nY(this,t,e,i?i.children.slice():[],o-1,r-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,o=0;for(let r of this.children){let s=i+r.length;s>t&&e.push(i<t?r.split(t-i):r),n<0&&i>=t&&(n=o),i=s,o++}let r=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new n9(this.mark,e,r)}domAtPos(t){return oe(this,t)}coordsAt(t,e){return oi(this,t,e)}}class n7 extends nQ{static create(t,e,i){return new n7(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=n7.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,o,r){return(!i||i instanceof n7&&!!this.widget.compare(i.widget)&&(!(t>0)||!(o<=0))&&(!(e<this.length)||!(r<=0)))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t instanceof n7&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return e1.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):e1.empty}domAtPos(t){return(this.length?0==t:this.side>0)?nW.before(this.dom):nW.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),o=null;if(!n.length)return null;let r=this.side?this.side<0:t>0;for(let e=r?n.length-1:0;o=n[e],t>0?0!=e:e!=n.length-1&&!(o.top<o.bottom);e+=r?-1:1);return nA(o,!r)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class ot extends nQ{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof ot&&t.side==this.side}split(){return new ot(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?nW.before(this.dom):nW.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return e1.empty}get isHidden(){return!0}}function oe(t,e){let i=t.dom,{children:n}=t,o=0;for(let t=0;o<n.length;o++){let r=n[o],s=t+r.length;if(!(s==t&&0>=r.getSide())){if(e>t&&e<s&&r.dom.parentNode==i)return r.domAtPos(e-t);if(e<=t)break;t=s}}for(let t=o;t>0;t--){let e=n[t-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let t=o;t<n.length;t++){let e=n[t];if(e.dom.parentNode==i)return e.domAtPos(0)}return new nW(i,0)}function oi(t,e,i){let n=null,o=-1,r=null,s=-1;!function t(e,a){for(let l=0,h=0;l<e.children.length&&h<=a;l++){let c=e.children[l],d=h+c.length;d>=a&&(c.children.length?t(c,a-h):(!r||r.isHidden&&i>0)&&(d>a||h==d&&c.getSide()>0)?(r=c,s=a-h):(h<a||h==d&&0>c.getSide()&&!c.isHidden)&&(n=c,o=a-h)),h=d}}(t,e);let a=(i<0?n:r)||n||r;return a?a.coordsAt(Math.max(0,a==n?o:s),i):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=n_(e);return i[i.length-1]||null}(t)}function on(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}n6.prototype.children=n7.prototype.children=ot.prototype.children=nV;const oo=Object.create(null);function or(t,e,i){if(t==e)return!0;t||(t=oo),e||(e=oo);let n=Object.keys(t),o=Object.keys(e);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=o.length-(i&&o.indexOf(i)>-1?1:0))return!1;for(let r of n)if(r!=i&&(-1==o.indexOf(r)||t[r]!==e[r]))return!1;return!0}function os(t,e,i){let n=!1;if(e)for(let o in e)i&&o in i||(n=!0,"style"==o?t.style.cssText="":t.removeAttribute(o));if(i)for(let o in i)e&&e[o]==i[o]||(n=!0,"style"==o?t.style.cssText=i[o]:t.setAttribute(o,i[o]));return n}class oa{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return -1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var ol=((l=ol||(ol={}))[l.Text=0]="Text",l[l.WidgetBefore=1]="WidgetBefore",l[l.WidgetAfter=2]="WidgetAfter",l[l.WidgetRange=3]="WidgetRange",l);class oh extends i2{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new oc(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new ou(t,e,e,i,t.widget||null,!1)}static replace(t){let e=!!t.block,i,n;if(t.isBlockGap)i=-5e8,n=4e8;else{let{start:o,end:r}=of(t,e);i=(o?e?-3e8:-1:5e8)-1,n=(r?e?2e8:1:-6e8)+1}return new ou(t,i,n,e,t.widget||null,!0)}static line(t){return new od(t)}static set(t,e=!1){return i8.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}oh.none=i8.empty;class oc extends oh{constructor(t){let{start:e,end:i}=of(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof oc&&this.tagName==t.tagName&&(this.class||(null===(e=this.attrs)||void 0===e?void 0:e.class))==(t.class||(null===(i=t.attrs)||void 0===i?void 0:i.class))&&or(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw RangeError("Mark decorations may not be empty");return super.range(t,e)}}oc.prototype.point=!1;class od extends oh{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof od&&this.spec.class==t.spec.class&&or(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}od.prototype.mapMode=is.TrackBefore,od.prototype.point=!0;class ou extends oh{constructor(t,e,i,n,o,r){super(e,i,o,t),this.block=n,this.isReplace=r,this.mapMode=n?e<=0?is.TrackBefore:is.TrackAfter:is.TrackDel}get type(){return this.startSide!=this.endSide?ol.WidgetRange:this.startSide<=0?ol.WidgetBefore:ol.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){var e,i;return t instanceof ou&&((e=this.widget)==(i=t.widget)||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function of(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function op(t,e,i,n=0){let o=i.length-1;o>=0&&i[o]+n>=t?i[o]=Math.max(i[o],e):i.push(t,e)}ou.prototype.point=!0;class og extends nQ{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,o,r){if(i){if(!(i instanceof og))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),nY(this,t,e,i?i.children.slice():[],o,r),!0}split(t){let e=new og;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){or(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){!function t(e,i,n){let o,{children:r}=e;n>0&&i instanceof n9&&r.length&&(o=r[r.length-1])instanceof n9&&o.mark.eq(i.mark)?t(o,i.children[0],n-1):(r.push(i),i.setParent(e)),e.length+=i.length}(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=on(e,this.attrs||{})),i&&(this.attrs=on({class:i},this.attrs||{}))}domAtPos(t){return oe(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?4&this.flags&&(nL(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(os(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&nQ.get(n)instanceof n9;)n=n.lastChild;if(!n||!this.length||"BR"!=n.nodeName&&(null===(i=nQ.get(n))||void 0===i?void 0:i.isEditable)==!1&&(!n8.ios||!this.children.some(t=>t instanceof n6))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t=0,e;for(let i of this.children){if(!(i instanceof n6)||/[^ -~]/.test(i.text))return null;let n=n_(i.dom);if(1!=n.length)return null;t+=n[0].width,e=n[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(t,e){let i=oi(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=i.bottom-i.top;if(2>Math.abs(e-t.lineHeight)&&t.textHeight<e){let n=(e-t.textHeight)/2;return{top:i.top+n,bottom:i.bottom-n,left:i.left,right:i.left}}}return i}become(t){return t instanceof og&&0==this.children.length&&0==t.children.length&&or(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let o=t.children[i],r=n+o.length;if(r>=e){if(o instanceof og)return o;if(r>e)break}n=r+o.breakAfter}return null}}class om extends nQ{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,o,r){return(!i||i instanceof om&&!!this.widget.compare(i.widget)&&(!(t>0)||!(o<=0))&&(!(e<this.length)||!(r<=0)))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return 0==t?nW.before(this.dom):nW.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new om(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return nV}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):e1.empty}domBoundsAround(){return null}become(t){return t instanceof om&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)||(this.widget instanceof ov?null:nA(this.dom.getBoundingClientRect(),this.length?0==t:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e!=i&&(t<0?e<0:i>0)}}class ov extends oa{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class oy{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof om&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new og),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(ob(new ot(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||t&&this.content.length&&this.content[this.content.length-1]instanceof om||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(ob(new n6(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,o,r){if(this.disallowBlockEffectsFor[r]&&i instanceof ou){if(i.block)throw RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw RangeError("Decorations that replace line breaks may not be specified via plugins")}let s=e-t;if(i instanceof ou){if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new om(i.widget||ow.block,s,i));else{let r=n7.create(i.widget||ow.inline,s,s?0:i.startSide),a=this.atCursorPos&&!r.isEditable&&o<=n.length&&(t<e||i.startSide>0),l=!r.isEditable&&(t<e||o>n.length||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||a||r.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),a&&(h.append(ob(new ot(1),n),o),o=n.length+Math.max(0,o-n.length)),h.append(ob(r,n),o),this.atCursorPos=l,this.pendingBuffer=l?t<e||o>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);s&&(this.textOff+s<=this.text.length?this.textOff+=s:(this.skip+=s-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=o)}static build(t,e,i,n,o){let r=new oy(t,e,i,o);return r.openEnd=i8.spans(n,e,i,r),r.openStart<0&&(r.openStart=r.openEnd),r.finish(r.openEnd),r}}function ob(t,e){for(let i of e)t=new n9(i,[t],t.length);return t}class ow extends oa{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}ow.inline=new ow("span"),ow.block=new ow("div");var ox=((h=ox||(ox={}))[h.LTR=0]="LTR",h[h.RTL=1]="RTL",h);const ok=ox.LTR,oO=ox.RTL;function oS(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const o_=oS("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),oC=oS("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),oE=Object.create(null),oM=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);oE[e]=i,oE[i]=-e}function oP(t){return t<=247?o_[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?oC[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const oT=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class oA{get dir(){return this.level%2?oO:ok}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let o=-1;for(let r=0;r<t.length;r++){let s=t[r];if(s.from<=e&&s.to>=e){if(s.level==i)return r;(o<0||(0!=n?n<0?s.from<e:s.to>e:t[o].level>s.level))&&(o=r)}}if(o<0)throw RangeError("Index out of range");return o}}const oD=[];function oI(t){return[new oA(0,t,0)]}let oB="";const oz=iw.define(),oR=iw.define(),oN=iw.define(),oL=iw.define(),oF=iw.define(),oj=iw.define(),oH=iw.define(),oW=iw.define(),oV=iw.define(),oQ=iw.define({combine:t=>t.some(t=>t)}),o$=iw.define({combine:t=>t.some(t=>t)}),oq=iw.define();class oU{constructor(t,e="nearest",i="nearest",n=5,o=5,r=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=o,this.isSnapshot=r}map(t){return t.empty?this:new oU(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new oU(iv.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const oY=iq.define({map:(t,e)=>t.map(e)}),oG=iq.define();function oX(t,e,i){let n=t.facet(oL);n.length?n[0](e):window.onerror?window.onerror(String(e),i,void 0,void 0,e):i?console.error(i+":",e):console.error(e)}const oK=iw.define({combine:t=>!t.length||t[0]});let oZ=0;const oJ=iw.define();class o0{constructor(t,e,i,n,o){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=o(this)}static define(t,e){let{eventHandlers:i,eventObservers:n,provide:o,decorations:r}=e||{};return new o0(oZ++,t,i,n,t=>{let e=[oJ.of(t)];return r&&e.push(o3.of(e=>{let i=e.plugin(t);return i?r(i):oh.none})),o&&e.push(o(t)),e})}static fromClass(t,e){return o0.define(e=>new t(e),e)}}class o1{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(oX(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){oX(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){oX(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const o2=iw.define(),o5=iw.define(),o3=iw.define(),o4=iw.define(),o8=iw.define(),o6=iw.define();function o9(t,e){let i=t.state.facet(o6);if(!i.length)return i;let n=i.map(e=>e instanceof Function?e(t):e),o=[];return i8.spans(n,e.from,e.to,{point(){},span(t,i,n,r){let s=t-e.from,a=i-e.from,l=o;for(let t=n.length-1;t>=0;t--,r--){let i=n[t].spec.bidiIsolate,o;if(null==i&&(i=function(t,e,i){for(let n=e;n<i;n++){let e=oP(t.charCodeAt(n));if(1==e)break;if(2==e||4==e)return oO}return ok}(e.text,s,a)),r>0&&l.length&&(o=l[l.length-1]).to==s&&o.direction==i)o.to=a,l=o.inner;else{let t={from:s,to:a,direction:i,inner:[]};l.push(t),l=t.inner}}}}),o}const o7=iw.define();function rt(t){let e=0,i=0,n=0,o=0;for(let r of t.state.facet(o7)){let s=r(t);s&&(null!=s.left&&(e=Math.max(e,s.left)),null!=s.right&&(i=Math.max(i,s.right)),null!=s.top&&(n=Math.max(n,s.top)),null!=s.bottom&&(o=Math.max(o,s.bottom)))}return{left:e,right:i,top:n,bottom:o}}const re=iw.define();class ri{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new ri(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,o=0,r=0,s=0;;n++){let a=n==t.length?null:t[n],l=r-s,h=a?a.fromB:1e9;for(;o<e.length&&e[o]<h;){let t=e[o],n=e[o+1],r=Math.max(s,t),a=Math.min(h,n);if(r<=a&&new ri(r+l,a+l,r,a).addToSet(i),n>h)break;o+=2}if(!a)return i;new ri(a.fromA,a.toA,a.fromB,a.toB).addToSet(i),r=a.toA,s=a.toB}}}class rn{constructor(t,e,i){for(let n of(this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=il.empty(this.startState.doc.length),i))this.changes=this.changes.compose(n.changes);let n=[];this.changes.iterChangedRanges((t,e,i,o)=>n.push(new ri(t,e,i,o))),this.changedRanges=n}static create(t,e,i){return new rn(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}}class ro extends nQ{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=oh.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new og],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ri(0,0,0,t.state.doc.length)],0,null)}update(t){var e,i,n,o,r,s;let a,l;let h=t.changedRanges;this.minWidth>0&&h.length&&(h.every(({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let c=-1;!(this.view.inputState.composing>=0)||this.view.observer.editContext||((null===(e=this.domChanged)||void 0===e?void 0:e.newSel)?c=this.domChanged.newSel.head:(i=t.changes,n=this.hasComposition,a=!1,n&&i.iterChangedRanges((t,e)=>{t<n.to&&e>n.from&&(a=!0)}),a||t.selectionSet||(c=t.state.selection.main.head)));let d=c>-1?function(t,e,i){let n=rr(t,i);if(!n)return null;let{node:o,from:r,to:s}=n,a=o.nodeValue;if(/[\n\r]/.test(a)||t.state.doc.sliceString(n.from,n.to)!=a)return null;let l=e.invertedDesc,h=new ri(l.mapPos(r),l.mapPos(s),r,s),c=[];for(let e=o.parentNode;;e=e.parentNode){let i=nQ.get(e);if(i instanceof n9)c.push({node:e,deco:i.mark});else{if(i instanceof og||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:h,text:o,marks:c,line:e};if(e==t.contentDOM)return null;c.push({node:e,deco:new oc({inclusive:!0,attributes:function(t){let e=Object.create(null);for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i];e[n.name]=n.value}return e}(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,t.changes,c):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:e,to:i}=this.hasComposition;h=new ri(e,i,t.changes.mapPos(e,-1),t.changes.mapPos(i,1)).addToSet(h.slice())}this.hasComposition=d?{from:d.range.fromB,to:d.range.toB}:null,(n8.ie||n8.chrome)&&!d&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let u=(o=this.decorations,r=this.updateDeco(),s=t.changes,l=new rs,i8.compare(o,r,s,l),l.changes);return h=ri.extendWithRanges(h,u),(!!(7&this.flags)||0!=h.length)&&(this.updateInner(h,t.startState.doc.length,d),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=n8.chrome||n8.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.flags&=-8,t&&(t.written||n.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(t=>t.flags&=-9);let o=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof om&&t.widget instanceof ov&&o.push(t.dom);n.updateGaps(o)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,o=this.childCursor(e);for(let t=n.length-1;;t--){let e=t>=0?n[t]:null;if(!e)break;let{fromA:r,toA:s,fromB:a,toB:l}=e,h,c,d,u;if(i&&i.range.fromB<l&&i.range.toB>a){let t=oy.build(this.view.state.doc,a,i.range.fromB,this.decorations,this.dynamicDecorationMap),e=oy.build(this.view.state.doc,i.range.toB,l,this.decorations,this.dynamicDecorationMap);c=t.breakAtStart,d=t.openStart,u=e.openEnd;let n=this.compositionView(i);e.breakAtStart?n.breakAfter=1:e.content.length&&n.merge(n.length,n.length,e.content[0],!1,e.openStart,0)&&(n.breakAfter=e.content[0].breakAfter,e.content.shift()),t.content.length&&n.merge(0,0,t.content[t.content.length-1],!0,0,t.openEnd)&&t.content.pop(),h=t.content.concat(n).concat(e.content)}else({content:h,breakAtStart:c,openStart:d,openEnd:u}=oy.build(this.view.state.doc,a,l,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=o.findPos(s,1),{i:g,off:m}=o.findPos(r,-1);nU(this,g,m,f,p,h,c,d,u)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){for(let e of(this.editContextFormatting=this.editContextFormatting.map(t.changes),t.transactions))for(let t of e.effects)t.is(oG)&&(this.editContextFormatting=t.value)}compositionView(t){let e=new n6(t.text.nodeValue);for(let{deco:i}of(e.flags|=8,t.marks))e=new n9(i,[e],e.length);let i=new og;return i.append(e,0),i}fixCompositionDOM(t){let e=(t,e)=>{e.flags|=8|(e.children.some(t=>7&t.flags)?1:0),this.markedForComposition.add(e);let i=nQ.get(t);i&&i!=e&&(i.dom=null),e.setDOM(t)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let o=t.marks.length-1;o>=-1;o--)i=n.childPos(i.off,1),n=n.children[i.i],e(o>=0?t.marks[o].node:t.text,n)}updateSelection(t=!1,e=!1){var i;(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,o=n==this.dom,r=!o&&!(this.view.state.facet(oK)||this.dom.tabIndex>-1)&&nS(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(o||e||r))return;let s=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),h=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(n8.gecko&&a.empty&&!this.hasComposition&&1==(i=l).node.nodeType&&i.node.firstChild&&(0==i.offset||"false"==i.node.childNodes[i.offset-1].contentEditable)&&(i.offset==i.node.childNodes.length||"false"==i.node.childNodes[i.offset].contentEditable)){let t=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(t,l.node.childNodes[l.offset]||null)),l=h=new nW(t,0),s=!0}let c=this.view.observer.selectionRange;!s&&c.focusNode&&(nC(l.node,l.offset,c.anchorNode,c.anchorOffset)&&nC(h.node,h.offset,c.focusNode,c.focusOffset)||this.suppressWidgetCursorChange(c,a))||(this.view.observer.ignore(()=>{n8.android&&n8.chrome&&this.dom.contains(c.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=nk(this.view.root);if(t){if(a.empty){if(n8.gecko){var e,i;let t=(e=l.node,i=l.offset,1!=e.nodeType?0:(i&&"false"==e.childNodes[i-1].contentEditable?1:0)|(i<e.childNodes.length&&"false"==e.childNodes[i].contentEditable?2:0));if(t&&3!=t){let e=(1==t?nj:nH)(l.node,l.offset);e&&(l=new nW(e.node,e.offset))}}t.collapse(l.node,l.offset),null!=a.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=a.bidiLevel)}else if(t.extend){t.collapse(l.node,l.offset);try{t.extend(h.node,h.offset)}catch(t){}}else{let e=document.createRange();a.anchor>a.head&&([l,h]=[h,l]),e.setEnd(h.node,h.offset),e.setStart(l.node,l.offset),t.removeAllRanges(),t.addRange(e)}}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(l,h)),this.impreciseAnchor=l.precise?null:new nW(c.anchorNode,c.anchorOffset),this.impreciseHead=h.precise?null:new nW(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&nC(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=nk(t.root),{anchorNode:n,anchorOffset:o}=t.observer.selectionRange;if(!i||!e.empty||!e.assoc||!i.modify)return;let r=og.find(this,e.head);if(!r)return;let s=r.posAtStart;if(e.head==s||e.head==s+r.length)return;let a=this.coordsAt(e.head,-1),l=this.coordsAt(e.head,1);if(!a||!l||a.bottom>l.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let c=t.observer.selectionRange;t.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=e.from&&i.collapse(n,o)}moveToLine(t){let e=this.dom,i;if(t.node!=e)return t;for(let n=t.offset;!i&&n<e.childNodes.length;n++){let t=nQ.get(e.childNodes[n]);t instanceof og&&(i=t.domAtPos(0))}for(let n=t.offset-1;!i&&n>=0;n--){let t=nQ.get(e.childNodes[n]);t instanceof og&&(i=t.domAtPos(t.length))}return i?new nW(i.node,i.offset,!0):t}nearest(t){for(let e=t;e;){let t=nQ.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof og)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let o=this.length,r=this.children.length-1;r>=0;r--){let s=this.children[r],a=o-s.breakAfter,l=a-s.length;if(a<t)break;if(l<=t&&(l<t||s.covers(-1))&&(a>t||s.covers(1))&&(!i||s instanceof og&&!(i instanceof og&&e>=0)))i=s,n=l;else if(i&&l==t&&a==t&&s instanceof om&&2>Math.abs(e)){if(s.deco.startSide<0)break;r&&(i=null)}o=l}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof og))return null;for(;n.children.length;){let{i:t,off:e}=n.childPos(i,1);for(;;t++){if(t==n.children.length)return null;if((n=n.children[t]).length)break}i=e}if(!(n instanceof n6))return null;let o=it(n.text,i);if(o==i)return null;let r=nR(n.dom,i,o).getClientRects();for(let t=0;t<r.length;t++){let e=r[t];if(t==r.length-1||e.top<e.bottom&&e.left<e.right)return e}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,o=this.view.contentDOM.clientWidth,r=o>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,s=-1,a=this.view.textDirection==ox.LTR;for(let t=0,l=0;l<this.children.length;l++){let h=this.children[l],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),r){let e=h.dom.lastChild,n=e?n_(e):[];if(n.length){let e=n[n.length-1],r=a?e.right-i.left:i.right-e.left;r>s&&(s=r,this.minWidth=o,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?ox.RTL:ox.LTR}measureTextSize(){for(let t of this.children)if(t instanceof og){let e=t.measureTextSize();if(e)return e}let t=document.createElement("div"),e,i,n;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let o=n_(t.firstChild)[0];e=t.getBoundingClientRect().height,i=o?o.width/27:7,n=o?o.height:e,t.remove()}),{lineHeight:e,charWidth:i,textHeight:n}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new nq(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let o=n==e.viewports.length?null:e.viewports[n],r=o?o.from-1:this.length;if(r>i){let n=(e.lineBlockAt(r).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(oh.replace({widget:new ov(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,r))}if(!o)break;i=o.to+1}return oh.set(t)}updateDeco(){let t=1,e=this.view.state.facet(o3).map(e=>(this.dynamicDecorationMap[t++]="function"==typeof e)?e(this.view):e),i=!1,n=this.view.state.facet(o4).map((t,e)=>{let n="function"==typeof t;return n&&(i=!0),n?t(this.view):t});for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(i8.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let e=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=e.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let e of this.view.state.facet(oq))try{if(e(this.view,t.range,t))return!0}catch(t){oX(this.view.state,t,"scroll handler")}let{range:e}=t,i=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),n;if(!i)return;!e.empty&&(n=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(i={left:Math.min(i.left,n.left),top:Math.min(i.top,n.top),right:Math.max(i.right,n.right),bottom:Math.max(i.bottom,n.bottom)});let o=rt(this.view),r={left:i.left-o.left,top:i.top-o.top,right:i.right+o.right,bottom:i.bottom+o.bottom},{offsetWidth:s,offsetHeight:a}=this.view.scrollDOM;!function(t,e,i,n,o,r,s,a){let l=t.ownerDocument,h=l.defaultView||window;for(let c=t,d=!1;c&&!d;)if(1==c.nodeType){let t,u=c==l.body,f=1,p=1;if(u)t=function(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let e=c.getBoundingClientRect();({scaleX:f,scaleY:p}=nD(c,e)),t={left:e.left,right:e.left+c.clientWidth*f,top:e.top,bottom:e.top+c.clientHeight*p}}let g=0,m=0;if("nearest"==o)e.top<t.top?(m=-(t.top-e.top+s),i>0&&e.bottom>t.bottom+m&&(m=e.bottom-t.bottom+m+s)):e.bottom>t.bottom&&(m=e.bottom-t.bottom+s,i<0&&e.top-m<t.top&&(m=-(t.top+m-e.top+s)));else{let n=e.bottom-e.top,r=t.bottom-t.top;m=("center"==o&&n<=r?e.top+n/2-r/2:"start"==o||"center"==o&&i<0?e.top-s:e.bottom-r+s)-t.top}if("nearest"==n?e.left<t.left?(g=-(t.left-e.left+r),i>0&&e.right>t.right+g&&(g=e.right-t.right+g+r)):e.right>t.right&&(g=e.right-t.right+r,i<0&&e.left<t.left+g&&(g=-(t.left+g-e.left+r))):g=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==a?e.left-r:e.right-(t.right-t.left)+r)-t.left,g||m){if(u)h.scrollBy(g,m);else{let t=0,i=0;if(m){let t=c.scrollTop;c.scrollTop+=m/p,i=(c.scrollTop-t)*p}if(g){let e=c.scrollLeft;c.scrollLeft+=g/f,t=(c.scrollLeft-e)*f}e={left:e.left-t,top:e.top-i,right:e.right-t,bottom:e.bottom-i},t&&1>Math.abs(t-g)&&(n="nearest"),i&&1>Math.abs(i-m)&&(o="nearest")}}if(u)break;c=c.assignedSlot||c.parentNode}else if(11==c.nodeType)c=c.host;else break}(this.view.scrollDOM,r,e.head<e.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,s),-s),Math.max(Math.min(t.yMargin,a),-a),this.view.textDirection==ox.LTR)}}function rr(t,e){let i=t.observer.selectionRange;if(!i.focusNode)return null;let n=nj(i.focusNode,i.focusOffset),o=nH(i.focusNode,i.focusOffset),r=n||o;if(o&&n&&o.node!=n.node){let e=nQ.get(o.node);if(!e||e instanceof n6&&e.text!=o.node.nodeValue)r=o;else if(t.docView.lastCompositionAfterCursor){let t=nQ.get(n.node);!t||t instanceof n6&&t.text!=n.node.nodeValue||(r=o)}}if(t.docView.lastCompositionAfterCursor=r!=n,!r)return null;let s=e-r.offset;return{from:s,to:s+r.node.nodeValue.length,node:r.node}}let rs=class{constructor(){this.changes=[]}compareRange(t,e){op(t,e,this.changes)}comparePoint(t,e){op(t,e,this.changes)}boundChange(t){op(t,t,this.changes)}};function ra(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function rl(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function rh(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function rc(t,e,i){let n=t.nodeValue.length,o=-1,r=1e9,s=0;for(let a=0;a<n;a++){let n=nR(t,a,a+1).getClientRects();for(let l=0;l<n.length;l++){let h=n[l];if(h.top==h.bottom)continue;s||(s=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<r){let i=e>=(h.left+h.right)/2,n=i;if((n8.chrome||n8.gecko)&&nR(t,a).getBoundingClientRect().left==h.right&&(n=!i),c<=0)return{node:t,offset:a+(n?1:0)};o=a+(n?1:0),r=c}}}return{node:t,offset:o>-1?o:s>0?t.nodeValue.length:0}}function rd(t,e,i,n=-1){var o,r;let s=t.contentDOM.getBoundingClientRect(),a=s.top+t.viewState.paddingTop,l,{docHeight:h}=t.viewState,{x:c,y:d}=e,u=d-a;if(u<0)return 0;if(u>h)return t.state.doc.length;for(let e=t.viewState.heightOracle.textHeight/2,o=!1;(l=t.elementAtHeight(u)).type!=ol.Text;)for(;!((u=n>0?l.bottom+e:l.top-e)>=0)||!(u<=h);){if(o)return i?null:0;o=!0,n=-n}d=a+u;let f=l.from;if(f<t.viewport.from)return 0==t.viewport.from?0:i?null:ru(t,s,l,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:ru(t,s,l,c,d);let p=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:p,m=g.elementFromPoint(c,d);m&&!t.contentDOM.contains(m)&&(m=null),!m&&(c=Math.max(s.left+1,Math.min(s.right-1,c)),(m=g.elementFromPoint(c,d))&&!t.contentDOM.contains(m)&&(m=null));let v,y=-1;if(m&&(null===(o=t.docView.nearest(m))||void 0===o?void 0:o.isEditable)!=!1){if(p.caretPositionFromPoint){let t=p.caretPositionFromPoint(c,d);t&&({offsetNode:v,offset:y}=t)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(c,d);e&&({startContainer:v,startOffset:y}=e,(!t.contentDOM.contains(v)||n8.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return nR(t,n-1,n).getBoundingClientRect().left>i}(v,y,c)||n8.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}return i-(1==t.nodeType?t.getBoundingClientRect():nR(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}(v,y,c))&&(v=void 0))}v&&(y=Math.min(nT(v),y))}if(!v||!t.docView.dom.contains(v)){let e=og.find(t.docView,f);if(!e)return u>l.top+l.height/2?l.to:l.from;({node:v,offset:y}=function t(e,i,n){let o,r,s,a,l,h,c,d,u=!1;for(let g=e.firstChild;g;g=g.nextSibling){let e=n_(g);for(let m=0;m<e.length;m++){var f,p;let v=e[m];h&&ra(h,v)&&(v=rl(rh(v,h.bottom),h.top));let y=(f=v).left>i?f.left-i:Math.max(0,i-f.right),b=(p=v).top>n?p.top-n:Math.max(0,n-p.bottom);if(0==y&&0==b)return 3==g.nodeType?rc(g,i,n):t(g,i,n);if(!l||d>b||d==b&&c>y){l=g,h=v,c=y,d=b;let t=b?n<v.top?-1:1:y?i<v.left?-1:1:0;u=!t||(t>0?m<e.length-1:m>0)}0==y?n>v.bottom&&(!s||s.bottom<v.bottom)?(o=g,s=v):n<v.top&&(!a||a.top>v.top)&&(r=g,a=v):s&&ra(s,v)?s=rh(s,v.bottom):a&&ra(a,v)&&(a=rl(a,v.top))}}if(s&&s.bottom>=n?(l=o,h=s):a&&a.top<=n&&(l=r,h=a),!l)return{node:e,offset:0};let g=Math.max(h.left,Math.min(h.right,i));if(3==l.nodeType)return rc(l,g,n);if(u&&"false"!=l.contentEditable)return t(l,g,n);let m=Array.prototype.indexOf.call(e.childNodes,l)+(i>=(h.left+h.right)/2?1:0);return{node:e,offset:m}}(e.dom,c,d))}let b=t.docView.nearest(v);if(!b)return null;if(!b.isWidget||(null===(r=b.dom)||void 0===r?void 0:r.nodeType)!=1)return b.localPosFromDOM(v,y)+b.posAtStart;{let t=b.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?b.posAtStart:b.posAtEnd}}function ru(t,e,i,n,o){let r=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){let e=t.viewState.heightOracle.textHeight;r+=Math.floor((o-i.top-(t.defaultLineHeight-e)*.5)/e)*t.viewState.heightOracle.lineLength}let s=t.state.sliceDoc(i.from,i.to);return i.from+nh(s,r,t.state.tabSize)}function rf(t,e){let i=t.lineBlockAt(e);if(Array.isArray(i.type)){for(let t of i.type)if(t.to>e||t.to==e&&(t.to==i.to||t.type==ol.Text))return t}return i}function rp(t,e,i,n){let o=t.state.doc.lineAt(e.head),r=t.bidiSpans(o),s=t.textDirectionAt(o.from);for(let a=e,l=null;;){let e=function(t,e,i,n,o){var r;let s=n.head-t.from,a=oA.find(e,s,null!==(r=n.bidiLevel)&&void 0!==r?r:-1,n.assoc),l=e[a],h=l.side(o,i);if(s==h){let t=a+=o?1:-1;if(t<0||t>=e.length)return null;s=(l=e[a=t]).side(!o,i),h=l.side(o,i)}let c=it(t.text,s,l.forward(o,i));(c<l.from||c>l.to)&&(c=h),oB=t.text.slice(Math.min(s,c),Math.max(s,c));let d=a==(o?e.length-1:0)?null:e[a+(o?1:-1)];return d&&c==h&&d.level+(o?0:1)<l.level?iv.cursor(d.side(!o,i)+t.from,d.forward(o,i)?1:-1,d.level):iv.cursor(c+t.from,l.forward(o,i)?-1:1,l.level)}(o,r,s,a,i),h=oB;if(!e){if(o.number==(i?t.state.doc.lines:1))return a;h="\n",o=t.state.doc.line(o.number+(i?1:-1)),r=t.bidiSpans(o),e=t.visualLineSide(o,!i)}if(l){if(!l(h))return a}else{if(!n)return e;l=n(h)}a=e}}function rg(t,e,i){for(;;){let n=0;for(let o of t)o.between(e-1,e+1,(t,o,r)=>{if(e>t&&e<o){let r=n||i||(e-t<o-e?-1:1);e=r<0?t:o,n=r}});if(!n)return e}}function rm(t,e,i){let n=rg(t.state.facet(o8).map(e=>e(t)),i.from,e.head>i.from?-1:1);return n==i.from?i:iv.cursor(n,n<i.from?1:-1)}class rv{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(i0.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+="ï¿¿"}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let t=this.text.length;this.readNode(n);let o=n.nextSibling;if(o==e)break;let r=nQ.get(n),s=nQ.get(o);(r&&s?r.breakAfter:(r?r.breakAfter:nM(n))||nM(o)&&("BR"!=n.nodeName||n.cmIgnore)&&this.text.length>t)&&this.lineBreak(),n=o}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let o=-1,r=1,s;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),r=this.lineSeparator.length):(s=n.exec(e))&&(o=s.index,r=s[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),r>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=r-1);i=o+r}}readNode(t){if(t.cmIgnore)return;let e=nQ.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(!function(t,e,i){for(;;){if(!e||i<nT(e))return!1;if(e==t)return!0;i=nE(e)+1,e=e.parentNode}}(t,i.node,i.offset)?0:e))}}class ry{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class rb{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:o,impreciseAnchor:r}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let e=o||r?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:o,focusOffset:r}=t.observer.selectionRange;return i&&(e.push(new ry(i,n)),(o!=i||r!=n)&&e.push(new ry(o,r))),e}(t),i=new rv(e,t.state);i.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=i.text,this.newSel=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?iv.single(i+e,n+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,i=o&&o.node==e.focusNode&&o.offset==e.focusOffset||!nO(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),n=r&&r.node==e.anchorNode&&r.offset==e.anchorOffset||!nO(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset),s=t.viewport;if((n8.ios||n8.chrome)&&t.state.selection.main.empty&&i!=n&&(s.from>0||s.to<t.state.doc.length)){let e=Math.min(i,n),o=Math.max(i,n),r=s.from-e,a=s.to-o;(0==r||1==r||0==e)&&(0==a||-1==a||o==t.state.doc.length)&&(i=0,n=t.state.doc.length)}this.newSel=iv.single(n,i)}}}function rw(t,e){let i;let{newSel:n}=e,o=t.state.selection.main,r=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:n,to:s}=e.bounds,a=o.from,l=null;(8===r||n8.android&&e.text.length<s-n)&&(a=o.to,l="end");let h=function(t,e,i,n){let o=Math.min(t.length,e.length),r=0;for(;r<o&&t.charCodeAt(r)==e.charCodeAt(r);)r++;if(r==o&&t.length==e.length)return null;let s=t.length,a=e.length;for(;s>0&&a>0&&t.charCodeAt(s-1)==e.charCodeAt(a-1);)s--,a--;if("end"==n){let t=Math.max(0,r-Math.min(s,a));i-=s+t-r}if(s<r&&t.length<e.length){let t=i<=r&&i>=s?r-i:0;r-=t,a=r+(a-s),s=r}else if(a<r){let t=i<=r&&i>=a?r-i:0;r-=t,s=r+(s-a),a=r}return{from:r,toA:s,toB:a}}(t.state.doc.sliceString(n,s,"ï¿¿"),e.text,a-n,l);h&&(n8.chrome&&13==r&&h.toB==h.from+2&&"ï¿¿ï¿¿"==e.text.slice(h.from,h.toB)&&h.toB--,i={from:n+h.from,to:n+h.toA,insert:e1.of(e.text.slice(h.from,h.toB).split("ï¿¿"))})}else n&&(!t.hasFocus&&t.state.facet(oK)||n.main.eq(o))&&(n=null);if(!i&&!n)return!1;if(!i&&e.typeOver&&!o.empty&&n&&n.main.empty?i={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,o.to)}:i&&i.from>=o.from&&i.to<=o.to&&(i.from!=o.from||i.to!=o.to)&&o.to-o.from-(i.to-i.from)<=4?i={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,i.from).append(i.insert).append(t.state.doc.slice(i.to,o.to))}:(n8.mac||n8.android)&&i&&i.from==i.to&&i.from==o.head-1&&/^\. ?$/.test(i.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(n&&2==i.insert.length&&(n=iv.single(n.main.anchor-1,n.main.head-1)),i={from:o.from,to:o.to,insert:e1.of([" "])}):n8.chrome&&i&&i.from==i.to&&i.from==o.head&&"\n "==i.insert.toString()&&t.lineWrapping&&(n&&(n=iv.single(n.main.anchor-1,n.main.head-1)),i={from:o.from,to:o.to,insert:e1.of([" "])}),i)return rx(t,i,n,r);if(!n||n.main.eq(o))return!1;{let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:e,userEvent:i}),!0}}function rx(t,e,i,n=-1){let o;if(n8.ios&&t.inputState.flushIOSKey(e))return!0;let r=t.state.selection.main;if(n8.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&" "==t.state.sliceDoc(e.from,r.from))&&1==e.insert.length&&2==e.insert.lines&&nN(t.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&0==e.insert.length||8==n&&e.insert.length<e.to-e.from&&e.to>r.head)&&nN(t.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&0==e.insert.length&&nN(t.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let a=()=>o||(o=function(t,e,i){let n,o=t.state,r=o.selection.main;if(e.from>=r.from&&e.to<=r.to&&e.to-e.from>=(r.to-r.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let i=r.from<e.from?o.sliceDoc(r.from,e.from):"",s=r.to>e.to?o.sliceDoc(e.to,r.to):"";n=o.replaceSelection(t.state.toText(i+e.insert.sliceString(0,void 0,t.state.lineBreak)+s))}else{let s=o.changes(e),a=i&&i.main.to<=s.newLength?i.main:void 0;if(o.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=r.to&&e.to>=r.to-10){let l=t.state.sliceDoc(e.from,e.to),h,c=i&&rr(t,i.main.head);if(c){let t=e.insert.length-(e.to-e.from);h={from:c.from,to:c.to-t}}else h=t.state.doc.lineAt(r.head);let d=r.to-e.to,u=r.to-r.from;n=o.changeByRange(i=>{if(i.from==r.from&&i.to==r.to)return{changes:s,range:a||i.map(s)};let n=i.to-d,c=n-l.length;if(i.to-i.from!=u||t.state.sliceDoc(c,n)!=l||i.to>=h.from&&i.from<=h.to)return{range:i};let f=o.changes({from:c,to:n,insert:e.insert}),p=i.to-r.to;return{changes:f,range:a?iv.range(Math.max(0,a.anchor+p),Math.max(0,a.head+p)):i.map(f)}})}else n={changes:s,selection:a&&o.selection.replaceRange(a)}}let s="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,s+=".compose",t.inputState.compositionFirstChange&&(s+=".start",t.inputState.compositionFirstChange=!1)),o.update(n,{userEvent:s,scrollIntoView:!0})}(t,e,i));return t.state.facet(oj).some(i=>i(t,e.from,e.to,s,a))||t.dispatch(a()),!0}class rk{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){var e;this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,n8.safari&&t.contentDOM.addEventListener("input",()=>null),n8.gecko&&(e=t.contentDOM.ownerDocument,rU.has(e)||(rU.add(e),e.addEventListener("copy",()=>{}),e.addEventListener("cut",()=>{})))}handleEvent(t){!(!function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i=e.target,n;i!=t.contentDOM;i=i.parentNode)if(!i||11==i.nodeType||(n=nQ.get(i))&&n.ignoreEvent(e))return!1;return!0}(this.view,t)||this.ignoreDuringComposition(t))&&("keydown"==t.type&&this.keydown(t)||this.runHandlers(t.type,t))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let t of i.observers)t(this.view,e);for(let t of i.handlers){if(e.defaultPrevented)break;if(t(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=function(t){let e=Object.create(null);function i(t){return e[t]||(e[t]={observers:[],handlers:[]})}for(let e of t){let t=e.spec;if(t&&t.domEventHandlers)for(let n in t.domEventHandlers){let o=t.domEventHandlers[n];o&&i(n).handlers.push(rO(e.value,o))}if(t&&t.domEventObservers)for(let n in t.domEventObservers){let o=t.domEventObservers[n];o&&i(n).observers.push(rO(e.value,o))}}for(let t in rP)i(t).handlers.push(rP[t]);for(let t in rT)i(t).observers.push(rT[t]);return e}(t),i=this.handlers,n=this.view.contentDOM;for(let t in e)if("scroll"!=t){let o=!e[t].handlers.length,r=i[t];r&&!r.handlers.length!=o&&(n.removeEventListener(t,this.handleEvent),r=null),r||n.addEventListener(t,this.handleEvent,{passive:o})}for(let t in i)"scroll"==t||e[t]||n.removeEventListener(t,this.handleEvent);this.handlers=e}keydown(t){let e;return this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),!!(9==t.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))||((this.tabFocusMode>0&&27!=t.keyCode&&0>rC.indexOf(t.keyCode)&&(this.tabFocusMode=-1),n8.android&&n8.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))?(this.view.observer.delayAndroidKey(t.key,t.keyCode),!0):n8.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((e=rS.find(e=>e.keyCode==t.keyCode))&&!t.ctrlKey||r_.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=e||t,setTimeout(()=>this.flushIOSKey(),250),!0):(229!=t.keyCode&&this.view.observer.forceFlush(),!1))}flushIOSKey(t){let e=this.pendingIOSKey;return!(!e||"Enter"==e.key&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString()))&&(this.pendingIOSKey=void 0,nN(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(n8.safari&&!n8.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function rO(t,e){return(i,n)=>{try{return e.call(t,n,i)}catch(t){oX(i.state,t)}}}const rS=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],r_="dthko",rC=[16,17,18,20,91,92,224,225];function rE(t){return .7*Math.max(0,t)+8}class rM{constructor(t,e,i,n){let o;this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=function(t){let e=t.ownerDocument,i,n;for(let o=t.parentNode;o&&o!=e.body&&(!i||!n);)if(1==o.nodeType)!n&&o.scrollHeight>o.clientHeight&&(n=o),!i&&o.scrollWidth>o.clientWidth&&(i=o),o=o.assignedSlot||o.parentNode;else if(11==o.nodeType)o=o.host;else break;return{x:i,y:n}}(t.contentDOM),this.atoms=t.state.facet(o8).map(e=>e(t));let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(i0.allowMultipleSelections)&&((o=t.state.facet(oz)).length?o[0](e):n8.mac?e.metaKey:e.ctrlKey),this.dragging=!!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=nk(t.root);if(!n||0==n.rangeCount)return!0;let o=n.getRangeAt(0).getClientRects();for(let t=0;t<o.length;t++){let i=o[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)&&1==rH(e)&&null}start(t){!1===this.dragging&&this.select(t)}move(t){var e;if(0==t.buttons)return this.destroy();if(this.dragging||null==this.dragging&&10>Math.max(Math.abs((e=this.startEvent).clientX-t.clientX),Math.abs(e.clientY-t.clientY)))return;this.select(this.lastEvent=t);let i=0,n=0,o=0,r=0,s=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:o,right:s}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=rt(this.view);t.clientX-l.left<=o+6?i=-rE(o-t.clientX):t.clientX+l.right>=s-6&&(i=rE(t.clientX-s)),t.clientY-l.top<=r+6?n=-rE(r-t.clientY):t.clientY+l.bottom>=a-6&&(n=rE(t.clientY-a)),this.setScrollSpeed(i,n)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],o=null;if(n.empty){let t=rg(this.atoms,n.from,0);t!=n.from&&(o=iv.cursor(t,-1))}else{let t=rg(this.atoms,n.from,-1),e=rg(this.atoms,n.to,1);(t!=n.from||e!=n.to)&&(o=iv.range(n.from==n.anchor?t:e,n.from==n.head?t:e))}o&&(e||(e=t.ranges.slice()),e[i]=o)}return e?iv.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!i.eq(e.state.selection,!1===this.dragging))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}const rP=Object.create(null),rT=Object.create(null),rA=n8.ie&&n8.ie_version<15||n8.ios&&n8.webkit_version<604;function rD(t,e,i){for(let n of t.facet(e))i=n(i,t);return i}function rI(t,e){e=rD(t.state,oW,e);let{state:i}=t,n,o=1,r=i.toText(e),s=r.lines==i.selection.ranges.length;if(null!=rV&&i.selection.ranges.every(t=>t.empty)&&rV==r.toString()){let t=-1;n=i.changeByRange(n=>{let a=i.doc.lineAt(n.from);if(a.from==t)return{range:n};t=a.from;let l=i.toText((s?r.line(o++).text:e)+i.lineBreak);return{changes:{from:a.from,insert:l},range:iv.cursor(n.from+l.length)}})}else n=s?i.changeByRange(t=>{let e=r.line(o++);return{changes:{from:t.from,to:t.to,insert:e.text},range:iv.cursor(t.from+e.length)}}):i.replaceSelection(r);t.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}function rB(t,e,i,n){if(1==n)return iv.cursor(e,i);{if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),o=t.doc.lineAt(e),r=e-o.from;if(0==o.length)return iv.cursor(e);0==r?i=1:r==o.length&&(i=-1);let s=r,a=r;i<0?s=it(o.text,r,!1):a=it(o.text,r);let l=n(o.text.slice(s,a));for(;s>0;){let t=it(o.text,s,!1);if(n(o.text.slice(t,s))!=l)break;s=t}for(;a<o.length;){let t=it(o.text,a);if(n(o.text.slice(a,t))!=l)break;a=t}return iv.range(s+o.from,a+o.from)}(t.state,e,i);let o=og.find(t.docView,e),r=t.state.doc.lineAt(o?o.posAtEnd:e),s=o?o.posAtStart:r.from,a=o?o.posAtEnd:r.to;return a<t.state.doc.length&&a==r.to&&a++,iv.range(s,a)}}rT.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft},rP.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),27==e.keyCode&&0!=t.inputState.tabFocusMode&&(t.inputState.tabFocusMode=Date.now()+2e3),!1),rT.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},rT.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},rP.mousedown=(t,e)=>{let i,n,o;if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let r=null;for(let i of t.state.facet(oN))if(r=i(t,e))break;if(r||0!=e.button||(i=rR(t,e),n=rH(e),o=t.state.selection,r={update(t){t.docChanged&&(i.pos=t.changes.mapPos(i.pos),o=o.map(t.changes))},get(e,r,s){let a=rR(t,e),l,h=rB(t,a.pos,a.bias,n);if(i.pos!=a.pos&&!r){let e=rB(t,i.pos,i.bias,n),o=Math.min(e.from,h.from),r=Math.max(e.to,h.to);h=o<h.from?iv.range(o,r):iv.range(r,o)}return r?o.replaceRange(o.main.extend(h.from,h.to)):s&&1==n&&o.ranges.length>1&&(l=function(t,e){for(let i=0;i<t.ranges.length;i++){let{from:n,to:o}=t.ranges[i];if(n<=e&&o>=e)return iv.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}(o,a.pos))?l:s?o.addRange(h):iv.create([h])}}),r){let i=!t.hasFocus;t.inputState.startMouseSelection(new rM(t,e,r,i)),i&&t.observer.ignore(()=>{nz(t.contentDOM);let e=t.root.activeElement;e&&!e.contains(t.contentDOM)&&e.blur()});let n=t.inputState.mouseSelection;if(n)return n.start(e),!1===n.dragging}return!1};let rz=(t,e,i)=>e>=i.top&&e<=i.bottom&&t>=i.left&&t<=i.right;function rR(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:function(t,e,i,n){let o=og.find(t.docView,e);if(!o)return 1;let r=e-o.posAtStart;if(0==r)return 1;if(r==o.length)return -1;let s=o.coordsAt(r,-1);if(s&&rz(i,n,s))return -1;let a=o.coordsAt(r,1);return a&&rz(i,n,a)?1:s&&s.bottom>=n?-1:1}(t,i,e.clientX,e.clientY)}}const rN=n8.ie&&n8.ie_version<=11;let rL=null,rF=0,rj=0;function rH(t){if(!rN)return t.detail;let e=rL,i=rj;return rL=t,rj=Date.now(),rF=!e||i>Date.now()-400&&2>Math.abs(e.clientX-t.clientX)&&2>Math.abs(e.clientY-t.clientY)?(rF+1)%3:1}function rW(t,e,i,n){let o;if(!(i=rD(t.state,oW,i)))return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=t.inputState,a=n&&s&&((o=t.state.facet(oR)).length?o[0](e):n8.mac?!e.altKey:!e.ctrlKey)?{from:s.from,to:s.to}:null,l={from:r,insert:i},h=t.state.changes(a?[a,l]:l);t.focus(),t.dispatch({changes:h,selection:{anchor:h.mapPos(r,-1),head:h.mapPos(r,1)},userEvent:a?"move.drop":"input.drop"}),t.inputState.draggedContent=null}rP.dragstart=(t,e)=>{let{selection:{main:i}}=t.state;if(e.target.draggable){let n=t.docView.nearest(e.target);if(n&&n.isWidget){let t=n.posAtStart,e=t+n.length;(t>=i.to||e<=i.from)&&(i=iv.range(t,e))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",rD(t.state,oV,t.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1},rP.dragend=t=>(t.inputState.draggedContent=null,!1),rP.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let n=Array(i.length),o=0,r=()=>{++o==i.length&&rW(t,e,n.filter(t=>null!=t).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=r,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),r()},e.readAsText(i[t])}return!0}{let i=e.dataTransfer.getData("Text");if(i)return rW(t,e,i,!0),!0}return!1},rP.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let i=rA?null:e.clipboardData;return i?(rI(t,i.getData("text/plain")||i.getData("text/uri-list")),!0):(function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(()=>{t.focus(),i.remove(),rI(t,i.value)},50)}(t),!1)};let rV=null;rP.copy=rP.cut=(t,e)=>{let{text:i,ranges:n,linewise:o}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let o=-1;for(let{from:n}of t.selection.ranges){let r=t.doc.lineAt(n);r.number>o&&(e.push(r.text),i.push({from:r.from,to:Math.min(t.doc.length,r.to+1)})),o=r.number}n=!0}return{text:rD(t,oV,e.join(t.lineBreak)),ranges:i,linewise:n}}(t.state);if(!i&&!o)return!1;rV=o?i:null,"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let r=rA?null:e.clipboardData;return r?(r.clearData(),r.setData("text/plain",i),!0):(!function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),t.focus()},50)}(t,i),!1)};const rQ=iV.define();function r$(t,e){let i=[];for(let n of t.facet(oH)){let o=n(t,e);o&&i.push(o)}return i?t.update({effects:i,annotations:rQ.of(!0)}):null}function rq(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=r$(t.state,e);i?t.dispatch(i):t.update([])}},10)}rT.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),rq(t)},rT.blur=t=>{t.observer.clearSelectionRange(),rq(t)},rT.compositionstart=rT.compositionupdate=t=>{!t.observer.editContext&&(null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))},rT.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,n8.chrome&&n8.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))},rT.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},rP.beforeinput=(t,e)=>{var i,n;let o;if("insertReplacementText"==e.inputType&&t.observer.editContext){let n=null===(i=e.dataTransfer)||void 0===i?void 0:i.getData("text/plain"),o=e.getTargetRanges();if(n&&o.length){let e=o[0],i=t.posAtDOM(e.startContainer,e.startOffset),r=t.posAtDOM(e.endContainer,e.endOffset);return rx(t,{from:i,to:r,insert:t.state.toText(n)},null),!0}}if(n8.chrome&&n8.android&&(o=rS.find(t=>t.inputType==e.inputType))&&(t.observer.delayAndroidKey(o.key,o.keyCode),"Backspace"==o.key||"Delete"==o.key)){let e=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout(()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return n8.ios&&"deleteContentForward"==e.inputType&&t.observer.flushSoon(),n8.safari&&"insertText"==e.inputType&&t.inputState.composing>=0&&setTimeout(()=>rT.compositionend(t,e),20),!1};const rU=new Set,rY=["pre-wrap","normal","pre-line","break-spaces"];let rG=!1;class rX{constructor(t){this.lineWrapping=t,this.doc=e1.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return rY.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,o,r){let s=rY.indexOf(t)>-1,a=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=o,a){this.heightSamples={};for(let t=0;t<r.length;t++){let e=r[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return a}}class rK{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class rZ{constructor(t,e,i,n,o){this.from=t,this.length=e,this.top=i,this.height=n,this._content=o}get type(){return"number"==typeof this._content?ol.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ou?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new rZ(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var rJ=((c=rJ||(rJ={}))[c.ByPos=0]="ByPos",c[c.ByHeight=1]="ByHeight",c[c.ByPosNoHeight=2]="ByPosNoHeight",c);class r0{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>.001&&(rG=!0),this.height=t)}replace(t,e,i){return r0.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let o=this,r=i.doc;for(let s=n.length-1;s>=0;s--){let{fromA:a,toA:l,fromB:h,toB:c}=n[s],d=o.lineAt(a,rJ.ByPosNoHeight,i.setDoc(e),0,0),u=d.to>=l?d:o.lineAt(l,rJ.ByPosNoHeight,i,0,0);for(c+=u.to-l,l=u.to;s>0&&d.from<=n[s-1].toA;)a=n[s-1].fromA,h=n[s-1].fromB,s--,a<d.from&&(d=o.lineAt(a,rJ.ByPosNoHeight,i,0,0));h+=d.from-a,a=d.from;let f=r6.build(i.setDoc(r),t,h,c);o=r1(o,o.replace(a,l,f))}return o.updateHeight(i,0)}static empty(){return new r5(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,o=0;for(;;)if(e==i){if(n>2*o){let o=t[e-1];o.break?t.splice(--e,1,o.left,null,o.right):t.splice(--e,1,o.left,o.right),i+=1+o.break,n-=o.size}else if(o>2*n){let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,o-=e.size}else break}else if(n<o){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(o+=e.size)}let r=0;return null==t[e-1]?(r=1,e--):null==t[e]&&(r=1,i++),new r4(r0.of(t.slice(0,e)),r,r0.of(t.slice(i)))}}function r1(t,e){return t==e?t:(t.constructor!=e.constructor&&(rG=!0),e)}r0.prototype.size=1;class r2 extends r0{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new rZ(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,o){return this.blockAt(0,i,n,o)}forEachLine(t,e,i,n,o,r){t<=o+this.length&&e>=o&&r(this.blockAt(0,i,n,o))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class r5 extends r2{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new rZ(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof r5||n instanceof r3&&4&n.flags)&&10>Math.abs(this.length-n.length)?(n instanceof r3?n=new r5(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):r0.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class r3 extends r0{constructor(t){super(t,0)}heightMetrics(t,e){let i=t.doc.lineAt(e).number,n=t.doc.lineAt(e+this.length).number,o=n-i+1,r,s=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*o);r=e/o,this.length>o+1&&(s=(this.height-e)/(this.length-o-1))}else r=this.height/o;return{firstLine:i,lastLine:n,perLine:r,perChar:s}}blockAt(t,e,i,n){let{firstLine:o,lastLine:r,perLine:s,perChar:a}=this.heightMetrics(e,n);if(e.lineWrapping){let o=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),r=e.doc.lineAt(o),l=s+r.length*a,h=Math.max(i,t-l/2);return new rZ(r.from,r.length,h,l,0)}{let n=Math.max(0,Math.min(r-o,Math.floor((t-i)/s))),{from:a,length:l}=e.doc.line(o+n);return new rZ(a,l,i+s*n,s,0)}}lineAt(t,e,i,n,o){if(e==rJ.ByHeight)return this.blockAt(t,i,n,o);if(e==rJ.ByPosNoHeight){let{from:e,to:n}=i.doc.lineAt(t);return new rZ(e,n-e,0,0,0)}let{firstLine:r,perLine:s,perChar:a}=this.heightMetrics(i,o),l=i.doc.lineAt(t),h=s+l.length*a,c=l.number-r,d=n+s*c+a*(l.from-o-c);return new rZ(l.from,l.length,Math.max(n,Math.min(d,n+this.height-h)),h,0)}forEachLine(t,e,i,n,o,r){t=Math.max(t,o),e=Math.min(e,o+this.length);let{firstLine:s,perLine:a,perChar:l}=this.heightMetrics(i,o);for(let h=t,c=n;h<=e;){let e=i.doc.lineAt(h);if(h==t){let i=e.number-s;c+=a*i+l*(t-o-i)}let n=a+l*e.length;r(new rZ(e.from,e.length,c,n,0)),c+=n,h=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof r3?i[i.length-1]=new r3(t.length+n):i.push(null,new r3(n-1))}if(t>0){let e=i[0];e instanceof r3?i[0]=new r3(t+e.length):i.unshift(new r3(t-1),null)}return r0.of(i)}decomposeLeft(t,e){e.push(new r3(t-1),null)}decomposeRight(t,e){e.push(null,new r3(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let o=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],r=Math.max(e,n.from),s=-1;for(n.from>e&&i.push(new r3(n.from-e-1).updateHeight(t,e));r<=o&&n.more;){let e=t.doc.lineAt(r).length;i.length&&i.push(null);let o=n.heights[n.index++];-1==s?s=o:Math.abs(o-s)>=.001&&(s=-2);let a=new r5(e,o);a.outdated=!1,i.push(a),r+=e+1}r<=o&&i.push(null,new r3(o-r).updateHeight(t,r));let a=r0.of(i);return(s<0||Math.abs(a.height-this.height)>=.001||Math.abs(s-this.heightMetrics(t,e).perLine)>=.001)&&(rG=!0),r1(this,a)}return(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class r4 extends r0{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let o=i+this.left.height;return t<o?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,o,n+this.left.length+this.break)}lineAt(t,e,i,n,o){let r=n+this.left.height,s=o+this.left.length+this.break,a=e==rJ.ByHeight?t<r:t<s,l=a?this.left.lineAt(t,e,i,n,o):this.right.lineAt(t,e,i,r,s);if(this.break||(a?l.to<s:l.from>s))return l;let h=e==rJ.ByPosNoHeight?rJ.ByPosNoHeight:rJ.ByPos;return a?l.join(this.right.lineAt(s,h,i,r,s)):this.left.lineAt(s,h,i,n,o).join(l)}forEachLine(t,e,i,n,o,r){let s=n+this.left.height,a=o+this.left.length+this.break;if(this.break)t<a&&this.left.forEachLine(t,e,i,n,o,r),e>=a&&this.right.forEachLine(t,e,i,s,a,r);else{let l=this.lineAt(a,rJ.ByPos,i,n,o);t<l.from&&this.left.forEachLine(t,l.from-1,i,n,o,r),l.to>=t&&l.from<=e&&r(l),e>l.to&&this.right.forEachLine(l.to+1,e,i,s,a,r)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let o=[];t>0&&this.decomposeLeft(t,o);let r=o.length;for(let t of i)o.push(t);if(t>0&&r8(o,r-1),e<this.length){let t=o.length;this.decomposeRight(e,o),r8(o,t)}return r0.of(o)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&t>=++i&&e.push(null),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?r0.of(this.break?[t,null,e]:[t,e]):(this.left=r1(this.left,t),this.right=r1(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:o,right:r}=this,s=e+o.length+this.break,a=null;return(n&&n.from<=e+o.length&&n.more?a=o=o.updateHeight(t,e,i,n):o.updateHeight(t,e,i),n&&n.from<=s+r.length&&n.more?a=r=r.updateHeight(t,s,i,n):r.updateHeight(t,s,i),a)?this.balanced(o,r):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function r8(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof r3&&(n=t[e+1])instanceof r3&&t.splice(e-1,3,new r3(i.length+1+n.length))}class r6{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof r5?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new r5(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,o=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let r=e-t;i.block?this.addBlock(new r2(r,n,i)):(r||o||n>=5)&&this.addLineDeco(n,o,r)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new r5(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new r3(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof r5)return t;let e=new r5(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof r5||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new r5(0,-1));let i=t;for(let t of this.nodes)t instanceof r5&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let o=new r6(i,t);return i8.spans(e,i,n,o,0),o.finish(i)}}class r9{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&op(t,e,this.changes,5)}}class r7{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],o=e[i];if(n.from!=o.from||n.to!=o.to||n.size!=o.size)return!1}return!0}draw(t,e){return oh.replace({widget:new st(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class st extends oa{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class se{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=sr,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ox.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(o5).some(t=>"function"!=typeof t&&"cm-lineWrapping"==t.class);this.heightOracle=new rX(e),this.stateDeco=t.facet(o3).filter(t=>"function"!=typeof t),this.heightMap=r0.empty().applyChanges(this.stateDeco,e1.empty,this.heightOracle.setDoc(t.doc),[new ri(0,0,0,t.doc.length)]);for(let t=0;t<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());t++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=oh.set(this.lineGaps.map(t=>t.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some(({from:t,to:e})=>n>=t&&n<=e)){let{from:e,to:i}=this.lineBlockAt(n);t.push(new si(e,i))}}return this.viewports=t.sort((t,e)=>t.from-e.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?sr:new ss(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(sa(t,this.scaler))})}update(t,e=null){var i,n;let o;this.state=t.state;let r=this.stateDeco;this.stateDeco=this.state.facet(o3).filter(t=>"function"!=typeof t);let s=t.changedRanges,a=ri.extendWithRanges(s,(i=this.stateDeco,n=t?t.changes:il.empty(this.state.doc.length),o=new r9,i8.compare(r,i,n,o,0),o.changes)),l=this.heightMap.height,h=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);rG=!1,this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),a),(this.heightMap.height!=l||rG)&&(t.flags|=2),h?(this.scrollAnchorPos=t.changes.mapPos(h.from,-1),this.scrollAnchorHeight=h.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let c=a.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<c.from||e.range.head>c.to)||!this.viewportIsAppropriate(c))&&(c=this.getViewport(0,e));let d=c.from!=this.viewport.from||c.to!=this.viewport.to;this.viewport=c,t.flags|=this.updateForViewport(),(d||!t.changes.empty||2&t.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(o$)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,o=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?ox.RTL:ox.LTR;let r=this.heightOracle.mustRefreshForWrapping(o),s=e.getBoundingClientRect(),a=r||this.mustMeasureContent||this.contentDOMHeight!=s.height;this.contentDOMHeight=s.height,this.mustMeasureContent=!1;let l=0,h=0;if(s.width&&s.height){let{scaleX:t,scaleY:i}=nD(e,s);(t>.005&&Math.abs(this.scaleX-t)>.005||i>.005&&Math.abs(this.scaleY-i)>.005)&&(this.scaleX=t,this.scaleY=i,l|=16,r=a=!0)}let c=(parseInt(i.paddingTop)||0)*this.scaleY,d=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=c||this.paddingBottom!=d)&&(this.paddingTop=c,this.paddingBottom=d,l|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(a=!0),this.editorWidth=t.scrollDOM.clientWidth,l|=16);let u=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=u&&(this.scrollAnchorHeight=-1,this.scrollTop=u),this.scrolledToBottom=nF(t.scrollDOM);let f=(this.printing?function(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}:function(t,e){let i=t.getBoundingClientRect(),n=t.ownerDocument,o=n.defaultView||window,r=Math.max(0,i.left),s=Math.min(o.innerWidth,i.right),a=Math.max(0,i.top),l=Math.min(o.innerHeight,i.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){let i=e,n=window.getComputedStyle(i);if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&"visible"!=n.overflow){let n=i.getBoundingClientRect();r=Math.max(r,n.left),s=Math.min(s,n.right),a=Math.max(a,n.top),l=Math.min(e==t.parentNode?o.innerHeight:l,n.bottom)}e="absolute"==n.position||"fixed"==n.position?i.offsetParent:i.parentNode}else if(11==e.nodeType)e=e.host;else break;return{left:r-i.left,right:Math.max(r,s)-i.left,top:a-(i.top+e),bottom:Math.max(a,l)-(i.top+e)}})(e,this.paddingTop),p=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(a=!0)),!this.inView&&!this.scrollTarget)return 0;let v=s.width;if((this.contentDOMWidth!=v||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=s.width,this.editorHeight=t.scrollDOM.clientHeight,l|=16),a){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(r=!0),r||n.lineWrapping&&Math.abs(v-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:s,textHeight:a}=t.docView.measureTextSize();(r=i>0&&n.refresh(o,i,s,a,v/s,e))&&(t.docView.minWidth=0,l|=16)}for(let i of(p>0&&g>0?h=Math.max(p,g):p<0&&g<0&&(h=Math.min(p,g)),rG=!1,this.viewports)){let o=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=(r?r0.empty().applyChanges(this.stateDeco,e1.empty,this.heightOracle,[new ri(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,r,new rK(i.from,o))}rG&&(l|=2)}let y=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return y&&(2&l&&(l|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),l|=this.updateForViewport()),(2&l||y)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(r?[]:this.lineGaps,t)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,o=this.heightOracle,{visibleTop:r,visibleBottom:s}=this,a=new si(n.lineAt(r-1e3*i,rJ.ByHeight,o,0,0).from,n.lineAt(s+(1-i)*1e3,rJ.ByHeight,o,0,0).to);if(e){let{head:t}=e.range;if(t<a.from||t>a.to){let i=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),r=n.lineAt(t,rJ.ByPos,o,0,0),s;s="center"==e.y?(r.top+r.bottom)/2-i/2:"start"==e.y||"nearest"==e.y&&t<a.from?r.top:r.bottom-i,a=new si(n.lineAt(s-500,rJ.ByHeight,o,0,0).from,n.lineAt(s+i+500,rJ.ByHeight,o,0,0).to)}}return a}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new si(this.heightMap.lineAt(i,rJ.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,rJ.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,rJ.ByPos,this.heightOracle,0,0),{bottom:o}=this.heightMap.lineAt(e,rJ.ByPos,this.heightOracle,0,0),{visibleTop:r,visibleBottom:s}=this;return(0==t||n<=r-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||o>=s+Math.max(10,Math.min(i,250)))&&n>r-2e3&&o<s+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new r7(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,o=n>>1,r=n<<1;if(this.defaultTextDirection!=ox.LTR&&!i)return[];let s=[],a=(n,r,l,h)=>{if(r-n<o)return;let c=this.state.selection.main,d=[c.from];for(let t of(c.empty||d.push(c.to),d))if(t>n&&t<r){a(n,t-10,l,h),a(t+10,r,l,h);return}let u=function(t,e){for(let i of t)if(e(i))return i}(t,t=>t.from>=l.from&&t.to<=l.to&&Math.abs(t.from-n)<o&&Math.abs(t.to-r)<o&&!d.some(e=>t.from<e&&t.to>e));if(!u){if(r<l.to&&e&&i&&e.visibleRanges.some(t=>t.from<=r&&t.to>=r)){let t=e.moveToLineBoundary(iv.cursor(r),!1,!0).head;t>n&&(r=t)}let t=this.gapSize(l,n,r,h),o=i||t<2e6?t:2e6;u=new r7(n,r,t,o)}s.push(u)},l=e=>{var o,s,l;let h,c,d,u,f;if(e.length<r||e.type!=ol.Text)return;let p=(o=e.from,s=e.to,l=this.stateDeco,d=[],u=o,f=0,i8.spans(l,o,s,{span(){},point(t,e){t>u&&(d.push({from:u,to:t}),f+=t-u),u=e}},20),u<s&&(d.push({from:u,to:s}),f+=s-u),{total:f,ranges:d});if(p.total<r)return;let g=this.scrollTarget?this.scrollTarget.range.head:null;if(i){let t,i,o=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=g){let n=so(p,g),r=((this.visibleBottom-this.visibleTop)/2+o)/e.height;t=n-r,i=n+r}else t=(this.visibleTop-e.top-o)/e.height,i=(this.visibleBottom-e.top+o)/e.height;h=sn(p,t),c=sn(p,i)}else{let i,o,r=p.total*this.heightOracle.charWidth,s=n*this.heightOracle.charWidth,a=0;if(r>2e6)for(let i of t)i.from>=e.from&&i.from<e.to&&i.size!=i.displaySize&&i.from*this.heightOracle.charWidth+a<this.pixelViewport.left&&(a=i.size-i.displaySize);let l=this.pixelViewport.left+a,d=this.pixelViewport.right+a;if(null!=g){let t=so(p,g),e=((d-l)/2+s)/r;i=t-e,o=t+e}else i=(l-s)/r,o=(d+s)/r;h=sn(p,i),c=sn(p,o)}h>e.from&&a(e.from,h,e,p),c<e.to&&a(c,e.to,e,p)};for(let t of this.viewportLines)Array.isArray(t.type)?t.type.forEach(l):l(t);return s}gapSize(t,e,i,n){let o=so(n,i)-so(n,e);return this.heightOracle.lineWrapping?t.height*o:n.total*this.heightOracle.charWidth*o}updateLineGaps(t){r7.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=oh.set(t.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];i8.spans(e,this.viewport.from,this.viewport.to,{span(t,e){i.push({from:t,to:e})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let e=0;e<i.length&&!(8&n);e++){let o=this.visibleRanges[e],r=i[e];o.from==r.from&&o.to==r.to||(n|=4,t&&t.mapPos(o.from,-1)==r.from&&t.mapPos(o.to,1)==r.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||sa(this.heightMap.lineAt(t,rJ.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(e=>e.top<=t&&e.bottom>=t)||sa(this.heightMap.lineAt(this.scaler.fromDOM(t),rJ.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return sa(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class si{constructor(t,e){this.from=t,this.to=e}}function sn({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:o}=e[t],r=o-i;if(n<=r)return i+n;n-=r}}function so(t,e){let i=0;for(let{from:n,to:o}of t.ranges){if(e<=o){i+=e-n;break}i+=o-n}return i/t.total}const sr={toDOM:t=>t,fromDOM:t=>t,scale:1,eq(t){return t==this}};class ss{constructor(t,e,i){let n=0,o=0,r=0;for(let s of(this.viewports=i.map(({from:i,to:o})=>{let r=e.lineAt(i,rJ.ByPos,t,0,0).top,s=e.lineAt(o,rJ.ByPos,t,0,0).bottom;return n+=s-r,{from:i,to:o,top:r,bottom:s,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(e.height-n),this.viewports))s.domTop=r+(s.top-o)*this.scale,r=s.domBottom=s.domTop+(s.bottom-s.top),o=s.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let o=e<this.viewports.length?this.viewports[e]:null;if(!o||t<o.top)return n+(t-i)*this.scale;if(t<=o.bottom)return o.domTop+(t-o.top);i=o.bottom,n=o.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let o=e<this.viewports.length?this.viewports[e]:null;if(!o||t<o.domTop)return i+(t-n)/this.scale;if(t<=o.domBottom)return o.top+(t-o.domTop);i=o.bottom,n=o.domBottom}}eq(t){return t instanceof ss&&this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to)}}function sa(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new rZ(t.from,t.length,i,n-i,Array.isArray(t._content)?t._content.map(t=>sa(t,e)):t._content)}const sl=iw.define({combine:t=>t.join(" ")}),sh=iw.define({combine:t=>t.indexOf(!0)>-1}),sc=nf.newName(),sd=nf.newName(),su=nf.newName(),sf={"&light":"."+sd,"&dark":"."+su};function sp(t,e,i){return new nf(e,{finish:e=>/&/.test(e)?e.replace(/&\w*/,e=>{if("&"==e)return t;if(!i||!i[e])throw RangeError(`Unsupported selector: ${e}`);return i[e]}):t+" "+e})}const sg=sp("."+sc,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},sf),sm={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},sv=n8.ie&&n8.ie_version<=11;class sy{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new nI,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let t of e)this.queue.push(t);(n8.ie&&n8.ie_version<=11||n8.ios&&t.composing)&&e.some(t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&!1!==t.constructor.EDIT_CONTEXT&&!(n8.chrome&&n8.chrome_version<126)&&(this.editContext=new sx(t),t.state.facet(oK)&&(t.contentDOM.editContext=this.editContext.editContext)),sv&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver(()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){("change"!=t.type&&t.type||t.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,i)=>e!=t[i]))){for(let e of(this.gapIntersection.disconnect(),t))this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(oK)?i.root.activeElement!=this.dom:!nS(this.dom,n))return;let o=n.anchorNode&&i.docView.nearest(n.anchorNode);if(o&&o.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(n8.ie&&n8.ie_version<=11||n8.android&&n8.chrome)&&!i.state.selection.main.empty&&n.focusNode&&nC(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=nk(t.root);if(!e)return!1;let i=n8.safari&&11==t.root.nodeType&&t.root.activeElement==this.dom&&function(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return sw(t,i)}let i=null;function n(t){t.preventDefault(),t.stopImmediatePropagation(),i=t.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),i?sw(t,i):null}(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=nS(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(n=Math.min(n,nT(i));;)if(n){if(1!=i.nodeType)return!1;let t=i.childNodes[n-1];"false"==t.contentEditable?n--:n=nT(i=t)}else{if(i==t)return!0;n=nE(i),i=i.parentNode}}(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else if(11==i.nodeType)i=i.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,sm),sv&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),sv&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;this.delayedAndroidKey||(this.flushingAndroidKey=this.view.win.requestAnimationFrame(()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=t.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&t.force&&nN(this.dom,t.key,t.keyCode))})),this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(i=this.delayedAndroidKey)||void 0===i?void 0:i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let o of t){let t=this.readMutation(o);t&&(t.typeOver&&(n=!0),-1==e?{from:e,to:i}=t:(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&nS(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let o=new rb(this.view,t,e,i);return this.view.docView.domChanged={newSel:o.newSel?o.newSel.main:null},o}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=rw(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.flags|=4),"childList"==t.type){let i=sb(e,t.previousSibling||t.target.previousSibling,-1),n=sb(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(oK)!=t.state.facet(oK)&&(t.view.contentDOM.editContext=t.state.facet(oK)?this.editContext.editContext:null))}destroy(){var t,e,i;for(let n of(this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resizeScroll)||void 0===i||i.disconnect(),this.scrollTargets))n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function sb(t,e,i){for(;e;){let n=nQ.get(e);if(n&&n.parent==t)return n;let o=e.parentNode;e=o!=t.dom?o:i>0?e.nextSibling:e.previousSibling}return null}function sw(t,e){let i=e.startContainer,n=e.startOffset,o=e.endContainer,r=e.endOffset,s=t.docView.domAtPos(t.state.selection.main.anchor);return nC(s.node,s.offset,o,r)&&([i,n,o,r]=[o,r,i,n]),{anchorNode:i,anchorOffset:n,focusNode:o,focusOffset:r}}class sx{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});for(let i in this.handlers.textupdate=e=>{let{anchor:i}=t.state.selection.main,n=this.toEditorPos(e.updateRangeStart),o=this.toEditorPos(e.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:e.updateRangeStart,editorBase:n,drifted:!1});let r={from:n,to:o,insert:e1.of(e.text.split("\n"))};if(r.from==this.from&&i<this.from?r.from=i:r.to==this.to&&i>this.to&&(r.to=i),r.from!=r.to||r.insert.length){if(this.pendingContextChange=r,!t.state.readOnly){let i=this.to-this.from+(r.to-r.from+r.insert.length);rx(t,r,iv.single(this.toEditorPos(e.selectionStart,i),this.toEditorPos(e.selectionEnd,i)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))}},this.handlers.characterboundsupdate=i=>{let n=[],o=null;for(let e=this.toEditorPos(i.rangeStart),r=this.toEditorPos(i.rangeEnd);e<r;e++){let i=t.coordsForChar(e);o=i&&new DOMRect(i.left,i.top,i.right-i.left,i.bottom-i.top)||o||new DOMRect,n.push(o)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=e=>{let i=[];for(let t of e.getTextFormats()){let e=t.underlineStyle,n=t.underlineThickness;if("None"!=e&&"None"!=n){let o=this.toEditorPos(t.rangeStart),r=this.toEditorPos(t.rangeEnd);if(o<r){let t=`text-decoration: underline ${"Dashed"==e?"dashed ":"Squiggle"==e?"wavy ":""}${"Thin"==n?1:2}px`;i.push(oh.mark({attributes:{style:t}}).range(o,r))}}}t.dispatch({effects:oG.of(oh.set(i))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:e}=this.composing;this.composing=null,e&&this.reset(t.state)}},this.handlers)e.addEventListener(i,this.handlers[i]);this.measureReq={read:t=>{this.editContext.updateControlBounds(t.contentDOM.getBoundingClientRect());let e=nk(t.root);e&&e.rangeCount&&this.editContext.updateSelectionBounds(e.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges((o,r,s,a,l)=>{if(i)return;let h=l.length-(r-o);if(n&&r>=n.to){if(n.from==o&&n.to==r&&n.insert.eq(l)){n=this.pendingContextChange=null,e+=h,this.to+=h;return}n=null,this.revertPending(t.state)}if(o+=e,(r+=e)<=this.from)this.from+=h,this.to+=h;else if(o<this.to){if(o<this.from||r>this.to||this.to-this.from+l.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(o),this.toContextPos(r),l.toString()),this.to+=h}e+=h}),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange;this.composing&&(this.composing.drifted||t.transactions.some(t=>!t.isUserEvent("input.type")&&t.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):this.applyEdits(t)&&this.rangeIsValid(t.state)?(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state):(this.pendingContextChange=null,this.reset(t.state)),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=n)&&this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>3e4)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class sk{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;for(let e of(this.dispatchTransactions=t.dispatchTransactions||i&&(t=>t.forEach(t=>i(t,this)))||(t=>this.update(t)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new se(t.state||i0.create(t)),t.scrollTo&&t.scrollTo.is(oY)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(oJ).map(t=>new o1(t)),this.plugins))e.update(this);this.observer=new sy(this),this.inputState=new rk(this),this.inputState.ensureHandlers(this.plugins),this.docView=new ro(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null===(e=document.fonts)||void 0===e?void 0:e.ready)&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let e=1==t.length&&t[0]instanceof iU?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(0!=this.updateState)throw Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,i=!1,n,o=this.state;for(let e of t){if(e.startState!=o)throw RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=e.state}if(this.destroyed){this.viewState.state=o;return}let r=this.hasFocus,s=0,a=null;t.some(t=>t.annotation(rQ))?(this.inputState.notifiedFocused=r,s=1):r==this.inputState.notifiedFocused||(this.inputState.notifiedFocused=r,(a=r$(o,r))||(s=1));let l=this.observer.delayedAndroidKey,h=null;if(l?(this.observer.clearDelayedAndroidKey(),((h=this.observer.readChange())&&!this.state.doc.eq(o.doc)||!this.state.selection.eq(o.selection))&&(h=null)):this.observer.clear(),o.facet(i0.phrases)!=this.state.facet(i0.phrases))return this.setState(o);n=rn.create(this,o,t),n.flags|=s;let c=this.viewState.scrollTarget;try{for(let e of(this.updateState=2,t)){if(c&&(c=c.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;c=new oU(t.empty?t:iv.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(oY)&&(c=t.value.clip(this.state))}this.viewState.update(n,c),this.bidiCache=s_.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),e=this.docView.update(n),this.state.facet(re)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(t=>t.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(sl)!=n.state.facet(sl)&&(this.viewState.mustMeasureContent=!0),(e||i||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),e&&this.docViewUpdate(),!n.empty)for(let t of this.state.facet(oF))try{t(n)}catch(t){oX(this.state,t,"update listener")}(a||h)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),h&&!rw(this,h)&&l.force&&nN(this.contentDOM,l.key,l.keyCode)})}setState(t){if(0!=this.updateState)throw Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);for(let e of(this.viewState=new se(t),this.plugins=t.facet(oJ).map(t=>new o1(t)),this.pluginMap.clear(),this.plugins))e.update(this);this.docView.destroy(),this.docView=new ro(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(oJ),i=t.state.facet(oJ);if(e!=i){let n=[];for(let o of i){let i=e.indexOf(o);if(i<0)n.push(new o1(o));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(t){oX(this.state,t,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:o,scrollAnchorHeight:r}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(r=-1),this.viewState.scrollAnchorHeight=-1;try{for(let t=0;;t++){if(r<0){if(nF(i))o=-1,r=this.viewState.heightMap.height;else{let t=this.viewState.scrollAnchorAt(n);o=t.from,r=t.top}}this.updateState=1;let s=this.viewState.measure(this);if(!s&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let a=[];4&s||([this.measureRequests,a]=[a,this.measureRequests]);let l=a.map(t=>{try{return t.read(this)}catch(t){return oX(this.state,t),sS}}),h=rn.create(this,this.state,[]),c=!1;h.flags|=s,e?e.flags|=s:e=h,this.updateState=2,!h.empty&&(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),(c=this.docView.update(h))&&this.docViewUpdate());for(let t=0;t<a.length;t++)if(l[t]!=sS)try{let e=a[t];e.write&&e.write(l[t],this)}catch(t){oX(this.state,t)}if(c&&this.docView.updateSelection(!0),!h.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,r=-1;continue}{let t=(o<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(o).top)-r;if(t>1||t<-1){n+=t,i.scrollTop=n/this.scaleY,r=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(oF))t(e)}get themeClasses(){return sc+" "+(this.state.facet(sh)?su:sd)+" "+this.state.facet(sl)}updateAttrs(){let t=sC(this,o2,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(oK)?"true":"false",class:"cm-content",style:`${n8.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),sC(this,o5,e);let i=this.observer.ignore(()=>{let i=os(this.contentDOM,this.contentAttrs,e),n=os(this.dom,this.editorAttrs,t);return i||n});return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)t.is(sk.announce)&&(e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(re);let t=this.state.facet(sk.cspNonce);nf.mount(this.root,this.styleModules.concat(sg).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t&&!(this.measureRequests.indexOf(t)>-1)){if(null!=t.key){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find(e=>e.spec==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return rm(this,t,rp(this,t,e,i))}moveByGroup(t,e){return rm(this,t,rp(this,t,e,e=>{var i;let n,o;return i=t.head,o=(n=this.state.charCategorizer(i))(e),t=>{let e=n(t);return o==iZ.Space&&(o=e),o==e}}))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),o=i[e?i.length-1:0];return iv.cursor(o.side(e,n)+t.from,o.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let o=rf(t,e.head),r=n&&o.type==ol.Text&&(t.lineWrapping||o.widgetLineBreaks)?t.coordsAtPos(e.assoc<0&&e.head>o.from?e.head-1:e.head):null;if(r){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(o.from),s=t.posAtCoords({x:i==(n==ox.LTR)?e.right-1:e.left+1,y:(r.top+r.bottom)/2});if(null!=s)return iv.cursor(s,i?-1:1)}return iv.cursor(i?o.to:o.from,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return rm(this,t,function(t,e,i,n){let o=e.head,r=i?1:-1;if(o==(i?t.state.doc.length:0))return iv.cursor(o,e.assoc);let s=e.goalColumn,a,l=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(o,e.assoc||-1),c=t.documentTop;if(h)null==s&&(s=h.left-l.left),a=r<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(o);null==s&&(s=Math.min(l.right-l.left,t.defaultCharacterWidth*(o-e.from))),a=(r<0?e.top:e.bottom)+c}let d=l.left+s,u=null!=n?n:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){let i=a+(u+e)*r,n=rd(t,{x:d,y:i},!1,r);if(i<l.top||i>l.bottom||(r<0?n<o:n>o)){let e=t.docView.coordsForChar(n),o=!e||i<e.top?-1:1;return iv.cursor(n,o,void 0,s)}}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),rd(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),o=this.bidiSpans(n);return nA(i,o[oA.find(o,t-n.from,-1,e)].dir==ox.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(oQ)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>sO)return oI(t.length);let e=this.textDirectionAt(t.from),i;for(let n of this.bidiCache)if(n.from==t.from&&n.dir==e&&(n.fresh||function t(e,i){if(e.length!=i.length)return!1;for(let n=0;n<e.length;n++){let o=e[n],r=i[n];if(o.from!=r.from||o.to!=r.to||o.direction!=r.direction||!t(o.inner,r.inner))return!1}return!0}(n.isolates,i=o9(this,t))))return n.order;i||(i=o9(this,t));let n=function(t,e,i){if(!t)return[new oA(0,0,e==oO?1:0)];if(e==ok&&!i.length&&!oT.test(t))return oI(t.length);if(i.length)for(;t.length>oD.length;)oD[oD.length]=256;let n=[],o=e==ok?0:1;return function t(e,i,n,o,r,s,a){let l=i%2?2:1;(function(t,e,i,n,o){for(let r=0;r<=n.length;r++){let s=r?n[r-1].to:e,a=r<n.length?n[r].from:i,l=r?256:o;for(let e=s,i=l,n=l;e<a;e++){let o=oP(t.charCodeAt(e));512==o?o=i:8==o&&4==n&&(o=16),oD[e]=4==o?2:o,7&o&&(n=o),i=o}for(let t=s,e=l,n=l;t<a;t++){let o=oD[t];if(128==o)t<a-1&&e==oD[t+1]&&24&e?o=oD[t]=e:oD[t]=256;else if(64==o){let o=t+1;for(;o<a&&64==oD[o];)o++;let r=t&&8==e||o<i&&8==oD[o]?1==n?1:8:256;for(let e=t;e<o;e++)oD[e]=r;t=o-1}else 8==o&&1==n&&(oD[t]=1);e=o,7&o&&(n=o)}}})(e,r,s,o,l),function(t,e,i,n,o){let r=1==o?2:1;for(let s=0,a=0,l=0;s<=n.length;s++){let h=s?n[s-1].to:e,c=s<n.length?n[s].from:i;for(let e=h,i,n,s;e<c;e++)if(n=oE[i=t.charCodeAt(e)]){if(n<0){for(let t=a-3;t>=0;t-=3)if(oM[t+1]==-n){let i=oM[t+2],n=2&i?o:4&i?1&i?r:o:0;n&&(oD[e]=oD[oM[t]]=n),a=t;break}}else if(189==oM.length)break;else oM[a++]=e,oM[a++]=i,oM[a++]=l}else if(2==(s=oD[e])||1==s){let t=s==o;l=t?0:1;for(let e=a-3;e>=0;e-=3){let i=oM[e+2];if(2&i)break;if(t)oM[e+2]|=2;else{if(4&i)break;oM[e+2]|=4}}}}}(e,r,s,o,l),function(t,e,i,n){for(let o=0,r=n;o<=i.length;o++){let s=o?i[o-1].to:t,a=o<i.length?i[o].from:e;for(let l=s;l<a;){let s=oD[l];if(256==s){let s=l+1;for(;;)if(s==a){if(o==i.length)break;s=i[o++].to,a=o<i.length?i[o].from:e}else if(256==oD[s])s++;else break;let h=1==r,c=h==((s<e?oD[s]:n)==1)?h?1:2:n;for(let e=s,n=o,r=n?i[n-1].to:t;e>l;)e==r&&(e=i[--n].from,r=n?i[n-1].to:t),oD[--e]=c;l=s}else r=s,l++}}}(r,s,o,l),function e(i,n,o,r,s,a,l){let h=r%2?2:1;if(r%2==s%2)for(let c=n,d=0;c<o;){let n=!0,u=!1;if(d==a.length||c<a[d].from){let t=oD[c];t!=h&&(n=!1,u=16==t)}let f=n||1!=h?null:[],p=n?r:r+1,g=c;e:for(;;)if(d<a.length&&g==a[d].from){if(u)break;let e=a[d];if(!n)for(let t=e.to,i=d+1;;){if(t==o)break e;if(i<a.length&&a[i].from==t)t=a[i++].to;else if(oD[t]==h)break e;else break}d++,f?f.push(e):(e.from>c&&l.push(new oA(c,e.from,p)),t(i,e.direction==ok!=!(p%2)?r+1:r,s,e.inner,e.from,e.to,l),c=e.to),g=e.to}else if(g==o||(n?oD[g]!=h:oD[g]==h))break;else g++;f?e(i,c,g,r+1,s,f,l):c<g&&l.push(new oA(c,g,p)),c=g}else for(let c=o,d=a.length;c>n;){let o=!0,u=!1;if(!d||c>a[d-1].to){let t=oD[c-1];t!=h&&(o=!1,u=16==t)}let f=o||1!=h?null:[],p=o?r:r+1,g=c;e:for(;;)if(d&&g==a[d-1].to){if(u)break;let e=a[--d];if(!o)for(let t=e.from,i=d;;){if(t==n)break e;if(i&&a[i-1].to==t)t=a[--i].from;else if(oD[t-1]==h)break e;else break}f?f.push(e):(e.to<c&&l.push(new oA(e.to,c,p)),t(i,e.direction==ok!=!(p%2)?r+1:r,s,e.inner,e.from,e.to,l),c=e.from),g=e.from}else if(g==n||(o?oD[g-1]!=h:oD[g-1]==h))break;else g--;f?e(i,g,c,r+1,s,f,l):g<c&&l.push(new oA(g,c,p)),c=g}}(e,r,s,i,n,o,a)}(t,o,o,i,0,t.length,n),n}(t.text,e,i);return this.bidiCache.push(new s_(t.from,t.to,e,i,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||n8.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{nz(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let t of(this.root.activeElement==this.contentDOM&&this.contentDOM.blur(),this.plugins))t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return oY.of(new oU("number"==typeof t?iv.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return oY.of(new oU(iv.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){null==t?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof t?this.inputState.tabFocusMode=t?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return o0.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return o0.define(()=>({}),{eventObservers:t})}static theme(t,e){let i=nf.newName(),n=[sl.of(i),re.of(sp(`.${i}`,t))];return e&&e.dark&&n.push(sh.of(!0)),n}static baseTheme(t){return iP.lowest(re.of(sp("."+sc,t,sf)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&nQ.get(i)||nQ.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}sk.styleModule=re,sk.inputHandler=oj,sk.clipboardInputFilter=oW,sk.clipboardOutputFilter=oV,sk.scrollHandler=oq,sk.focusChangeEffect=oH,sk.perLineTextDirection=oQ,sk.exceptionSink=oL,sk.updateListener=oF,sk.editable=oK,sk.mouseSelectionStyle=oN,sk.dragMovesSelection=oR,sk.clickAddsSelectionRange=oz,sk.decorations=o3,sk.outerDecorations=o4,sk.atomicRanges=o8,sk.bidiIsolatedRanges=o6,sk.scrollMargins=o7,sk.darkTheme=sh,sk.cspNonce=iw.define({combine:t=>t.length?t[0]:""}),sk.contentAttributes=o5,sk.editorAttributes=o2,sk.lineWrapping=sk.contentAttributes.of({class:"cm-lineWrapping"}),sk.announce=iq.define();const sO=4096,sS={};class s_{constructor(t,e,i,n,o,r){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=o,this.order=r}static update(t,e){if(e.empty&&!t.some(t=>t.fresh))return t;let i=[],n=t.length?t[t.length-1].dir:ox.LTR;for(let o=Math.max(0,t.length-10);o<t.length;o++){let r=t[o];r.dir!=n||e.touchesRange(r.from,r.to)||i.push(new s_(e.mapPos(r.from,1),e.mapPos(r.to,-1),r.dir,r.isolates,!1,r.order))}return i}}function sC(t,e,i){for(let n=t.state.facet(e),o=n.length-1;o>=0;o--){let e=n[o],r="function"==typeof e?e(t):e;r&&on(r,i)}return i}const sE=n8.mac?"mac":n8.windows?"win":n8.linux?"linux":"key";function sM(t,e,i){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==i&&e.shiftKey&&(t="Shift-"+t),t}const sP=iP.default(sk.domEventHandlers({keydown:(t,e)=>sz(sD(e.state),t,e,"editor")})),sT=iw.define({enables:sP}),sA=new WeakMap;function sD(t){let e=t.facet(sT),i=sA.get(e);return i||sA.set(e,i=function(t,e=sE){let i=Object.create(null),n=Object.create(null),o=(t,e)=>{let i=n[t];if(null==i)n[t]=e;else if(i!=e)throw Error("Key binding "+t+" is used both as a regular binding and as a multi-stroke prefix")},r=(t,n,r,s,a)=>{var l,h;let c=i[t]||(i[t]=Object.create(null)),d=n.split(/ (?!$)/).map(t=>(function(t,e){let i,n,o,r;let s=t.split(/-(?!$)/),a=s[s.length-1];"Space"==a&&(a=" ");for(let t=0;t<s.length-1;++t){let a=s[t];if(/^(cmd|meta|m)$/i.test(a))r=!0;else if(/^a(lt)?$/i.test(a))i=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))"mac"==e?r=!0:n=!0;else throw Error("Unrecognized modifier name: "+a)}return i&&(a="Alt-"+a),n&&(a="Ctrl-"+a),r&&(a="Meta-"+a),o&&(a="Shift-"+a),a})(t,e));for(let e=1;e<d.length;e++){let i=d.slice(0,e).join(" ");o(i,!0),c[i]||(c[i]={preventDefault:!0,stopPropagation:!1,run:[e=>{let n=sI={view:e,prefix:i,scope:t};return setTimeout(()=>{sI==n&&(sI=null)},4e3),!0}]})}let u=d.join(" ");o(u,!1);let f=c[u]||(c[u]={preventDefault:!1,stopPropagation:!1,run:(null===(h=null===(l=c._any)||void 0===l?void 0:l.run)||void 0===h?void 0:h.slice())||[]});r&&f.run.push(r),s&&(f.preventDefault=!0),a&&(f.stopPropagation=!0)};for(let n of t){let t=n.scope?n.scope.split(" "):["editor"];if(n.any)for(let e of t){let t=i[e]||(i[e]=Object.create(null));t._any||(t._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:o}=n;for(let e in t)t[e].run.push(t=>o(t,sB))}let o=n[e]||n.key;if(o)for(let e of t)r(e,o,n.run,n.preventDefault,n.stopPropagation),n.shift&&r(e,"Shift-"+o,n.shift,n.preventDefault,n.stopPropagation)}return i}(e.reduce((t,e)=>t.concat(e),[]))),i}let sI=null,sB=null;function sz(t,e,i,n){var o;sB=e;let r=("Esc"==(o=!(ny&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||nb&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?nv:nm)[e.keyCode]||e.key||"Unidentified")&&(o="Escape"),"Del"==o&&(o="Delete"),"Left"==o&&(o="ArrowLeft"),"Up"==o&&(o="ArrowUp"),"Right"==o&&(o="ArrowRight"),"Down"==o&&(o="ArrowDown"),o),s=io(ie(r,0))==r.length&&" "!=r,a="",l=!1,h=!1,c=!1;sI&&sI.view==i&&sI.scope==n&&(a=sI.prefix+" ",0>rC.indexOf(e.keyCode)&&(h=!0,sI=null));let d=new Set,u=t=>{if(t){for(let e of t.run)if(!d.has(e)&&(d.add(e),e(i)))return t.stopPropagation&&(c=!0),!0;t.preventDefault&&(t.stopPropagation&&(c=!0),h=!0)}return!1},f=t[n],p,g;return f&&(u(f[a+sM(r,e,!s)])?l=!0:s&&(e.altKey||e.metaKey||e.ctrlKey)&&!(n8.windows&&e.ctrlKey&&e.altKey)&&(p=nm[e.keyCode])&&p!=r?u(f[a+sM(p,e,!0)])?l=!0:e.shiftKey&&(g=nv[e.keyCode])!=r&&g!=p&&u(f[a+sM(g,e,!1)])&&(l=!0):s&&e.shiftKey&&u(f[a+sM(r,e,!0)])&&(l=!0),!l&&u(f._any)&&(l=!0)),h&&(l=!0),l&&c&&e.stopPropagation(),sB=null,l}class sR{constructor(t,e,i,n,o){this.className=t,this.left=e,this.top=i,this.width=n,this.height=o}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,e){return e.className==this.className&&(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",null!=this.width&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,e,i){if(!i.empty)return function(t,e,i){if(i.to<=t.viewport.from||i.from>=t.viewport.to)return[];let n=Math.max(i.from,t.viewport.from),o=Math.min(i.to,t.viewport.to),r=t.textDirection==ox.LTR,s=t.contentDOM,a=s.getBoundingClientRect(),l=sN(t),h=s.querySelector(".cm-line"),c=h&&window.getComputedStyle(h),d=a.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),u=a.right-(c?parseInt(c.paddingRight):0),f=rf(t,n),p=rf(t,o),g=f.type==ol.Text?f:null,m=p.type==ol.Text?p:null;if(g&&(t.lineWrapping||f.widgetLineBreaks)&&(g=sL(t,n,1,g)),m&&(t.lineWrapping||p.widgetLineBreaks)&&(m=sL(t,o,-1,m)),g&&m&&g.from==m.from&&g.to==m.to)return y(b(i.from,i.to,g));{let e=g?b(i.from,null,g):w(f,!1),n=m?b(null,i.to,m):w(p,!0),o=[];return(g||f).to<(m||p).from-(g&&m?1:0)||f.widgetLineBreaks>1&&e.bottom+t.defaultLineHeight/2<n.top?o.push(v(d,e.bottom,u,n.top)):e.bottom<n.top&&t.elementAtHeight((e.bottom+n.top)/2).type==ol.Text&&(e.bottom=n.top=(e.bottom+n.top)/2),y(e).concat(o).concat(y(n))}function v(t,i,n,o){return new sR(e,t-l.left,i-l.top,n-t,o-i)}function y({top:t,bottom:e,horizontal:i}){let n=[];for(let o=0;o<i.length;o+=2)n.push(v(i[o],t,i[o+1],e));return n}function b(e,i,n){let o=1e9,s=-1e9,a=[];function l(e,i,l,h,c){let f=t.coordsAtPos(e,e==n.to?-2:2),p=t.coordsAtPos(l,l==n.from?2:-2);f&&p&&(o=Math.min(f.top,p.top,o),s=Math.max(f.bottom,p.bottom,s),c==ox.LTR?a.push(r&&i?d:f.left,r&&h?u:p.right):a.push(!r&&h?d:p.left,!r&&i?u:f.right))}let h=null!=e?e:n.from,c=null!=i?i:n.to;for(let n of t.visibleRanges)if(n.to>h&&n.from<c)for(let o=Math.max(n.from,h),r=Math.min(n.to,c);;){let n=t.state.doc.lineAt(o);for(let s of t.bidiSpans(n)){let t=s.from+n.from,a=s.to+n.from;if(t>=r)break;a>o&&l(Math.max(t,o),null==e&&t<=h,Math.min(a,r),null==i&&a>=c,s.dir)}if((o=n.to+1)>=r)break}return 0==a.length&&l(h,null==e,c,null==i,t.textDirection),{top:o,bottom:s,horizontal:a}}function w(t,e){let i=a.top+(e?t.top:t.bottom);return{top:i,bottom:i,horizontal:[]}}}(t,e,i);{let n=t.coordsAtPos(i.head,i.assoc||1);if(!n)return[];let o=sN(t);return[new sR(e,n.left-o.left,n.top-o.top,null,n.bottom-n.top)]}}}function sN(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==ox.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function sL(t,e,i,n){let o=t.coordsAtPos(e,2*i);if(!o)return n;let r=t.dom.getBoundingClientRect(),s=(o.top+o.bottom)/2,a=t.posAtCoords({x:r.left+1,y:s}),l=t.posAtCoords({x:r.right-1,y:s});return null==a||null==l?n:{from:Math.max(n.from,Math.min(a,l)),to:Math.min(n.to,Math.max(a,l))}}class sF{constructor(t,e){this.view=t,this.layer=e,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),e.above&&this.dom.classList.add("cm-layer-above"),e.class&&this.dom.classList.add(e.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),e.mount&&e.mount(this.dom,t)}update(t){t.startState.facet(sj)!=t.state.facet(sj)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&(this.scale(),t.view.requestMeasure(this.measureReq))}docViewUpdate(t){!1!==this.layer.updateOnDocViewUpdate&&t.requestMeasure(this.measureReq)}setOrder(t){let e=0,i=t.facet(sj);for(;e<i.length&&i[e]!=this.layer;)e++;this.dom.style.zIndex=String((this.layer.above?150:-1)-e)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:t,scaleY:e}=this.view;(t!=this.scaleX||e!=this.scaleY)&&(this.scaleX=t,this.scaleY=e,this.dom.style.transform=`scale(${1/t}, ${1/e})`)}draw(t){if(t.length!=this.drawn.length||t.some((t,e)=>{var i;return i=this.drawn[e],!(t.constructor==i.constructor&&t.eq(i))})){let e=this.dom.firstChild,i=0;for(let n of t)n.update&&e&&n.constructor&&this.drawn[i].constructor&&n.update(e,this.drawn[i])?(e=e.nextSibling,i++):this.dom.insertBefore(n.draw(),e);for(;e;){let t=e.nextSibling;e.remove(),e=t}this.drawn=t}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const sj=iw.define();function sH(t){return[o0.define(e=>new sF(e,t)),sj.of(t)]}const sW=!(n8.ios&&n8.webkit&&n8.webkit_version<534),sV=iw.define({combine:t=>i1(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,e)=>Math.min(t,e),drawRangeCursor:(t,e)=>t||e})});function sQ(t){return t.startState.facet(sV)!=t.state.facet(sV)}const s$=sH({above:!0,markers(t){let{state:e}=t,i=e.facet(sV),n=[];for(let o of e.selection.ranges){let r=o==e.selection.main;if(o.empty?!r||sW:i.drawRangeCursor){let e=r?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",i=o.empty?o:iv.cursor(o.head,o.head>o.anchor?-1:1);for(let o of sR.forRange(t,e,i))n.push(o)}}return n},update(t,e){t.transactions.some(t=>t.selection)&&(e.style.animationName="cm-blink"==e.style.animationName?"cm-blink2":"cm-blink");let i=sQ(t);return i&&sq(t.state,e),t.docChanged||t.selectionSet||i},mount(t,e){sq(e.state,t)},class:"cm-cursorLayer"});function sq(t,e){e.style.animationDuration=t.facet(sV).cursorBlinkRate+"ms"}const sU=sH({above:!1,markers:t=>t.state.selection.ranges.map(e=>e.empty?[]:sR.forRange(t,"cm-selectionBackground",e)).reduce((t,e)=>t.concat(e)),update:(t,e)=>t.docChanged||t.selectionSet||t.viewportChanged||sQ(t),class:"cm-selectionLayer"}),sY={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};sW&&(sY[".cm-line"].caretColor=sY[".cm-content"].caretColor="transparent !important");const sG=iP.highest(sk.theme(sY)),sX=iq.define({map:(t,e)=>null==t?null:e.mapPos(t)}),sK=iC.define({create:()=>null,update:(t,e)=>(null!=t&&(t=e.changes.mapPos(t)),e.effects.reduce((t,e)=>e.is(sX)?e.value:t,t))}),sZ=o0.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let i=t.state.field(sK);null==i?null!=this.cursor&&(null===(e=this.cursor)||void 0===e||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field(sK)!=i||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:t}=this,e=t.state.field(sK),i=null!=e&&t.coordsAtPos(e);if(!i)return null;let n=t.scrollDOM.getBoundingClientRect();return{left:i.left-n.left+t.scrollDOM.scrollLeft*t.scaleX,top:i.top-n.top+t.scrollDOM.scrollTop*t.scaleY,height:i.bottom-i.top}}drawCursor(t){if(this.cursor){let{scaleX:e,scaleY:i}=this.view;t?(this.cursor.style.left=t.left/e+"px",this.cursor.style.top=t.top/i+"px",this.cursor.style.height=t.height/i+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field(sK)!=t&&this.view.dispatch({effects:sX.of(t)})}},{eventObservers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){t.target!=this.view.contentDOM&&this.view.contentDOM.contains(t.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function sJ(t,e,i,n,o){e.lastIndex=0;for(let r=t.iterRange(i,n),s=i,a;!r.next().done;s+=r.value.length)if(!r.lineBreak)for(;a=e.exec(r.value);)o(s+a.index,a)}class s0{constructor(t){let{regexp:e,decoration:i,decorate:n,boundary:o,maxLength:r=1e3}=t;if(!e.global)throw RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=e,n)this.addMatch=(t,e,i,o)=>n(o,i,i+t[0].length,t,e);else if("function"==typeof i)this.addMatch=(t,e,n,o)=>{let r=i(t,e,n);r&&o(n,n+t[0].length,r)};else if(i)this.addMatch=(t,e,n,o)=>o(n,n+t[0].length,i);else throw RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=o,this.maxLength=r}createDeco(t){let e=new i6,i=e.add.bind(e);for(let{from:e,to:n}of function(t,e){let i=t.visibleRanges;if(1==i.length&&i[0].from==t.viewport.from&&i[0].to==t.viewport.to)return i;let n=[];for(let{from:o,to:r}of i)o=Math.max(t.state.doc.lineAt(o).from,o-e),r=Math.min(t.state.doc.lineAt(r).to,r+e),n.length&&n[n.length-1].to>=o?n[n.length-1].to=r:n.push({from:o,to:r});return n}(t,this.maxLength))sJ(t.state.doc,this.regexp,e,n,(e,n)=>this.addMatch(n,t,e,i));return e.finish()}updateDeco(t,e){let i=1e9,n=-1;return(t.docChanged&&t.changes.iterChanges((e,o,r,s)=>{s>=t.view.viewport.from&&r<=t.view.viewport.to&&(i=Math.min(r,i),n=Math.max(s,n))}),t.viewportMoved||n-i>1e3)?this.createDeco(t.view):n>-1?this.updateRange(t.view,e.map(t.changes),i,n):e}updateRange(t,e,i,n){for(let o of t.visibleRanges){let r=Math.max(o.from,i),s=Math.min(o.to,n);if(s>r){let i=t.state.doc.lineAt(r),n=i.to<s?t.state.doc.lineAt(s):i,a=Math.max(o.from,i.from),l=Math.min(o.to,n.to);if(this.boundary){for(;r>i.from;r--)if(this.boundary.test(i.text[r-1-i.from])){a=r;break}for(;s<n.to;s++)if(this.boundary.test(n.text[s-n.from])){l=s;break}}let h=[],c,d=(t,e,i)=>h.push(i.range(t,e));if(i==n)for(this.regexp.lastIndex=a-i.from;(c=this.regexp.exec(i.text))&&c.index<l-i.from;)this.addMatch(c,t,c.index+i.from,d);else sJ(t.state.doc,this.regexp,a,l,(e,i)=>this.addMatch(i,t,e,d));e=e.update({filterFrom:a,filterTo:l,filter:(t,e)=>t<a||e>l,add:h})}}return e}}const s1=null!=/x/.unicode?"gu":"g",s2=RegExp("[\0-\b\n-\x1f-ÂÂ­Øâââ\u2028\u2029â­â®â¦â§â©\uFEFFï¿¹-ï¿¼]",s1),s5={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let s3=null;const s4=iw.define({combine(t){let e=i1(t,{render:null,specialChars:s2,addSpecialChars:null});return(e.replaceTabs=!function(){var t;if(null==s3&&"undefined"!=typeof document&&document.body){let e=document.body.style;s3=(null!==(t=e.tabSize)&&void 0!==t?t:e.MozTabSize)!=null}return s3||!1}())&&(e.specialChars=RegExp("	|"+e.specialChars.source,s1)),e.addSpecialChars&&(e.specialChars=RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,s1)),e}});let s8=null;class s6 extends oa{constructor(t,e){super(),this.options=t,this.code=e}eq(t){return t.code==this.code}toDOM(t){var e;let i=(e=this.code)>=32?"â¢":10==e?"â¤":String.fromCharCode(9216+e),n=t.state.phrase("Control character")+" "+(s5[this.code]||"0x"+this.code.toString(16)),o=this.options.render&&this.options.render(this.code,n,i);if(o)return o;let r=document.createElement("span");return r.textContent=i,r.title=n,r.setAttribute("aria-label",n),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class s9 extends oa{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="	",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}const s7=oh.line({class:"cm-activeLine"}),at=o0.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,i=[];for(let n of t.state.selection.ranges){let o=t.lineBlockAt(n.head);o.from>e&&(i.push(s7.range(o.from)),e=o.from)}return oh.set(i)}},{decorations:t=>t.decorations});function ae(t,e){var i;let n,o=t.posAtCoords({x:e.clientX,y:e.clientY},!1),r=t.state.doc.lineAt(o),s=o-r.from,a=s>2e3?-1:s==r.length?(i=e.clientX,(n=t.coordsAtPos(t.viewport.from))?Math.round(Math.abs((n.left-i)/t.defaultCharacterWidth)):-1):nl(r.text,t.state.tabSize,o-r.from);return{line:r.number,col:a,off:s}}const ai={Alt:[18,t=>!!t.altKey],Control:[17,t=>!!t.ctrlKey],Shift:[16,t=>!!t.shiftKey],Meta:[91,t=>!!t.metaKey]},an={style:"cursor: crosshair"},ao="-10000px";class ar{constructor(t,e,i,n){this.facet=e,this.createTooltipView=i,this.removeTooltipView=n,this.input=t.state.facet(e),this.tooltips=this.input.filter(t=>t);let o=null;this.tooltipViews=this.tooltips.map(t=>o=i(t,o))}update(t,e){var i;let n=t.state.facet(this.facet),o=n.filter(t=>t);if(n===this.input){for(let e of this.tooltipViews)e.update&&e.update(t);return!1}let r=[],s=e?[]:null;for(let i=0;i<o.length;i++){let n=o[i],a=-1;if(n){for(let t=0;t<this.tooltips.length;t++){let e=this.tooltips[t];e&&e.create==n.create&&(a=t)}if(a<0)r[i]=this.createTooltipView(n,i?r[i-1]:null),s&&(s[i]=!!n.above);else{let n=r[i]=this.tooltipViews[a];s&&(s[i]=e[a]),n.update&&n.update(t)}}}for(let t of this.tooltipViews)0>r.indexOf(t)&&(this.removeTooltipView(t),null===(i=t.destroy)||void 0===i||i.call(t));return e&&(s.forEach((t,i)=>e[i]=t),e.length=s.length),this.input=n,this.tooltips=o,this.tooltipViews=r,!0}}function as(t){let{win:e}=t;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const aa=iw.define({combine:t=>{var e,i,n;return{position:n8.ios?"absolute":(null===(e=t.find(t=>t.position))||void 0===e?void 0:e.position)||"fixed",parent:(null===(i=t.find(t=>t.parent))||void 0===i?void 0:i.parent)||null,tooltipSpace:(null===(n=t.find(t=>t.tooltipSpace))||void 0===n?void 0:n.tooltipSpace)||as}}}),al=new WeakMap,ah=o0.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(aa);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver="function"==typeof ResizeObserver?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new ar(t,af,(t,e)=>this.createTooltip(t,e),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver)for(let t of(this.intersectionObserver.disconnect(),this.manager.tooltipViews))this.intersectionObserver.observe(t.dom)}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let i=e||t.geometryChanged,n=t.state.facet(aa);if(n.position!=this.position&&!this.madeAbsolute){for(let t of(this.position=n.position,this.manager.tooltipViews))t.dom.style.position=this.position;i=!0}if(n.parent!=this.parent){for(let t of(this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer(),this.manager.tooltipViews))this.container.appendChild(t.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(t,e){let i=t.create(this.view),n=e?e.dom:null;if(i.dom.classList.add("cm-tooltip"),t.arrow&&!i.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",i.dom.appendChild(t)}return i.dom.style.position=this.position,i.dom.style.top=ao,i.dom.style.left="0px",this.container.insertBefore(i.dom,n),i.mount&&i.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(i.dom),i}destroy(){var t,e,i;for(let e of(this.view.win.removeEventListener("resize",this.measureSoon),this.manager.tooltipViews))e.dom.remove(),null===(t=e.destroy)||void 0===t||t.call(e);this.parent&&this.container.remove(),null===(e=this.resizeObserver)||void 0===e||e.disconnect(),null===(i=this.intersectionObserver)||void 0===i||i.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,i=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:t}=this.manager.tooltipViews[0];if(n8.gecko)i=t.offsetParent!=this.container.ownerDocument.body;else if(t.style.top==ao&&"0px"==t.style.left){let e=t.getBoundingClientRect();i=Math.abs(e.top+1e4)>1||Math.abs(e.left)>1}}if(i||"absolute"==this.position){if(this.parent){let i=this.parent.getBoundingClientRect();i.width&&i.height&&(t=i.width/this.parent.offsetWidth,e=i.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState)}let n=this.view.scrollDOM.getBoundingClientRect(),o=rt(this.view);return{visible:{left:n.left+o.left,top:n.top+o.top,right:n.right-o.right,bottom:n.bottom-o.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((t,e)=>{let i=this.manager.tooltipViews[e];return i.getCoords?i.getCoords(t.pos):this.view.coordsAtPos(t.pos)}),size:this.manager.tooltipViews.map(({dom:t})=>t.getBoundingClientRect()),space:this.view.state.facet(aa).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:i}}writeMeasure(t){var e;if(t.makeAbsolute)for(let t of(this.madeAbsolute=!0,this.position="absolute",this.manager.tooltipViews))t.dom.style.position="absolute";let{visible:i,space:n,scaleX:o,scaleY:r}=t,s=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],h=this.manager.tooltipViews[a],{dom:c}=h,d=t.pos[a],u=t.size[a];if(!d||!1!==l.clip&&(d.bottom<=Math.max(i.top,n.top)||d.top>=Math.min(i.bottom,n.bottom)||d.right<Math.max(i.left,n.left)-.1||d.left>Math.min(i.right,n.right)+.1)){c.style.top=ao;continue}let f=l.arrow?h.dom.querySelector(".cm-tooltip-arrow"):null,p=f?7:0,g=u.right-u.left,m=null!==(e=al.get(h))&&void 0!==e?e:u.bottom-u.top,v=h.offset||au,y=this.view.textDirection==ox.LTR,b=u.width>n.right-n.left?y?n.left:n.right-u.width:y?Math.max(n.left,Math.min(d.left-(f?14:0)+v.x,n.right-g)):Math.min(Math.max(n.left,d.left-g+(f?14:0)-v.x),n.right-g),w=this.above[a];!l.strictSide&&(w?d.top-m-p-v.y<n.top:d.bottom+m+p+v.y>n.bottom)&&w==n.bottom-d.bottom>d.top-n.top&&(w=this.above[a]=!w);let x=(w?d.top-n.top:n.bottom-d.bottom)-p;if(x<m&&!1!==h.resize){if(x<this.view.defaultLineHeight){c.style.top=ao;continue}al.set(h,m),c.style.height=(m=x)/r+"px"}else c.style.height&&(c.style.height="");let k=w?d.top-m-p-v.y:d.bottom+p+v.y,O=b+g;if(!0!==h.overlap)for(let t of s)t.left<O&&t.right>b&&t.top<k+m&&t.bottom>k&&(k=w?t.top-m-2-p:t.bottom+p+2);if("absolute"==this.position?(c.style.top=(k-t.parent.top)/r+"px",ac(c,(b-t.parent.left)/o)):(c.style.top=k/r+"px",ac(c,b/o)),f){let t=d.left+(y?v.x:-v.x)-(b+14-7);f.style.left=t/o+"px"}!0!==h.overlap&&s.push({left:b,top:k,right:O,bottom:k+m}),c.classList.toggle("cm-tooltip-above",w),c.classList.toggle("cm-tooltip-below",!w),h.positioned&&h.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=ao}},{eventObservers:{scroll(){this.maybeMeasure()}}});function ac(t,e){let i=parseInt(t.style.left,10);(isNaN(i)||Math.abs(e-i)>1)&&(t.style.left=e+"px")}const ad=sk.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),au={x:0,y:0},af=iw.define({enables:[ah,ad]}),ap=iw.define({combine:t=>t.reduce((t,e)=>t.concat(e),[])});class ag{static create(t){return new ag(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new ar(t,ap,(t,e)=>this.createHostedView(t,e),t=>t.dom.remove())}createHostedView(t,e){let i=t.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,e?e.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)null===(t=e.destroy)||void 0===t||t.call(e)}passProp(t){let e;for(let i of this.manager.tooltipViews){let n=i[t];if(void 0!==n){if(void 0===e)e=n;else if(e!==n)return}}return e}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const am=af.compute([ap],t=>{let e=t.facet(ap);return 0===e.length?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var e;return null!==(e=t.end)&&void 0!==e?e:t.pos})),create:ag.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class av{constructor(t,e,i,n,o){this.view=t,this.source=e,this.field=i,this.setHover=n,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:e}=this,i=t.docView.nearest(e.target);if(!i)return;let n,o=1;if(i instanceof n7)n=i.posAtStart;else{if(null==(n=t.posAtCoords(e)))return;let i=t.coordsAtPos(n);if(!i||e.y<i.top||e.y>i.bottom||e.x<i.left-t.defaultCharacterWidth||e.x>i.right+t.defaultCharacterWidth)return;let r=t.bidiSpans(t.state.doc.lineAt(n)).find(t=>t.from<=n&&t.to>=n),s=r&&r.dir==ox.RTL?-1:1;o=e.x<i.left?-s:s}let r=this.source(t,n,o);if(null==r?void 0:r.then){let e=this.pending={pos:n};r.then(i=>{this.pending==e&&(this.pending=null,i&&!(Array.isArray(i)&&!i.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(i)?i:[i])}))},e=>oX(t.state,e,"hover tooltip"))}else r&&!(Array.isArray(r)&&!r.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(r)?r:[r])})}get tooltip(){let t=this.view.plugin(ah),e=t?t.manager.tooltips.findIndex(t=>t.create==ag.create):-1;return e>-1?t.manager.tooltipViews[e]:null}mousemove(t){var e,i;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:o}=this;if(n.length&&o&&!function(t,e){let{left:i,right:n,top:o,bottom:r}=t.getBoundingClientRect(),s;if(s=t.querySelector(".cm-tooltip-arrow")){let t=s.getBoundingClientRect();o=Math.min(t.top,o),r=Math.max(t.bottom,r)}return e.clientX>=i-4&&e.clientX<=n+4&&e.clientY>=o-4&&e.clientY<=r+4}(o.dom,t)||this.pending){let{pos:o}=n[0]||this.pending,r=null!==(i=null===(e=n[0])||void 0===e?void 0:e.end)&&void 0!==i?i:o;(o==r?this.view.posAtCoords(this.lastMove)!=o:!function(t,e,i,n,o,r){let s=t.scrollDOM.getBoundingClientRect(),a=t.documentTop+t.documentPadding.top+t.contentHeight;if(s.left>n||s.right<n||s.top>o||Math.min(s.bottom,a)<o)return!1;let l=t.posAtCoords({x:n,y:o},!1);return l>=e&&l<=i}(this.view,o,r,t.clientX,t.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:e}=this;if(e.length){let{tooltip:e}=this;e&&e.dom.contains(t.relatedTarget)?this.watchTooltipLeave(e.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(t){let e=i=>{t.removeEventListener("mouseleave",e),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",e)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function ay(t,e){let i=t.plugin(ah);if(!i)return null;let n=i.manager.tooltips.indexOf(e);return n<0?null:i.manager.tooltipViews[n]}const ab=iq.define(),aw=iw.define({combine(t){let e,i;for(let n of t)e=e||n.topContainer,i=i||n.bottomContainer;return{topContainer:e,bottomContainer:i}}});function ax(t,e){let i=t.plugin(ak),n=i?i.specs.indexOf(e):-1;return n>-1?i.panels[n]:null}const ak=o0.fromClass(class{constructor(t){this.input=t.state.facet(a_),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(e=>e(t));let e=t.state.facet(aw);for(let i of(this.top=new aO(t,!0,e.topContainer),this.bottom=new aO(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top)),this.panels))i.dom.classList.add("cm-panel"),i.mount&&i.mount()}update(t){let e=t.state.facet(aw);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new aO(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new aO(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=t.state.facet(a_);if(i!=this.input){let e=i.filter(t=>t),n=[],o=[],r=[],s=[];for(let i of e){let e=this.specs.indexOf(i),a;e<0?(a=i(t.view),s.push(a)):(a=this.panels[e]).update&&a.update(t),n.push(a),(a.top?o:r).push(a)}for(let t of(this.specs=e,this.panels=n,this.top.sync(o),this.bottom.sync(r),s))t.dom.classList.add("cm-panel"),t.mount&&t.mount()}else for(let e of this.panels)e.update&&e.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>sk.scrollMargins.of(e=>{let i=e.plugin(t);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}})});class aO{constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&0>t.indexOf(e)&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(0==this.panels.length){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=aS(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=aS(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function aS(t){let e=t.nextSibling;return t.remove(),e}const a_=iw.define({enables:ak});class aC extends i2{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}aC.prototype.elementClass="",aC.prototype.toDOM=void 0,aC.prototype.mapMode=is.TrackBefore,aC.prototype.startSide=aC.prototype.endSide=-1,aC.prototype.point=!0;const aE=iw.define(),aM=iw.define(),aP={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>i8.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},aT=iw.define();function aA(t){return[aI(),aT.of(Object.assign(Object.assign({},aP),t))]}const aD=iw.define({combine:t=>t.some(t=>t)});function aI(t){let e=[aB];return t&&!1===t.fixed&&e.push(aD.of(!0)),e}const aB=o0.fromClass(class{constructor(t){for(let e of(this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(aT).map(e=>new aL(t,e)),this.gutters))this.dom.appendChild(e.dom);this.fixed=!t.state.facet(aD),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,i=t.view.viewport,n=Math.min(e.to,i.to)-Math.max(e.from,i.from);this.syncGutters(n<(i.to-i.from)*.8)}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(aD)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let i=i8.iter(this.view.state.facet(aE),this.view.viewport.from),n=[],o=this.gutters.map(t=>new aN(t,this.view.viewport,-this.view.documentPadding.top));for(let t of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(t.type)){let e=!0;for(let r of t.type)if(r.type==ol.Text&&e){for(let t of(aR(i,n,r.from),o))t.line(this.view,r,n);e=!1}else if(r.widget)for(let t of o)t.widget(this.view,r)}else if(t.type==ol.Text)for(let e of(aR(i,n,t.from),o))e.line(this.view,t,n);else if(t.widget)for(let e of o)e.widget(this.view,t);for(let t of o)t.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(aT),i=t.state.facet(aT),n=t.docChanged||t.heightChanged||t.viewportChanged||!i8.eq(t.startState.facet(aE),t.state.facet(aE),t.view.viewport.from,t.view.viewport.to);if(e==i)for(let e of this.gutters)e.update(t)&&(n=!0);else{n=!0;let o=[];for(let n of i){let i=e.indexOf(n);i<0?o.push(new aL(this.view,n)):(this.gutters[i].update(t),o.push(this.gutters[i]))}for(let t of this.gutters)t.dom.remove(),0>o.indexOf(t)&&t.destroy();for(let t of o)this.dom.appendChild(t.dom);this.gutters=o}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>sk.scrollMargins.of(e=>{let i=e.plugin(t);return i&&0!=i.gutters.length&&i.fixed?e.textDirection==ox.LTR?{left:i.dom.offsetWidth*e.scaleX}:{right:i.dom.offsetWidth*e.scaleX}:null})});function az(t){return Array.isArray(t)?t:[t]}function aR(t,e,i){for(;t.value&&t.from<=i;)t.from==i&&e.push(t.value),t.next()}class aN{constructor(t,e,i){this.gutter=t,this.height=i,this.i=0,this.cursor=i8.iter(t.markers,e.from)}addElement(t,e,i){let{gutter:n}=this,o=(e.top-this.height)/t.scaleY,r=e.height/t.scaleY;if(this.i==n.elements.length){let e=new aF(t,r,o,i);n.elements.push(e),n.dom.appendChild(e.dom)}else n.elements[this.i].update(t,r,o,i);this.height=e.bottom,this.i++}line(t,e,i){let n=[];aR(this.cursor,n,e.from),i.length&&(n=n.concat(i));let o=this.gutter.config.lineMarker(t,e,n);o&&n.unshift(o);let r=this.gutter;(0!=n.length||r.config.renderEmptyElements)&&this.addElement(t,e,n)}widget(t,e){let i=this.gutter.config.widgetMarker(t,e.widget,e),n=i?[i]:null;for(let i of t.state.facet(aM)){let o=i(t,e.widget,e);o&&(n||(n=[])).push(o)}n&&this.addElement(t,e,n)}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class aL{constructor(t,e){for(let i in this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:""),e.domEventHandlers)this.dom.addEventListener(i,n=>{let o=n.target,r;if(o!=this.dom&&this.dom.contains(o)){for(;o.parentNode!=this.dom;)o=o.parentNode;let t=o.getBoundingClientRect();r=(t.top+t.bottom)/2}else r=n.clientY;let s=t.lineBlockAtHeight(r-t.documentTop);e.domEventHandlers[i](t,s,n)&&n.preventDefault()});this.markers=az(e.markers(t)),e.initialSpacer&&(this.spacer=new aF(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=az(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let e=this.config.updateSpacer(this.spacer.markers[0],t);e!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[e])}let i=t.view.viewport;return!i8.eq(this.markers,e,i.from,i.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(t)}destroy(){for(let t of this.elements)t.destroy()}}class aF{constructor(t,e,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,i,n)}update(t,e,i,n){this.height!=e&&(this.height=e,this.dom.style.height=e+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),!function(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].compare(e[i]))return!1;return!0}(this.markers,n)&&this.setMarkers(t,n)}setMarkers(t,e){let i="cm-gutterElement",n=this.dom.firstChild;for(let o=0,r=0;;){let s=r,a=o<e.length?e[o++]:null,l=!1;if(a){let t=a.elementClass;t&&(i+=" "+t);for(let t=r;t<this.markers.length;t++)if(this.markers[t].compare(a)){s=t,l=!0;break}}else s=this.markers.length;for(;r<s;){let t=this.markers[r++];if(t.toDOM){t.destroy(n);let e=n.nextSibling;n.remove(),n=e}}if(!a)break;a.toDOM&&(l?n=n.nextSibling:this.dom.insertBefore(a.toDOM(t),n)),l&&r++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}}const aj=iw.define(),aH=iw.define(),aW=iw.define({combine:t=>i1(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let i=Object.assign({},t);for(let t in e){let n=i[t],o=e[t];i[t]=n?(t,e,i)=>n(t,e,i)||o(t,e,i):o}return i}})});class aV extends aC{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function aQ(t,e){return t.state.facet(aW).formatNumber(e,t.state)}const a$=aT.compute([aW],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:t=>t.state.facet(aj),lineMarker:(t,e,i)=>i.some(t=>t.toDOM)?null:new aV(aQ(t,t.state.doc.lineAt(e.from).number)),widgetMarker:(t,e,i)=>{for(let n of t.state.facet(aH)){let o=n(t,e,i);if(o)return o}return null},lineMarkerChange:t=>t.startState.facet(aW)!=t.state.facet(aW),initialSpacer:t=>new aV(aQ(t,aq(t.state.doc.lines))),updateSpacer(t,e){let i=aQ(e.view,aq(e.view.state.doc.lines));return i==t.number?t:new aV(i)},domEventHandlers:t.facet(aW).domEventHandlers}));function aq(t){let e=9;for(;e<t;)e=10*e+9;return e}const aU=new class extends aC{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},aY=aE.compute(["selection"],t=>{let e=[],i=-1;for(let n of t.selection.ranges){let o=t.doc.lineAt(n.head).from;o>i&&(i=o,e.push(aU.range(o)))}return i8.of(e)});let aG=0;class aX{constructor(t,e){this.from=t,this.to=e}}class aK{constructor(t={}){this.id=aG++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=a0.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}aK.closedBy=new aK({deserialize:t=>t.split(" ")}),aK.openedBy=new aK({deserialize:t=>t.split(" ")}),aK.group=new aK({deserialize:t=>t.split(" ")}),aK.isolate=new aK({deserialize:t=>{if(t&&"rtl"!=t&&"ltr"!=t&&"auto"!=t)throw RangeError("Invalid value for isolate: "+t);return t||"auto"}}),aK.contextHash=new aK({perNode:!0}),aK.lookAhead=new aK({perNode:!0}),aK.mounted=new aK({perNode:!0});class aZ{constructor(t,e,i){this.tree=t,this.overlay=e,this.parser=i}static get(t){return t&&t.props&&t.props[aK.mounted.id]}}const aJ=Object.create(null);class a0{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):aJ,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new a0(t.name||"",e,t.id,i);if(t.props){for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(aK.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(aK.group),n=-1;n<(i?i.length:0);n++){let o=e[n<0?t.name:i[n]];if(o)return o}}}}a0.none=new a0("",Object.create(null),0,8);class a1{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let e of t){let t=e(i);t&&(n||(n=Object.assign({},i.props)),n[t[0].id]=t[1])}e.push(n?new a0(i.name,n,i.id,i.flags):i)}return new a1(e)}}const a2=new WeakMap,a5=new WeakMap;(d=u||(u={}))[d.ExcludeBuffers=1]="ExcludeBuffers",d[d.IncludeAnonymous=2]="IncludeAnonymous",d[d.IgnoreMounts=4]="IgnoreMounts",d[d.IgnoreOverlays=8]="IgnoreOverlays";class a3{constructor(t,e,i,n,o){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,o&&o.length)for(let[t,e]of(this.props=Object.create(null),o))this.props["number"==typeof t?t:t.id]=e}toString(){let t=aZ.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new la(this.topNode,t)}cursorAt(t,e=0,i=0){let n=new la(a2.get(this)||this.topNode);return n.moveTo(t,e),a2.set(this,n._tree),n}get topNode(){return new lt(this,0,0,null)}resolve(t,e=0){let i=a9(a2.get(this)||this.topNode,t,e,!1);return a2.set(this,i),i}resolveInner(t,e=0){let i=a9(a5.get(this)||this.topNode,t,e,!0);return a5.set(this,i),i}resolveStack(t,e=0){return function(t,e,i){let n=t.resolveInner(e,i),o=null;for(let t=n instanceof lt?n:n.context.parent;t;t=t.parent)if(t.index<0){let r=t.parent;(o||(o=[n])).push(r.resolve(e,i)),t=r}else{let r=aZ.get(t.tree);if(r&&r.overlay&&r.overlay[0].from<=e&&r.overlay[r.overlay.length-1].to>=e){let s=new lt(r.tree,r.overlay[0].from+t.from,-1,t);(o||(o=[n])).push(a9(s,e,i,!1))}}return o?lr(o):n}(this,t,e)}iterate(t){let{enter:e,leave:i,from:n=0,to:o=this.length}=t,r=t.mode||0,s=(r&u.IncludeAnonymous)>0;for(let t=this.cursor(r|u.IncludeAnonymous);;){let r=!1;if(t.from<=o&&t.to>=n&&(!s&&t.type.isAnonymous||!1!==e(t))){if(t.firstChild())continue;r=!0}for(;r&&i&&(s||!t.type.isAnonymous)&&i(t),!t.nextSibling();){if(!t.parent())return;r=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:ld(a0.none,this.children,this.positions,0,this.children.length,0,this.length,(t,e,i)=>new a3(this.type,t,e,i,this.propValues),t.makeTree||((t,e,i)=>new a3(a0.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:o=1024,reused:r=[],minRepeatType:s=n.types.length}=t,a=Array.isArray(i)?new a4(i,i.length):i,l=n.types,h=0,c=0;function d(t,e,i,o,r,s,a,l,h){let c=[],d=[];for(;t.length>o;)c.push(t.pop()),d.push(e.pop()+i-r);t.push(u(n.types[a],c,d,s-r,l-s,h)),e.push(r-i)}function u(t,e,i,n,o,r,s){if(r){let t=[aK.contextHash,r];s=s?[t].concat(s):[t]}if(o>25){let t=[aK.lookAhead,o];s=s?[t].concat(s):[t]}return new a3(t,e,i,n,s)}let f=[],p=[];for(;a.pos>0;)!function t(e,i,f,p,g,m){let{id:v,start:y,end:b,size:w}=a,x=c,k=h;for(;w<0;){if(a.next(),-1==w){let t=r[v];f.push(t),p.push(y-e);return}if(-3==w){h=v;return}if(-4==w){c=v;return}throw RangeError(`Unrecognized record size: ${w}`)}let O=l[v],S,_,C=y-e;if(b-y<=o&&(_=function(t,e){let i=a.fork(),n=0,r=0,l=0,h=i.end-o,c={size:0,start:0,skip:0};i:for(let o=i.pos-t;i.pos>o;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=r,c.skip=l,l+=4,n+=4,i.next();continue}let a=i.pos-t;if(t<0||a<o||i.start<h)break;let d=i.id>=s?4:0,u=i.start;for(i.next();i.pos>a;){if(i.size<0){if(-3==i.size)d+=4;else break i}else i.id>=s&&(d+=4);i.next()}r=u,n+=t,l+=d}return(e<0||n==t)&&(c.size=n,c.start=r,c.skip=l),c.size>4?c:void 0}(a.pos-i,g))){let t=new Uint16Array(_.size-_.skip),i=a.pos-_.size,o=t.length;for(;a.pos>i;)o=function t(e,i,n){let{id:o,start:r,end:l,size:d}=a;if(a.next(),d>=0&&o<s){let s=n;if(d>4){let o=a.pos-(d-4);for(;a.pos>o;)n=t(e,i,n)}i[--n]=s,i[--n]=l-e,i[--n]=r-e,i[--n]=o}else -3==d?h=o:-4==d&&(c=o);return n}(_.start,t,o);S=new a8(t,b-_.start,n),C=_.start-e}else{let e=a.pos-w;a.next();let i=[],r=[],l=v>=s?v:-1,h=0,c=b;for(;a.pos>e;)l>=0&&a.id==l&&a.size>=0?(a.end<=c-o&&(d(i,r,y,h,a.end,c,l,x,k),h=i.length,c=a.end),a.next()):m>2500?function(t,e,i,r){let s=[],l=0,h=-1;for(;a.pos>e;){let{id:t,start:e,end:i,size:n}=a;if(n>4)a.next();else if(h>-1&&e<h)break;else h<0&&(h=i-o),s.push(t,e,i),l++,a.next()}if(l){let e=new Uint16Array(4*l),o=s[s.length-2];for(let t=s.length-3,i=0;t>=0;t-=3)e[i++]=s[t],e[i++]=s[t+1]-o,e[i++]=s[t+2]-o,e[i++]=i;i.push(new a8(e,s[2]-o,n)),r.push(o-t)}}(y,e,i,r):t(y,e,i,r,l,m+1);if(l>=0&&h>0&&h<i.length&&d(i,r,y,h,y,c,l,x,k),i.reverse(),r.reverse(),l>-1&&h>0){let t=function(t,e){return(i,n,o)=>{let r=0,s=i.length-1,a,l;if(s>=0&&(a=i[s])instanceof a3){if(!s&&a.type==t&&a.length==o)return a;(l=a.prop(aK.lookAhead))&&(r=n[s]+a.length+l)}return u(t,i,n,o,r,e)}}(O,k);S=ld(O,i,r,0,i.length,0,b-y,t,t)}else S=u(O,i,r,b-y,x-b,k)}f.push(S),p.push(C)}(t.start||0,t.bufferStart||0,f,p,-1,0);let g=null!==(e=t.length)&&void 0!==e?e:f.length?p[0]+f[0].length:0;return new a3(l[t.topID],f.reverse(),p.reverse(),g)}(t)}}a3.empty=new a3(a0.none,[],[],0);class a4{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new a4(this.buffer,this.index)}}class a8{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return a0.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],o=n.name;if(/\W/.test(o)&&!n.isError&&(o=JSON.stringify(o)),i==(t+=4))return o;let r=[];for(;t<i;)r.push(this.childString(t)),t=this.buffer[t+3];return o+"("+r.join(",")+")"}findChild(t,e,i,n,o){let{buffer:r}=this,s=-1;for(let a=t;a!=e&&(!a6(o,n,r[a+1],r[a+2])||(s=a,!(i>0)));a=r[a+3]);return s}slice(t,e,i){let n=this.buffer,o=new Uint16Array(e-t),r=0;for(let s=t,a=0;s<e;){o[a++]=n[s++],o[a++]=n[s++]-i;let e=o[a++]=n[s++]-i;o[a++]=n[s++]-t,r=Math.max(r,e)}return new a8(o,r,this.set)}}function a6(t,e,i,n){switch(t){case -2:return i<e;case -1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function a9(t,e,i,n){for(var o;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof lt&&t.index<0?null:t.parent;if(!e)return t;t=e}let r=n?0:u.IgnoreOverlays;if(n)for(let n=t,s=n.parent;s;s=(n=s).parent)n instanceof lt&&n.index<0&&(null===(o=s.enter(e,i,r))||void 0===o?void 0:o.from)!=n.from&&(t=s);for(;;){let n=t.enter(e,i,r);if(!n)return t;t=n}}class a7{cursor(t=0){return new la(this,t)}getChild(t,e=null,i=null){let n=le(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return le(this,t,e,i)}resolve(t,e=0){return a9(this,t,e,!1)}resolveInner(t,e=0){return a9(this,t,e,!0)}matchContext(t){return li(this.parent,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),i=this;for(;e;){let t=e.lastChild;if(!t||t.to!=e.to)break;t.type.isError&&t.from==t.to?(i=e,e=t.prevSibling):e=t}return i}get node(){return this}get next(){return this.parent}}class lt extends a7{constructor(t,e,i,n){super(),this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,o=0){for(let r=this;;){for(let{children:s,positions:a}=r._tree,l=e>0?s.length:-1;t!=l;t+=e){let l=s[t],h=a[t]+r.from;if(a6(n,i,h,h+l.length)){if(l instanceof a8){if(o&u.ExcludeBuffers)continue;let s=l.findChild(0,l.buffer.length,e,i-h,n);if(s>-1)return new lo(new ln(r,l,t,h),null,s)}else if(o&u.IncludeAnonymous||!l.type.isAnonymous||ll(l)){let s;if(!(o&u.IgnoreMounts)&&(s=aZ.get(l))&&!s.overlay)return new lt(s.tree,h,t,r);let a=new lt(l,h,t,r);return o&u.IncludeAnonymous||!a.type.isAnonymous?a:a.nextChild(e<0?l.children.length-1:0,e,i,n)}}}if(o&u.IncludeAnonymous||!r.type.isAnonymous||(t=r.index>=0?r.index+e:e<0?-1:r._parent._tree.children.length,!(r=r._parent)))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&u.IgnoreOverlays)&&(n=aZ.get(this._tree))&&n.overlay){let i=t-this.from;for(let{from:t,to:o}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?o>=i:o>i))return new lt(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function le(t,e,i,n){let o=t.cursor(),r=[];if(!o.firstChild())return r;if(null!=i){for(let t=!1;!t;)if(t=o.type.is(i),!o.nextSibling())return r}for(;;){if(null!=n&&o.type.is(n))return r;if(o.type.is(e)&&r.push(o.node),!o.nextSibling())return null==n?r:[]}}function li(t,e,i=e.length-1){for(let n=t;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class ln{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class lo extends a7{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){super(),this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:n}=this.context,o=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return o<0?null:new lo(this.context,this,o)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&u.ExcludeBuffers)return null;let{buffer:n}=this.context,o=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return o<0?null:new lo(this.context,this,o)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new lo(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new lo(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,o=i.buffer[this.index+3];if(o>n){let r=i.buffer[this.index+1];t.push(i.slice(n,o,r)),e.push(0)}return new a3(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function lr(t){if(!t.length)return null;let e=0,i=t[0];for(let n=1;n<t.length;n++){let o=t[n];(o.from>i.from||o.to<i.to)&&(i=o,e=n)}let n=i instanceof lt&&i.index<0?null:i.parent,o=t.slice();return n?o[e]=n:o.splice(e,1),new ls(o,i)}class ls{constructor(t,e){this.heads=t,this.node=e}get next(){return lr(this.heads)}}class la{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof lt)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof lt?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,o=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(o<0)&&(this.stack.push(this.index),this.yieldBuf(o))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&u.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&u.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&u.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;{index:e,_parent:i}=i)if(e>-1)for(let n=e+t,o=t<0?-1:i._tree.children.length;n!=o;n+=t){let t=i._tree.children[n];if(this.mode&u.IncludeAnonymous||t instanceof a8||!t.type.isAnonymous||ll(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)i:for(let n=this.index,o=this.stack.length;o>=0;){for(let r=t;r;r=r._parent)if(r.index==n){if(n==this.index)return r;e=r,i=o+1;break i}n=this.stack[--o]}for(let t=i;t<this.stack.length;t++)e=new lo(this.buffer,e,this.stack[t]);return this.bufferNode=new lo(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&e&&e(this),n=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return li(this.node.parent,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,o=this.stack.length-1;n>=0;o--){if(o<0)return li(this._tree,t,n);let r=i[e.buffer[this.stack[o]]];if(!r.isAnonymous){if(t[n]&&t[n]!=r.name)return!1;n--}}return!0}}function ll(t){return t.children.some(t=>t instanceof a8||!t.type.isAnonymous||ll(t))}const lh=new WeakMap;function lc(t,e){if(!t.isAnonymous||e instanceof a8||e.type!=t)return 1;let i=lh.get(e);if(null==i){for(let n of(i=1,e.children)){if(n.type!=t||!(n instanceof a3)){i=1;break}i+=lc(t,n)}lh.set(e,i)}return i}function ld(t,e,i,n,o,r,s,a,l){let h=0;for(let i=n;i<o;i++)h+=lc(t,e[i]);let c=Math.ceil(1.5*h/8),d=[],u=[];return!function e(i,n,o,s,a){for(let h=o;h<s;){let o=h,f=n[h],p=lc(t,i[h]);for(h++;h<s;h++){let e=lc(t,i[h]);if(p+e>=c)break;p+=e}if(h==o+1){if(p>c){let t=i[o];e(t.children,t.positions,0,t.children.length,n[o]+a);continue}d.push(i[o])}else{let e=n[h-1]+i[h-1].length-f;d.push(ld(t,i,n,o,h,f,e,null,l))}u.push(f+a-r)}}(e,i,n,o,0),(a||l)(d,u,s)}class lu{constructor(t,e,i,n,o=!1,r=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(o?1:0)|(r?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new lu(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],o=1,r=t.length?t[0]:null;for(let s=0,a=0,l=0;;s++){let h=s<e.length?e[s]:null,c=h?h.fromA:1e9;if(c-a>=i)for(;r&&r.from<c;){let e=r;if(a>=e.from||c<=e.to||l){let t=Math.max(e.from,a)-l,i=Math.min(e.to,c)-l;e=t>=i?null:new lu(t,i,e.tree,e.offset+l,s>0,!!h)}if(e&&n.push(e),r.to>c)break;r=o<t.length?t[o++]:null}if(!h)break;a=h.toA,l=h.toA-h.toB}return n}}class lf{startParse(t,e,i){return"string"==typeof t&&(t=new lp(t)),i=i?i.length?i.map(t=>new aX(t.from,t.to)):[new aX(0,0)]:[new aX(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}class lp{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new aK({perNode:!0});var lg={},lm=lg={};function lv(){throw Error("setTimeout has not been defined")}function ly(){throw Error("clearTimeout has not been defined")}function lb(t){if(f===setTimeout)return setTimeout(t,0);if((f===lv||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}!function(){try{f="function"==typeof setTimeout?setTimeout:lv}catch(t){f=lv}try{p="function"==typeof clearTimeout?clearTimeout:ly}catch(t){p=ly}}();var lw=[],lx=!1,lk=-1;function lO(){lx&&g&&(lx=!1,g.length?lw=g.concat(lw):lk=-1,lw.length&&lS())}function lS(){if(!lx){var t=lb(lO);lx=!0;for(var e=lw.length;e;){for(g=lw,lw=[];++lk<e;)g&&g[lk].run();lk=-1,e=lw.length}g=null,lx=!1,function(t){if(p===clearTimeout)return clearTimeout(t);if((p===ly||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}(t)}}function l_(t,e){this.fun=t,this.array=e}function lC(){}lm.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];lw.push(new l_(t,e)),1!==lw.length||lx||lb(lS)},l_.prototype.run=function(){this.fun.apply(null,this.array)},lm.title="browser",lm.browser=!0,lm.env={},lm.argv=[],lm.version="",lm.versions={},lm.on=lC,lm.addListener=lC,lm.once=lC,lm.off=lC,lm.removeListener=lC,lm.removeAllListeners=lC,lm.emit=lC,lm.prependListener=lC,lm.prependOnceListener=lC,lm.listeners=function(t){return[]},lm.binding=function(t){throw Error("process.binding is not supported")},lm.cwd=function(){return"/"},lm.chdir=function(t){throw Error("process.chdir is not supported")},lm.umask=function(){return 0};class lE{constructor(t,e,i,n,o,r,s,a,l,h=0,c){this.p=t,this.stack=e,this.state=i,this.reducePos=n,this.pos=o,this.score=r,this.buffer=s,this.bufferBase=a,this.curContext=l,this.lookAhead=h,this.parent=c}toString(){return`[${this.stack.filter((t,e)=>e%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let n=t.parser.context;return new lE(t,[],e,i,i,0,[],0,n?new lM(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let i=t>>19,n=65535&t,{parser:o}=this.p,r=this.reducePos<this.pos-25;r&&this.setLookAhead(this.pos);let s=o.dynamicPrecedence(n);if(s&&(this.score+=s),0==i){this.pushState(o.getGoto(this.state,n,!0),this.reducePos),n<o.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,r?8:4,!0),this.reduceContext(n,this.reducePos);return}let a=this.stack.length-(i-1)*3-(262144&t?6:0),l=a?this.stack[a-2]:this.p.ranges[0].from,h=this.reducePos-l;h>=2e3&&!(null===(e=this.p.parser.nodeSet.types[n])||void 0===e?void 0:e.isAnonymous)&&(l==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=l,this.p.lastBigReductionSize=h));let c=a?this.stack[a-1]:0,d=this.bufferBase+this.buffer.length-c;if(n<o.minRepeatTerm||131072&t){let t=o.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,l,t,d+4,!0)}if(262144&t)this.state=this.stack[a];else{let t=this.stack[a-3];this.state=o.getGoto(t,n,!0)}for(;this.stack.length>a;)this.stack.pop();this.reduceContext(n,l)}storeNode(t,e,i,n=4,o=!1){if(0==t&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let t=this,n=this.buffer.length;if(0==n&&t.parent&&(n=t.bufferBase-t.parent.bufferBase,t=t.parent),n>0&&0==t.buffer[n-4]&&t.buffer[n-1]>-1){if(e==i)return;if(t.buffer[n-2]>=e){t.buffer[n-2]=i;return}}}if(o&&this.pos!=i){let o=this.buffer.length;if(o>0&&0!=this.buffer[o-4]){let t=!1;for(let e=o;e>0&&this.buffer[e-2]>i;e-=4)if(this.buffer[e-1]>=0){t=!0;break}if(t)for(;o>0&&this.buffer[o-2]>i;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,n>4&&(n-=4)}this.buffer[o]=t,this.buffer[o+1]=e,this.buffer[o+2]=i,this.buffer[o+3]=n}else this.buffer.push(t,e,i,n)}shift(t,e,i,n){if(131072&t)this.pushState(65535&t,this.pos);else if((262144&t)==0){let{parser:o}=this.p;(n>this.pos||e<=o.maxNode)&&(this.pos=n,o.stateFlag(t,1)||(this.reducePos=n)),this.pushState(t,i),this.shiftContext(e,i),e<=o.maxNode&&this.buffer.push(e,i,n,4)}else this.pos=n,this.shiftContext(e,i),e<=this.p.parser.maxNode&&this.buffer.push(e,i,n,4)}apply(t,e,i,n){65536&t?this.reduce(t):this.shift(t,e,i,n)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new lE(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new lP(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(0==i)return!1;if((65536&i)==0)return!0;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let i=[];for(let n=0,o;n<e.length;n+=2)(o=e[n+1])!=this.state&&this.p.parser.hasAction(o,t)&&i.push(e[n],o);if(this.stack.length<120)for(let t=0;i.length<8&&t<e.length;t+=2){let n=e[t+1];i.some((t,e)=>1&e&&t==n)||i.push(e[t],n)}e=i}let i=[];for(let t=0;t<e.length&&i.length<4;t+=2){let n=e[t+1];if(n==this.state)continue;let o=this.split();o.pushState(n,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(e[t],this.pos),o.reducePos=this.pos,o.score-=200,i.push(o)}return i}forceReduce(){let{parser:t}=this.p,e=t.stateSlot(this.state,5);if((65536&e)==0)return!1;if(!t.validAction(this.state,e)){let i=e>>19,n=65535&e,o=this.stack.length-3*i;if(o<0||0>t.getGoto(this.stack[o],n,!1)){let t=this.findForcedReduction();if(null==t)return!1;e=t}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}findForcedReduction(){let{parser:t}=this.p,e=[],i=(n,o)=>{if(!e.includes(n))return e.push(n),t.allActions(n,e=>{if(393216&e);else if(65536&e){let i=(e>>19)-o;if(i>1){let n=65535&e,o=this.stack.length-3*i;if(o>=0&&t.getGoto(this.stack[o],n,!1)>=0)return i<<19|65536|n}}else{let t=i(e,o+1);if(null!=t)return t}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:t}=this.p;return 65535==t.data[t.stateSlot(this.state,1)]&&!t.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||-3!=this.buffer[t])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||-4!=this.buffer[t])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new lM(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class lM{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}class lP{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=t>>19;0==e?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(e-1)*3;let i=this.start.p.parser.getGoto(this.stack[this.base-3],65535&t,!0);this.state=i}}class lT{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,0==this.index&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new lT(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;null!=t&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new lT(this.stack,this.pos,this.index)}}function lA(t,e=Uint16Array){if("string"!=typeof t)return t;let i=null;for(let n=0,o=0;n<t.length;){let r=0;for(;;){let e=t.charCodeAt(n++),i=!1;if(126==e){r=65535;break}e>=92&&e--,e>=34&&e--;let o=e-32;if(o>=46&&(o-=46,i=!0),r+=o,i)break;r*=46}i?i[o++]=r:i=new e(r)}return i}class lD{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const lI=new lD;class lB{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=lI,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,n=this.rangeIndex,o=this.pos+t;for(;o<i.from;){if(!n)return null;let t=this.ranges[--n];o-=i.from-t.to,i=t}for(;e<0?o>i.to:o>=i.to;){if(n==this.ranges.length-1)return null;let t=this.ranges[++n];o+=t.from-i.to,i=t}return o}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e=this.chunkOff+t,i,n;if(e>=0&&e<this.chunk.length)i=this.pos+t,n=this.chunk.charCodeAt(e);else{let e=this.resolveOffset(t,1);if(null==e)return -1;if((i=e)>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let t=this.rangeIndex,e=this.range;for(;e.to<=i;)e=this.ranges[++t];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>e.to&&(this.chunk2=this.chunk2.slice(0,e.to-i)),n=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),n}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(null==i||i<this.token.start)throw RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}acceptTokenTo(t,e){this.token.value=t,this.token.end=e}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=lI,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(i+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return i}}class lz{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:i}=e.p;lN(this.data,t,e,this.id,i.data,i.tokenPrecTable)}}lz.prototype.contextual=lz.prototype.fallback=lz.prototype.extend=!1;class lR{constructor(t,e,i){this.precTable=e,this.elseToken=i,this.data="string"==typeof t?lA(t):t}token(t,e){let i=t.pos,n=0;for(;;){let i=t.next<0,o=t.resolveOffset(1,1);if(lN(this.data,t,e,0,this.data,this.precTable),t.token.value>-1)break;if(null==this.elseToken)return;if(!i&&n++,null==o)break;t.reset(o,t.token)}n&&(t.reset(i,t.token),t.acceptToken(this.elseToken,n))}}function lN(t,e,i,n,o,r){let s=0,a=1<<n,{dialect:l}=i.p.parser;i:for(;(a&t[s])!=0;){let i=t[s+1];for(let n=s+3;n<i;n+=2)if((t[n+1]&a)>0){let i=t[n];if(l.allows(i)&&(-1==e.token.value||e.token.value==i||function(t,e,i,n){let o=lL(i,n,e);return o<0||lL(i,n,t)<o}(i,e.token.value,o,r))){e.acceptToken(i);break}}let n=e.next,h=0,c=t[s+2];if(e.next<0&&c>h&&65535==t[i+3*c-3]){s=t[i+3*c-1];continue}for(;h<c;){let o=h+c>>1,r=i+o+(o<<1),a=t[r],l=t[r+1]||65536;if(n<a)c=o;else if(n>=l)h=o+1;else{s=t[r+2],e.advance();continue i}}break}}function lL(t,e,i){for(let n=e,o;65535!=(o=t[n]);n++)if(o==i)return n-e;return -1}lR.prototype.contextual=lz.prototype.fallback=lz.prototype.extend=!1;const lF=void 0!==lg&&lg.env&&/\bparse\b/.test(void 0);let lj=null;function lH(t,e,i){let n=t.cursor(u.IncludeAnonymous);for(n.moveTo(e);;)if(!(i<0?n.childBefore(e):n.childAfter(e)))for(;;){if((i<0?n.to<e:n.from>e)&&!n.type.isError)return i<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(t.length,Math.max(n.from+1,e+25));if(i<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return i<0?0:t.length}}class lW{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?lH(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?lH(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],n=this.index[e];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let o=i.children[n],r=this.start[e]+i.positions[n];if(r>t)return this.nextStart=r,null;if(o instanceof a3){if(r==t){if(r<this.safeFrom)return null;let t=r+o.length;if(t<=this.safeTo){let e=o.prop(aK.lookAhead);if(!e||t+e<this.fragment.to)return o}}this.index[e]++,r+o.length>=Math.max(this.safeFrom,t)&&(this.trees.push(o),this.start.push(r),this.index.push(0))}else this.index[e]++,this.nextStart=r+o.length}}}class lV{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map(t=>new lD)}getActions(t){let e=0,i=null,{parser:n}=t.p,{tokenizers:o}=n,r=n.stateSlot(t.state,3),s=t.curContext?t.curContext.hash:0,a=0;for(let n=0;n<o.length;n++){if((1<<n&r)==0)continue;let l=o[n],h=this.tokens[n];if((!i||l.fallback)&&((l.contextual||h.start!=t.pos||h.mask!=r||h.context!=s)&&(this.updateCachedToken(h,l,t),h.mask=r,h.context=s),h.lookAhead>h.end+25&&(a=Math.max(h.lookAhead,a)),0!=h.value)){let n=e;if(h.extended>-1&&(e=this.addActions(t,h.extended,h.end,e)),e=this.addActions(t,h.value,h.end,e),!l.extend&&(i=h,e>n))break}}for(;this.actions.length>e;)this.actions.pop();return a&&t.setLookAhead(a),i||t.pos!=this.stream.end||((i=new lD).value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new lD,{pos:i,p:n}=t;return e.start=i,e.end=Math.min(i+1,n.stream.end),e.value=i==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,i){let n=this.stream.clipPos(i.pos);if(e.token(this.stream.reset(n,t),i),t.value>-1){let{parser:e}=i.p;for(let n=0;n<e.specialized.length;n++)if(e.specialized[n]==t.value){let o=e.specializers[n](this.stream.read(t.start,t.end),i);if(o>=0&&i.p.parser.dialect.allows(o>>1)){(1&o)==0?t.value=o>>1:t.extended=o>>1;break}}}else t.value=0,t.end=this.stream.clipPos(n+1)}putAction(t,e,i,n){for(let e=0;e<n;e+=3)if(this.actions[e]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=i,n}addActions(t,e,i,n){let{state:o}=t,{parser:r}=t.p,{data:s}=r;for(let t=0;t<2;t++)for(let a=r.stateSlot(o,t?2:1);;a+=3){if(65535==s[a]){if(1==s[a+1])a=lY(s,a+2);else{0==n&&2==s[a+1]&&(n=this.putAction(lY(s,a+2),e,i,n));break}}s[a]==e&&(n=this.putAction(lY(s,a+1),e,i,n))}return n}}class lQ{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new lB(e,n),this.tokens=new lV(t,this.stream),this.topTerm=t.top[1];let{from:o}=n[0];this.stacks=[lE.start(this,t.top[0],o)],this.fragments=i.length&&this.stream.end-o>4*t.bufferLength?new lW(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t,e,i=this.stacks,n=this.minStackPos,o=this.stacks=[];if(this.bigReductionCount>300&&1==i.length){let[t]=i;for(;t.forceReduce()&&t.stack.length&&t.stack[t.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let r=0;r<i.length;r++){let s=i[r];for(;;){if(this.tokens.mainToken=null,s.pos>n)o.push(s);else{if(this.advanceStack(s,o,i))continue;t||(t=[],e=[]),t.push(s);let n=this.tokens.getMainToken(s);e.push(n.value,n.end)}break}}if(!o.length){let e=t&&function(t){let e=null;for(let i of t){let t=i.p.stoppedAt;(i.pos==i.p.stream.end||null!=t&&i.pos>t)&&i.p.parser.stateFlag(i.state,2)&&(!e||e.score<i.score)&&(e=i)}return e}(t);if(e)return lF&&console.log("Finish with "+this.stackID(e)),this.stackToTree(e);if(this.parser.strict)throw lF&&t&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),SyntaxError("No parse at "+n);this.recovering||(this.recovering=5)}if(this.recovering&&t){let i=null!=this.stoppedAt&&t[0].pos>this.stoppedAt?t[0]:this.runRecovery(t,e,o);if(i)return lF&&console.log("Force-finish "+this.stackID(i)),this.stackToTree(i.forceAll())}if(this.recovering){let t=1==this.recovering?1:3*this.recovering;if(o.length>t)for(o.sort((t,e)=>e.score-t.score);o.length>t;)o.pop();o.some(t=>t.reducePos>n)&&this.recovering--}else if(o.length>1){n:for(let t=0;t<o.length-1;t++){let e=o[t];for(let i=t+1;i<o.length;i++){let n=o[i];if(e.sameState(n)||e.buffer.length>500&&n.buffer.length>500){if((e.score-n.score||e.buffer.length-n.buffer.length)>0)o.splice(i--,1);else{o.splice(t--,1);continue n}}}}o.length>12&&o.splice(12,o.length-12)}this.minStackPos=o[0].pos;for(let t=1;t<o.length;t++)o[t].pos<this.minStackPos&&(this.minStackPos=o[t].pos);return null}stopAt(t){if(null!=this.stoppedAt&&this.stoppedAt<t)throw RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let n=t.pos,{parser:o}=this,r=lF?this.stackID(t)+" -> ":"";if(null!=this.stoppedAt&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let e=t.curContext&&t.curContext.tracker.strict,i=e?t.curContext.hash:0;for(let s=this.fragments.nodeAt(n);s;){let n=this.parser.nodeSet.types[s.type.id]==s.type?o.getGoto(t.state,s.type.id):-1;if(n>-1&&s.length&&(!e||(s.prop(aK.contextHash)||0)==i))return t.useNode(s,n),lF&&console.log(r+this.stackID(t)+` (via reuse of ${o.getName(s.type.id)})`),!0;if(!(s instanceof a3)||0==s.children.length||s.positions[0]>0)break;let a=s.children[0];if(a instanceof a3&&0==s.positions[0])s=a;else break}}let s=o.stateSlot(t.state,4);if(s>0)return t.reduce(s),lF&&console.log(r+this.stackID(t)+` (via always-reduce ${o.getName(65535&s)})`),!0;if(t.stack.length>=8400)for(;t.stack.length>6e3&&t.forceReduce(););let a=this.tokens.getActions(t);for(let s=0;s<a.length;){let l=a[s++],h=a[s++],c=a[s++],d=s==a.length||!i,u=d?t:t.split(),f=this.tokens.mainToken;if(u.apply(l,h,f?f.start:u.pos,c),lF&&console.log(r+this.stackID(u)+` (via ${(65536&l)==0?"shift":`reduce of ${o.getName(65535&l)}`} for ${o.getName(h)} @ ${n}${u==t?"":", split"})`),d)return!0;u.pos>n?e.push(u):i.push(u)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return l$(t,e),!0}}runRecovery(t,e,i){let n=null,o=!1;for(let r=0;r<t.length;r++){let s=t[r],a=e[r<<1],l=e[(r<<1)+1],h=lF?this.stackID(s)+" -> ":"";if(s.deadEnd&&(o||(o=!0,s.restart(),lF&&console.log(h+this.stackID(s)+" (restarted)"),this.advanceFully(s,i))))continue;let c=s.split(),d=h;for(let t=0;c.forceReduce()&&t<10&&(lF&&console.log(d+this.stackID(c)+" (via force-reduce)"),!this.advanceFully(c,i));t++)lF&&(d=this.stackID(c)+" -> ");for(let t of s.recoverByInsert(a))lF&&console.log(h+this.stackID(t)+" (via recover-insert)"),this.advanceFully(t,i);this.stream.end>s.pos?(l==s.pos&&(l++,a=0),s.recoverByDelete(a,l),lF&&console.log(h+this.stackID(s)+` (via recover-delete ${this.parser.getName(a)})`),l$(s,i)):(!n||n.score<s.score)&&(n=s)}return n}stackToTree(t){return t.close(),a3.build({buffer:lT.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(lj||(lj=new WeakMap)).get(t);return e||lj.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function l$(t,e){for(let i=0;i<e.length;i++){let n=e[i];if(n.pos==t.pos&&n.sameState(t)){e[i].score<t.score&&(e[i]=t);return}}e.push(t)}class lq{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||0==this.disabled[t]}}class lU extends lf{constructor(t){if(super(),this.wrappers=[],14!=t.version)throw RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let i=0;i<t.repeatNodeCount;i++)e.push("");let i=Object.keys(t.topRules).map(e=>t.topRules[e][1]),n=[];for(let t=0;t<e.length;t++)n.push([]);function o(t,e,i){n[t].push([e,e.deserialize(String(i))])}if(t.nodeProps)for(let e of t.nodeProps){let t=e[0];"string"==typeof t&&(t=aK[t]);for(let i=1;i<e.length;){let n=e[i++];if(n>=0)o(n,t,e[i++]);else{let r=e[i+-n];for(let s=-n;s>0;s--)o(e[i++],t,r);i++}}}this.nodeSet=new a1(e.map((e,o)=>a0.define({name:o>=this.minRepeatTerm?void 0:e,id:o,props:n[o],top:i.indexOf(o)>-1,error:0==o,skipped:t.skippedNodes&&t.skippedNodes.indexOf(o)>-1}))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=1024;let r=lA(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let t=0;t<this.specializerSpecs.length;t++)this.specialized[t]=this.specializerSpecs[t].term;this.specializers=this.specializerSpecs.map(lG),this.states=lA(t.states,Uint32Array),this.data=lA(t.stateData),this.goto=lA(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map(t=>"number"==typeof t?new lz(r,t):t),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let n=new lQ(this,t,e,i);for(let o of this.wrappers)n=o(n,t,e,i);return n}getGoto(t,e,i=!1){let n=this.goto;if(e>=n[0])return -1;for(let o=n[e+1];;){let e=n[o++],r=1&e,s=n[o++];if(r&&i)return s;for(let i=o+(e>>1);o<i;o++)if(n[o]==t)return s;if(r)return -1}}hasAction(t,e){let i=this.data;for(let n=0;n<2;n++)for(let o=this.stateSlot(t,n?2:1),r;;o+=3){if(65535==(r=i[o])){if(1==i[o+1])r=i[o=lY(i,o+2)];else if(2==i[o+1])return lY(i,o+2);else break}if(r==e||0==r)return lY(i,o+1)}return 0}stateSlot(t,e){return this.states[6*t+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){return!!this.allActions(t,t=>t==e||null)}allActions(t,e){let i=this.stateSlot(t,4),n=i?e(i):void 0;for(let i=this.stateSlot(t,1);null==n;i+=3){if(65535==this.data[i]){if(1==this.data[i+1])i=lY(this.data,i+2);else break}n=e(lY(this.data,i+1))}return n}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i]){if(1==this.data[i+1])i=lY(this.data,i+2);else break}if((1&this.data[i+2])==0){let t=this.data[i+1];e.some((e,i)=>1&i&&e==t)||e.push(this.data[i],t)}}return e}configure(t){let e=Object.assign(Object.create(lU.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map(e=>{let i=t.tokenizers.find(t=>t.from==e);return i?i.to:e})),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map((i,n)=>{let o=t.specializers.find(t=>t.from==i.external);if(!o)return i;let r=Object.assign(Object.assign({},i),{external:o.to});return e.specializers[n]=lG(r),r})),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),null!=t.strict&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),null!=t.bufferLength&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return null==e?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map(()=>!1);if(t)for(let n of t.split(" ")){let t=e.indexOf(n);t>=0&&(i[t]=!0)}let n=null;for(let t=0;t<e.length;t++)if(!i[t])for(let i=this.dialects[e[t]],o;65535!=(o=this.data[i++]);)(n||(n=new Uint8Array(this.maxTerm+1)))[o]=1;return new lq(t,i,n)}static deserialize(t){return new lU(t)}}function lY(t,e){return t[e]|t[e+1]<<16}function lG(t){if(t.external){let e=t.extend?1:0;return(i,n)=>t.external(i,n)<<1|e}return t.get}const lX={__proto__:null,shared:10,let:14,const:16,self:34,true:36,false:36,null:38,void:44,typeof:46,delete:48,main:76,channel:82,while:90,for:94,in:96,if:104,else:106,run:110,loop:120,atomic:124,send:128,wait:130,seq:134,first:136,receive:142,program:158,always:162},lK=lU.deserialize({version:14,states:":vQ`QPOOPnOPOOOOQO'#Ec'#EcOOQO'#ER'#ERQ`QPOOOsQPO'#C`OxQPO'#DRO}QPO'#D|O!VQPO'#EOP![OWO'#C^POOO)C@Q)C@QOOQO-E8P-E8PO!gQPO,58zO#vQPO'#EhOOQO,59m,59mOOQO'#Eo'#EoOOQO'#Df'#DfO#}QPO,5:hO%QQPO'#EtOOQO,5:j,5:jPOOO'#EQ'#EQP%XOWO,58xPOOO,58x,58xOOQO'#ES'#ESO%dQPO1G.fO${QPO'#EeOOQO1G.f1G.fO%oQQO'#CeO%wQQO'#ClOOQO'#Ck'#CkO!rQPO'#DkOOQO'#Dy'#DyO&PQPO'#DxO&UQQO'#DzOOQO'#Ei'#EiOOQO'#ET'#ETO&ZQPO,5;SOOQO,5;S,5;SO&bQPO'#DTO&gQPO'#DUO$SQPO'#DYO&bQPO'#D[O$SQPO'#DaO}QPO'#DdO!rQPO'#DiO&gQPO'#DmO&rQPO'#EqO'PQPO'#EiO'UQPO1G0SOOQO'#Ce'#CeOOQO'#Cl'#ClO$SQPO'#CqO$SQPO'#CwO'lQSO'#EYOOQO'#Eg'#EgO'sQPO,5;`OOQO,5;`,5;`POOO-E8O-E8OPOOO1G.d1G.dOOQO-E8Q-E8QOOQO7+$Q7+$QO'zQPO,5;POOQO,5:V,5:VO(VQPO'#DgOOQO,5:d,5:dO$SQPO,5:fOOQO-E8R-E8ROOQO1G0n1G0nO(aQPO,59oO(lQQO'#EjO(zQPO,59pO)SQSO,59tO)ZQPO,59vO)SQSO,59{O&PQPO,5:OOOQO,5:T,5:TO&PQPO,5:XO)`QSO'#DsO)jQSO'#DsO)rQPO'#DtO*QQPO'#DpOOQO,5;],5;]OOQO,5;T,5;TOxQPO7+%nO*VQSO,59]O*mQSO,59cO$SQPO,59fO$SQPO,59fO$SQPO,59fOOQO,5:t,5:tOOQO-E8W-E8WOOQO1G0z1G0zOOQO1G0k1G0kO$SQPO1G0kO*tQQO1G0kO*yQSO'#EpO$SQPO'#EpO+TQPO,5:RO+YQSO1G0QOOQO1G/Z1G/ZO$SQPO1G/ZO+aQQO1G/ZO&gQPO,5;UO+fQQO1G/[O+nQPO1G/[OOQO1G/`1G/`O$SQPO1G/bO+sQPO1G/gOOQO1G/j1G/jOOQO1G/s1G/sOOQO,5:_,5:_O!rQPO,5:_O-pQPO'#ErO-{QSO,5:`O.TQPO,5:`O.YQPO,5:[OOQO<<IY<<IYOOQO1G.}1G.}OOQO1G/Q1G/QO/UQSO1G/QO/]QSO1G/QO/dQSO7+&VO/kQPO7+&VO/sQPO'#EVO/zQPO,5;[O0SQSO,5;[OOQO1G/m1G/mO0^QSO7+$uO0eQPO7+$uOOQO1G0p1G0pO0mQPO'#ElO0uQPO7+$vO+fQQO7+$vO0zQSO'#D`OOQO'#D_'#D_OxQPO7+$|OxQPO7+%ROOQO1G/y1G/yOOQO'#Dv'#DvOOQO'#Es'#EsO1RQPO,5;^O1ZQPO1G/zO2_QSO1G/zOOQO'#EW'#EWO2gQPO1G/vOOQO1G/v1G/vOOQO<<Iq<<IqO$SQPO<<IqO2qQSO,5:qO$SQPO,5:qOOQO-E8T-E8TO2{QPO1G0vOOQO<<Ha<<HaO$SQPO<<HaO3TQQO'#EUO3YQPO,5;WO3bQPO<<HbO3pQPO<<HbO$SQPO,59zOOQO<<Hh<<HhOOQO<<Hm<<HmO-pQPO'#EXO3uQPO1G0xOOQO1G0x1G0xOOQO7+%f7+%fO1ZQPO7+%fOOQO-E8U-E8UOOQO7+%b7+%bO3}QSOAN?]O4UQSO1G0]O4`QSOAN={OOQO,5:p,5:pOOQO-E8S-E8SO4gQPOAN=|O&gQPOAN=|O4lQPOAN=|O4zQSO1G/fOOQO,5:s,5:sOOQO-E8V-E8VOOQO7+&d7+&dOOQO<<IQ<<IQOOQOG24wG24wOOQOG23gG23gOOQOG23hG23hO5RQPOG23hO&gQPOG23hO5WQSO1G/gOOQOLD)SLD)SO5cQPOLD)SOOQO!$'Ln!$'LnO)SQSO,59{O$SQPO'#DaO1ZQPO'#DiO1ZQPO'#DkO1ZQPO,5:_O5hQSO'#DsO5rQSO'#DsO&rQPO'#Eq",stateData:"6S~O#POS#QOSPOS#RPQ~OTTOvUO!qVO!sWO~O#RXO~OU[O~OU]O~O#W_O#Y_O~OUbO~O#SdO#TdO#UfO~OViOWiOtjO~OU]OVvOWvOamOinOywO}xO!PyO!UzO!X{O!^|O!`nO!b}O!c!OO#WlO#YkO~OtuO~P!rOl!QO~O]!WO^!WOamOb!WOc!WOd!WOf!TOg!TOh!TOi!TOj!TOl!UO#W!SO#Y!RO~Ot!YO~P$SO#SdO#TdO#U![O~OViOWiOt!^O~Ol#cX!oXX~Ol#cX!o`X~Ol!aO~O!o!cO~Ot!eO~P!rO#W!SO~OamO#W!SO#Y!RO~O!e!rO!f!rO!i!qO~P$SOs!tO~Om!uO~Oj!yOo!xOp!xOq!xOr!zO~Os!{O~P'ZOt!}O~P$SOY#QO[#POs#OO~O![#SOm#dP~P$SOY#XO[#WOs#VO~Oz#YOl#^X#_#^Xs#^X~Ol#ZO#_#[O~OU]O~P'ZO!Q#^O~Os#bO!k#cO~P'ZOs#bO!k#cO~OamOl#dO#W!SO#Y!RO~OU#gO~OseaUea!keamea{ea#bea~P'ZOm#iO~P'ZOZ#nO~O{#oOm#dX~P'ZOm#rO~Os!ni~P'ZOZ#tO~OZ#vOm#`P~Ol#xO~O!V#|OU!TiV!TiW!Tia!Tii!Tit!Tiy!Ti}!Ti!P!Ti!U!Ti!X!Ti!^!Ti!`!Ti!b!Ti!c!Ti#W!Ti#Y!Ti]!Ti^!Tib!Tic!Tid!Tif!Tig!Tih!Tij!Til!Ti!i!Ti~O]$OO^$OO#W!SO~O!k$ROs!ha~Ol#dO~Ot$VO!i!qO~P$SOo!xOp!xOq!xOrnisniUni!knimni{ni#bni~Ojni~P.dOj!yO~P.dOs$WO~P'ZO[$XOs$WO~O![$ZO~P$SO{#oOm#da~O{#oOm#da~P'ZOs$^O~P'ZO[$_Os$^O~O{$`Om#`X~Om$bO~O#b$dO~P'ZOm$iO{$gO~OU]OVvOWvOamOi%XOywO}xO!PyO!U%VO!X{O!^%WO!`%XO!b}O!c%]O#WlO#YkO~O!k$kOs!hi~Ot$mO!i!qO~P$SOm!ya{!ya~P'ZO{#oOm#di~OZ$qO~O{$`Om#`a~OamO#W!SO#Y!RO#a$tO~Om$uO~Om$yO{$gO~Os${O~P'ZOm!yi{!yi~P'ZOs$|O~P'ZOs$}O~OamO#W!SO#Y!RO#a%PO~OU!Si~P'ZOs%RO~O!V#|Os!Ti!k!Ti~Os%TO~Os#bO!k%YO~P'ZOs#bO!k%YO~O]z#RPdPo~",goto:".s#iPP#jP#mPPPP#qPPPPP$s%vPPPP'PPPPPP'PPP'PPPPPPP#mP'l'lPPP'lP'lPP'x'{'lPP(OP([(bP'lP'lP(OPP(kPP(o(wP&{P(O)P(OP#mP#mP)])c)i)o)u){*V*]*cPPPPPPPP*iP*mP*q,Y,{-cP-yPP.P.a'l.d.j.pRYPTQOS!xm]bntwxz|}!O!T!U!X!a!c!q!x!y!z#P#S#W#Y#^#c#g#o$R$U$X$Z$_$b$d$k$t$u%P%V%W%X%Y%]R!_idq]nt|#c$R$k%W%X%Y!S!Wbxz!O!T!U!X!a!c!x!y!z#P#S#W#^#g#o$U$X$Z$_$d%V%]a!gw}!q#Y$b$t$u%P!xm]bntwxz|}!O!T!U!X!a!c!q!x!y!z#P#S#W#Y#^#c#g#o$R$U$X$Z$_$b$d$k$t$u%P%V%W%X%Y%]Q!fvQ!jyT$P#d$g!T!Wbxz!O!T!U!X!a!c!x!y!z#P#S#W#^#g#o$U$X$Z$_$d%V%]er]nt|#c$R$k%W%X%YR#{#^R#z#^e!P]nt|#c$R$k%W%X%YQaVR!l{Q!bpQ#`!lR#a!nT!s!O%]S!s!O%]T$T#g$UU!p!O#g$UR%[%]ep]nt|#c$R$k%W%X%YQeXR!ZeQSORZSQh[R!]hQt]R!dtQ$a#vR$r$aQ#p#RS$[#p$]R$]#qQ$U#gR$l$UQ$h$QR$x$hQ!XbR!|!XTROSTg[hS!Vb!XQ!ixQ!kzU!o!O#g$UQ!v!TQ!w!UQ#R!aQ#U!cQ#j!xQ#k!yQ#l!zQ#m#PQ#q#SQ#s#WQ#y#^Q$Y#oQ$n$XQ$o$ZQ$p$_Q$v$dQ%U%VR%Z%]Q^Udr]nt|#c$R$k%W%X%YQ#]!iQ#_!kQ#h!uQ$e#{Q$f#|R%Q%USs]tS!`n%XS!m|%WS#}#c%YQ$j$RR$z$kQ!hwQ!n}Q#f!qQ#u#YQ$s$bS%O$t$uR%S%PQ#w#ZR$c#xS`V{eo]nt|#c$R$k%W%X%YR#T!aQ#e!qR$S#fQ$Q#dR$w$gRcW",nodeNames:"â  LineComment BlockComment Project GlobalBlock shared { let const SharedVariableName : Type = Number String Variable LocalVariableName self BooleanLiteral null RegExp UnaryExpression void typeof delete LogicOp ArithOp ParenthesizedExpression ( ) BinaryExpression ArithOp ArithOp ArithOp CompareOp ; } MainBlock main VariableDeclaration ChannelDeclarationStatement channel . , WhileStatement while ForStatement for in ListExpression RangeExpression IfStatement if else RunExpression run ProgName ArgList ... LoopStatement loop AtomicStatement atomic SendExpression send wait WaitingBlock seq first WaitingBlockCase ReceiveExpression receive Literal => CallExpression FnName AssignmentExpression UpdateOp ProgramBlock program ConditionBlock always",maxTerm:116,nodeProps:[["group",-9,13,14,15,18,19,20,21,27,30,"Expression"]],skippedNodes:[0,1,2,82],repeatNodeCount:9,tokenData:"@r~RuXY#fYZ#wZ[#f]^#wpq#fqr#|rs$Zuv&Rwx&`xy(Ryz(Wz{(]{|(e|}(m}!O(e!O!P(r!P!Q*b!Q!R/|!R![1S![!]3k!]!^3p!^!_3u!_!`3|!`!a4`!c!}4g#T#U5[#U#V6P#V#Y5[#Y#Z8}#Z#]5[#]#^;|#^#g5[#g#h<q#h#o5[#o#p@h#q#r@m$f$g#f~#kS#P~XY#fZ[#fpq#f$f$g#f~#|O#Q~Y$RPiQ!_!`$UW$ZOrW~$`W^~OY$ZZr$Zrs$xs#O$Z#O#P$}#P;'S$Z;'S;=`%{<%lO$Z~$}O^~~%QRO;'S$Z;'S;=`%Z;=`O$Z~%`X^~OY$ZZr$Zrs$xs#O$Z#O#P$}#P;'S$Z;'S;=`%{;=`<%l$Z<%lO$Z~&OP;=`<%l$Z[&WPpW!_!`&ZS&`O!oS~&eW^~OY&`Zw&`wx$xx#O&`#O#P&}#P;'S&`;'S;=`'{<%lO&`~'QRO;'S&`;'S;=`'Z;=`O&`~'`X^~OY&`Zw&`wx$xx#O&`#O#P&}#P;'S&`;'S;=`'{;=`<%l&`<%lO&`~(OP;=`<%l&`~(WOl~~(]Om~[(bPqW!_!`&Z^(jPjY!_!`&Z~(rO{~~(wQzS!O!P(}!Q![)[Y)SP#bW!O!P)VQ)[O![Q~)aS]~!Q![)[!g!h)m#R#S)[#X#Y)m~)pS{|)|}!O)|!Q![*V#R#S*V~*PQ!Q![*V#R#S*V~*[Q]~!Q![*V#R#S*V~*g]oWOY+`Zz+`z{-}{!P+`!P!Q.q!Q!_+`!_!`/Y!`!}+`!}#O,i#O#P-h#P;'S+`;'S;=`-w<%lO+`Q+eXdQOY+`Z!P+`!P!Q,Q!Q!}+`!}#O,i#O#P-h#P;'S+`;'S;=`-w<%lO+`Q,VUdQ#Z#[,Q#]#^,Q#a#b,Q#g#h,Q#i#j,Q#m#n,QQ,lVOY,iZ#O,i#O#P-R#P#Q+`#Q;'S,i;'S;=`-b<%lO,iQ-USOY,iZ;'S,i;'S;=`-b<%lO,iQ-eP;=`<%l,iQ-kSOY+`Z;'S+`;'S;=`-w<%lO+`Q-zP;=`<%l+`~.UX#R~dQOY+`Z!P+`!P!Q,Q!Q!}+`!}#O,i#O#P-h#P;'S+`;'S;=`-w<%lO+`~.vSP~OY.qZ;'S.q;'S;=`/S<%lO.q~/VP;=`<%l.qU/aX!oSdQOY+`Z!P+`!P!Q,Q!Q!}+`!}#O,i#O#P-h#P;'S+`;'S;=`-w<%lO+`~0RX]~!O!P0n!Q![1S!g!h)m#R#S1S#U#V1p#X#Y)m#b#c1k#c#d2_#l#m2v~0qQ!Q![0w#R#S0w~0|Q]~!g!h)m#X#Y)m~1XU]~!O!P0n!Q![1S!g!h)m#R#S1S#X#Y)m#b#c1k~1pO]~~1sR!Q!R1|!R!S1|#R#S1|~2RS]~!Q!R1|!R!S1|#R#S1|#b#c1k~2bQ!Q!Y2h#R#S2h~2mR]~!Q!Y2h#R#S2h#b#c1k~2yS!Q![3V!c!i3V#R#S3V#T#Z3V~3[T]~!Q![3V!c!i3V#R#S3V#T#Z3V#b#c1k~3pOY~~3uOs~^3|O#_UrW^4TQ[Q!oS!_!`$U!`!a4ZW4`O!kWY4gO#aQrW~4lW#Y~tu4g!Q![4g!c!}4g#R#S4g#T#o4g$g;'S4g;'S;=`5U<%lO4g~5XP;=`<%l4gY5aW#WYtu5[!Q![5[!c!}5[#R#S5[#T#o5[$g;'S5[;'S;=`5y<%lO5[Y5|P;=`<%l5[^6UY#WYtu5[!Q![5[!c!}5[#R#S5[#T#c5[#c#d6t#d#o5[$g;'S5[;'S;=`5y<%lO5[^6yY#WYtu5[!Q![5[!c!}5[#R#S5[#T#c5[#c#d7i#d#o5[$g;'S5[;'S;=`5y<%lO5[^7nY#WYtu5[!Q![5[!c!}5[#R#S5[#T#`5[#`#a8^#a#o5[$g;'S5[;'S;=`5y<%lO5[^8eWZS#WYtu5[!Q![5[!c!}5[#R#S5[#T#o5[$g;'S5[;'S;=`5y<%lO5[^9SY#WYtu5[!Q![5[!c!}5[#R#S5[#T#`5[#`#a9r#a#o5[$g;'S5[;'S;=`5y<%lO5[^9wY#WYtu5[!Q![5[!c!}5[#R#S5[#T#c5[#c#d:g#d#o5[$g;'S5[;'S;=`5y<%lO5[^:lX#WYtu5[!Q![5[!c!}5[#R#S5[#T#U;X#U#o5[$g;'S5[;'S;=`5y<%lO5[^;^Y#WYtu5[!Q![5[!c!}5[#R#S5[#T#h5[#h#i8^#i#o5[$g;'S5[;'S;=`5y<%lO5[^<RY#WYtu5[!Q![5[!c!}5[#R#S5[#T#b5[#b#c;X#c#o5[$g;'S5[;'S;=`5y<%lO5[^<vY#WYtu5[!Q![5[!c!}5[#R#S5[#T#h5[#h#i=f#i#o5[$g;'S5[;'S;=`5y<%lO5[^=kY#WYtu5[!Q![5[!c!}5[#R#S5[#T#f5[#f#g>Z#g#o5[$g;'S5[;'S;=`5y<%lO5[^>`Y#WYtu5[!Q![5[!c!}5[#R#S5[#T#]5[#]#^?O#^#o5[$g;'S5[;'S;=`5y<%lO5[^?TY#WYtu5[!Q![5[!c!}5[#R#S5[#T#b5[#b#c?s#c#o5[$g;'S5[;'S;=`5y<%lO5[^?xY#WYtu5[!Q![5[!c!}5[#R#S5[#T#Z5[#Z#[8^#[#o5[$g;'S5[;'S;=`5y<%lO5[~@mOU~~@rOt~",tokenizers:[1,2,3,new lR("j~RQYZXz{^~^O#T~~aP!P!Qd~iO#U~~",25,96)],topRules:{Project:[0,3]},specialized:[{term:100,get:t=>lX[t]||-1}],tokenPrec:962});let lZ=0;class lJ{constructor(t,e,i,n){this.name=t,this.set=e,this.base=i,this.modified=n,this.id=lZ++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){if(t instanceof lJ&&(e=t),null==e?void 0:e.base)throw Error("Can not derive from a modified tag");let i=new lJ("string"==typeof t?t:"?",[],null,[]);if(i.set.push(i),e)for(let t of e.set)i.set.push(t);return i}static defineModifier(t){let e=new l1(t);return t=>t.modified.indexOf(e)>-1?t:l1.get(t.base||t,t.modified.concat(e).sort((t,e)=>t.id-e.id))}}let l0=0;class l1{constructor(t){this.name=t,this.instances=[],this.id=l0++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find(i=>{var n;return i.base==t&&(n=i.modified,e.length==n.length&&e.every((t,e)=>t==n[e]))});if(i)return i;let n=[],o=new lJ(t.name,n,t,e);for(let t of e)t.instances.push(o);let r=function(t){let e=[[]];for(let i=0;i<t.length;i++)for(let n=0,o=e.length;n<o;n++)e.push(e[n].concat(t[i]));return e.sort((t,e)=>e.length-t.length)}(e);for(let e of t.set)if(!e.modified.length)for(let t of r)n.push(l1.get(e,t));return o}}function l2(t){let e=Object.create(null);for(let i in t){let n=t[i];for(let t of(Array.isArray(n)||(n=[n]),i.split(" ")))if(t){let i=[],o=2,r=t;for(let e=0;;){if("..."==r&&e>0&&e+3==t.length){o=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(r);if(!n)throw RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),(e+=n[0].length)==t.length)break;let s=t[e++];if(e==t.length&&"!"==s){o=0;break}if("/"!=s)throw RangeError("Invalid path: "+t);r=t.slice(e)}let s=i.length-1,a=i[s];if(!a)throw RangeError("Invalid path: "+t);let l=new l3(n,o,s>0?i.slice(0,s):null);e[a]=l.sort(e[a])}}return l5.add(e)}const l5=new aK;class l3{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}function l4(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:o=null}=e||{};return{style:t=>{let e=o;for(let n of t)for(let t of n.set){let n=i[t.id];if(n){e=e?e+" "+n:n;break}}return e},scope:n}}l3.empty=new l3([],2,null);class l8{constructor(t,e,i){this.at=t,this.highlighters=e,this.span=i,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,n,o){let{type:r,from:s,to:a}=t;if(s>=i||a<=e)return;r.isTop&&(o=this.highlighters.filter(t=>!t.scope||t.scope(r)));let l=n,h=function(t){let e=t.type.prop(l5);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}(t)||l3.empty,c=function(t,e){let i=null;for(let n of t){let t=n.style(e);t&&(i=i?i+" "+t:t)}return i}(o,h.tags);if(c&&(l&&(l+=" "),l+=c,1==h.mode&&(n+=(n?" ":"")+c)),this.startSpan(Math.max(e,s),l),h.opaque)return;let d=t.tree&&t.tree.prop(aK.mounted);if(d&&d.overlay){let r=t.node.enter(d.overlay[0].from+s,1),h=this.highlighters.filter(t=>!t.scope||t.scope(d.tree.type)),c=t.firstChild();for(let u=0,f=s;;u++){let p=u<d.overlay.length?d.overlay[u]:null,g=p?p.from+s:a,m=Math.max(e,f),v=Math.min(i,g);if(m<v&&c)for(;t.from<v&&(this.highlightRange(t,m,v,n,o),this.startSpan(Math.min(v,t.to),l),!(t.to>=g)&&t.nextSibling()););if(!p||g>i)break;(f=p.to+s)>e&&(this.highlightRange(r.cursor(),Math.max(e,p.from+s),Math.min(i,f),"",h),this.startSpan(Math.min(i,f),l))}c&&t.parent()}else if(t.firstChild()){d&&(n="");do{if(t.to<=e)continue;if(t.from>=i)break;this.highlightRange(t,e,i,n,o),this.startSpan(Math.min(i,t.to),l)}while(t.nextSibling())t.parent()}}}const l6=lJ.define,l9=l6(),l7=l6(),ht=l6(l7),he=l6(l7),hi=l6(),hn=l6(hi),ho=l6(hi),hr=l6(),hs=l6(hr),ha=l6(),hl=l6(),hh=l6(),hc=l6(hh),hd=l6(),hu={comment:l9,lineComment:l6(l9),blockComment:l6(l9),docComment:l6(l9),name:l7,variableName:l6(l7),typeName:ht,tagName:l6(ht),propertyName:he,attributeName:l6(he),className:l6(l7),labelName:l6(l7),namespace:l6(l7),macroName:l6(l7),literal:hi,string:hn,docString:l6(hn),character:l6(hn),attributeValue:l6(hn),number:ho,integer:l6(ho),float:l6(ho),bool:l6(hi),regexp:l6(hi),escape:l6(hi),color:l6(hi),url:l6(hi),keyword:ha,self:l6(ha),null:l6(ha),atom:l6(ha),unit:l6(ha),modifier:l6(ha),operatorKeyword:l6(ha),controlKeyword:l6(ha),definitionKeyword:l6(ha),moduleKeyword:l6(ha),operator:hl,derefOperator:l6(hl),arithmeticOperator:l6(hl),logicOperator:l6(hl),bitwiseOperator:l6(hl),compareOperator:l6(hl),updateOperator:l6(hl),definitionOperator:l6(hl),typeOperator:l6(hl),controlOperator:l6(hl),punctuation:hh,separator:l6(hh),bracket:hc,angleBracket:l6(hc),squareBracket:l6(hc),paren:l6(hc),brace:l6(hc),content:hr,heading:hs,heading1:l6(hs),heading2:l6(hs),heading3:l6(hs),heading4:l6(hs),heading5:l6(hs),heading6:l6(hs),contentSeparator:l6(hr),list:l6(hr),quote:l6(hr),emphasis:l6(hr),strong:l6(hr),link:l6(hr),monospace:l6(hr),strikethrough:l6(hr),inserted:l6(),deleted:l6(),changed:l6(),invalid:l6(),meta:hd,documentMeta:l6(hd),annotation:l6(hd),processingInstruction:l6(hd),definition:lJ.defineModifier("definition"),constant:lJ.defineModifier("constant"),function:lJ.defineModifier("function"),standard:lJ.defineModifier("standard"),local:lJ.defineModifier("local"),special:lJ.defineModifier("special")};for(let t in hu){let e=hu[t];e instanceof lJ&&(e.name=t)}l4([{tag:hu.link,class:"tok-link"},{tag:hu.heading,class:"tok-heading"},{tag:hu.emphasis,class:"tok-emphasis"},{tag:hu.strong,class:"tok-strong"},{tag:hu.keyword,class:"tok-keyword"},{tag:hu.atom,class:"tok-atom"},{tag:hu.bool,class:"tok-bool"},{tag:hu.url,class:"tok-url"},{tag:hu.labelName,class:"tok-labelName"},{tag:hu.inserted,class:"tok-inserted"},{tag:hu.deleted,class:"tok-deleted"},{tag:hu.literal,class:"tok-literal"},{tag:hu.string,class:"tok-string"},{tag:hu.number,class:"tok-number"},{tag:[hu.regexp,hu.escape,hu.special(hu.string)],class:"tok-string2"},{tag:hu.variableName,class:"tok-variableName"},{tag:hu.local(hu.variableName),class:"tok-variableName tok-local"},{tag:hu.definition(hu.variableName),class:"tok-variableName tok-definition"},{tag:hu.special(hu.variableName),class:"tok-variableName2"},{tag:hu.definition(hu.propertyName),class:"tok-propertyName tok-definition"},{tag:hu.typeName,class:"tok-typeName"},{tag:hu.namespace,class:"tok-namespace"},{tag:hu.className,class:"tok-className"},{tag:hu.macroName,class:"tok-macroName"},{tag:hu.propertyName,class:"tok-propertyName"},{tag:hu.operator,class:"tok-operator"},{tag:hu.comment,class:"tok-comment"},{tag:hu.meta,class:"tok-meta"},{tag:hu.invalid,class:"tok-invalid"},{tag:hu.punctuation,class:"tok-punctuation"}]);const hf=new aK,hp=new aK;class hg{constructor(t,e,i=[],n=""){this.data=t,this.name=n,i0.prototype.hasOwnProperty("tree")||Object.defineProperty(i0.prototype,"tree",{get(){return hy(this)}}),this.parser=e,this.extension=[hE.of(this),i0.languageData.of((t,e,i)=>{let n=hm(t,e,i),o=n.type.prop(hf);if(!o)return[];let r=t.facet(o),s=n.type.prop(hp);if(s){let o=n.resolve(e-n.from,i);for(let e of s)if(e.test(o,t)){let i=t.facet(e.facet);return"replace"==e.type?i:i.concat(r)}}return r})].concat(i)}isActiveAt(t,e,i=-1){return hm(t,e,i).type.prop(hf)==this.data}findRegions(t){let e=t.facet(hE);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(t,e)=>{if(t.prop(hf)==this.data){i.push({from:e,to:e+t.length});return}let o=t.prop(aK.mounted);if(o){if(o.tree.prop(hf)==this.data){if(o.overlay)for(let t of o.overlay)i.push({from:t.from+e,to:t.to+e});else i.push({from:e,to:e+t.length});return}if(o.overlay){let t=i.length;if(n(o.tree,o.overlay[0].from+e),i.length>t)return}}for(let i=0;i<t.children.length;i++){let o=t.children[i];o instanceof a3&&n(o,t.positions[i]+e)}};return n(hy(t),0),i}get allowsNesting(){return!0}}function hm(t,e,i){let n=t.facet(hE),o=hy(t).topNode;if(!n||n.allowsNesting)for(let t=o;t;t=t.enter(e,i,u.ExcludeBuffers))t.type.isTop&&(o=t);return o}hg.setState=iq.define();class hv extends hg{constructor(t,e,i){super(t,e,[],i),this.parser=e}static define(t){var e;let i=(e=t.languageData,iw.define({combine:e?t=>t.concat(e):void 0}));return new hv(i,t.parser.configure({props:[hf.add(t=>t.isTop?i:void 0)]}),t.name)}configure(t,e){return new hv(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function hy(t){let e=t.field(hg.state,!1);return e?e.tree:a3.empty}class hb{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let hw=null;class hx{constructor(t,e,i=[],n,o,r,s,a){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=o,this.viewport=r,this.skipped=s,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new hx(t,e,[],a3.empty,0,i,[],null)}startParse(){return this.parser.startParse(new hb(this.state.doc),this.fragments)}work(t,e){return(null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=a3.empty&&this.isDone(null!=e?e:this.state.doc.length))?(this.takeTree(),!0):this.withContext(()=>{var i;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(lu.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(lu.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=hw;hw=this;try{return t()}finally{hw=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=hk(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:o,viewport:r,skipped:s}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges((t,i,n,o)=>e.push({fromA:t,toA:i,fromB:n,toB:o})),i=lu.applyChanges(i,e),n=a3.empty,o=0,r={from:t.mapPos(r.from,-1),to:t.mapPos(r.to,1)},this.skipped.length)for(let e of(s=[],this.skipped)){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);i<n&&s.push({from:i,to:n})}}return new hx(this.parser,e,i,n,o,r,s,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:i,to:n}=this.skipped[e];i<t.to&&n>t.from&&(this.fragments=hk(this.fragments,i,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends lf{createParse(e,i,n){let o=n[0].from,r=n[n.length-1].to;return{parsedPos:o,advance(){let e=hw;if(e){for(let t of n)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=r,new a3(a0.none,[],[],r-o)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return hw}}function hk(t,e,i){return lu.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class hO{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new hO(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=hx.create(t.facet(hE).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new hO(i)}}hg.state=iC.define({create:hO.init,update(t,e){for(let t of e.effects)if(t.is(hg.setState))return t.value;return e.startState.facet(hE)!=e.state.facet(hE)?hO.init(e.state):t.apply(e)}});let hS=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(hS=t=>{let e=-1,i=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const h_="undefined"!=typeof navigator&&(null===(m=navigator.scheduling)||void 0===m?void 0:m.isInputPending)?()=>navigator.scheduling.isInputPending():null,hC=o0.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(hg.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(hg.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=hS(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,o=i.field(hg.state);if(o.tree==o.context.tree&&o.context.isDone(n+1e5))return;let r=Date.now()+Math.min(this.chunkBudget,100,t&&!h_?Math.max(25,t.timeRemaining()-5):1e9),s=o.context.treeLen<n&&i.doc.length>n+1e3,a=o.context.work(()=>h_&&h_()||Date.now()>r,n+(s?0:1e5));this.chunkBudget-=Date.now()-e,(a||this.chunkBudget<=0)&&(o.context.takeTree(),this.view.dispatch({effects:hg.setState.of(new hO(o.context))})),this.chunkBudget>0&&!(a&&!s)&&this.scheduleWork(),this.checkAsyncSchedule(o.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(t=>oX(this.view.state,t)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),hE=iw.define({combine:t=>t.length?t[0]:null,enables:t=>[hg.state,hC,sk.contentAttributes.compute([t],e=>{let i=e.facet(t);return i&&i.name?{"data-language":i.name}:{}})]});class hM{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}const hP=iw.define(),hT=iw.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function hA(t){let e=t.facet(hT);return 9==e.charCodeAt(0)?t.tabSize*e.length:e.length}function hD(t,e){let i="",n=t.tabSize,o=t.facet(hT)[0];if("	"==o){for(;e>=n;)i+="	",e-=n;o=" "}for(let t=0;t<e;t++)i+=o;return i}function hI(t,e){for(let i of(t instanceof i0&&(t=new hB(t)),t.state.facet(hP))){let n=i(t,e);if(void 0!==n)return n}let i=hy(t.state);return i.length>=e?function(t,e,i){let n=e.resolveStack(i),o=e.resolveInner(i,-1).resolve(i,0).enterUnfinishedNodesBefore(i);if(o!=n.node){let t=[];for(let e=o;e!=n.node;e=e.parent)t.push(e);for(let e=t.length-1;e>=0;e--)n={node:t[e],next:n}}return hR(n,t,i)}(t,i,e):null}class hB{constructor(t,e={}){this.state=t,this.options=e,this.unit=hA(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:o}=this.options;return null!=n&&n>=i.from&&n<=i.to?o&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(t,e);return i.slice(t-n,Math.min(i.length,t+100-n))}column(t,e=1){let{text:i,from:n}=this.lineAt(t,e),o=this.countColumn(i,t-n),r=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return r>-1&&(o+=r-this.countColumn(i,i.search(/\S|$/))),o}countColumn(t,e=t.length){return nl(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:n}=this.lineAt(t,e),o=this.options.overrideIndentation;if(o){let t=o(n);if(t>-1)return t}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const hz=new aK;function hR(t,e,i){for(let n=t;n;n=n.next){let t=function(t){let e=t.type.prop(hz);if(e)return e;let i=t.firstChild,n;if(i&&(n=i.type.prop(aK.closedBy))){let e=t.lastChild,i=e&&n.indexOf(e.name)>-1;return t=>(function(t,e,i,n,o){let r=t.textAfter,s=r.match(/^\s*/)[0].length,a=n&&r.slice(s,s+n.length)==n||o==t.pos+s,l=e?function(t){let e=t.node,i=e.childAfter(e.from),n=e.lastChild;if(!i)return null;let o=t.options.simulateBreak,r=t.state.doc.lineAt(i.from),s=null==o||o<=r.from?r.to:Math.min(r.to,o);for(let t=i.to;;){let o=e.childAfter(t);if(!o||o==n)return null;if(!o.type.isSkipped){if(o.from>=s)return null;let t=/^ */.exec(r.text.slice(i.to-r.from))[0].length;return{from:i.from,to:i.to+t}}t=o.to}}(t):null;return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:1*t.unit)})(t,!0,0,void 0,i&&!(t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak)?e.from:void 0)}return null==t.parent?hN:null}(n.node);if(t)return t(hL.create(e,i,n))}return 0}function hN(){return 0}class hL extends hB{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.context=i}get node(){return this.context.node}static create(t,e,i){return new hL(t,e,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let i=t.resolve(e.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(function(t,e){for(let i=e;i;i=i.parent)if(t==i)return!0;return!1}(i,t))break;e=this.state.doc.lineAt(i.from)}return this.lineIndent(e.from)}continue(){return hR(this.context.next,this.base,this.pos)}}const hF=iw.define(),hj=new aK;function hH(t,e,i){for(let n of t.facet(hF)){let o=n(t,e,i);if(o)return o}return function(t,e,i){let n=hy(t);if(n.length<i)return null;let o=n.resolveStack(i,1),r=null;for(let s=o;s;s=s.next){let o=s.node;if(o.to<=i||o.from>i)continue;if(r&&o.from<e)break;let a=o.type.prop(hj);if(a&&(o.to<n.length-50||n.length==t.doc.length||!function(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}(o))){let n=a(o,t);n&&n.from<=i&&n.from>=e&&n.to>i&&(r=n)}}return r}(t,e,i)}function hW(t,e){let i=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);return i>=n?void 0:{from:i,to:n}}const hV=iq.define({map:hW}),hQ=iq.define({map:hW});function h$(t){let e=[];for(let{head:i}of t.state.selection.ranges)e.some(t=>t.from<=i&&t.to>=i)||e.push(t.lineBlockAt(i));return e}const hq=iC.define({create:()=>oh.none,update(t,e){for(let i of(t=t.map(e.changes),e.effects))if(i.is(hV)&&!function(t,e,i){let n=!1;return t.between(e,e,(t,o)=>{t==e&&o==i&&(n=!0)}),n}(t,i.value.from,i.value.to)){let{preparePlaceholder:n}=e.state.facet(hZ),o=n?oh.replace({widget:new h2(n(e.state,i.value))}):h1;t=t.update({add:[o.range(i.value.from,i.value.to)]})}else i.is(hQ)&&(t=t.update({filter:(t,e)=>i.value.from!=t||i.value.to!=e,filterFrom:i.value.from,filterTo:i.value.to}));if(e.selection){let i=!1,{head:n}=e.selection.main;t.between(n,n,(t,e)=>{t<n&&e>n&&(i=!0)}),i&&(t=t.update({filterFrom:n,filterTo:n,filter:(t,e)=>e<=n||t>=n}))}return t},provide:t=>sk.decorations.from(t),toJSON(t,e){let i=[];return t.between(0,e.doc.length,(t,e)=>{i.push(t,e)}),i},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw RangeError("Invalid JSON for fold state");let e=[];for(let i=0;i<t.length;){let n=t[i++],o=t[i++];if("number"!=typeof n||"number"!=typeof o)throw RangeError("Invalid JSON for fold state");e.push(h1.range(n,o))}return oh.set(e,!0)}});function hU(t,e,i){var n;let o=null;return null===(n=t.field(hq,!1))||void 0===n||n.between(e,i,(t,e)=>{(!o||o.from>t)&&(o={from:t,to:e})}),o}function hY(t,e){return t.field(hq,!1)?e:e.concat(iq.appendConfig.of(hJ()))}function hG(t,e,i=!0){let n=t.state.doc.lineAt(e.from).number,o=t.state.doc.lineAt(e.to).number;return sk.announce.of(`${t.state.phrase(i?"Folded lines":"Unfolded lines")} ${n} ${t.state.phrase("to")} ${o}.`)}const hX=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:t=>{for(let e of h$(t)){let i=hH(t.state,e.from,e.to);if(i)return t.dispatch({effects:hY(t.state,[hV.of(i),hG(t,i)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:t=>{if(!t.state.field(hq,!1))return!1;let e=[];for(let i of h$(t)){let n=hU(t.state,i.from,i.to);n&&e.push(hQ.of(n),hG(t,n,!1))}return e.length&&t.dispatch({effects:e}),e.length>0}},{key:"Ctrl-Alt-[",run:t=>{let{state:e}=t,i=[];for(let n=0;n<e.doc.length;){let o=t.lineBlockAt(n),r=hH(e,o.from,o.to);r&&i.push(hV.of(r)),n=(r?t.lineBlockAt(r.to):o).to+1}return i.length&&t.dispatch({effects:hY(t.state,i)}),!!i.length}},{key:"Ctrl-Alt-]",run:t=>{let e=t.state.field(hq,!1);if(!e||!e.size)return!1;let i=[];return e.between(0,t.state.doc.length,(t,e)=>{i.push(hQ.of({from:t,to:e}))}),t.dispatch({effects:i}),!0}}],hK={placeholderDOM:null,preparePlaceholder:null,placeholderText:"â¦"},hZ=iw.define({combine:t=>i1(t,hK)});function hJ(t){let e=[hq,h4];return t&&e.push(hZ.of(t)),e}function h0(t,e){let{state:i}=t,n=i.facet(hZ),o=e=>{let i=t.lineBlockAt(t.posAtDOM(e.target)),n=hU(t.state,i.from,i.to);n&&t.dispatch({effects:hQ.of(n)}),e.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(t,o,e);let r=document.createElement("span");return r.textContent=n.placeholderText,r.setAttribute("aria-label",i.phrase("folded code")),r.title=i.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=o,r}const h1=oh.replace({widget:new class extends oa{toDOM(t){return h0(t,null)}}});class h2 extends oa{constructor(t){super(),this.value=t}eq(t){return this.value==t.value}toDOM(t){return h0(t,this.value)}}const h5={openText:"â",closedText:"âº",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class h3 extends aC{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}const h4=sk.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class h8{constructor(t,e){let i;function n(t){let e=nf.newName();return(i||(i=Object.create(null)))["."+e]=t,e}this.specs=t;let o="string"==typeof e.all?e.all:e.all?n(e.all):void 0,r=e.scope;this.scope=r instanceof hg?t=>t.prop(hf)==r.data:r?t=>t==r:void 0,this.style=l4(t.map(t=>({tag:t.tag,class:t.class||n(Object.assign({},t,{tag:null}))})),{all:o}).style,this.module=i?new nf(i):null,this.themeType=e.themeType}static define(t,e){return new h8(t,e||{})}}const h6=iw.define(),h9=iw.define({combine:t=>t.length?[t[0]]:null});function h7(t){let e=t.facet(h6);return e.length?e:t.facet(h9)}function ct(t,e){let i=[ce],n;return t instanceof h8&&(t.module&&i.push(sk.styleModule.of(t.module)),n=t.themeType),(null==e?void 0:e.fallback)?i.push(h9.of(t)):n?i.push(h6.computeN([sk.darkTheme],e=>e.facet(sk.darkTheme)==("dark"==n)?[t]:[])):i.push(h6.of(t)),i}const ce=iP.high(o0.fromClass(class{constructor(t){this.markCache=Object.create(null),this.tree=hy(t.state),this.decorations=this.buildDeco(t,h7(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=hy(t.state),i=h7(t.state),n=i!=h7(t.startState),{viewport:o}=t.view,r=t.changes.mapPos(this.decoratedTo,1);e.length<o.to&&!n&&e.type==this.tree.type&&r>=o.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=r):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,i),this.decoratedTo=o.to)}buildDeco(t,e){if(!e||!this.tree.length)return oh.none;let i=new i6;for(let{from:n,to:o}of t.visibleRanges)!function(t,e,i,n=0,o=t.length){let r=new l8(n,Array.isArray(e)?e:[e],i);r.highlightRange(t.cursor(),n,o,"",r.highlighters),r.flush(o)}(this.tree,e,(t,e,n)=>{i.add(t,e,this.markCache[n]||(this.markCache[n]=oh.mark({class:n})))},n,o);return i.finish()}},{decorations:t=>t.decorations}));hu.meta,hu.link,hu.heading,hu.emphasis,hu.strong,hu.strikethrough,hu.keyword,hu.atom,hu.bool,hu.url,hu.contentSeparator,hu.labelName,hu.literal,hu.inserted,hu.string,hu.deleted,hu.regexp,hu.escape,hu.special(hu.string),hu.definition(hu.variableName),hu.local(hu.variableName),hu.typeName,hu.namespace,hu.className,hu.special(hu.variableName),hu.macroName,hu.definition(hu.propertyName),hu.comment,hu.invalid;const ci=sk.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),cn="()[]{}",co=iw.define({combine:t=>i1(t,{afterCursor:!0,brackets:cn,maxScanDistance:1e4,renderMatch:ca})}),cr=oh.mark({class:"cm-matchingBracket"}),cs=oh.mark({class:"cm-nonmatchingBracket"});function ca(t){let e=[],i=t.matched?cr:cs;return e.push(i.range(t.start.from,t.start.to)),t.end&&e.push(i.range(t.end.from,t.end.to)),e}const cl=[iC.define({create:()=>oh.none,update(t,e){if(!e.docChanged&&!e.selection)return t;let i=[],n=e.state.facet(co);for(let t of e.state.selection.ranges){if(!t.empty)continue;let o=cu(e.state,t.head,-1,n)||t.head>0&&cu(e.state,t.head-1,1,n)||n.afterCursor&&(cu(e.state,t.head,1,n)||t.head<e.state.doc.length&&cu(e.state,t.head+1,-1,n));o&&(i=i.concat(n.renderMatch(o,e.state)))}return oh.set(i,!0)},provide:t=>sk.decorations.from(t)}),ci],ch=new aK;function cc(t,e,i){let n=t.prop(e<0?aK.openedBy:aK.closedBy);if(n)return n;if(1==t.name.length){let n=i.indexOf(t.name);if(n>-1&&n%2==(e<0?1:0))return[i[n+e]]}return null}function cd(t){let e=t.type.prop(ch);return e?e(t.node):t}function cu(t,e,i,n={}){let o=n.maxScanDistance||1e4,r=n.brackets||cn,s=hy(t),a=s.resolveInner(e,i);for(let t=a;t;t=t.parent){let n=cc(t.type,i,r);if(n&&t.from<t.to){let o=cd(t);if(o&&(i>0?e>=o.from&&e<o.to:e>o.from&&e<=o.to))return function(t,e,i,n,o,r,s){let a=n.parent,l={from:o.from,to:o.to},h=0,c=null==a?void 0:a.cursor();if(c&&(i<0?c.childBefore(n.from):c.childAfter(n.to)))do if(i<0?c.to<=n.from:c.from>=n.to){if(0==h&&r.indexOf(c.type.name)>-1&&c.from<c.to){let t=cd(c);return{start:l,end:t?{from:t.from,to:t.to}:void 0,matched:!0}}if(cc(c.type,i,s))h++;else if(cc(c.type,-i,s)){if(0==h){let t=cd(c);return{start:l,end:t&&t.from<t.to?{from:t.from,to:t.to}:void 0,matched:!1}}h--}}while(i<0?c.prevSibling():c.nextSibling())return{start:l,matched:!1}}(0,0,i,t,o,n,r)}}return function(t,e,i,n,o,r,s){let a=i<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=s.indexOf(a);if(l<0||l%2==0!=i>0)return null;let h={from:i<0?e-1:e,to:i>0?e+1:e},c=t.doc.iterRange(e,i>0?t.doc.length:0),d=0;for(let t=0;!c.next().done&&t<=r;){let r=c.value;i<0&&(t+=r.length);let a=e+t*i;for(let t=i>0?0:r.length-1,e=i>0?r.length:-1;t!=e;t+=i){let e=s.indexOf(r[t]);if(!(e<0)&&n.resolveInner(a+t,1).type==o){if(e%2==0==i>0)d++;else{if(1==d)return{start:h,end:{from:a+t,to:a+t+1},matched:e>>1==l>>1};d--}}}i>0&&(t+=r.length)}return c.done?{start:h,matched:!1}:null}(t,e,i,s,a.type,o,r)}const cf=Object.create(null),cp=[a0.none],cg=[],cm=Object.create(null),cv=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])cv[t]=function(t,e){let i=[];for(let n of e.split(" ")){let e=[];for(let i of n.split(".")){let n=t[i]||hu[i];n?"function"==typeof n?e.length?e=e.map(n):cy(i,`Modifier ${i} used at start of tag`):e.length?cy(i,`Tag ${i} used as modifier`):e=Array.isArray(n)?n:[n]:cy(i,`Unknown highlighting tag ${i}`)}for(let t of e)i.push(t)}if(!i.length)return 0;let n=e.replace(/ /g,"_"),o=n+" "+i.map(t=>t.id),r=cm[o];if(r)return r.id;let s=cm[o]=a0.define({id:cp.length,name:n,props:[l2({[n]:i})]});return cp.push(s),s.id}(cf,e);function cy(t,e){cg.indexOf(t)>-1||(cg.push(t),console.warn(e))}function cb(t){return t.length<=4096&&/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/.test(t)}function cw(t){for(let e=t.iter();!e.next().done;)if(cb(e.value))return!0;return!1}const cx=iw.define({combine:t=>t.some(t=>t)});function ck(t,e,i){let n=new i6,o=t.visibleRanges;for(let{from:r,to:s}of(i||(o=function(t,e){let i=e.iter(),n=0,o=[],r=null;for(let{from:e,to:s}of t)if(!r||!(r.to>e)||!((e=r.to)>=s))for(n+i.value.length<e&&(i.next(e-(n+i.value.length)),n=e);;){let t=n,e=n+i.value.length;if(!i.lineBreak&&cb(i.value)&&(r&&r.to>t-10?r.to=Math.min(s,e):o.push(r={from:t,to:Math.min(s,e)})),e>=s)break;n=e,i.next()}return o}(o,t.state.doc)),o))e.iterate({enter:t=>{let e=t.type.prop(aK.isolate);e&&n.add(t.from,t.to,cO[e])},from:r,to:s});return n.finish()}o0.fromClass(class{constructor(t){this.always=t.state.facet(cx)||t.textDirection!=ox.LTR||t.state.facet(sk.perLineTextDirection),this.hasRTL=!this.always&&cw(t.state.doc),this.tree=hy(t.state),this.decorations=this.always||this.hasRTL?ck(t,this.tree,this.always):oh.none}update(t){var e;let i,n=t.state.facet(cx)||t.view.textDirection!=ox.LTR||t.state.facet(sk.perLineTextDirection);if(n||this.hasRTL||(e=t.changes,i=!1,e.iterChanges((t,e,n,o,r)=>{!i&&cw(r)&&(i=!0)}),!i)||(this.hasRTL=!0),!n&&!this.hasRTL)return;let o=hy(t.state);(n!=this.always||o!=this.tree||t.docChanged||t.viewportChanged)&&(this.tree=o,this.always=n,this.decorations=ck(t.view,o,n))}},{provide:t=>{function e(e){var i,n;return null!==(n=null===(i=e.plugin(t))||void 0===i?void 0:i.decorations)&&void 0!==n?n:oh.none}return[sk.outerDecorations.of(e),iP.lowest(sk.bidiIsolatedRanges.of(e))]}});const cO={rtl:oh.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:ox.RTL}),ltr:oh.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:ox.LTR}),auto:oh.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})};class cS{constructor(t,e,i,n){this.state=t,this.pos=e,this.explicit=i,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(t){let e=hy(this.state).resolveInner(this.pos,-1);for(;e&&0>t.indexOf(e.name);)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),i=Math.max(e.from,this.pos-250),n=e.text.slice(i-e.from,this.pos-e.from),o=n.search(cP(t,!1));return o<0?null:{from:i+o,to:this.pos,text:n.slice(o)}}get aborted(){return null==this.abortListeners}addEventListener(t,e,i){"abort"==t&&this.abortListeners&&(this.abortListeners.push(e),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function c_(t){let e=Object.keys(t).join(""),i=/\w/.test(e);return i&&(e=e.replace(/\w/g,"")),`[${i?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function cC(t){let e=t.map(t=>"string"==typeof t?{label:t}:t),[i,n]=e.every(t=>/^\w+$/.test(t.label))?[/\w*$/,/\w+$/]:function(t){let e=Object.create(null),i=Object.create(null);for(let{label:n}of t){e[n[0]]=!0;for(let t=1;t<n.length;t++)i[n[t]]=!0}let n=c_(e)+c_(i)+"*$";return[RegExp("^"+n),new RegExp(n)]}(e);return t=>{let o=t.matchBefore(n);return o||t.explicit?{from:o?o.from:t.pos,options:e,validFor:i}:null}}class cE{constructor(t,e,i,n){this.completion=t,this.source=e,this.match=i,this.score=n}}function cM(t){return t.selection.main.from}function cP(t,e){var i;let{source:n}=t,o=e&&"^"!=n[0],r="$"!=n[n.length-1];return o||r?RegExp(`${o?"^":""}(?:${n})${r?"$":""}`,null!==(i=t.flags)&&void 0!==i?i:t.ignoreCase?"i":""):t}const cT=iV.define(),cA=new WeakMap;function cD(t){if(!Array.isArray(t))return t;let e=cA.get(t);return e||cA.set(t,e=cC(t)),e}const cI=iq.define(),cB=iq.define();class cz{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let e=0;e<t.length;){let i=ie(t,e),n=io(i);this.chars.push(i);let o=t.slice(e,e+n),r=o.toUpperCase();this.folded.push(ie(r==o?o.toLowerCase():r,0)),e+=n}this.astral=t.length!=this.chars.length}ret(t,e){return this.score=t,this.matched=e,this}match(t){if(0==this.pattern.length)return this.ret(-100,[]);if(t.length<this.pattern.length)return null;let{chars:e,folded:i,any:n,precise:o,byWord:r}=this;if(1==e.length){let n=ie(t,0),o=io(n),r=o==t.length?0:-100;if(n==e[0]);else{if(n!=i[0])return null;r+=-200}return this.ret(r,[0,o])}let s=t.indexOf(this.pattern);if(0==s)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=e.length,l=0;if(s<0){for(let o=0,r=Math.min(t.length,200);o<r&&l<a;){let r=ie(t,o);(r==e[l]||r==i[l])&&(n[l++]=o),o+=io(r)}if(l<a)return null}let h=0,c=0,d=!1,u=0,f=-1,p=-1,g=/[a-z]/.test(t),m=!0;for(let n=0,l=Math.min(t.length,200),v=0;n<l&&c<a;){let l=ie(t,n);s<0&&(h<a&&l==e[h]&&(o[h++]=n),u<a&&(l==e[u]||l==i[u]?(0==u&&(f=n),p=n+1,u++):u=0));let y,b=l<255?l>=48&&l<=57||l>=97&&l<=122?2:l>=65&&l<=90?1:0:(y=ii(l))!=y.toLowerCase()?1:y!=y.toUpperCase()?2:0;(!n||1==b&&g||0==v&&0!=b)&&(e[c]==l||i[c]==l&&(d=!0)?r[c++]=n:r.length&&(m=!1)),v=b,n+=io(l)}return c==a&&0==r[0]&&m?this.result(-100+(d?-200:0),r,t):u==a&&0==f?this.ret(-200-t.length+(p==t.length?0:-100),[0,p]):s>-1?this.ret(-700-t.length,[s,s+this.pattern.length]):u==a?this.ret(-900-t.length,[f,p]):c==a?this.result(-100+(d?-200:0)+-700+(m?0:-1100),r,t):2==e.length?null:this.result((n[0]?-700:0)+-200+-1100,n,t)}result(t,e,i){let n=[],o=0;for(let t of e){let e=t+(this.astral?io(ie(i,t)):1);o&&n[o-1]==t?n[o-1]=e:(n[o++]=t,n[o++]=e)}return this.ret(t-i.length,n)}}class cR{constructor(t){this.pattern=t,this.matched=[],this.score=0,this.folded=t.toLowerCase()}match(t){if(t.length<this.pattern.length)return null;let e=t.slice(0,this.pattern.length),i=e==this.pattern?0:e.toLowerCase()==this.folded?-200:null;return null==i?null:(this.matched=[0,e.length],this.score=i+(t.length==this.pattern.length?0:-100),this)}}const cN=iw.define({combine:t=>i1(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:cF,filterStrict:!1,compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,tooltipClass:(t,e)=>i=>cL(t(i),e(i)),optionClass:(t,e)=>i=>cL(t(i),e(i)),addToOptions:(t,e)=>t.concat(e),filterStrict:(t,e)=>t||e})});function cL(t,e){return t?e?t+" "+e:t:e}function cF(t,e,i,n,o,r){let s=t.textDirection==ox.RTL,a=s,l=!1,h="top",c,d,u=e.left-o.left,f=o.right-e.right,p=n.right-n.left,g=n.bottom-n.top;if(a&&u<Math.min(p,f)?a=!1:!a&&f<Math.min(p,u)&&(a=!0),p<=(a?u:f))c=Math.max(o.top,Math.min(i.top,o.bottom-g))-e.top,d=Math.min(400,a?u:f);else{l=!0,d=Math.min(400,(s?e.right:o.right-e.left)-30);let t=o.bottom-e.bottom;t>=g||t>e.top?c=i.bottom-e.top:(h="bottom",c=e.bottom-i.top)}let m=(e.bottom-e.top)/r.offsetHeight,v=(e.right-e.left)/r.offsetWidth;return{style:`${h}: ${c/m}px; max-width: ${d/v}px`,class:"cm-completionInfo-"+(l?s?"left-narrow":"right-narrow":a?"left":"right")}}function cj(t,e,i){if(t<=i)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let t=Math.floor(e/i);return{from:t*i,to:(t+1)*i}}let n=Math.floor((t-e)/i);return{from:t-(n+1)*i,to:t-n*i}}class cH{constructor(t,e,i){let n;this.view=t,this.stateField=e,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:t=>this.placeInfo(t),key:this},this.space=null,this.currentClass="";let o=t.state.field(e),{options:r,selected:s}=o.open,a=t.state.facet(cN);this.optionContent=(n=a.addToOptions.slice(),a.icons&&n.push({render(t){let e=document.createElement("div");return e.classList.add("cm-completionIcon"),t.type&&e.classList.add(...t.type.split(/\s+/g).map(t=>"cm-completionIcon-"+t)),e.setAttribute("aria-hidden","true"),e},position:20}),n.push({render(t,e,i,n){let o=document.createElement("span");o.className="cm-completionLabel";let r=t.displayLabel||t.label,s=0;for(let t=0;t<n.length;){let e=n[t++],i=n[t++];e>s&&o.appendChild(document.createTextNode(r.slice(s,e)));let a=o.appendChild(document.createElement("span"));a.appendChild(document.createTextNode(r.slice(e,i))),a.className="cm-completionMatchedText",s=i}return s<r.length&&o.appendChild(document.createTextNode(r.slice(s))),o},position:50},{render(t){if(!t.detail)return null;let e=document.createElement("span");return e.className="cm-completionDetail",e.textContent=t.detail,e},position:80}),n.sort((t,e)=>t.position-e.position).map(t=>t.render)),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=cj(r.length,s,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",i=>{let{options:n}=t.state.field(e).open;for(let e=i.target,o;e&&e!=this.dom;e=e.parentNode)if("LI"==e.nodeName&&(o=/-(\d+)$/.exec(e.id))&&+o[1]<n.length){this.applyCompletion(t,n[+o[1]]),i.preventDefault();return}}),this.dom.addEventListener("focusout",e=>{let i=t.state.field(this.stateField,!1);i&&i.tooltip&&t.state.facet(cN).closeOnBlur&&e.relatedTarget!=t.contentDOM&&t.dispatch({effects:cB.of(null)})}),this.showOptions(r,o.id)}mount(){this.updateSel()}showOptions(t,e){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t,e,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(t){var e;let i=t.state.field(this.stateField),n=t.startState.field(this.stateField);if(this.updateTooltipClass(t.state),i!=n){let{options:o,selected:r,disabled:s}=i.open;n.open&&n.open.options==o||(this.range=cj(o.length,r,t.state.facet(cN).maxRenderedOptions),this.showOptions(o,i.id)),this.updateSel(),s!=(null===(e=n.open)||void 0===e?void 0:e.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!s)}}updateTooltipClass(t){let e=this.tooltipClass(t);if(e!=this.currentClass){for(let t of this.currentClass.split(" "))t&&this.dom.classList.remove(t);for(let t of e.split(" "))t&&this.dom.classList.add(t);this.currentClass=e}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=cj(e.options.length,e.selected,this.view.state.facet(cN).maxRenderedOptions),this.showOptions(e.options,t.id)),this.updateSelectedOption(e.selected)){this.destroyInfo();let{completion:i}=e.options[e.selected],{info:n}=i;if(!n)return;let o="string"==typeof n?document.createTextNode(n):n(i);if(!o)return;"then"in o?o.then(e=>{e&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(e,i)}).catch(t=>oX(this.view.state,t,"completion info")):this.addInfoPane(o,i)}}addInfoPane(t,e){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",null!=t.nodeType)i.appendChild(t),this.infoDestroy=null;else{let{dom:e,destroy:n}=t;i.appendChild(e),this.infoDestroy=n||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){var e,i;let n,o,r,s=null;for(let e=this.list.firstChild,i=this.range.from;e;e=e.nextSibling,i++)"LI"==e.nodeName&&e.id?i==t?e.hasAttribute("aria-selected")||(e.setAttribute("aria-selected","true"),s=e):e.hasAttribute("aria-selected")&&e.removeAttribute("aria-selected"):i--;return s&&(e=this.list,i=s,n=e.getBoundingClientRect(),o=i.getBoundingClientRect(),r=n.height/e.offsetHeight,o.top<n.top?e.scrollTop-=(n.top-o.top)/r:o.bottom>n.bottom&&(e.scrollTop+=(o.bottom-n.bottom)/r)),s}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),n=t.getBoundingClientRect(),o=this.space;if(!o){let t=this.dom.ownerDocument.defaultView||window;o={left:0,top:0,right:t.innerWidth,bottom:t.innerHeight}}return n.top>Math.min(o.bottom,e.bottom)-10||n.bottom<Math.max(o.top,e.top)+10?null:this.view.state.facet(cN).positionInfo(this.view,e,n,i,o,this.dom)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,e,i){let n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions"));let o=null;for(let r=i.from;r<i.to;r++){let{completion:s,match:a}=t[r],{section:l}=s;if(l){let t="string"==typeof l?l:l.name;t!=o&&(r>i.from||0==i.from)&&(o=t,"string"!=typeof l&&l.header?n.appendChild(l.header(l)):n.appendChild(document.createElement("completion-section")).textContent=t)}let h=n.appendChild(document.createElement("li"));h.id=e+"-"+r,h.setAttribute("role","option");let c=this.optionClass(s);for(let t of(c&&(h.className=c),this.optionContent)){let e=t(s,this.view.state,this.view,a);e&&h.appendChild(e)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function cW(t){return 100*(t.boost||0)+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}class cV{constructor(t,e,i,n,o,r){this.options=t,this.attrs=e,this.tooltip=i,this.timestamp=n,this.selected=o,this.disabled=r}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new cV(this.options,cU(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,i,n,o,r){if(n&&!r&&t.some(t=>t.isPending))return n.setDisabled();let s=function(t,e){let i=[],n=null,o=t=>{i.push(t);let{section:e}=t.completion;if(e){n||(n=[]);let t="string"==typeof e?e:e.name;n.some(e=>e.name==t)||n.push("string"==typeof e?{name:t}:e)}},r=e.facet(cN);for(let n of t)if(n.hasResult()){let t=n.result.getMatch;if(!1===n.result.filter)for(let e of n.result.options)o(new cE(e,n.source,t?t(e):[],1e9-i.length));else{let i=e.sliceDoc(n.from,n.to),s,a=r.filterStrict?new cR(i):new cz(i);for(let e of n.result.options)if(s=a.match(e.label)){let i=e.displayLabel?t?t(e,s.matched):[]:s.matched;o(new cE(e,n.source,i,s.score+(e.boost||0)))}}}if(n){let t=Object.create(null),e=0;for(let i of n.sort((t,e)=>{var i,n;return(null!==(i=t.rank)&&void 0!==i?i:1e9)-(null!==(n=e.rank)&&void 0!==n?n:1e9)||(t.name<e.name?-1:1)}))e-=1e5,t[i.name]=e;for(let e of i){let{section:i}=e.completion;i&&(e.score+=t["string"==typeof i?i:i.name])}}let s=[],a=null,l=r.compareCompletions;for(let t of i.sort((t,e)=>e.score-t.score||l(t.completion,e.completion))){let e=t.completion;a&&a.label==e.label&&a.detail==e.detail&&(null==a.type||null==e.type||a.type==e.type)&&a.apply==e.apply&&a.boost==e.boost?cW(t.completion)>cW(a)&&(s[s.length-1]=t):s.push(t),a=t.completion}return s}(t,e);if(!s.length)return n&&t.some(t=>t.isPending)?n.setDisabled():null;let a=e.facet(cN).selectOnOpen?0:-1;if(n&&n.selected!=a&&-1!=n.selected){let t=n.options[n.selected].completion;for(let e=0;e<s.length;e++)if(s[e].completion==t){a=e;break}}return new cV(s,cU(i,a),{pos:t.reduce((t,e)=>e.hasResult()?Math.min(t,e.from):t,1e8),create:c2,above:o.aboveCursor},n?n.timestamp:Date.now(),a,!1)}map(t){return new cV(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new cV(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class cQ{constructor(t,e,i){this.active=t,this.id=e,this.open=i}static start(){return new cQ(cY,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(t){let{state:e}=t,i=e.facet(cN),n=(i.override||e.languageDataAt("autocomplete",cM(e)).map(cD)).map(e=>(this.active.find(t=>t.source==e)||new cX(e,this.active.some(t=>0!=t.state)?1:0)).update(t,i));n.length==this.active.length&&n.every((t,e)=>t==this.active[e])&&(n=this.active);let o=this.open,r=t.effects.some(t=>t.is(cZ));for(let s of(o&&t.docChanged&&(o=o.map(t.changes)),t.selection||n.some(e=>e.hasResult()&&t.changes.touchesRange(e.from,e.to))||!function(t,e){if(t==e)return!0;for(let i=0,n=0;;){for(;i<t.length&&!t[i].hasResult();)i++;for(;n<e.length&&!e[n].hasResult();)n++;let o=i==t.length,r=n==e.length;if(o||r)return o==r;if(t[i++].result!=e[n++].result)return!1}}(n,this.active)||r?o=cV.build(n,e,this.id,o,i,r):o&&o.disabled&&!n.some(t=>t.isPending)&&(o=null),!o&&n.every(t=>!t.isPending)&&n.some(t=>t.hasResult())&&(n=n.map(t=>t.hasResult()?new cX(t.source,0):t)),t.effects))s.is(cJ)&&(o=o&&o.setSelected(s.value,this.id));return n==this.active&&o==this.open?this:new cQ(n,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?c$:cq}}const c$={"aria-autocomplete":"list"},cq={};function cU(t,e){let i={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(i["aria-activedescendant"]=t+"-"+e),i}const cY=[];function cG(t,e){if(t.isUserEvent("input.complete")){let i=t.annotation(cT);if(i&&e.activateOnCompletion(i))return 12}let i=t.isUserEvent("input.type");return i&&e.activateOnTyping?5:i?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class cX{constructor(t,e,i=!1){this.source=t,this.state=e,this.explicit=i}hasResult(){return!1}get isPending(){return 1==this.state}update(t,e){let i=cG(t,e),n=this;for(let e of((8&i||16&i&&this.touches(t))&&(n=new cX(n.source,0)),4&i&&0==n.state&&(n=new cX(this.source,1)),n=n.updateFor(t,i),t.effects))if(e.is(cI))n=new cX(n.source,1,e.value);else if(e.is(cB))n=new cX(n.source,0);else if(e.is(cZ))for(let t of e.value)t.source==n.source&&(n=t);return n}updateFor(t,e){return this.map(t.changes)}map(t){return this}touches(t){return t.changes.touchesRange(cM(t.state))}}class cK extends cX{constructor(t,e,i,n,o,r){super(t,3,e),this.limit=i,this.result=n,this.from=o,this.to=r}hasResult(){return!0}updateFor(t,e){var i;if(!(3&e))return this.map(t.changes);let n=this.result;n.map&&!t.changes.empty&&(n=n.map(n,t.changes));let o=t.changes.mapPos(this.from),r=t.changes.mapPos(this.to,1),s=cM(t.state);if(s>r||!n||2&e&&(cM(t.startState)==this.from||s<this.limit))return new cX(this.source,4&e?1:0);let a=t.changes.mapPos(this.limit);return!function(t,e,i,n){if(!t)return!1;let o=e.sliceDoc(i,n);return"function"==typeof t?t(o,i,n,e):cP(t,!0).test(o)}(n.validFor,t.state,o,r)?n.update&&(n=n.update(n,o,r,new cS(t.state,s,!1)))?new cK(this.source,this.explicit,a,n,n.from,null!==(i=n.to)&&void 0!==i?i:cM(t.state)):new cX(this.source,1,this.explicit):new cK(this.source,this.explicit,a,n,o,r)}map(t){return t.empty?this:(this.result.map?this.result.map(this.result,t):this.result)?new cK(this.source,this.explicit,t.mapPos(this.limit),this.result,t.mapPos(this.from),t.mapPos(this.to,1)):new cX(this.source,0)}touches(t){return t.changes.touchesRange(this.from,this.to)}}const cZ=iq.define({map:(t,e)=>t.map(t=>t.map(e))}),cJ=iq.define(),c0=iC.define({create:()=>cQ.start(),update:(t,e)=>t.update(e),provide:t=>[af.from(t,t=>t.tooltip),sk.contentAttributes.from(t,t=>t.attrs)]});function c1(t,e){let i=e.completion.apply||e.completion.label,n=t.state.field(c0).active.find(t=>t.source==e.source);return n instanceof cK&&("string"==typeof i?t.dispatch(Object.assign(Object.assign({},function(t,e,i,n){let{main:o}=t.selection,r=i-o.from,s=n-o.from;return Object.assign(Object.assign({},t.changeByRange(a=>{if(a!=o&&i!=n&&t.sliceDoc(a.from+r,a.from+s)!=t.sliceDoc(i,n))return{range:a};let l=t.toText(e);return{changes:{from:a.from+r,to:n==o.from?a.to:a.from+s,insert:l},range:iv.cursor(a.from+r+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}(t.state,i,n.from,n.to)),{annotations:cT.of(e.completion)})):i(t,e.completion,n.from,n.to),!0)}const c2=t=>new cH(t,c0,c1);function c5(t,e="option"){return i=>{let n=i.state.field(c0,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<i.state.facet(cN).interactionDelay)return!1;let o=1,r;"page"==e&&(r=ay(i,n.open.tooltip))&&(o=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:s}=n.open.options,a=n.open.selected>-1?n.open.selected+o*(t?1:-1):t?0:s-1;return a<0?a="page"==e?0:s-1:a>=s&&(a="page"==e?s-1:0),i.dispatch({effects:cJ.of(a)}),!0}}const c3=t=>!!t.state.field(c0,!1)&&(t.dispatch({effects:cI.of(!0)}),!0);class c4{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const c8=o0.fromClass(class{constructor(t){for(let e of(this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0,t.state.field(c0).active))e.isPending&&this.startQuery(e)}update(t){let e=t.state.field(c0),i=t.state.facet(cN);if(!t.selectionSet&&!t.docChanged&&t.startState.field(c0)==e)return;let n=t.transactions.some(t=>{let e=cG(t,i);return 8&e||(t.selection||t.docChanged)&&!(3&e)});for(let e=0;e<this.running.length;e++){let i=this.running[e];if(n||i.context.abortOnDocChange&&t.docChanged||i.updates.length+t.transactions.length>50&&Date.now()-i.time>1e3){for(let t of i.context.abortListeners)try{t()}catch(t){oX(this.view.state,t)}i.context.abortListeners=null,this.running.splice(e--,1)}else i.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(t=>t.effects.some(t=>t.is(cI)))&&(this.pendingStart=!0);let o=this.pendingStart?50:i.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(t=>t.isPending&&!this.running.some(e=>e.active.source==t.source))?setTimeout(()=>this.startUpdate(),o):-1,0!=this.composing)for(let e of t.transactions)e.isUserEvent("input.type")?this.composing=2:2==this.composing&&e.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(c0);for(let t of e.active)t.isPending&&!this.running.some(e=>e.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(cN).updateSyncTime))}startQuery(t){let{state:e}=this.view,i=cM(e),n=new cS(e,i,t.explicit,this.view),o=new c4(t,n);this.running.push(o),Promise.resolve(t.source(n)).then(t=>{o.context.aborted||(o.done=t||null,this.scheduleAccept())},t=>{this.view.dispatch({effects:cB.of(null)}),oX(this.view.state,t)})}scheduleAccept(){this.running.every(t=>void 0!==t.done)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(cN).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],i=this.view.state.facet(cN),n=this.view.state.field(c0);for(let o=0;o<this.running.length;o++){let r=this.running[o];if(void 0===r.done)continue;if(this.running.splice(o--,1),r.done){let n=cM(r.updates.length?r.updates[0].startState:this.view.state),o=Math.min(n,r.done.from+(r.active.explicit?0:1)),s=new cK(r.active.source,r.active.explicit,o,r.done,r.done.from,null!==(t=r.done.to)&&void 0!==t?t:n);for(let t of r.updates)s=s.update(t,i);if(s.hasResult()){e.push(s);continue}}let s=n.active.find(t=>t.source==r.active.source);if(s&&s.isPending){if(null==r.done){let t=new cX(r.active.source,0);for(let e of r.updates)t=t.update(e,i);t.isPending||e.push(t)}else this.startQuery(s)}}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:cZ.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(c0,!1);if(e&&e.tooltip&&this.view.state.facet(cN).closeOnBlur){let i=e.open&&ay(this.view,e.open.tooltip);i&&i.dom.contains(t.relatedTarget)||setTimeout(()=>this.view.dispatch({effects:cB.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:cI.of(!1)}),20),this.composing=0}}}),c6="object"==typeof navigator&&/Win/.test(navigator.platform),c9=iP.highest(sk.domEventHandlers({keydown(t,e){let i=e.state.field(c0,!1);if(!i||!i.open||i.open.disabled||i.open.selected<0||t.key.length>1||t.ctrlKey&&!(c6&&t.altKey)||t.metaKey)return!1;let n=i.open.options[i.open.selected],o=i.active.find(t=>t.source==n.source),r=n.completion.commitCharacters||o.result.commitCharacters;return r&&r.indexOf(t.key)>-1&&c1(e,n),!1}})),c7=sk.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"Â·Â·Â·"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'Æ'"}},".cm-completionIcon-class":{"&:after":{content:"'â'"}},".cm-completionIcon-interface":{"&:after":{content:"'â'"}},".cm-completionIcon-variable":{"&:after":{content:"'\uD835\uDC65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\uD835\uDC36'"}},".cm-completionIcon-type":{"&:after":{content:"'\uD835\uDC61'"}},".cm-completionIcon-enum":{"&:after":{content:"'âª'"}},".cm-completionIcon-property":{"&:after":{content:"'â¡'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\uD83D\uDD11ï¸'"}},".cm-completionIcon-namespace":{"&:after":{content:"'â¢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});let dt=oh.widget({widget:new class extends oa{toDOM(){let t=document.createElement("span");return t.className="cm-snippetFieldPosition",t}ignoreEvent(){return!1}}}),de=oh.mark({class:"cm-snippetField"});class di{constructor(t,e){this.ranges=t,this.active=e,this.deco=oh.set(t.map(t=>(t.from==t.to?dt:de).range(t.from,t.to)))}map(t){let e=[];for(let i of this.ranges){let n=i.map(t);if(!n)return null;e.push(n)}return new di(e,this.active)}selectionInsideField(t){return t.ranges.every(t=>this.ranges.some(e=>e.field==this.active&&e.from<=t.from&&e.to>=t.to))}}const dn=iq.define({map:(t,e)=>t&&t.map(e)}),dr=iq.define(),ds=iC.define({create:()=>null,update(t,e){for(let i of e.effects){if(i.is(dn))return i.value;if(i.is(dr)&&t)return new di(t.ranges,i.value)}return t&&e.docChanged&&(t=t.map(e.changes)),t&&e.selection&&!t.selectionInsideField(e.selection)&&(t=null),t},provide:t=>sk.decorations.from(t,t=>t?t.deco:oh.none)});function da(t,e){return iv.create(t.filter(t=>t.field==e).map(t=>iv.range(t.from,t.to)))}function dl(t){return({state:e,dispatch:i})=>{let n=e.field(ds,!1);if(!n||t<0&&0==n.active)return!1;let o=n.active+t,r=t>0&&!n.ranges.some(e=>e.field==o+t);return i(e.update({selection:da(n.ranges,o),effects:dn.of(r?null:new di(n.ranges,o)),scrollIntoView:!0})),!0}}const dh=[{key:"Tab",run:dl(1),shift:dl(-1)},{key:"Escape",run:({state:t,dispatch:e})=>!!t.field(ds,!1)&&(e(t.update({effects:dn.of(null)})),!0)}],dc=iw.define({combine:t=>t.length?t[0]:dh});iP.highest(sT.compute([dc],t=>t.facet(dc))),sk.domEventHandlers({mousedown(t,e){let i=e.state.field(ds,!1),n;if(!i||null==(n=e.posAtCoords({x:t.clientX,y:t.clientY})))return!1;let o=i.ranges.find(t=>t.from<=n&&t.to>=n);return!!o&&o.field!=i.active&&(e.dispatch({selection:da(i.ranges,o.field),effects:dn.of(i.ranges.some(t=>t.field>o.field)?new di(i.ranges,o.field):null),scrollIntoView:!0}),!0)}});const dd={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},du=iq.define({map(t,e){let i=e.mapPos(t,-1,is.TrackAfter);return null==i?void 0:i}}),df=new class extends i2{};df.startSide=1,df.endSide=-1;const dp=iC.define({create:()=>i8.empty,update(t,e){if(t=t.map(e.changes),e.selection){let i=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:t=>t>=i.from&&t<=i.to})}for(let i of e.effects)i.is(du)&&(t=t.update({add:[df.range(i.value,i.value+1)]}));return t}}),dg="()[]{}<>";function dm(t){for(let e=0;e<dg.length;e+=2)if(dg.charCodeAt(e)==t)return dg.charAt(e+1);return ii(t<128?t:t+1)}function dv(t,e){return t.languageDataAt("closeBrackets",e)[0]||dd}const dy="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),db=sk.inputHandler.of((t,e,i,n)=>{if((dy?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let o=t.state.selection.main;if(n.length>2||2==n.length&&1==io(ie(n,0))||e!=o.from||i!=o.to)return!1;let r=function(t,e){let i=dv(t,t.selection.main.head),n=i.brackets||dd.brackets;for(let o of n){let r=dm(ie(o,0));if(e==o)return r==o?function(t,e,i,n){let o=n.stringPrefixes||dd.stringPrefixes,r=null,s=t.changeByRange(n=>{if(!n.empty)return{changes:[{insert:e,from:n.from},{insert:e,from:n.to}],effects:du.of(n.to+e.length),range:iv.range(n.anchor+e.length,n.head+e.length)};let s=n.head,a=dk(t.doc,s),l;if(a==e){if(dO(t,s))return{changes:{insert:e+e,from:s},effects:du.of(s+e.length),range:iv.cursor(s+e.length)};if(dx(t,s)){let n=i&&t.sliceDoc(s,s+3*e.length)==e+e+e?e+e+e:e;return{changes:{from:s,to:s+n.length,insert:n},range:iv.cursor(s+n.length)}}}else if(i&&t.sliceDoc(s-2*e.length,s)==e+e&&(l=dS(t,s-2*e.length,o))>-1&&dO(t,l))return{changes:{insert:e+e+e+e,from:s},effects:du.of(s+e.length),range:iv.cursor(s+e.length)};else if(t.charCategorizer(s)(a)!=iZ.Word&&dS(t,s,o)>-1&&!function(t,e,i,n){let o=hy(t).resolveInner(e,-1),r=n.reduce((t,e)=>Math.max(t,e.length),0);for(let s=0;s<5;s++){let s=t.sliceDoc(o.from,Math.min(o.to,o.from+i.length+r)),a=s.indexOf(i);if(!a||a>-1&&n.indexOf(s.slice(0,a))>-1){let e=o.firstChild;for(;e&&e.from==o.from&&e.to-e.from>i.length+a;){if(t.sliceDoc(e.to-i.length,e.to)==i)return!1;e=e.firstChild}return!0}let l=o.to==e&&o.parent;if(!l)break;o=l}return!1}(t,s,e,o))return{changes:{insert:e+e,from:s},effects:du.of(s+e.length),range:iv.cursor(s+e.length)};return{range:r=n}});return r?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}(t,o,n.indexOf(o+o+o)>-1,i):function(t,e,i,n){let o=null,r=t.changeByRange(r=>{if(!r.empty)return{changes:[{insert:e,from:r.from},{insert:i,from:r.to}],effects:du.of(r.to+e.length),range:iv.range(r.anchor+e.length,r.head+e.length)};let s=dk(t.doc,r.head);return!s||/\s/.test(s)||n.indexOf(s)>-1?{changes:{insert:e+i,from:r.head},effects:du.of(r.head+e.length),range:iv.cursor(r.head+e.length)}:{range:o=r}});return o?null:t.update(r,{scrollIntoView:!0,userEvent:"input.type"})}(t,o,r,i.before||dd.before);if(e==r&&dx(t,t.selection.main.from))return function(t,e,i){let n=null,o=t.changeByRange(e=>e.empty&&dk(t.doc,e.head)==i?{changes:{from:e.head,to:e.head+i.length,insert:i},range:iv.cursor(e.head+i.length)}:n={range:e});return n?null:t.update(o,{scrollIntoView:!0,userEvent:"input.type"})}(t,0,r)}return null}(t.state,n);return!!r&&(t.dispatch(r),!0)}),dw=[{key:"Backspace",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=dv(t,t.selection.main.head).brackets||dd.brackets,n=null,o=t.changeByRange(e=>{if(e.empty){var o,r;let n;let s=(o=t.doc,r=e.head,io(ie(n=o.sliceString(r-2,r),0))==n.length?n:n.slice(1));for(let n of i)if(n==s&&dk(t.doc,e.head)==dm(ie(n,0)))return{changes:{from:e.head-n.length,to:e.head+n.length},range:iv.cursor(e.head-n.length)}}return{range:n=e}});return n||e(t.update(o,{scrollIntoView:!0,userEvent:"delete.backward"})),!n}}];function dx(t,e){let i=!1;return t.field(dp).between(0,t.doc.length,t=>{t==e&&(i=!0)}),i}function dk(t,e){let i=t.sliceString(e,e+2);return i.slice(0,io(ie(i,0)))}function dO(t,e){let i=hy(t).resolveInner(e+1);return i.parent&&i.from==e}function dS(t,e,i){let n=t.charCategorizer(e);if(n(t.sliceDoc(e-1,e))!=iZ.Word)return e;for(let o of i){let i=e-o.length;if(t.sliceDoc(i,e)==o&&n(t.sliceDoc(i-1,i))!=iZ.Word)return i}return -1}const d_=[{key:"Ctrl-Space",run:c3},{mac:"Alt-`",run:c3},{key:"Escape",run:t=>{let e=t.state.field(c0,!1);return!!(e&&e.active.some(t=>0!=t.state))&&(t.dispatch({effects:cB.of(null)}),!0)}},{key:"ArrowDown",run:c5(!0)},{key:"ArrowUp",run:c5(!1)},{key:"PageDown",run:c5(!0,"page")},{key:"PageUp",run:c5(!1,"page")},{key:"Enter",run:t=>{let e=t.state.field(c0,!1);return!(t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(cN).interactionDelay)&&c1(t,e.open.options[e.open.selected])}}],dC=iP.highest(sT.computeN([cN],t=>t.facet(cN).defaultKeymap?[d_]:[])),dE=l2({atomic:hu.modifier,"while wait if else receive send run for loop in":hu.controlKeyword,instanceof:hu.operatorKeyword,"let const channel":hu.definitionKeyword,"program always main shared":hu.moduleKeyword,TemplateString:hu.special(hu.string),super:hu.atom,BooleanLiteral:hu.bool,this:hu.self,null:hu.null,Star:hu.modifier,Type:hu.typeName,"Variable/self":hu.self,LocalVariableName:hu.variableName,SharedVariableName:hu.propertyName,ProgName:hu.className,FnName:hu.macroName,UpdateOp:hu.updateOperator,LineComment:hu.lineComment,BlockComment:hu.blockComment,Number:hu.number,String:hu.string,ArithOp:hu.arithmeticOperator,LogicOp:hu.logicOperator,BitOp:hu.bitwiseOperator,CompareOp:hu.compareOperator,RegExp:hu.regexp,Equals:hu.definitionOperator,Arrow:hu.function(hu.punctuation),"( )":hu.paren,"[ ]":hu.squareBracket,"{ }":hu.brace,"InterpolationStart InterpolationEnd":hu.special(hu.brace),".":hu.derefOperator,", ;":hu.separator});let dM=lK.configure({props:[dE,hz.add({Application:t=>t.column(t.node.from)+t.unit}),hj.add({Application:function(t){let e=t.firstChild,i=t.lastChild;return e&&e.to<i.from?{from:e.to,to:i.type.isError?t.to:i.from}:null}})]});const dP=hv.define({parser:dM,languageData:{commentTokens:{line:";"}}}),dT=dP.data.of({autocomplete:cC([{label:"defun",type:"keyword"},{label:"defvar",type:"keyword"},{label:"let",type:"keyword"},{label:"cons",type:"function"},{label:"car",type:"function"},{label:"cdr",type:"function"}])});function dA(t,e){return({state:i,dispatch:n})=>{if(i.readOnly)return!1;let o=t(e,i);return!!o&&(n(i.update(o)),!0)}}const dD=dA(function(t,e,i=e.selection.ranges){let n=[],o=-1;for(let{from:t,to:r}of i){let i=n.length,s=1e9,a=dz(e,t).line;if(a){for(let i=t;i<=r;){let l=e.doc.lineAt(i);if(l.from>o&&(t==r||r>l.from)){o=l.from;let t=/^\s*/.exec(l.text)[0].length,e=t==l.length,i=l.text.slice(t,t+a.length)==a?t:-1;t<l.text.length&&t<s&&(s=t),n.push({line:l,comment:i,token:a,indent:t,empty:e,single:!1})}i=l.to+1}if(s<1e9)for(let t=i;t<n.length;t++)n[t].indent<n[t].line.text.length&&(n[t].indent=s);n.length==i+1&&(n[i].single=!0)}}if(2!=t&&n.some(t=>t.comment<0&&(!t.empty||t.single))){let t=[];for(let{line:e,token:i,indent:o,empty:r,single:s}of n)(s||!r)&&t.push({from:e.from+o,insert:i+" "});let i=e.changes(t);return{changes:i,selection:e.selection.map(i,1)}}if(1!=t&&n.some(t=>t.comment>=0)){let t=[];for(let{line:e,comment:i,token:o}of n)if(i>=0){let n=e.from+i,r=n+o.length;" "==e.text[r-e.from]&&r++,t.push({from:n,to:r})}return{changes:t}}return null},0),dI=dA(dR,0),dB=dA((t,e)=>dR(t,e,function(t){let e=[];for(let i of t.selection.ranges){let n=t.doc.lineAt(i.from),o=i.to<=n.to?n:t.doc.lineAt(i.to);o.from>n.from&&o.from==i.to&&(o=i.to==n.to+1?n:t.doc.lineAt(i.to-1));let r=e.length-1;r>=0&&e[r].to>n.from?e[r].to=o.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:o.to})}return e}(e)),0);function dz(t,e){let i=t.languageDataAt("commentTokens",e);return i.length?i[0]:{}}function dR(t,e,i=e.selection.ranges){let n=i.map(t=>dz(e,t.from).block);if(!n.every(t=>t))return null;let o=i.map((t,i)=>(function(t,{open:e,close:i},n,o){let r,s,a=t.sliceDoc(n-50,n),l=t.sliceDoc(o,o+50),h=/\s*$/.exec(a)[0].length,c=/^\s*/.exec(l)[0].length,d=a.length-h;if(a.slice(d-e.length,d)==e&&l.slice(c,c+i.length)==i)return{open:{pos:n-h,margin:h&&1},close:{pos:o+c,margin:c&&1}};o-n<=100?r=s=t.sliceDoc(n,o):(r=t.sliceDoc(n,n+50),s=t.sliceDoc(o-50,o));let u=/^\s*/.exec(r)[0].length,f=/\s*$/.exec(s)[0].length,p=s.length-f-i.length;return r.slice(u,u+e.length)==e&&s.slice(p,p+i.length)==i?{open:{pos:n+u+e.length,margin:/\s/.test(r.charAt(u+e.length))?1:0},close:{pos:o-f-i.length,margin:/\s/.test(s.charAt(p-1))?1:0}}:null})(e,n[i],t.from,t.to));if(2!=t&&!o.every(t=>t))return{changes:e.changes(i.map((t,e)=>o[e]?[]:[{from:t.from,insert:n[e].open+" "},{from:t.to,insert:" "+n[e].close}]))};if(1!=t&&o.some(t=>t)){let t=[];for(let e=0,i;e<o.length;e++)if(i=o[e]){let o=n[e],{open:r,close:s}=i;t.push({from:r.pos-o.open.length,to:r.pos+r.margin},{from:s.pos-s.margin,to:s.pos+o.close.length})}return{changes:t}}return null}const dN=iV.define(),dL=iV.define(),dF=iw.define(),dj=iw.define({combine:t=>i1(t,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(i,n)=>t(i,n)||e(i,n)})}),dH=iC.define({create:()=>d0.empty,update(t,e){let i=e.state.facet(dj),n=e.annotation(dN);if(n){let o=dU.fromTransaction(e,n.selection),r=n.side,s=0==r?t.undone:t.done;return s=o?dY(s,s.length,i.minDepth,o):dK(s,e.startState.selection),new d0(0==r?n.rest:s,0==r?s:n.rest)}let o=e.annotation(dL);if(("full"==o||"before"==o)&&(t=t.isolate()),!1===e.annotation(iU.addToHistory))return e.changes.empty?t:t.addMapping(e.changes.desc);let r=dU.fromTransaction(e),s=e.annotation(iU.time),a=e.annotation(iU.userEvent);return r?t=t.addChanges(r,s,a,i,e):e.selection&&(t=t.addSelection(e.startState.selection,s,a,i.newGroupDelay)),("full"==o||"after"==o)&&(t=t.isolate()),t},toJSON:t=>({done:t.done.map(t=>t.toJSON()),undone:t.undone.map(t=>t.toJSON())}),fromJSON:t=>new d0(t.done.map(dU.fromJSON),t.undone.map(dU.fromJSON))});function dW(t,e){return function({state:i,dispatch:n}){if(!e&&i.readOnly)return!1;let o=i.field(dH,!1);if(!o)return!1;let r=o.pop(t,i,e);return!!r&&(n(r),!0)}}const dV=dW(0,!1),dQ=dW(1,!1),d$=dW(0,!0),dq=dW(1,!0);class dU{constructor(t,e,i,n,o){this.changes=t,this.effects=e,this.mapped=i,this.startSelection=n,this.selectionsAfter=o}setSelAfter(t){return new dU(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,i;return{changes:null===(t=this.changes)||void 0===t?void 0:t.toJSON(),mapped:null===(e=this.mapped)||void 0===e?void 0:e.toJSON(),startSelection:null===(i=this.startSelection)||void 0===i?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(t=>t.toJSON())}}static fromJSON(t){return new dU(t.changes&&il.fromJSON(t.changes),[],t.mapped&&ia.fromJSON(t.mapped),t.startSelection&&iv.fromJSON(t.startSelection),t.selectionsAfter.map(iv.fromJSON))}static fromTransaction(t,e){let i=dX;for(let e of t.startState.facet(dF)){let n=e(t);n.length&&(i=i.concat(n))}return!i.length&&t.changes.empty?null:new dU(t.changes.invert(t.startState.doc),i,void 0,e||t.startState.selection,dX)}static selection(t){return new dU(void 0,dX,void 0,void 0,t)}}function dY(t,e,i,n){let o=t.slice(e+1>i+20?e-i-1:0,e);return o.push(n),o}function dG(t,e){return t.length?e.length?t.concat(e):t:e}const dX=[];function dK(t,e){if(!t.length)return[dU.selection([e])];{let i=t[t.length-1],n=i.selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-200));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),dY(t,t.length-1,1e9,i.setSelAfter(n)))}}function dZ(t,e){if(!t.length)return t;let i=t.length,n=dX;for(;i;){let o=function(t,e,i){let n=dG(t.selectionsAfter.length?t.selectionsAfter.map(t=>t.map(e)):dX,i);if(!t.changes)return dU.selection(n);let o=t.changes.map(e),r=e.mapDesc(t.changes,!0),s=t.mapped?t.mapped.composeDesc(r):r;return new dU(o,iq.mapEffects(t.effects,e),s,t.startSelection.map(r),n)}(t[i-1],e,n);if(o.changes&&!o.changes.empty||o.effects.length){let e=t.slice(0,i);return e[i-1]=o,e}e=o.mapped,i--,n=o.selectionsAfter}return n.length?[dU.selection(n)]:dX}const dJ=/^(input\.type|delete)($|\.)/;class d0{constructor(t,e,i=0,n){this.done=t,this.undone=e,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new d0(this.done,this.undone):this}addChanges(t,e,i,n,o){var r,s;let a,l,h=this.done,c=h[h.length-1];return new d0(h=c&&c.changes&&!c.changes.empty&&t.changes&&(!i||dJ.test(i))&&(!c.selectionsAfter.length&&e-this.prevTime<n.newGroupDelay&&n.joinToEvent(o,(r=c.changes,s=t.changes,a=[],l=!1,r.iterChangedRanges((t,e)=>a.push(t,e)),s.iterChangedRanges((t,e,i,n)=>{for(let t=0;t<a.length;){let e=a[t++],o=a[t++];n>=e&&i<=o&&(l=!0)}}),l))||"input.type.compose"==i)?dY(h,h.length-1,n.minDepth,new dU(t.changes.compose(c.changes),dG(iq.mapEffects(t.effects,c.changes),c.effects),c.mapped,c.startSelection,dX)):dY(h,h.length,n.minDepth,t),dX,e,i)}addSelection(t,e,i,n){var o;let r=this.done.length?this.done[this.done.length-1].selectionsAfter:dX;return r.length>0&&e-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&(o=r[r.length-1]).ranges.length==t.ranges.length&&0===o.ranges.filter((e,i)=>e.empty!=t.ranges[i].empty).length?this:new d0(dK(this.done,t),this.undone,e,i)}addMapping(t){return new d0(dZ(this.done,t),dZ(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,i){let n=0==t?this.done:this.undone;if(0==n.length)return null;let o=n[n.length-1],r=o.selectionsAfter[0]||e.selection;if(i&&o.selectionsAfter.length){let i,s;return e.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:dN.of({side:t,rest:(i=n[n.length-1],(s=n.slice())[n.length-1]=i.setSelAfter(i.selectionsAfter.slice(0,i.selectionsAfter.length-1)),s),selection:r}),userEvent:0==t?"select.undo":"select.redo",scrollIntoView:!0})}{if(!o.changes)return null;let i=1==n.length?dX:n.slice(0,n.length-1);return o.mapped&&(i=dZ(i,o.mapped)),e.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:dN.of({side:t,rest:i,selection:r}),filter:!1,userEvent:0==t?"undo":"redo",scrollIntoView:!0})}}}function d1(t,e){return iv.create(t.ranges.map(e),t.mainIndex)}function d2(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function d5({state:t,dispatch:e},i){let n=d1(t.selection,i);return!n.eq(t.selection,!0)&&(e(d2(t,n)),!0)}function d3(t,e){return iv.cursor(e?t.to:t.from)}function d4(t,e){return d5(t,i=>i.empty?t.moveByChar(i,e):d3(i,e))}function d8(t){return t.textDirectionAt(t.state.selection.main.head)==ox.LTR}d0.empty=new d0(dX,dX);const d6=t=>d4(t,!d8(t)),d9=t=>d4(t,d8(t));function d7(t,e){return d5(t,i=>i.empty?t.moveByGroup(i,e):d3(i,e))}function ut(t,e,i){let n,o,r=hy(t).resolveInner(e.head),s=i?aK.closedBy:aK.openedBy;for(let n=e.head;;){let e=i?r.childAfter(n):r.childBefore(n);if(!e)break;!function(t,e,i){if(e.type.prop(i))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}(t,e,s)?n=i?e.to:e.from:r=e}return o=r.type.prop(s)&&(n=i?cu(t,r.from,1):cu(t,r.to,-1))&&n.matched?i?n.end.to:n.end.from:i?r.to:r.from,iv.cursor(o,i?-1:1)}function ue(t,e){return d5(t,i=>{if(!i.empty)return d3(i,e);let n=t.moveVertically(i,e);return n.head!=i.head?n:t.moveToLineBoundary(i,e)})}"undefined"!=typeof Intl&&Intl.Segmenter;const ui=t=>ue(t,!1),un=t=>ue(t,!0);function uo(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,i=0,n=0,o;if(e){for(let e of t.state.facet(sk.scrollMargins)){let o=e(t);(null==o?void 0:o.top)&&(i=Math.max(null==o?void 0:o.top,i)),(null==o?void 0:o.bottom)&&(n=Math.max(null==o?void 0:o.bottom,n))}o=t.scrollDOM.clientHeight-i-n}else o=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:i,marginBottom:n,selfScroll:e,height:Math.max(t.defaultLineHeight,o-5)}}function ur(t,e){let i,n=uo(t),{state:o}=t,r=d1(o.selection,i=>i.empty?t.moveVertically(i,e,n.height):d3(i,e));if(r.eq(o.selection))return!1;if(n.selfScroll){let e=t.coordsAtPos(o.selection.main.head),s=t.scrollDOM.getBoundingClientRect(),a=s.top+n.marginTop,l=s.bottom-n.marginBottom;e&&e.top>a&&e.bottom<l&&(i=sk.scrollIntoView(r.main.head,{y:"start",yMargin:e.top-a}))}return t.dispatch(d2(o,r),{effects:i}),!0}const us=t=>ur(t,!1),ua=t=>ur(t,!0);function ul(t,e,i){let n=t.lineBlockAt(e.head),o=t.moveToLineBoundary(e,i);if(o.head==e.head&&o.head!=(i?n.to:n.from)&&(o=t.moveToLineBoundary(e,i,!1)),!i&&o.head==n.from&&n.length){let i=/^\s*/.exec(t.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;i&&e.head!=n.from+i&&(o=iv.cursor(n.from+i))}return o}function uh(t,e){let i=d1(t.state.selection,t=>{let i=e(t);return iv.range(t.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return!i.eq(t.state.selection)&&(t.dispatch(d2(t.state,i)),!0)}function uc(t,e){return uh(t,i=>t.moveByChar(i,e))}const ud=t=>uc(t,!d8(t)),uu=t=>uc(t,d8(t));function uf(t,e){return uh(t,i=>t.moveByGroup(i,e))}function up(t,e){return uh(t,i=>t.moveVertically(i,e))}const ug=t=>up(t,!1),um=t=>up(t,!0);function uv(t,e){return uh(t,i=>t.moveVertically(i,e,uo(t).height))}const uy=t=>uv(t,!1),ub=t=>uv(t,!0),uw=({state:t,dispatch:e})=>(e(d2(t,{anchor:0})),!0),ux=({state:t,dispatch:e})=>(e(d2(t,{anchor:t.doc.length})),!0),uk=({state:t,dispatch:e})=>(e(d2(t,{anchor:t.selection.main.anchor,head:0})),!0),uO=({state:t,dispatch:e})=>(e(d2(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0);function uS(t,e){if(t.state.readOnly)return!1;let i="delete.selection",{state:n}=t,o=n.changeByRange(n=>{let{from:o,to:r}=n;if(o==r){let s=e(n);s<o?(i="delete.backward",s=u_(t,s,!1)):s>o&&(i="delete.forward",s=u_(t,s,!0)),o=Math.min(o,s),r=Math.max(r,s)}else o=u_(t,o,!1),r=u_(t,r,!0);return o==r?{range:n}:{changes:{from:o,to:r},range:iv.cursor(o,o<n.head?-1:1)}});return!o.changes.empty&&(t.dispatch(n.update(o,{scrollIntoView:!0,userEvent:i,effects:"delete.selection"==i?sk.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function u_(t,e,i){if(t instanceof sk)for(let n of t.state.facet(sk.atomicRanges).map(e=>e(t)))n.between(e,e,(t,n)=>{t<e&&n>e&&(e=i?n:t)});return e}const uC=(t,e,i)=>uS(t,n=>{let o=n.from,{state:r}=t,s=r.doc.lineAt(o),a,l;if(i&&!e&&o>s.from&&o<s.from+200&&!/[^ \t]/.test(a=s.text.slice(0,o-s.from))){if("	"==a[a.length-1])return o-1;let t=nl(a,r.tabSize)%hA(r)||hA(r);for(let e=0;e<t&&" "==a[a.length-1-e];e++)o--;l=o}else(l=it(s.text,o-s.from,e,e)+s.from)==o&&s.number!=(e?r.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(s.text.slice(l-s.from,o-s.from))&&(l=it(s.text,l-s.from,!1,!1)+s.from);return l}),uE=t=>uC(t,!1,!0),uM=t=>uC(t,!0,!1),uP=(t,e)=>uS(t,i=>{let n=i.head,{state:o}=t,r=o.doc.lineAt(n),s=o.charCategorizer(n);for(let t=null;;){if(n==(e?r.to:r.from)){n==i.head&&r.number!=(e?o.doc.lines:1)&&(n+=e?1:-1);break}let a=it(r.text,n-r.from,e)+r.from,l=r.text.slice(Math.min(n,a)-r.from,Math.max(n,a)-r.from),h=s(l);if(null!=t&&h!=t)break;(" "!=l||n!=i.head)&&(t=h),n=a}return n}),uT=t=>uP(t,!1);function uA(t){let e=[],i=-1;for(let n of t.selection.ranges){let o=t.doc.lineAt(n.from),r=t.doc.lineAt(n.to);if(n.empty||n.to!=r.from||(r=t.doc.lineAt(n.to-1)),i>=o.number){let t=e[e.length-1];t.to=r.to,t.ranges.push(n)}else e.push({from:o.from,to:r.to,ranges:[n]});i=r.number+1}return e}function uD(t,e,i){if(t.readOnly)return!1;let n=[],o=[];for(let e of uA(t)){if(i?e.to==t.doc.length:0==e.from)continue;let r=t.doc.lineAt(i?e.to+1:e.from-1),s=r.length+1;if(i)for(let i of(n.push({from:e.to,to:r.to},{from:e.from,insert:r.text+t.lineBreak}),e.ranges))o.push(iv.range(Math.min(t.doc.length,i.anchor+s),Math.min(t.doc.length,i.head+s)));else for(let i of(n.push({from:r.from,to:e.from},{from:e.to,insert:t.lineBreak+r.text}),e.ranges))o.push(iv.range(i.anchor-s,i.head-s))}return!!n.length&&(e(t.update({changes:n,scrollIntoView:!0,selection:iv.create(o,t.selection.mainIndex),userEvent:"move.line"})),!0)}function uI(t,e,i){if(t.readOnly)return!1;let n=[];for(let e of uA(t))i?n.push({from:e.from,insert:t.doc.slice(e.from,e.to)+t.lineBreak}):n.push({from:e.to,insert:t.lineBreak+t.doc.slice(e.from,e.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const uB=uR(!1),uz=uR(!0);function uR(t){return({state:e,dispatch:i})=>{if(e.readOnly)return!1;let n=e.changeByRange(i=>{let{from:n,to:o}=i,r=e.doc.lineAt(n),s=!t&&n==o&&function(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let i=hy(t).resolveInner(e),n=i.childBefore(e),o=i.childAfter(e),r;return n&&o&&n.to<=e&&o.from>=e&&(r=n.type.prop(aK.closedBy))&&r.indexOf(o.name)>-1&&t.doc.lineAt(n.to).from==t.doc.lineAt(o.from).from&&!/\S/.test(t.sliceDoc(n.to,o.from))?{from:n.to,to:o.from}:null}(e,n);t&&(n=o=(o<=r.to?r:e.doc.lineAt(o)).to);let a=new hB(e,{simulateBreak:n,simulateDoubleBreak:!!s}),l=hI(a,n);for(null==l&&(l=nl(/^\s*/.exec(e.doc.lineAt(n).text)[0],e.tabSize));o<r.to&&/\s/.test(r.text[o-r.from]);)o++;s?{from:n,to:o}=s:n>r.from&&n<r.from+100&&!/\S/.test(r.text.slice(0,n))&&(n=r.from);let h=["",hD(e,l)];return s&&h.push(hD(e,a.lineIndent(r.from,-1))),{changes:{from:n,to:o,insert:e1.of(h)},range:iv.cursor(n+1+h[1].length)}});return i(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function uN(t,e){let i=-1;return t.changeByRange(n=>{let o=[];for(let r=n.from;r<=n.to;){let s=t.doc.lineAt(r);s.number>i&&(n.empty||n.to>s.from)&&(e(s,o,n),i=s.number),r=s.to+1}let r=t.changes(o);return{changes:o,range:iv.range(r.mapPos(n.anchor,1),r.mapPos(n.head,1))}})}const uL=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(uN(t,(e,i)=>{i.push({from:e.from,insert:t.facet(hT)})}),{userEvent:"input.indent"})),!0),uF=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(uN(t,(e,i)=>{let n=/^\s*/.exec(e.text)[0];if(!n)return;let o=nl(n,t.tabSize),r=0,s=hD(t,Math.max(0,o-hA(t)));for(;r<n.length&&r<s.length&&n.charCodeAt(r)==s.charCodeAt(r);)r++;i.push({from:e.from+r,to:e.from+n.length,insert:s.slice(r)})}),{userEvent:"delete.dedent"})),!0),uj=[{key:"Ctrl-b",run:d6,shift:ud,preventDefault:!0},{key:"Ctrl-f",run:d9,shift:uu},{key:"Ctrl-p",run:ui,shift:ug},{key:"Ctrl-n",run:un,shift:um},{key:"Ctrl-a",run:t=>d5(t,e=>iv.cursor(t.lineBlockAt(e.head).from,1)),shift:t=>uh(t,e=>iv.cursor(t.lineBlockAt(e.head).from))},{key:"Ctrl-e",run:t=>d5(t,e=>iv.cursor(t.lineBlockAt(e.head).to,-1)),shift:t=>uh(t,e=>iv.cursor(t.lineBlockAt(e.head).to))},{key:"Ctrl-d",run:uM},{key:"Ctrl-h",run:uE},{key:"Ctrl-k",run:t=>uS(t,e=>{let i=t.lineBlockAt(e.head).to;return e.head<i?i:Math.min(t.state.doc.length,e.head+1)})},{key:"Ctrl-Alt-h",run:uT},{key:"Ctrl-o",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e1.of(["",""])},range:iv.cursor(t.from)}));return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange(e=>{if(!e.empty||0==e.from||e.from==t.doc.length)return{range:e};let i=e.from,n=t.doc.lineAt(i),o=i==n.from?i-1:it(n.text,i-n.from,!1)+n.from,r=i==n.to?i+1:it(n.text,i-n.from,!0)+n.from;return{changes:{from:o,to:r,insert:t.doc.slice(i,r).append(t.doc.slice(o,i))},range:iv.cursor(r)}});return!i.changes.empty&&(e(t.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:ua}],uH=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:t=>d5(t,e=>ut(t.state,e,!d8(t))),shift:t=>uh(t,e=>ut(t.state,e,!d8(t)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:t=>d5(t,e=>ut(t.state,e,d8(t))),shift:t=>uh(t,e=>ut(t.state,e,d8(t)))},{key:"Alt-ArrowUp",run:({state:t,dispatch:e})=>uD(t,e,!1)},{key:"Shift-Alt-ArrowUp",run:({state:t,dispatch:e})=>uI(t,e,!1)},{key:"Alt-ArrowDown",run:({state:t,dispatch:e})=>uD(t,e,!0)},{key:"Shift-Alt-ArrowDown",run:({state:t,dispatch:e})=>uI(t,e,!0)},{key:"Escape",run:({state:t,dispatch:e})=>{let i=t.selection,n=null;return i.ranges.length>1?n=iv.create([i.main]):i.main.empty||(n=iv.create([iv.cursor(i.main.head)])),!!n&&(e(d2(t,n)),!0)}},{key:"Mod-Enter",run:uz},{key:"Alt-l",mac:"Ctrl-l",run:({state:t,dispatch:e})=>{let i=uA(t).map(({from:e,to:i})=>iv.range(e,Math.min(i+1,t.doc.length)));return e(t.update({selection:iv.create(i),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:t,dispatch:e})=>{let i=d1(t.selection,e=>{let i=hy(t),n=i.resolveStack(e.from,1);if(e.empty){let t=i.resolveStack(e.from,-1);t.node.from>=n.node.from&&t.node.to<=n.node.to&&(n=t)}for(let t=n;t;t=t.next){let{node:i}=t;if((i.from<e.from&&i.to>=e.to||i.to>e.to&&i.from<=e.from)&&t.next)return iv.range(i.to,i.from)}return e});return!i.eq(t.selection)&&(e(d2(t,i)),!0)},preventDefault:!0},{key:"Mod-[",run:uF},{key:"Mod-]",run:uL},{key:"Mod-Alt-\\",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=Object.create(null),n=new hB(t,{overrideIndentation:t=>{let e=i[t];return null==e?-1:e}}),o=uN(t,(e,o,r)=>{let s=hI(n,e.from);if(null==s)return;/\S/.test(e.text)||(s=0);let a=/^\s*/.exec(e.text)[0],l=hD(t,s);(a!=l||r.from<e.from+a.length)&&(i[e.from]=s,o.push({from:e.from,to:e.from+a.length,insert:l}))});return o.changes.empty||e(t.update(o,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:t=>{if(t.state.readOnly)return!1;let{state:e}=t,i=e.changes(uA(e).map(({from:t,to:i})=>(t>0?t--:i<e.doc.length&&i++,{from:t,to:i}))),n=d1(e.selection,e=>{let i;if(t.lineWrapping){let n=t.lineBlockAt(e.head),o=t.coordsAtPos(e.head,e.assoc||1);o&&(i=n.bottom+t.documentTop-o.bottom+t.defaultLineHeight/2)}return t.moveVertically(e,!0,i)}).map(i);return t.dispatch({changes:i,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:t,dispatch:e})=>{let i,n;return i=!1,n=d1(t.selection,e=>{let n=cu(t,e.head,-1)||cu(t,e.head,1)||e.head>0&&cu(t,e.head-1,1)||e.head<t.doc.length&&cu(t,e.head+1,-1);if(!n||!n.end)return e;i=!0;let o=n.start.from==e.head?n.end.to:n.end.from;return iv.cursor(o)}),!!i&&(e(d2(t,n)),!0)}},{key:"Mod-/",run:t=>{let{state:e}=t,i=e.doc.lineAt(e.selection.main.from),n=dz(t.state,i.from);return n.line?dD(t):!!n.block&&dB(t)}},{key:"Alt-A",run:dI},{key:"Ctrl-m",mac:"Shift-Alt-m",run:t=>(t.setTabFocusMode(),!0)}].concat([{key:"ArrowLeft",run:d6,shift:ud,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:t=>d7(t,!d8(t)),shift:t=>uf(t,!d8(t)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:t=>d5(t,e=>ul(t,e,!d8(t))),shift:t=>uh(t,e=>ul(t,e,!d8(t))),preventDefault:!0},{key:"ArrowRight",run:d9,shift:uu,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:t=>d7(t,d8(t)),shift:t=>uf(t,d8(t)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:t=>d5(t,e=>ul(t,e,d8(t))),shift:t=>uh(t,e=>ul(t,e,d8(t))),preventDefault:!0},{key:"ArrowUp",run:ui,shift:ug,preventDefault:!0},{mac:"Cmd-ArrowUp",run:uw,shift:uk},{mac:"Ctrl-ArrowUp",run:us,shift:uy},{key:"ArrowDown",run:un,shift:um,preventDefault:!0},{mac:"Cmd-ArrowDown",run:ux,shift:uO},{mac:"Ctrl-ArrowDown",run:ua,shift:ub},{key:"PageUp",run:us,shift:uy},{key:"PageDown",run:ua,shift:ub},{key:"Home",run:t=>d5(t,e=>ul(t,e,!1)),shift:t=>uh(t,e=>ul(t,e,!1)),preventDefault:!0},{key:"Mod-Home",run:uw,shift:uk},{key:"End",run:t=>d5(t,e=>ul(t,e,!0)),shift:t=>uh(t,e=>ul(t,e,!0)),preventDefault:!0},{key:"Mod-End",run:ux,shift:uO},{key:"Enter",run:uB,shift:uB},{key:"Mod-a",run:({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:uE,shift:uE},{key:"Delete",run:uM},{key:"Mod-Backspace",mac:"Alt-Backspace",run:uT},{key:"Mod-Delete",mac:"Alt-Delete",run:t=>uP(t,!0)},{mac:"Mod-Backspace",run:t=>uS(t,e=>{let i=t.moveToLineBoundary(e,!1).head;return e.head>i?i:Math.max(0,e.head-1)})},{mac:"Mod-Delete",run:t=>uS(t,e=>{let i=t.moveToLineBoundary(e,!0).head;return e.head<i?i:Math.min(t.state.doc.length,e.head+1)})}].concat(uj.map(t=>({mac:t.key,run:t.run,shift:t.shift})))),uW={key:"Tab",run:uL,shift:uF};function uV(){var t=arguments[0];"string"==typeof t&&(t=document.createElement(t));var e=1,i=arguments[1];if(i&&"object"==typeof i&&null==i.nodeType&&!Array.isArray(i)){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var o=i[n];"string"==typeof o?t.setAttribute(n,o):null!=o&&(t[n]=o)}e++}for(;e<arguments.length;e++)!function t(e,i){if("string"==typeof i)e.appendChild(document.createTextNode(i));else if(null==i);else if(null!=i.nodeType)e.appendChild(i);else if(Array.isArray(i))for(var n=0;n<i.length;n++)t(e,i[n]);else throw RangeError("Unsupported child node: "+i)}(t,arguments[e]);return t}const uQ="function"==typeof String.prototype.normalize?t=>t.normalize("NFKD"):t=>t;class u${constructor(t,e,i=0,n=t.length,o,r){this.test=r,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(i,n),this.bufferStart=i,this.normalize=o?t=>o(uQ(t)):uQ,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return -1;this.bufferPos=0,this.buffer=this.iter.value}return ie(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=ii(t),i=this.bufferStart+this.bufferPos;this.bufferPos+=io(t);let n=this.normalize(e);if(n.length)for(let t=0,o=i;;t++){let r=n.charCodeAt(t),s=this.match(r,o,this.bufferPos+this.bufferStart);if(t==n.length-1){if(s)return this.value=s,this;break}o==i&&t<e.length&&e.charCodeAt(t)==r&&o++}}}match(t,e,i){let n=null;for(let e=0;e<this.matches.length;e+=2){let o=this.matches[e],r=!1;this.query.charCodeAt(o)==t&&(o==this.query.length-1?n={from:this.matches[e+1],to:i}:(this.matches[e]++,r=!0)),r||(this.matches.splice(e,2),e-=2)}return this.query.charCodeAt(0)==t&&(1==this.query.length?n={from:e,to:i}:this.matches.push(1,e)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferStart)&&(n=null),n}}"undefined"!=typeof Symbol&&(u$.prototype[Symbol.iterator]=function(){return this});const uq={from:-1,to:-1,match:/.*/.exec("")},uU="gm"+(null==/x/.unicode?"":"u");class uY{constructor(t,e,i,n=0,o=t.length){if(this.text=t,this.to=o,this.curLine="",this.done=!1,this.value=uq,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new uK(t,e,i,n,o);this.re=new RegExp(e,uU+((null==i?void 0:i.ignoreCase)?"i":"")),this.test=null==i?void 0:i.test,this.iter=t.iter();let r=t.lineAt(n);this.curLineStart=r.from,this.matchPos=uZ(t,n),this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let i=this.curLineStart+e.index,n=i+e[0].length;if(this.matchPos=uZ(this.text,n+(i==n?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<n||i>this.value.to)&&(!this.test||this.test(i,n,e)))return this.value={from:i,to:n,match:e},this;t=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),t=0}}}}const uG=new WeakMap;class uX{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,i){let n=uG.get(t);if(!n||n.from>=i||n.to<=e){let n=new uX(e,t.sliceString(e,i));return uG.set(t,n),n}if(n.from==e&&n.to==i)return n;let{text:o,from:r}=n;return r>e&&(o=t.sliceString(e,r)+o,r=e),n.to<i&&(o+=t.sliceString(n.to,i)),uG.set(t,new uX(r,o)),new uX(e,o.slice(e-r,i-r))}}class uK{constructor(t,e,i,n,o){this.text=t,this.to=o,this.done=!1,this.value=uq,this.matchPos=uZ(t,n),this.re=new RegExp(e,uU+((null==i?void 0:i.ignoreCase)?"i":"")),this.test=null==i?void 0:i.test,this.flat=uX.get(t,n,this.chunkEnd(n+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e){let t=this.flat.from+e.index,i=t+e[0].length;if((this.flat.to>=this.to||e.index+e[0].length<=this.flat.text.length-10)&&(!this.test||this.test(t,i,e)))return this.value={from:t,to:i,match:e},this.matchPos=uZ(this.text,i+(t==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=uX.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function uZ(t,e){if(e>=t.length)return e;let i=t.lineAt(e),n;for(;e<i.to&&(n=i.text.charCodeAt(e-i.from))>=56320&&n<57344;)e++;return e}function uJ(t){let e=uV("input",{class:"cm-textfield",name:"line",value:String(t.state.doc.lineAt(t.state.selection.main.head).number)});function i(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!i)return;let{state:n}=t,o=n.doc.lineAt(n.selection.main.head),[,r,s,a,l]=i,h=a?+a.slice(1):0,c=s?+s:o.number;if(s&&l){let t=c/100;r&&(t=t*("-"==r?-1:1)+o.number/n.doc.lines),c=Math.round(n.doc.lines*t)}else s&&r&&(c=c*("-"==r?-1:1)+o.number);let d=n.doc.line(Math.max(1,Math.min(n.doc.lines,c))),u=iv.cursor(d.from+Math.max(0,Math.min(h,d.length)));t.dispatch({effects:[u0.of(!1),sk.scrollIntoView(u.from,{y:"center"})],selection:u}),t.focus()}return{dom:uV("form",{class:"cm-gotoLine",onkeydown:e=>{27==e.keyCode?(e.preventDefault(),t.dispatch({effects:u0.of(!1)}),t.focus()):13==e.keyCode&&(e.preventDefault(),i())},onsubmit:t=>{t.preventDefault(),i()}},uV("label",t.state.phrase("Go to line"),": ",e)," ",uV("button",{class:"cm-button",type:"submit"},t.state.phrase("go")))}}"undefined"!=typeof Symbol&&(uY.prototype[Symbol.iterator]=uK.prototype[Symbol.iterator]=function(){return this});const u0=iq.define(),u1=iC.define({create:()=>!0,update(t,e){for(let i of e.effects)i.is(u0)&&(t=i.value);return t},provide:t=>a_.from(t,t=>t?uJ:null)}),u2=sk.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),u5={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},u3=iw.define({combine:t=>i1(t,u5,{highlightWordAroundCursor:(t,e)=>t||e,minSelectionLength:Math.min,maxMatches:Math.min})}),u4=oh.mark({class:"cm-selectionMatch"}),u8=oh.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function u6(t,e,i,n){return(0==i||t(e.sliceDoc(i-1,i))!=iZ.Word)&&(n==e.doc.length||t(e.sliceDoc(n,n+1))!=iZ.Word)}const u9=o0.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(u3),{state:i}=t,n=i.selection;if(n.ranges.length>1)return oh.none;let o=n.main,r,s=null;if(o.empty){if(!e.highlightWordAroundCursor)return oh.none;let t=i.wordAt(o.head);if(!t)return oh.none;s=i.charCategorizer(o.head),r=i.sliceDoc(t.from,t.to)}else{let t=o.to-o.from;if(t<e.minSelectionLength||t>200)return oh.none;if(e.wholeWords){var a,l,h;if(r=i.sliceDoc(o.from,o.to),!(u6(s=i.charCategorizer(o.head),i,o.from,o.to)&&(a=s,l=o.from,h=o.to,a(i.sliceDoc(l,l+1))==iZ.Word&&a(i.sliceDoc(h-1,h))==iZ.Word)))return oh.none}else if(!(r=i.sliceDoc(o.from,o.to)))return oh.none}let c=[];for(let n of t.visibleRanges){let t=new u$(i.doc,r,n.from,n.to);for(;!t.next().done;){let{from:n,to:r}=t.value;if((!s||u6(s,i,n,r))&&(o.empty&&n<=o.from&&r>=o.to?c.push(u8.range(n,r)):(n>=o.to||r<=o.from)&&c.push(u4.range(n,r)),c.length>e.maxMatches))return oh.none}}return oh.set(c)}},{decorations:t=>t.decorations}),u7=sk.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),ft=({state:t,dispatch:e})=>{let{selection:i}=t,n=iv.create(i.ranges.map(e=>t.wordAt(e.head)||iv.cursor(e.head)),i.mainIndex);return!n.eq(i)&&(e(t.update({selection:n})),!0)},fe=iw.define({combine:t=>i1(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:t=>new fT(t),scrollToMatch:t=>sk.scrollIntoView(t)})});class fi{constructor(t){this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.literal=!!t.literal,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||function(t){try{return new RegExp(t,uU),!0}catch(t){return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!t.wholeWord}unquote(t){return this.literal?t:t.replace(/\\([nrt\\])/g,(t,e)=>"n"==e?"\n":"r"==e?"\r":"t"==e?"	":"\\")}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseSensitive==t.caseSensitive&&this.regexp==t.regexp&&this.wholeWord==t.wholeWord}create(){return this.regexp?new fh(this):new fr(this)}getCursor(t,e=0,i){let n=t.doc?t:i0.create({doc:t});return null==i&&(i=n.doc.length),this.regexp?fs(this,n,e,i):fo(this,n,e,i)}}class fn{constructor(t){this.spec=t}}function fo(t,e,i,n){var o,r;return new u$(e.doc,t.unquoted,i,n,t.caseSensitive?void 0:t=>t.toLowerCase(),t.wholeWord?(o=e.doc,r=e.charCategorizer(e.selection.main.head),(t,e,i,n)=>((n>t||n+i.length<e)&&(n=Math.max(0,t-2),i=o.sliceString(n,Math.min(o.length,e+2))),(r(fa(i,t-n))!=iZ.Word||r(fl(i,t-n))!=iZ.Word)&&(r(fl(i,e-n))!=iZ.Word||r(fa(i,e-n))!=iZ.Word))):void 0)}class fr extends fn{constructor(t){super(t)}nextMatch(t,e,i){let n=fo(this.spec,t,i,t.doc.length).nextOverlapping();if(n.done){let i=Math.min(t.doc.length,e+this.spec.unquoted.length);n=fo(this.spec,t,0,i).nextOverlapping()}return n.done||n.value.from==e&&n.value.to==i?null:n.value}prevMatchInRange(t,e,i){for(let n=i;;){let i=Math.max(e,n-1e4-this.spec.unquoted.length),o=fo(this.spec,t,i,n),r=null;for(;!o.nextOverlapping().done;)r=o.value;if(r)return r;if(i==e)return null;n-=1e4}}prevMatch(t,e,i){let n=this.prevMatchInRange(t,0,e);return n||(n=this.prevMatchInRange(t,Math.max(0,i-this.spec.unquoted.length),t.doc.length)),n&&(n.from!=e||n.to!=i)?n:null}getReplacement(t){return this.spec.unquote(this.spec.replace)}matchAll(t,e){let i=fo(this.spec,t,0,t.doc.length),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let o=fo(this.spec,t,Math.max(0,e-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,t.doc.length));for(;!o.next().done;)n(o.value.from,o.value.to)}}function fs(t,e,i,n){var o;return new uY(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?(o=e.charCategorizer(e.selection.main.head),(t,e,i)=>!i[0].length||(o(fa(i.input,i.index))!=iZ.Word||o(fl(i.input,i.index))!=iZ.Word)&&(o(fl(i.input,i.index+i[0].length))!=iZ.Word||o(fa(i.input,i.index+i[0].length))!=iZ.Word)):void 0},i,n)}function fa(t,e){return t.slice(it(t,e,!1),e)}function fl(t,e){return t.slice(e,it(t,e))}class fh extends fn{nextMatch(t,e,i){let n=fs(this.spec,t,i,t.doc.length).next();return n.done&&(n=fs(this.spec,t,0,e).next()),n.done?null:n.value}prevMatchInRange(t,e,i){for(let n=1;;n++){let o=Math.max(e,i-1e4*n),r=fs(this.spec,t,o,i),s=null;for(;!r.next().done;)s=r.value;if(s&&(o==e||s.from>o+10))return s;if(o==e)return null}}prevMatch(t,e,i){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,i,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(e,i)=>"$"==i?"$":"&"==i?t.match[0]:"0"!=i&&+i<t.match.length?t.match[i]:e)}matchAll(t,e){let i=fs(this.spec,t,0,t.doc.length),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let o=fs(this.spec,t,Math.max(0,e-250),Math.min(i+250,t.doc.length));for(;!o.next().done;)n(o.value.from,o.value.to)}}const fc=iq.define(),fd=iq.define(),fu=iC.define({create:t=>new ff(fS(t).create(),null),update(t,e){for(let i of e.effects)i.is(fc)?t=new ff(i.value.create(),t.panel):i.is(fd)&&(t=new ff(t.query,i.value?fO:null));return t},provide:t=>a_.from(t,t=>t.panel)});class ff{constructor(t,e){this.query=t,this.panel=e}}const fp=oh.mark({class:"cm-searchMatch"}),fg=oh.mark({class:"cm-searchMatch cm-searchMatch-selected"}),fm=o0.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(fu))}update(t){let e=t.state.field(fu);(e!=t.startState.field(fu)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return oh.none;let{view:i}=this,n=new i6;for(let e=0,o=i.visibleRanges,r=o.length;e<r;e++){let{from:s,to:a}=o[e];for(;e<r-1&&a>o[e+1].from-500;)a=o[++e].to;t.highlight(i.state,s,a,(t,e)=>{let o=i.state.selection.ranges.some(i=>i.from==t&&i.to==e);n.add(t,e,o?fg:fp)})}return n.finish()}},{decorations:t=>t.decorations});function fv(t){return e=>{let i=e.state.field(fu,!1);return i&&i.query.spec.valid?t(e,i):fE(e)}}const fy=fv((t,{query:e})=>{let{to:i}=t.state.selection.main,n=e.nextMatch(t.state,i,i);if(!n)return!1;let o=iv.single(n.from,n.to),r=t.state.facet(fe);return t.dispatch({selection:o,effects:[fI(t,n),r.scrollToMatch(o.main,t)],userEvent:"select.search"}),fC(t),!0}),fb=fv((t,{query:e})=>{let{state:i}=t,{from:n}=i.selection.main,o=e.prevMatch(i,n,n);if(!o)return!1;let r=iv.single(o.from,o.to),s=t.state.facet(fe);return t.dispatch({selection:r,effects:[fI(t,o),s.scrollToMatch(r.main,t)],userEvent:"select.search"}),fC(t),!0}),fw=fv((t,{query:e})=>{let i=e.matchAll(t.state,1e3);return!!i&&!!i.length&&(t.dispatch({selection:iv.create(i.map(t=>iv.range(t.from,t.to))),userEvent:"select.search.matches"}),!0)}),fx=fv((t,{query:e})=>{let{state:i}=t,{from:n,to:o}=i.selection.main;if(i.readOnly)return!1;let r=e.nextMatch(i,n,n);if(!r)return!1;let s=r,a=[],l,h,c=[];if(s.from==n&&s.to==o&&(h=i.toText(e.getReplacement(s)),a.push({from:s.from,to:s.to,insert:h}),s=e.nextMatch(i,s.from,s.to),c.push(sk.announce.of(i.phrase("replaced match on line $",i.doc.lineAt(n).number)+"."))),s){let e=0==a.length||a[0].from>=r.to?0:r.to-r.from-h.length;l=iv.single(s.from-e,s.to-e),c.push(fI(t,s)),c.push(i.facet(fe).scrollToMatch(l.main,t))}return t.dispatch({changes:a,selection:l,effects:c,userEvent:"input.replace"}),!0}),fk=fv((t,{query:e})=>{if(t.state.readOnly)return!1;let i=e.matchAll(t.state,1e9).map(t=>{let{from:i,to:n}=t;return{from:i,to:n,insert:e.getReplacement(t)}});if(!i.length)return!1;let n=t.state.phrase("replaced $ matches",i.length)+".";return t.dispatch({changes:i,effects:sk.announce.of(n),userEvent:"input.replace.all"}),!0});function fO(t){return t.state.facet(fe).createPanel(t)}function fS(t,e){var i,n,o,r,s;let a=t.selection.main,l=a.empty||a.to>a.from+100?"":t.sliceDoc(a.from,a.to);if(e&&!l)return e;let h=t.facet(fe);return new fi({search:(null!==(i=null==e?void 0:e.literal)&&void 0!==i?i:h.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:null!==(n=null==e?void 0:e.caseSensitive)&&void 0!==n?n:h.caseSensitive,literal:null!==(o=null==e?void 0:e.literal)&&void 0!==o?o:h.literal,regexp:null!==(r=null==e?void 0:e.regexp)&&void 0!==r?r:h.regexp,wholeWord:null!==(s=null==e?void 0:e.wholeWord)&&void 0!==s?s:h.wholeWord})}function f_(t){let e=ax(t,fO);return e&&e.dom.querySelector("[main-field]")}function fC(t){let e=f_(t);e&&e==t.root.activeElement&&e.select()}const fE=t=>{let e=t.state.field(fu,!1);if(e&&e.panel){let i=f_(t);if(i&&i!=t.root.activeElement){let n=fS(t.state,e.query.spec);n.valid&&t.dispatch({effects:fc.of(n)}),i.focus(),i.select()}}else t.dispatch({effects:[fd.of(!0),e?fc.of(fS(t.state,e.query.spec)):iq.appendConfig.of(fz)]});return!0},fM=t=>{let e=t.state.field(fu,!1);if(!e||!e.panel)return!1;let i=ax(t,fO);return i&&i.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:fd.of(!1)}),!0},fP=[{key:"Mod-f",run:fE,scope:"editor search-panel"},{key:"F3",run:fy,shift:fb,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:fy,shift:fb,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:fM,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:t,dispatch:e})=>{let i=t.selection;if(i.ranges.length>1||i.main.empty)return!1;let{from:n,to:o}=i.main,r=[],s=0;for(let e=new u$(t.doc,t.sliceDoc(n,o));!e.next().done;){if(r.length>1e3)return!1;e.value.from==n&&(s=r.length),r.push(iv.range(e.value.from,e.value.to))}return e(t.update({selection:iv.create(r,s),userEvent:"select.search.matches"})),!0}},{key:"Mod-Alt-g",run:t=>{let e=ax(t,uJ);if(!e){let i=[u0.of(!0)];null==t.state.field(u1,!1)&&i.push(iq.appendConfig.of([u1,u2])),t.dispatch({effects:i}),e=ax(t,uJ)}return e&&e.dom.querySelector("input").select(),!0}},{key:"Mod-d",run:({state:t,dispatch:e})=>{let{ranges:i}=t.selection;if(i.some(t=>t.from===t.to))return ft({state:t,dispatch:e});let n=t.sliceDoc(i[0].from,i[0].to);if(t.selection.ranges.some(e=>t.sliceDoc(e.from,e.to)!=n))return!1;let o=function(t,e){let{main:i,ranges:n}=t.selection,o=t.wordAt(i.head),r=o&&o.from==i.from&&o.to==i.to;for(let i=!1,o=new u$(t.doc,e,n[n.length-1].to);;)if(o.next(),o.done){if(i)return null;o=new u$(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),i=!0}else{if(i&&n.some(t=>t.from==o.value.from))continue;if(r){let e=t.wordAt(o.value.from);if(!e||e.from!=o.value.from||e.to!=o.value.to)continue}return o.value}}(t,n);return!!o&&(e(t.update({selection:t.selection.addRange(iv.range(o.from,o.to),!1),effects:sk.scrollIntoView(o.to)})),!0)},preventDefault:!0}];class fT{constructor(t){this.view=t;let e=this.query=t.state.field(fu).query.spec;function i(t,e,i){return uV("button",{class:"cm-button",name:t,onclick:e,type:"button"},i)}this.commit=this.commit.bind(this),this.searchField=uV("input",{value:e.search,placeholder:fA(t,"Find"),"aria-label":fA(t,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=uV("input",{value:e.replace,placeholder:fA(t,"Replace"),"aria-label":fA(t,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=uV("input",{type:"checkbox",name:"case",form:"",checked:e.caseSensitive,onchange:this.commit}),this.reField=uV("input",{type:"checkbox",name:"re",form:"",checked:e.regexp,onchange:this.commit}),this.wordField=uV("input",{type:"checkbox",name:"word",form:"",checked:e.wholeWord,onchange:this.commit}),this.dom=uV("div",{onkeydown:t=>this.keydown(t),class:"cm-search"},[this.searchField,i("next",()=>fy(t),[fA(t,"next")]),i("prev",()=>fb(t),[fA(t,"previous")]),i("select",()=>fw(t),[fA(t,"all")]),uV("label",null,[this.caseField,fA(t,"match case")]),uV("label",null,[this.reField,fA(t,"regexp")]),uV("label",null,[this.wordField,fA(t,"by word")]),...t.state.readOnly?[]:[uV("br"),this.replaceField,i("replace",()=>fx(t),[fA(t,"replace")]),i("replaceAll",()=>fk(t),[fA(t,"replace all")])],uV("button",{name:"close",onclick:()=>fM(t),"aria-label":fA(t,"close"),type:"button"},["Ã"])])}commit(){let t=new fi({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});t.eq(this.query)||(this.query=t,this.view.dispatch({effects:fc.of(t)}))}keydown(t){var e,i;(e=this.view,i="search-panel",sz(sD(e.state),t,e,i))?t.preventDefault():13==t.keyCode&&t.target==this.searchField?(t.preventDefault(),(t.shiftKey?fb:fy)(this.view)):13==t.keyCode&&t.target==this.replaceField&&(t.preventDefault(),fx(this.view))}update(t){for(let e of t.transactions)for(let t of e.effects)t.is(fc)&&!t.value.eq(this.query)&&this.setQuery(t.value)}setQuery(t){this.query=t,this.searchField.value=t.search,this.replaceField.value=t.replace,this.caseField.checked=t.caseSensitive,this.reField.checked=t.regexp,this.wordField.checked=t.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(fe).top}}function fA(t,e){return t.state.phrase(e)}const fD=/[\s\.,:;?!]/;function fI(t,{from:e,to:i}){let n=t.state.doc.lineAt(e),o=t.state.doc.lineAt(i).to,r=Math.max(n.from,e-30),s=Math.min(o,i+30),a=t.state.sliceDoc(r,s);if(r!=n.from){for(let t=0;t<30;t++)if(!fD.test(a[t+1])&&fD.test(a[t])){a=a.slice(t);break}}if(s!=o){for(let t=a.length-1;t>a.length-30;t--)if(!fD.test(a[t-1])&&fD.test(a[t])){a=a.slice(0,t);break}}return sk.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${n.number}.`)}const fB=sk.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),fz=[fu,iP.low(fm),fB];class fR{constructor(t,e,i){this.from=t,this.to=e,this.diagnostic=i}}class fN{constructor(t,e,i){this.diagnostics=t,this.panel=e,this.selected=i}static init(t,e,i){let n=t,o=i.facet(fX).markerFilter;o&&(n=o(n,i));let r=t.slice().sort((t,e)=>t.from-e.from||t.to-e.to),s=new i6,a=[],l=0;for(let t=0;;){let e,n,o=t==r.length?null:r[t];if(!o&&!a.length)break;for(a.length?(e=l,n=a.reduce((t,e)=>Math.min(t,e.to),o&&o.from>e?o.from:1e8)):(e=o.from,n=o.to,a.push(o),t++);t<r.length;){let i=r[t];if(i.from==e&&(i.to>i.from||i.to==e))a.push(i),t++,n=Math.min(i.to,n);else{n=Math.min(i.from,n);break}}let h=f4(a);if(a.some(t=>t.from==t.to||t.from==t.to-1&&i.doc.lineAt(t.from).to==t.from))s.add(e,e,oh.widget({widget:new fJ(h),diagnostics:a.slice()}));else{let t=a.reduce((t,e)=>e.markClass?t+" "+e.markClass:t,"");s.add(e,n,oh.mark({class:"cm-lintRange cm-lintRange-"+h+t,diagnostics:a.slice(),inclusiveEnd:a.some(t=>t.to>n)}))}l=n;for(let t=0;t<a.length;t++)a[t].to<=l&&a.splice(t--,1)}let h=s.finish();return new fN(h,e,fL(h))}}function fL(t,e=null,i=0){let n=null;return t.between(i,1e9,(t,i,{spec:o})=>{if(!(e&&0>o.diagnostics.indexOf(e))){if(n){if(0>o.diagnostics.indexOf(n.diagnostic))return!1;n=new fR(n.from,i,n.diagnostic)}else n=new fR(t,i,e||o.diagnostics[0])}}),n}function fF(t,e){let i=e.pos,n=e.end||i,o=t.state.facet(fX).hideOn(t,i,n);if(null!=o)return o;let r=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(t=>t.is(fH))||t.changes.touchesRange(r.from,Math.max(r.to,n)))}function fj(t,e){return t.field(fQ,!1)?e:e.concat(iq.appendConfig.of(pi))}const fH=iq.define(),fW=iq.define(),fV=iq.define(),fQ=iC.define({create:()=>new fN(oh.none,null,null),update(t,e){if(e.docChanged&&t.diagnostics.size){let i=t.diagnostics.map(e.changes),n=null,o=t.panel;if(t.selected){let o=e.changes.mapPos(t.selected.from,1);n=fL(i,t.selected.diagnostic,o)||fL(i,null,o)}!i.size&&o&&e.state.facet(fX).autoPanel&&(o=null),t=new fN(i,o,n)}for(let i of e.effects)if(i.is(fH)){let n=e.state.facet(fX).autoPanel?i.value.length?f1.open:null:t.panel;t=fN.init(i.value,n,e.state)}else i.is(fW)?t=new fN(t.diagnostics,i.value?f1.open:null,t.selected):i.is(fV)&&(t=new fN(t.diagnostics,t.panel,i.value));return t},provide:t=>[a_.from(t,t=>t.panel),sk.decorations.from(t,t=>t.diagnostics)]}),f$=oh.mark({class:"cm-lintRange cm-lintRange-active"});function fq(t,e){return uV("ul",{class:"cm-tooltip-lint"},e.map(e=>fZ(t,e,!1)))}const fU=t=>{let e=t.state.field(fQ,!1);return!!e&&!!e.panel&&(t.dispatch({effects:fW.of(!1)}),!0)},fY=[{key:"Mod-Shift-m",run:t=>{let e=t.state.field(fQ,!1);e&&e.panel||t.dispatch({effects:fj(t.state,[fW.of(!0)])});let i=ax(t,f1.open);return i&&i.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:t=>{let e=t.state.field(fQ,!1);if(!e)return!1;let i=t.state.selection.main,n=e.diagnostics.iter(i.to+1);return(!!n.value||!!(n=e.diagnostics.iter(0)).value&&(n.from!=i.from||n.to!=i.to))&&(t.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)}}],fG=o0.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(fX);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let t=Date.now();if(t<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:t}=this.view,{sources:e}=t.facet(fX);e.length&&function(t,e,i){let n=[],o=-1;for(let r of t)r.then(i=>{n.push(i),clearTimeout(o),n.length==t.length?e(n):o=setTimeout(()=>e(n),200)},i)}(e.map(t=>Promise.resolve(t(this.view))),e=>{if(this.view.state.doc==t.doc){var i,n;this.view.dispatch((i=this.view.state,n=e.reduce((t,e)=>t.concat(e)),{effects:fj(i,[fH.of(n)])}))}},t=>{oX(this.view.state,t)})}}update(t){let e=t.state.facet(fX);(t.docChanged||e!=t.startState.facet(fX)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),fX=iw.define({combine:t=>Object.assign({sources:t.map(t=>t.source).filter(t=>null!=t)},i1(t.map(t=>t.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(t,e)=>t?e?i=>t(i)||e(i):t:e}))});function fK(t){let e=[];if(t)o:for(let{name:i}of t){for(let t=0;t<i.length;t++){let n=i[t];if(/[a-zA-Z]/.test(n)&&!e.some(t=>t.toLowerCase()==n.toLowerCase())){e.push(n);continue o}}e.push("")}return e}function fZ(t,e,i){var n;let o=i?fK(e.actions):[];return uV("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},uV("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),null===(n=e.actions)||void 0===n?void 0:n.map((i,n)=>{let r=!1,s=n=>{if(n.preventDefault(),r)return;r=!0;let o=fL(t.state.field(fQ).diagnostics,e);o&&i.apply(t,o.from,o.to)},{name:a}=i,l=o[n]?a.indexOf(o[n]):-1,h=l<0?a:[a.slice(0,l),uV("u",a.slice(l,l+1)),a.slice(l+1)];return uV("button",{type:"button",class:"cm-diagnosticAction",onclick:s,onmousedown:s,"aria-label":` Action: ${a}${l<0?"":` (access key "${o[n]})"`}.`},h)}),e.source&&uV("div",{class:"cm-diagnosticSource"},e.source))}class fJ extends oa{constructor(t){super(),this.sev=t}eq(t){return t.sev==this.sev}toDOM(){return uV("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class f0{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(0xffffffff*Math.random()).toString(16),this.dom=fZ(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class f1{constructor(t){this.view=t,this.items=[],this.list=uV("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e=>{if(27==e.keyCode)fU(this.view),this.view.focus();else if(38==e.keyCode||33==e.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==e.keyCode||34==e.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==e.keyCode)this.moveSelection(0);else if(35==e.keyCode)this.moveSelection(this.items.length-1);else if(13==e.keyCode)this.view.focus();else{if(!(e.keyCode>=65)||!(e.keyCode<=90)||!(this.selectedIndex>=0))return;let{diagnostic:i}=this.items[this.selectedIndex],n=fK(i.actions);for(let o=0;o<n.length;o++)if(n[o].toUpperCase().charCodeAt(0)==e.keyCode){let e=fL(this.view.state.field(fQ).diagnostics,i);e&&i.actions[o].apply(t,e.from,e.to)}}e.preventDefault()},onclick:t=>{for(let e=0;e<this.items.length;e++)this.items[e].dom.contains(t.target)&&this.moveSelection(e)}}),this.dom=uV("div",{class:"cm-panel-lint"},this.list,uV("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>fU(this.view)},"Ã")),this.update()}get selectedIndex(){let t=this.view.state.field(fQ).selected;if(!t)return -1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return -1}update(){let{diagnostics:t,selected:e}=this.view.state.field(fQ),i=0,n=!1,o=null,r=new Set;for(t.between(0,this.view.state.doc.length,(t,s,{spec:a})=>{for(let t of a.diagnostics){if(r.has(t))continue;r.add(t);let s=-1,a;for(let e=i;e<this.items.length;e++)if(this.items[e].diagnostic==t){s=e;break}s<0?(a=new f0(this.view,t),this.items.splice(i,0,a),n=!0):(a=this.items[s],s>i&&(this.items.splice(i,s-i),n=!0)),e&&a.diagnostic==e.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),o=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();0==this.items.length&&(this.items.push(new f0(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:t,panel:e})=>{let i=e.height/this.list.offsetHeight;t.top<e.top?this.list.scrollTop-=(e.top-t.top)/i:t.bottom>e.bottom&&(this.list.scrollTop+=(t.bottom-e.bottom)/i)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let t=this.list.firstChild;function e(){let e=t;t=e.nextSibling,e.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;t!=i.dom;)e();t=i.dom.nextSibling}else this.list.insertBefore(i.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=fL(this.view.state.field(fQ).diagnostics,this.items[t].diagnostic);e&&this.view.dispatch({selection:{anchor:e.from,head:e.to},scrollIntoView:!0,effects:fV.of(e)})}static open(t){return new f1(t)}}function f2(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function f5(t){return f2(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const f3=sk.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:f5("#d11")},".cm-lintRange-warning":{backgroundImage:f5("orange")},".cm-lintRange-info":{backgroundImage:f5("#999")},".cm-lintRange-hint":{backgroundImage:f5("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function f4(t){let e="hint",i=1;for(let o of t){var n;let t="error"==(n=o.severity)?4:"warning"==n?3:"info"==n?2:1;t>i&&(i=t,e=o.severity)}return e}class f8 extends aC{constructor(t){super(),this.diagnostics=t,this.severity=f4(t)}toDOM(t){let e=document.createElement("div");e.className="cm-lint-marker cm-lint-marker-"+this.severity;let i=this.diagnostics,n=t.state.facet(pn).tooltipFilter;return n&&(i=n(i,t.state)),i.length&&(e.onmouseover=()=>(function(t,e,i){function n(){let n,o=t.elementAtHeight(e.getBoundingClientRect().top+5-t.documentTop);t.coordsAtPos(o.from)&&t.dispatch({effects:f7.of({pos:o.from,above:!1,clip:!1,create:()=>({dom:fq(t,i),getCoords:()=>e.getBoundingClientRect()})})}),e.onmouseout=e.onmousemove=null,n=i=>{let o=e.getBoundingClientRect();if(!(i.clientX>o.left-10)||!(i.clientX<o.right+10)||!(i.clientY>o.top-10)||!(i.clientY<o.bottom+10)){for(let t=i.target;t;t=t.parentNode)if(1==t.nodeType&&t.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",n),t.state.field(pt)&&t.dispatch({effects:f7.of(null)})}},window.addEventListener("mousemove",n)}let{hoverTime:o}=t.state.facet(pn),r=setTimeout(n,o);e.onmouseout=()=>{clearTimeout(r),e.onmouseout=e.onmousemove=null},e.onmousemove=()=>{clearTimeout(r),r=setTimeout(n,o)}})(t,e,i)),e}}const f6=aA({class:"cm-gutter-lint",markers:t=>t.state.field(f9),widgetMarker:(t,e,i)=>{let n=[];return t.state.field(f9).between(i.from,i.to,(t,e,o)=>{t>i.from&&t<i.to&&n.push(...o.diagnostics)}),n.length?new f8(n):null}}),f9=iC.define({create:()=>i8.empty,update(t,e){t=t.map(e.changes);let i=e.state.facet(pn).markerFilter;for(let n of e.effects)if(n.is(fH)){let o=n.value;i&&(o=i(o||[],e.state)),t=function(t,e){let i=Object.create(null);for(let n of e){let e=t.lineAt(n.from);(i[e.from]||(i[e.from]=[])).push(n)}let n=[];for(let t in i)n.push(new f8(i[t]).range(+t));return i8.of(n,!0)}(e.state.doc,o.slice(0))}return t}}),f7=iq.define(),pt=iC.define({create:()=>null,update:(t,e)=>(t&&e.docChanged&&(t=fF(e,t)?null:Object.assign(Object.assign({},t),{pos:e.changes.mapPos(t.pos)})),e.effects.reduce((t,e)=>e.is(f7)?e.value:t,t)),provide:t=>af.from(t)}),pe=sk.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:f2('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:f2('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:f2('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),pi=[fQ,sk.decorations.compute([fQ],t=>{let{selected:e,panel:i}=t.field(fQ);return e&&i&&e.from!=e.to?oh.set([f$.range(e.from,e.to)]):oh.none}),function(t,e={}){let i=iq.define(),n=iC.define({create:()=>[],update(t,n){if(t.length&&(e.hideOnChange&&(n.docChanged||n.selection)?t=[]:e.hideOn&&(t=t.filter(t=>!e.hideOn(n,t))),n.docChanged)){let e=[];for(let i of t){let t=n.changes.mapPos(i.pos,-1,is.TrackDel);if(null!=t){let o=Object.assign(Object.create(null),i);o.pos=t,null!=o.end&&(o.end=n.changes.mapPos(o.end)),e.push(o)}}t=e}for(let e of n.effects)e.is(i)&&(t=e.value),e.is(ab)&&(t=[]);return t},provide:t=>ap.from(t)});return{active:n,extension:[n,o0.define(o=>new av(o,t,n,i,e.hoverTime||300)),am]}}(function(t,e,i){let{diagnostics:n}=t.state.field(fQ),o,r=-1,s=-1;n.between(e-(i<0?1:0),e+(i>0?1:0),(t,n,{spec:a})=>{if(e>=t&&e<=n&&(t==n||(e>t||i>0)&&(e<n||i<0)))return o=a.diagnostics,r=t,s=n,!1});let a=t.state.facet(fX).tooltipFilter;return(o&&a&&(o=a(o,t.state)),o)?{pos:r,end:s,above:t.state.doc.lineAt(r).to<s,create:()=>({dom:fq(t,o)})}:null},{hideOn:fF}),f3],pn=iw.define({combine:t=>i1(t,{hoverTime:300,markerFilter:null,tooltipFilter:null})}),po="#e06c75",pr="#abb2bf",ps="#7d8799",pa="#d19a66",pl="#2c313a",ph="#282c34",pc="#353a42",pd="#528bff",pu=[sk.theme({"&":{color:pr,backgroundColor:ph},".cm-content":{caretColor:pd},".cm-cursor, .cm-dropCursor":{borderLeftColor:pd},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#3E4451"},".cm-panels":{backgroundColor:"#21252b",color:pr},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:ph,color:ps,border:"none"},".cm-activeLineGutter":{backgroundColor:pl},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:pc},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:pc,borderBottomColor:pc},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:pl,color:pr}}},{dark:!0}),ct(h8.define([{tag:hu.keyword,color:"#c678dd"},{tag:[hu.name,hu.deleted,hu.character,hu.propertyName,hu.macroName],color:po},{tag:[hu.function(hu.variableName),hu.labelName],color:"#61afef"},{tag:[hu.color,hu.constant(hu.name),hu.standard(hu.name)],color:pa},{tag:[hu.definition(hu.name),hu.separator],color:pr},{tag:[hu.typeName,hu.className,hu.number,hu.changed,hu.annotation,hu.modifier,hu.self,hu.namespace],color:"#e5c07b"},{tag:[hu.operator,hu.operatorKeyword,hu.url,hu.escape,hu.regexp,hu.link,hu.special(hu.string)],color:"#56b6c2"},{tag:[hu.meta,hu.comment],color:ps},{tag:hu.strong,fontWeight:"bold"},{tag:hu.emphasis,fontStyle:"italic"},{tag:hu.strikethrough,textDecoration:"line-through"},{tag:hu.link,color:ps,textDecoration:"underline"},{tag:hu.heading,fontWeight:"bold",color:po},{tag:[hu.atom,hu.bool,hu.special(hu.variableName)],color:pa},{tag:[hu.processingInstruction,hu.string,hu.inserted],color:"#98c379"},{tag:hu.invalid,color:"#ffffff"}]))];var pf=[{tag:hu.propertyName,color:"#ff7979"},{tag:hu.variableName,color:"#c4c4c4;"},{tag:hu.macroName,color:"#739777"},{tag:hu.string,color:"#9dd575"},{tag:hu.moduleKeyword,color:"#8b4de4",fontWeight:"bold"},{tag:hu.className,color:"#e5c07b",fontWeight:"bold"}];const pp=[function(t={}){return[aW.of(t),aI(),a$]}(),aY,function(t={}){return[s4.of(t),s8||(s8=o0.fromClass(class{constructor(t){this.view=t,this.decorations=oh.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(s4)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new s0({regexp:t.specialChars,decoration:(e,i,n)=>{let{doc:o}=i.state,r=ie(e[0],0);if(9==r){let t=o.lineAt(n),e=i.state.tabSize,r=nl(t.text,e,n-t.from);return oh.replace({widget:new s9((e-r%e)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[r]||(this.decorationCache[r]=oh.replace({widget:new s6(t,r)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(s4);t.startState.facet(s4)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))]}(),function(t={}){return[dH,dj.of(t),sk.domEventHandlers({beforeinput(t,e){let i="historyUndo"==t.inputType?dV:"historyRedo"==t.inputType?dQ:null;return!!i&&(t.preventDefault(),i(e))}})]}(),function(t={}){let e=Object.assign(Object.assign({},h5),t),i=new h3(e,!0),n=new h3(e,!1),o=o0.fromClass(class{constructor(t){this.from=t.viewport.from,this.markers=this.buildMarkers(t)}update(t){(t.docChanged||t.viewportChanged||t.startState.facet(hE)!=t.state.facet(hE)||t.startState.field(hq,!1)!=t.state.field(hq,!1)||hy(t.startState)!=hy(t.state)||e.foldingChanged(t))&&(this.markers=this.buildMarkers(t.view))}buildMarkers(t){let e=new i6;for(let o of t.viewportLineBlocks){let r=hU(t.state,o.from,o.to)?n:hH(t.state,o.from,o.to)?i:null;r&&e.add(o.from,o.from,r)}return e.finish()}}),{domEventHandlers:r}=e;return[o,aA({class:"cm-foldGutter",markers(t){var e;return(null===(e=t.plugin(o))||void 0===e?void 0:e.markers)||i8.empty},initialSpacer:()=>new h3(e,!1),domEventHandlers:Object.assign(Object.assign({},r),{click:(t,e,i)=>{if(r.click&&r.click(t,e,i))return!0;let n=hU(t.state,e.from,e.to);if(n)return t.dispatch({effects:hQ.of(n)}),!0;let o=hH(t.state,e.from,e.to);return!!o&&(t.dispatch({effects:hV.of(o)}),!0)}})}),hJ()]}(),function(t={}){return[sV.of(t),s$,sU,sG,o$.of(!0)]}(),[sK,sZ],i0.allowMultipleSelections.of(!0),i0.transactionFilter.of(t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let i=t.newDoc,{head:n}=t.newSelection.main,o=i.lineAt(n);if(n>o.from+200)return t;let r=i.sliceString(o.from,n);if(!e.some(t=>t.test(r)))return t;let{state:s}=t,a=-1,l=[];for(let{head:t}of s.selection.ranges){let e=s.doc.lineAt(t);if(e.from==a)continue;a=e.from;let i=hI(s,e.from);if(null==i)continue;let n=/^\s*/.exec(e.text)[0],o=hD(s,i);n!=o&&l.push({from:e.from,to:e.from+n.length,insert:o})}return l.length?[t,{changes:l,sequential:!0}]:t}),function(t={}){return[co.of(t),cl]}(),[db,dp],function(t={}){return[c9,c0,cN.of(t),c8,dC,c7]}(),(o=t=>t.altKey&&0==t.button,sk.mouseSelectionStyle.of((t,e)=>{let i,n;return o(e)?(i=ae(t,e),n=t.state.selection,i?{update(t){if(t.docChanged){let e=t.changes.mapPos(t.startState.doc.line(i.line).from),o=t.state.doc.lineAt(e);i={line:o.number,col:i.col,off:Math.min(i.off,o.length)},n=n.map(t.changes)}},get(e,o,r){let s=ae(t,e);if(!s)return n;let a=function(t,e,i){let n=Math.min(e.line,i.line),o=Math.max(e.line,i.line),r=[];if(e.off>2e3||i.off>2e3||e.col<0||i.col<0){let s=Math.min(e.off,i.off),a=Math.max(e.off,i.off);for(let e=n;e<=o;e++){let i=t.doc.line(e);i.length<=a&&r.push(iv.range(i.from+s,i.to+a))}}else{let s=Math.min(e.col,i.col),a=Math.max(e.col,i.col);for(let e=n;e<=o;e++){let i=t.doc.line(e),n=nh(i.text,s,t.tabSize,!0);if(n<0)r.push(iv.cursor(i.to));else{let e=nh(i.text,a,t.tabSize);r.push(iv.range(i.from+n,i.from+e))}}}return r}(t.state,i,s);return a.length?r?iv.create(a.concat(n.ranges)):iv.create(a):n}}:null):null})),function(t={}){let[e,i]=ai[t.key||"Alt"],n=o0.fromClass(class{constructor(t){this.view=t,this.isDown=!1}set(t){this.isDown!=t&&(this.isDown=t,this.view.update([]))}},{eventObservers:{keydown(t){this.set(t.keyCode==e||i(t))},keyup(t){t.keyCode!=e&&i(t)||this.set(!1)},mousemove(t){this.set(i(t))}}});return[n,sk.contentAttributes.of(t=>{var e;return(null===(e=t.plugin(n))||void 0===e?void 0:e.isDown)?an:null})]}(),at,[u7,u9],sT.of([...dw,...uH,...fP,{key:"Mod-z",run:dV,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:dQ,preventDefault:!0},{linux:"Ctrl-Shift-z",run:dQ,preventDefault:!0},{key:"Mod-u",run:d$,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:dq,preventDefault:!0},...hX,...d_,...fY])];var pg=({compile:t,defaultValue:e,onValueChange:i})=>{let n=function(t){let[e,i]=z(),[n,o]=z();function r(t){return function(t,e){let i=new iA,n=t=>{e()?.dispatch({effects:i.reconfigure(t)})};return N(j([e,"function"==typeof t?t:()=>t],([t,e])=>{t&&e&&(i.get(t.state)?n(e):t.dispatch({effects:iq.appendConfig.of(i.of(e))}))},{defer:!0})),n}(t,n)}return r(sk.updateListener.of(e=>t?.onModelViewUpdate?.(e))),N(j(e,e=>{var i;let r=new sk({state:i0.create({doc:t?.value??""}),parent:e,dispatch:(e,i)=>{if(t?.onTransactionDispatched&&t.onTransactionDispatched(e,i),r.update([e]),e.docChanged){let i=e.state.doc.toString();t?.onValueChange?.(i)}}});i=()=>o(r),N(()=>F(i)),H(()=>{n()?.destroy(),o(void 0)})})),N(j(n,e=>{let i=e?.state.doc.toString();i!==t?.value&&e&&e.dispatch({changes:{from:0,to:i?.length,insert:t?.value??""}})},{defer:!0})),{editorView:n,ref:i,createExtension:r}}({value:e,onValueChange:i}),o=sk.theme({"&":{textAlign:"left",fontSize:"18px"}});n.createExtension(o),n.createExtension(pp),n.createExtension(sT.of([uW])),n.createExtension(new hM(dP,[dT])),sk.theme({".cm-gutters":{borderRight:"#383e48 solid 2px"},".cm-line span":{position:"relative"},".cm-line span:hover::after":{position:"absolute",bottom:"100%",left:0,background:"black",color:"white",border:"solid 2px",borderRadius:"5px",content:"var(--tags)",width:"max-content",padding:"1px 4px",zIndex:10,pointerEvents:"none"}}),ct(h8.define(Object.entries(hu).map(([t,e])=>({tag:e,"--tags":`"tag.${t}"`}))));let r=h8.define(pf),s=[sk.theme({".cm-gutters":{borderRight:"#383e48 solid 2px"}}),ct(r)];n.createExtension(s),n.createExtension(pu);let a=function(t,e={}){return[fX.of({source:t,config:e}),fG,pi]}(e=>{console.log("linting");let i=[];try{t(e.state.doc.toString())}catch(t){console.log(t),console.log(Object.keys(t)),i.push({from:t.pos.start,to:t.pos.end,severity:"error",message:t.message})}return i});return n.createExtension(a),n.createExtension(function(t={}){return[pn.of(t),f9,f6,pe,pt]}()),n},pm=w("clphu"),pv=tx("<div class=state-graph>"),py=t=>{var e,i,n,o;let r=new pm.default.DataSet([]),s=new pm.default.DataSet([]);return N(()=>{r.clear(),s.clear(),r.add(t.nodes),s.add(t.edges)}),i=()=>{new pm.default.Network(e,{nodes:r,edges:s},{layout:{hierarchical:{direction:"UD",sortMethod:"directed"}},edges:{arrows:"to"},physics:{enabled:!0,hierarchicalRepulsion:{avoidOverlap:1}}})},N(()=>F(i)),n=pv(),"function"==typeof(o=e)?tS(o,n):e=n,n},pb=tx("<div id=header><button>Load Example"),pw=tx("<div>"),px=tx("<button>Run"),pk=tx("<button>Check"),pO=tx("<div><div>Console</div><pre>"),pS=tx("<div><div>Execution</div><pre>");eq().then(()=>{console.log("loaded")});const p_=t=>"tuple"==Object.keys(t)[0]?"("+Object.values(t)[0].map(p_).join(",")+")":t[Object.keys(t)[0]],pC=t=>"channels:\n"+[...t.channels.entries().map(([t,e])=>t.join(".")+" <- "+e.map(t=>p_(t)).join(","))].join("\n")+("\nGlobals: "+[...t.globals.entries().map(([t,e])=>t+"="+p_(e))].join(",")+"\nLocals: \n")+Object.values(t.locals).map(t=>"pc:"+t[1]+" stack:["+t[0].map(t=>p_(t)).join(",")+"]").join("\n"),pE=`

shared {
  let Done = false;
  let Leader = 0;
}

program A(my_id: int) {

  let leader_id = my_id;

  send out(my_id);

  loop atomic wait receive in (x) => {
    print("receive", x);
      if x > leader_id {
        leader_id = x;
        send out(x);
      } else {
        if x == leader_id {
          print("finished");
          send out(x);
          break;
        }
      }
  };
  
  if my_id == leader_id {
    print("I AM THE LEADER!!!");
    ! {
        Done = true;
        Leader += 1;
    }
  }
}

always {
    !Done || (Leader == 1);
}

main {
  let a = run A(1);
  let b = run A(2);

  channel a.out (int)> b.in;
  channel b.out (int)> a.in;

  print("DONE");
}

`;function pM(){var t;let i=pE;localStorage.getItem("source-code")&&(i=localStorage.getItem("source-code"));let n=pg({compile:eW,defaultValue:i,onValueChange:t=>{localStorage.setItem("source-code",t)}}),[o,r]=z([]),[s,a]=z([]),[l,h]=z("The console output will appear here"),[c,d]=z("The execution output will appear here");return[((t=pb()).firstChild.$$click=()=>{let t=n.editorView().state.update({changes:{from:0,to:n.editorView().state.doc.length,insert:pE}});n.editorView().update([t])},t),tn(eE,{id:"content",get children(){return[tn(eE.Panel,{class:"editor-panel",initialSize:.6,minSize:.2,get children(){var u=pw(),f=n.ref;return"function"==typeof f?tS(f,u):n.ref=u,u}}),tn(eE.Handle,{}),tn(eE.Panel,{class:"right-panel",initialSize:.4,minSize:.2,get children(){var p,g,m,v;return[((p=px()).$$click=t=>{try{let t=function(t){try{let o=e.__wbindgen_add_to_stack_pointer(-16),r=eF(t,e.__wbindgen_malloc,e.__wbindgen_realloc),s=eR;e.run(o,r,s);var i=eH().getInt32(o+0,!0),n=eH().getInt32(o+4,!0);if(eH().getInt32(o+8,!0))throw eT(n);return eT(i)}finally{e.__wbindgen_add_to_stack_pointer(16)}}(n.editorView().state.doc.toString());d(t.debug),h(t.stdout.join("\n"))}catch(t){d("ERROR: "+(t.pos&&"line "+t.pos.line)+"\n"+t.message)}},p),((g=pk()).$$click=t=>{try{let t=function(t){try{let o=e.__wbindgen_add_to_stack_pointer(-16),r=eF(t,e.__wbindgen_malloc,e.__wbindgen_realloc),s=eR;e.check(o,r,s);var i=eH().getInt32(o+0,!0),n=eH().getInt32(o+4,!0);if(eH().getInt32(o+8,!0))throw eT(n);return eT(i)}finally{e.__wbindgen_add_to_stack_pointer(16)}}(n.editorView().state.doc.toString());d(t),console.log(t);let i=[];t[0].length>0&&t[0].forEach(t=>{i.push(pC(t.to))});let o={};r(t[1].nodes.map((t,e)=>{let n=pC(t[0]),{level:r,predecessor:s,successors:a}=t[1];return o[n]=e,{id:e,level:r,label:n,color:i.includes(n)||i.length>0&&0==r?"#ec9999":"#a6dfa6",shape:"box",font:{align:"left"}}}));let s=[];t[1].nodes.forEach((t,e)=>{pC(t[0]);let{level:i,predecessor:n,successors:r}=t[1];r.forEach(({lines:t,pid:i,name:n,to:r})=>{r=pC(r),s.push({from:e,to:o[r],label:n+"#"+i+": "+t.join(",")})})}),a(s)}catch(t){d("ERROR: "+(t.pos&&"line "+t.pos.line)+"\n"+t.message)}},g),(t_((m=pO()).firstChild.nextSibling,l),m),(t_((v=pS()).firstChild.nextSibling,c),v),tn(py,{get nodes(){return o()},get edges(){return s()}})]}})]}})]}tk(["click"]);const pP=document.getElementById("app");pP&&function(t,e,i,n={}){let o;!function(t,e){let i=A,n=P,o=0===t.length,r=void 0===e?n:e,s=o?M:{owned:null,cleanups:null,context:r?r.context:null,owner:r},a=o?t:()=>t(()=>F(()=>te(s)));P=s,A=null;try{return K(a,!0)}finally{A=i,P=n}}(i=>{o=i,e===document?t():t_(e,t(),e.firstChild?null:void 0,void 0)},n.owner),()=>{o(),e.textContent=""}}(()=>tn(pM,{}),pP);
//# sourceMappingURL=index.88d096f7.js.map
